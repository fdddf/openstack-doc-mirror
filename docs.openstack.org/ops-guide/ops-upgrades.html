<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Upgrades</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Upgrades</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="ops-advanced-configuration.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Advanced Configuration"></i></a>
    
    
    <a href="app-usecases.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Use Cases"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 08:41</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Upgrades</a><ul>
<li><a class="reference internal" href="#pre-upgrade-considerations">Pre-upgrade considerations</a><ul>
<li><a class="reference internal" href="#upgrade-planning">Upgrade planning</a></li>
<li><a class="reference internal" href="#pre-upgrade-testing-environment">Pre-upgrade testing environment</a></li>
<li><a class="reference internal" href="#upgrade-levels">Upgrade Levels</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrade-process">Upgrade process</a><ul>
<li><a class="reference internal" href="#service-specific-upgrade-instructions">Service specific upgrade instructions</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#perform-a-backup">Perform a backup</a></li>
<li><a class="reference internal" href="#manage-repositories">Manage repositories</a></li>
<li><a class="reference internal" href="#upgrade-packages-on-each-node">Upgrade packages on each node</a></li>
<li><a class="reference internal" href="#update-services">Update services</a></li>
<li><a class="reference internal" href="#final-steps">Final steps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rolling-back-a-failed-upgrade">Rolling back a failed upgrade</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="upgrades">
<h1>Upgrades<a class="headerlink" href="#upgrades" title="Permalink to this headline">¶</a></h1>
<p>With the exception of Object Storage, upgrading from one version of
OpenStack to another can take a great deal of effort. This chapter
provides some guidance on the operational aspects that you should
consider for performing an upgrade for an OpenStack environment.</p>
<div class="section" id="pre-upgrade-considerations">
<h2>Pre-upgrade considerations<a class="headerlink" href="#pre-upgrade-considerations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="upgrade-planning">
<h3>Upgrade planning<a class="headerlink" href="#upgrade-planning" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Thoroughly review the <a class="reference external" href="https://releases.openstack.org/">release
notes</a> to learn
about new, updated, and deprecated features. Find incompatibilities
between versions.</li>
<li>Consider the impact of an upgrade to users. The upgrade process
interrupts management of your environment including the dashboard. If
you properly prepare for the upgrade, existing instances, networking,
and storage should continue to operate. However, instances might
experience intermittent network interruptions.</li>
<li>Consider the approach to upgrading your environment. You can perform
an upgrade with operational instances, but this is a dangerous
approach. You might consider using live migration to temporarily
relocate instances to other compute nodes while performing upgrades.
However, you must ensure database consistency throughout the process;
otherwise your environment might become unstable. Also, don&#8217;t forget
to provide sufficient notice to your users, including giving them
plenty of time to perform their own backups.</li>
<li>Consider adopting structure and options from the service
configuration files and merging them with existing configuration
files. The <a class="reference external" href="https://docs.openstack.org/newton/config-reference/">OpenStack Configuration
Reference</a>
contains new, updated, and deprecated options for most services.</li>
<li>Like all major system upgrades, your upgrade could fail for one or
more reasons. You can prepare for this situation by having the
ability to roll back your environment to the previous release,
including databases, configuration files, and packages. We provide an
example process for rolling back your environment in
<a class="reference internal" href="#rolling-back-a-failed-upgrade"><span class="std std-ref">Rolling back a failed upgrade</span></a>.</li>
<li>Develop an upgrade procedure and assess it thoroughly by using a test
environment similar to your production environment.</li>
</ul>
</div>
<div class="section" id="pre-upgrade-testing-environment">
<h3>Pre-upgrade testing environment<a class="headerlink" href="#pre-upgrade-testing-environment" title="Permalink to this headline">¶</a></h3>
<p>The most important step is the pre-upgrade testing. If you are upgrading
immediately after release of a new version, undiscovered bugs might
hinder your progress. Some deployers prefer to wait until the first
point release is announced. However, if you have a significant
deployment, you might follow the development and testing of the release
to ensure that bugs for your use cases are fixed.</p>
<p>Each OpenStack cloud is different even if you have a near-identical
architecture as described in this guide. As a result, you must still
test upgrades between versions in your environment using an approximate
clone of your environment.</p>
<p>However, that is not to say that it needs to be the same size or use
identical hardware as the production environment. It is important to
consider the hardware and scale of the cloud that you are upgrading. The
following tips can help you minimise the cost:</p>
<dl class="docutils">
<dt>Use your own cloud</dt>
<dd>The simplest place to start testing the next version of OpenStack is
by setting up a new environment inside your own cloud. This might
seem odd, especially the double virtualization used in running
compute nodes. But it is a sure way to very quickly test your
configuration.</dd>
<dt>Use a public cloud</dt>
<dd>Consider using a public cloud to test the scalability limits of your
cloud controller configuration. Most public clouds bill by the hour,
which means it can be inexpensive to perform even a test with many
nodes.</dd>
<dt>Make another storage endpoint on the same system</dt>
<dd>If you use an external storage plug-in or shared file system with
your cloud, you can test whether it works by creating a second share
or endpoint. This allows you to test the system before entrusting
the new version on to your storage.</dd>
<dt>Watch the network</dt>
<dd>Even at smaller-scale testing, look for excess network packets to
determine whether something is going horribly wrong in
inter-component communication.</dd>
</dl>
<p>To set up the test environment, you can use one of several methods:</p>
<ul>
<li><p class="first">Do a full manual install by using the <a class="reference external" href="https://docs.openstack.org/project-install-guide/newton/">Installation Tutorials and Guides</a> for
your platform. Review the final configuration files and installed
packages.</p>
</li>
<li><p class="first">Create a clone of your automated configuration infrastructure with
changed package repository URLs.</p>
<p>Alter the configuration until it works.</p>
</li>
</ul>
<p>Either approach is valid. Use the approach that matches your experience.</p>
<p>An upgrade pre-testing system is excellent for getting the configuration
to work. However, it is important to note that the historical use of the
system and differences in user interaction can affect the success of
upgrades.</p>
<p>If possible, we highly recommend that you dump your production database
tables and test the upgrade in your development environment using this
data. Several MySQL bugs have been uncovered during database migrations
because of slight table differences between a fresh installation and
tables that migrated from one version to another. This will have impact
on large real datasets, which you do not want to encounter during a
production outage.</p>
<p>Artificial scale testing can go only so far. After your cloud is
upgraded, you must pay careful attention to the performance aspects of
your cloud.</p>
</div>
<div class="section" id="upgrade-levels">
<h3>Upgrade Levels<a class="headerlink" href="#upgrade-levels" title="Permalink to this headline">¶</a></h3>
<p>Upgrade levels are a feature added to OpenStack Compute since the
Grizzly release to provide version locking on the RPC (Message Queue)
communications between the various Compute services.</p>
<p>This functionality is an important piece of the puzzle when it comes to
live upgrades and is conceptually similar to the existing API versioning
that allows OpenStack services of different versions to communicate
without issue.</p>
<p>Without upgrade levels, an X+1 version Compute service can receive and
understand X version RPC messages, but it can only send out X+1 version
RPC messages. For example, if a nova-conductor process has been upgraded
to X+1 version, then the conductor service will be able to understand
messages from X version nova-compute processes, but those compute
services will not be able to understand messages sent by the conductor
service.</p>
<p>During an upgrade, operators can add configuration options to
<code class="docutils literal"><span class="pre">nova.conf</span></code> which lock the version of RPC messages and allow live
upgrading of the services without interruption caused by version
mismatch. The configuration options allow the specification of RPC
version numbers if desired, but release name alias are also supported.
For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[upgrade_levels]</span>
<span class="na">compute</span><span class="o">=</span><span class="s">X+1</span>
<span class="na">conductor</span><span class="o">=</span><span class="s">X+1</span>
<span class="na">scheduler</span><span class="o">=</span><span class="s">X+1</span>
</pre></div>
</div>
<p>will keep the RPC version locked across the specified services to the
RPC version used in X+1. As all instances of a particular service are
upgraded to the newer version, the corresponding line can be removed
from <code class="docutils literal"><span class="pre">nova.conf</span></code>.</p>
<p>Using this functionality, ideally one would lock the RPC version to the
OpenStack version being upgraded from on nova-compute nodes, to ensure
that, for example X+1 version nova-compute processes will continue to
work with X version nova-conductor processes while the upgrade
completes. Once the upgrade of nova-compute processes is complete, the
operator can move onto upgrading nova-conductor and remove the version
locking for nova-compute in <code class="docutils literal"><span class="pre">nova.conf</span></code>.</p>
</div>
</div>
<div class="section" id="upgrade-process">
<h2>Upgrade process<a class="headerlink" href="#upgrade-process" title="Permalink to this headline">¶</a></h2>
<p>This section describes the process to upgrade a basic OpenStack
deployment based on the basic two-node architecture in the <a class="reference external" href="https://docs.openstack.org/project-install-guide/newton/">Installation
Tutorials and Guides</a>. All
nodes must run a supported distribution of Linux with a recent kernel
and the current release packages.</p>
<div class="section" id="service-specific-upgrade-instructions">
<h3>Service specific upgrade instructions<a class="headerlink" href="#service-specific-upgrade-instructions" title="Permalink to this headline">¶</a></h3>
<p>Refer to the following upgrade notes for information on upgrading specific
OpenStack services:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.openstack.org/developer/neutron/devref/upgrade.html">Upgrading the Networking service</a></li>
<li><a class="reference external" href="https://docs.openstack.org/developer/nova/upgrade.html">Upgrading the Compute service</a></li>
<li><a class="reference external" href="https://docs.openstack.org/developer/keystone/upgrading.html">Upgrading the Identity service</a></li>
<li><a class="reference external" href="https://docs.openstack.org/developer/cinder/upgrade.html">Upgrading the Block Storage service</a></li>
</ul>
</div>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Perform some cleaning of the environment prior to starting the
upgrade process to ensure a consistent state. For example, instances
not fully purged from the system after deletion might cause
indeterminate behavior.</p>
</li>
<li><p class="first">For environments using the OpenStack Networking service (neutron),
verify the release version of the database. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;neutron-db-manage --config-file /etc/neutron/neutron.conf \</span>
<span class="s2">  --config-file /etc/neutron/plugins/ml2/ml2_conf.ini current&quot;</span> neutron
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="perform-a-backup">
<h3>Perform a backup<a class="headerlink" href="#perform-a-backup" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Save the configuration files on all nodes. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="k">for</span> i in keystone glance nova neutron openstack-dashboard cinder heat ceilometer<span class="p">;</span> <span class="se">\</span>
  <span class="k">do</span> mkdir <span class="nv">$i</span>-RELEASE_NAME<span class="p">;</span> <span class="se">\</span>
  <span class="k">done</span>
<span class="gp">#</span> <span class="k">for</span> i in keystone glance nova neutron openstack-dashboard cinder heat ceilometer<span class="p">;</span> <span class="se">\</span>
  <span class="k">do</span> cp -r /etc/<span class="nv">$i</span>/* <span class="nv">$i</span>-RELEASE_NAME/<span class="p">;</span> <span class="se">\</span>
  <span class="k">done</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can modify this example script on each node to handle different
services.</p>
</div>
</li>
<li><p class="first">Make a full database backup of your production data. Since the Kilo release,
database downgrades are not supported, and restoring from backup is the only
method available to retrieve a previous database version.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mysqldump -u root -p --opt --add-drop-database --all-databases &gt; RELEASE_NAME-db-backup.sql
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Consider updating your SQL server configuration as described in the
<a class="reference external" href="https://docs.openstack.org/project-install-guide/newton/">Installation Tutorials and Guides</a>.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="manage-repositories">
<h3>Manage repositories<a class="headerlink" href="#manage-repositories" title="Permalink to this headline">¶</a></h3>
<p>On all nodes:</p>
<ol class="arabic simple">
<li>Remove the repository for the previous release packages.</li>
<li>Add the repository for the new release packages.</li>
<li>Update the repository database.</li>
</ol>
</div>
<div class="section" id="upgrade-packages-on-each-node">
<h3>Upgrade packages on each node<a class="headerlink" href="#upgrade-packages-on-each-node" title="Permalink to this headline">¶</a></h3>
<p>Depending on your specific configuration, upgrading all packages might
restart or break services supplemental to your OpenStack environment.
For example, if you use the TGT iSCSI framework for Block Storage
volumes and the upgrade includes new packages for it, the package
manager might restart the TGT iSCSI services and impact connectivity to
volumes.</p>
<p>If the package manager prompts you to update configuration files, reject
the changes. The package manager appends a suffix to newer versions of
configuration files. Consider reviewing and adopting content from these
files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to explicitly install the <code class="docutils literal"><span class="pre">ipset</span></code> package if your
distribution does not install it as a dependency.</p>
</div>
</div>
<div class="section" id="update-services">
<h3>Update services<a class="headerlink" href="#update-services" title="Permalink to this headline">¶</a></h3>
<p>To update a service on each node, you generally modify one or more
configuration files, stop the service, synchronize the database schema,
and start the service. Some services require different steps. We
recommend verifying operation of each service before proceeding to the
next service.</p>
<p>The order you should upgrade services, and any changes from the general
upgrade process is described below:</p>
<p><strong>Controller node</strong></p>
<ol class="arabic simple">
<li>Identity service - Clear any expired tokens before synchronizing
the database.</li>
<li>Image service</li>
<li>Compute service, including networking components.</li>
<li>Networking service</li>
<li>Block Storage service</li>
<li>Dashboard - In typical environments, updating Dashboard only
requires restarting the Apache HTTP service.</li>
<li>Orchestration service</li>
<li>Telemetry service - In typical environments, updating the
Telemetry service only requires restarting the service.</li>
<li>Compute service - Edit the configuration file and restart the service.</li>
<li>Networking service - Edit the configuration file and restart the service.</li>
</ol>
<p><strong>Storage nodes</strong></p>
<ul class="simple">
<li>Block Storage service - Updating the Block Storage service only requires
restarting the service.</li>
</ul>
<p><strong>Compute nodes</strong></p>
<ul class="simple">
<li>Networking service - Edit the configuration file and restart the service.</li>
</ul>
</div>
<div class="section" id="final-steps">
<h3>Final steps<a class="headerlink" href="#final-steps" title="Permalink to this headline">¶</a></h3>
<p>On all distributions, you must perform some final tasks to complete the
upgrade process.</p>
<ol class="arabic simple">
<li>Decrease DHCP timeouts by modifying the <code class="file docutils literal"><span class="pre">/etc/nova/nova.conf</span></code> file on
the compute nodes back to the original value for your environment.</li>
<li>Update all <code class="docutils literal"><span class="pre">.ini</span></code> files to match passwords and pipelines as required
for the OpenStack release in your environment.</li>
<li>After migration, users see different results from
<strong class="command">openstack image list</strong> and <strong class="command">glance image-list</strong>. To ensure
users see the same images in the list commands, edit the
<code class="file docutils literal"><span class="pre">/etc/glance/policy.json</span></code> file and <code class="file docutils literal"><span class="pre">/etc/nova/policy.json</span></code> file
to contain <code class="docutils literal"><span class="pre">&quot;context_is_admin&quot;:</span> <span class="pre">&quot;role:admin&quot;</span></code>, which limits access to
private images for projects.</li>
<li>Verify proper operation of your environment. Then, notify your users
that their cloud is operating normally again.</li>
</ol>
</div>
</div>
<div class="section" id="rolling-back-a-failed-upgrade">
<span id="id3"></span><h2>Rolling back a failed upgrade<a class="headerlink" href="#rolling-back-a-failed-upgrade" title="Permalink to this headline">¶</a></h2>
<p>This section provides guidance for rolling back to a previous release of
OpenStack. All distributions follow a similar procedure.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Rolling back your environment should be the final course of action
since you are likely to lose any data added since the backup.</p>
</div>
<p>A common scenario is to take down production management services in
preparation for an upgrade, completed part of the upgrade process, and
discovered one or more problems not encountered during testing. As a
consequence, you must roll back your environment to the original &#8220;known
good&#8221; state. You also made sure that you did not make any state changes
after attempting the upgrade process; no new instances, networks,
storage volumes, and so on. Any of these new resources will be in a
frozen state after the databases are restored from backup.</p>
<p>Within this scope, you must complete these steps to successfully roll
back your environment:</p>
<ol class="arabic simple">
<li>Roll back configuration files.</li>
<li>Restore databases from backup.</li>
<li>Roll back packages.</li>
</ol>
<p>You should verify that you have the requisite backups to restore.
Rolling back upgrades is a tricky process because distributions tend to
put much more effort into testing upgrades than downgrades. Broken
downgrades take significantly more effort to troubleshoot and, resolve
than broken upgrades. Only you can weigh the risks of trying to push a
failed upgrade forward versus rolling it back. Generally, consider
rolling back as the very last option.</p>
<p>The following steps described for Ubuntu have worked on at least one
production environment, but they might not work for all environments.</p>
<p><strong>To perform a rollback</strong></p>
<ol class="arabic">
<li><p class="first">Stop all OpenStack services.</p>
</li>
<li><p class="first">Copy contents of configuration backup directories that you created
during the upgrade process back to <code class="docutils literal"><span class="pre">/etc/&lt;service&gt;</span></code> directory.</p>
</li>
<li><p class="first">Restore databases from the <code class="docutils literal"><span class="pre">RELEASE_NAME-db-backup.sql</span></code> backup file
that you created with the <strong class="command">mysqldump</strong> command during the upgrade
process:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mysql -u root -p &lt; RELEASE_NAME-db-backup.sql
</pre></div>
</div>
</li>
<li><p class="first">Downgrade OpenStack packages.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Downgrading packages is by far the most complicated step; it is
highly dependent on the distribution and the overall administration
of the system.</p>
</div>
<ol class="arabic">
<li><p class="first">Determine which OpenStack packages are installed on your system. Use the
<strong class="command">dpkg --get-selections</strong> command. Filter for OpenStack
packages, filter again to omit packages explicitly marked in the
<code class="docutils literal"><span class="pre">deinstall</span></code> state, and save the final output to a file. For example,
the following command covers a controller node with keystone, glance,
nova, neutron, and cinder:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> dpkg --get-selections <span class="p">|</span> grep -e keystone -e glance -e nova -e neutron <span class="se">\</span>
-e cinder <span class="p">|</span> grep -v deinstall <span class="p">|</span> tee openstack-selections
<span class="go">cinder-api                                      install</span>
<span class="go">cinder-common                                   install</span>
<span class="go">cinder-scheduler                                install</span>
<span class="go">cinder-volume                                   install</span>
<span class="go">glance                                          install</span>
<span class="go">glance-api                                      install</span>
<span class="go">glance-common                                   install</span>
<span class="go">glance-registry                                 install</span>
<span class="go">neutron-common                                  install</span>
<span class="go">neutron-dhcp-agent                              install</span>
<span class="go">neutron-l3-agent                                install</span>
<span class="go">neutron-lbaas-agent                             install</span>
<span class="go">neutron-metadata-agent                          install</span>
<span class="go">neutron-plugin-openvswitch                      install</span>
<span class="go">neutron-plugin-openvswitch-agent                install</span>
<span class="go">neutron-server                                  install</span>
<span class="go">nova-api                                        install</span>
<span class="go">nova-cert                                       install</span>
<span class="go">nova-common                                     install</span>
<span class="go">nova-conductor                                  install</span>
<span class="go">nova-consoleauth                                install</span>
<span class="go">nova-novncproxy                                 install</span>
<span class="go">nova-objectstore                                install</span>
<span class="go">nova-scheduler                                  install</span>
<span class="go">python-cinder                                   install</span>
<span class="go">python-cinderclient                             install</span>
<span class="go">python-glance                                   install</span>
<span class="go">python-glanceclient                             install</span>
<span class="go">python-keystone                                 install</span>
<span class="go">python-keystoneclient                           install</span>
<span class="go">python-neutron                                  install</span>
<span class="go">python-neutronclient                            install</span>
<span class="go">python-nova                                     install</span>
<span class="go">python-novaclient                               install</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Depending on the type of server, the contents and order of your
package list might vary from this example.</p>
</div>
</li>
<li><p class="first">You can determine the package versions available for reversion by using
the <code class="docutils literal"><span class="pre">apt-cache</span> <span class="pre">policy</span></code> command. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-cache policy nova-common

<span class="go">nova-common:</span>
<span class="go">Installed: 2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">Candidate: 2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">Version table:</span>
<span class="go">*** 2:14.0.1-0ubuntu1~cloud0 500</span>
<span class="go">      500 http://ubuntu-cloud.archive.canonical.com/ubuntu xenial-updates/newton/main amd64 Packages</span>
<span class="go">      100 /var/lib/dpkg/status</span>
<span class="go">    2:13.1.2-0ubuntu2 500</span>
<span class="go">      500 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages</span>
<span class="go">    2:13.0.0-0ubuntu2 500</span>
<span class="go">      500 http://archive.ubuntu.com/ubuntu xenial/main amd64 Packages</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you removed the release repositories, you must first reinstall
them and run the <strong class="command">apt-get update</strong> command.</p>
</div>
<p>The command output lists the currently installed version of the package,
newest candidate version, and all versions along with the repository that
contains each version. Look for the appropriate release
version— <code class="docutils literal"><span class="pre">2:14.0.1-0ubuntu1~cloud0</span></code> in this case. The process of
manually picking through this list of packages is rather tedious and
prone to errors. You should consider using a script to help
with this process. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="k">for</span> i in <span class="sb">`</span>cut -f <span class="m">1</span> openstack-selections <span class="p">|</span> sed <span class="s1">&#39;s/neutron/;&#39;</span><span class="sb">`</span><span class="p">;</span>
<span class="go">  do echo -n $i ;apt-cache policy $i | grep -B 1 RELEASE_NAME |</span>
<span class="go">  grep -v Packages | awk &#39;{print &quot;=&quot;$1}&#39;;done | tr &#39;\n&#39; &#39; &#39; |</span>
<span class="go">  tee openstack-RELEASE_NAME-versions</span>
<span class="go">cinder-api=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">cinder-common=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">cinder-scheduler=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">cinder-volume=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">glance=2:13.0.0-0ubuntu1~cloud0</span>
<span class="go">glance-api=2:13.0.0-0ubuntu1~cloud0 500</span>
<span class="go">glance-common=2:13.0.0-0ubuntu1~cloud0 500</span>
<span class="go">glance-registry=2:13.0.0-0ubuntu1~cloud0 500</span>
<span class="go">neutron-common=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">neutron-dhcp-agent=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">neutron-l3-agent=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">neutron-lbaas-agent=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">neutron-metadata-agent=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">neutron-server=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">nova-api=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-cert=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-common=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-conductor=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-consoleauth=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-novncproxy=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-objectstore=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">nova-scheduler=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">python-cinder=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">python-cinderclient=1:1.9.0-0ubuntu1~cloud0</span>
<span class="go">python-glance=2:13.0.0-0ubuntu1~cloud0</span>
<span class="go">python-glanceclient=1:2.5.0-0ubuntu1~cloud0</span>
<span class="go">python-neutron=2:9.0.0-0ubuntu1~cloud0</span>
<span class="go">python-neutronclient=1:6.0.0-0ubuntu1~cloud0</span>
<span class="go">python-nova=2:14.0.1-0ubuntu1~cloud0</span>
<span class="go">python-novaclient=2:6.0.0-0ubuntu1~cloud0</span>
<span class="go">python-openstackclient=3.2.0-0ubuntu2~cloud0</span>
</pre></div>
</div>
</li>
<li><p class="first">Use the <strong class="command">apt-get install</strong> command to install specific versions
of each package by specifying <code class="docutils literal"><span class="pre">&lt;package-name&gt;=&lt;version&gt;</span></code>. The script in
the previous step conveniently created a list of <code class="docutils literal"><span class="pre">package=version</span></code>
pairs for you:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install <span class="sb">`</span>cat openstack-RELEASE_NAME-versions<span class="sb">`</span>
</pre></div>
</div>
<p>This step completes the rollback procedure. You should remove the
upgrade release repository and run <strong class="command">apt-get update</strong> to prevent
accidental upgrades until you solve whatever issue caused you to roll
back your environment.</p>
</li>
</ol>
</li>
</ol>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="ops-advanced-configuration.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Advanced Configuration"></i></a>
          
          
            <a href="app-usecases.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Use Cases"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 08:41</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="operations.html">Operations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ops-lay-of-the-land.html">Lay of the Land</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-projects-users.html">Managing Projects and Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-user-facing-operations.html">User-Facing Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-maintenance.html">Maintenance, Failures, and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-network-troubleshooting.html">Network Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-logging-monitoring.html">Logging and Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-backup-recovery.html">Backup and Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-customize.html">Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-advanced-configuration.html">Advanced Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Upgrades</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app-usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-crypt.html">Tales From the Cryp^H^H^H^H Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-roadmaps.html">Working with Roadmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "ops-upgrades" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/ops-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 0719207c6d82d2c215b9c13234f3a27478e0c0f3";
        var bugProject = "openstack-manuals";
        var bugTitle = "Upgrades in Operations Guide";
    var fieldTags = "ops-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.0.1 on 2017-02-14 08:41";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>