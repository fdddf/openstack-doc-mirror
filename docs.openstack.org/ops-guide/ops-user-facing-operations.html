<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: User-Facing Operations</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>User-Facing Operations</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="ops-projects-users-summary.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Summary"></i></a>
    
    
    <a href="ops-maintenance.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Maintenance, Failures, and Debugging"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 08:41</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">User-Facing Operations</a><ul>
<li><a class="reference internal" href="#images">Images</a><ul>
<li><a class="reference internal" href="#adding-images">Adding Images</a></li>
<li><a class="reference internal" href="#adding-signed-images">Adding Signed Images</a></li>
<li><a class="reference internal" href="#sharing-images-between-projects">Sharing Images Between Projects</a></li>
<li><a class="reference internal" href="#deleting-images">Deleting Images</a></li>
<li><a class="reference internal" href="#other-cli-options">Other CLI Options</a></li>
<li><a class="reference internal" href="#the-image-service-and-the-database">The Image service and the Database</a></li>
<li><a class="reference internal" href="#example-image-service-database-queries">Example Image service Database Queries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flavors">Flavors</a><ul>
<li><a class="reference internal" href="#private-flavors">Private Flavors</a></li>
<li><a class="reference internal" href="#how-do-i-modify-an-existing-flavor">How Do I Modify an Existing Flavor?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-groups">Security Groups</a><ul>
<li><a class="reference internal" href="#general-security-groups-configuration">General Security Groups Configuration</a></li>
<li><a class="reference internal" href="#end-user-configuration-of-security-groups">End-User Configuration of Security Groups</a></li>
</ul>
</li>
<li><a class="reference internal" href="#block-storage">Block Storage</a><ul>
<li><a class="reference internal" href="#block-storage-creation-failures">Block Storage Creation Failures</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shared-file-systems-service">Shared File Systems Service</a><ul>
<li><a class="reference internal" href="#create-share">Create Share</a></li>
<li><a class="reference internal" href="#manage-access-to-shares">Manage Access To Shares</a></li>
<li><a class="reference internal" href="#manage-shares">Manage Shares</a></li>
<li><a class="reference internal" href="#update-share">Update Share</a></li>
<li><a class="reference internal" href="#reset-share-state">Reset Share State</a></li>
<li><a class="reference internal" href="#delete-share">Delete Share</a></li>
<li><a class="reference internal" href="#create-snapshots">Create Snapshots</a></li>
<li><a class="reference internal" href="#create-a-share-network">Create a Share Network</a></li>
<li><a class="reference internal" href="#manage-a-share-network">Manage a Share Network</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instances">Instances</a><ul>
<li><a class="reference internal" href="#starting-instances">Starting Instances</a></li>
<li><a class="reference internal" href="#instance-boot-failures">Instance Boot Failures</a></li>
<li><a class="reference internal" href="#using-instance-specific-data">Using Instance-Specific Data</a></li>
<li><a class="reference internal" href="#instance-metadata">Instance metadata</a></li>
<li><a class="reference internal" href="#instance-user-data">Instance user data</a></li>
<li><a class="reference internal" href="#file-injection">File injection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#associating-security-groups">Associating Security Groups</a></li>
<li><a class="reference internal" href="#floating-ips">Floating IPs</a></li>
<li><a class="reference internal" href="#attaching-block-storage">Attaching Block Storage</a></li>
<li><a class="reference internal" href="#taking-snapshots">Taking Snapshots</a><ul>
<li><a class="reference internal" href="#live-snapshots">Live Snapshots</a></li>
</ul>
</li>
<li><a class="reference internal" href="#instances-in-the-database">Instances in the Database</a></li>
<li><a class="reference internal" href="#good-luck">Good Luck!</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="user-facing-operations">
<h1>User-Facing Operations<a class="headerlink" href="#user-facing-operations" title="Permalink to this headline">¶</a></h1>
<p>This guide is for OpenStack operators and does not seek to be an
exhaustive reference for users, but as an operator, you should have a
basic understanding of how to use the cloud facilities. This chapter
looks at OpenStack from a basic user perspective, which helps you
understand your users&#8217; needs and determine, when you get a trouble
ticket, whether it is a user issue or a service issue. The main concepts
covered are images, flavors, security groups, block storage, shared file
system storage, and instances.</p>
<div class="section" id="images">
<h2>Images<a class="headerlink" href="#images" title="Permalink to this headline">¶</a></h2>
<p>OpenStack images can often be thought of as &#8220;virtual machine templates.&#8221;
Images can also be standard installation media such as ISO images.
Essentially, they contain bootable file systems that are used to launch
instances.</p>
<div class="section" id="adding-images">
<h3>Adding Images<a class="headerlink" href="#adding-images" title="Permalink to this headline">¶</a></h3>
<p>Several pre-made images exist and can easily be imported into the Image
service. A common image to add is the CirrOS image, which is very small
and used for testing purposes. To add this image, simply do:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img
<span class="gp">$</span> openstack image create --file cirros-0.3.4-x86_64-disk.img <span class="se">\</span>
  --public --container-format bare <span class="se">\</span>
  --disk-format qcow2 <span class="s2">&quot;cirros image&quot;</span>
</pre></div>
</div>
<p>The <strong class="command">openstack image create</strong> command provides a large set of options
for working with your image. For example, the <code class="docutils literal"><span class="pre">--min-disk</span></code> option is
useful for images that require root disks of a certain size (for example,
large Windows images). To view these options, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack <span class="nb">help</span> image create
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">location</span></code> option is important to note. It does not copy the
entire image into the Image service, but references an original location
where the image can be found. Upon launching an instance of that image,
the Image service accesses the image from the location specified.</p>
<p>The <code class="docutils literal"><span class="pre">copy-from</span></code> option copies the image from the location specified
into the <code class="docutils literal"><span class="pre">/var/lib/glance/images</span></code> directory. The same thing is done
when using the STDIN redirection with &lt;, as shown in the example.</p>
<p>Run the following command to view the properties of existing images:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image show IMAGE_NAME_OR_UUID
</pre></div>
</div>
</div>
<div class="section" id="adding-signed-images">
<h3>Adding Signed Images<a class="headerlink" href="#adding-signed-images" title="Permalink to this headline">¶</a></h3>
<p>To provide a chain of trust from an end user to the Image service,
and the Image service to Compute, an end user can import signed images
that can be initially verified in the Image service, and later verified
in the Compute service.  Appropriate Image service properties need
to be set to enable this signature feature.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to the steps below, an asymmetric keypair and certificate must
be generated. In this example, these are called private_key.pem and
new_cert.crt, respectively, and both reside in the current
directory. Also note that the image in this example is
cirros-0.3.4-x86_64-disk.img, but any image can be used.</p>
</div>
<p>The following are steps needed to create the signature used for the
signed images:</p>
<ol class="arabic">
<li><p class="first">Retrieve image for upload</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img
</pre></div>
</div>
</li>
<li><p class="first">Use private key to create a signature of the image</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The following implicit values are being used to create the signature
in this example:</p>
<ul class="last simple">
<li>Signature hash method = SHA-256</li>
<li>Signature key type = RSA-PSS</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The following options are currently supported:</p>
<ul class="last simple">
<li>Signature hash methods: SHA-224, SHA-256, SHA-384, and SHA-512</li>
<li>Signature key types: DSA, ECC_SECT571K1, ECC_SECT409K1,
ECC_SECT571R1, ECC_SECT409R1, ECC_SECP521R1, ECC_SECP384R1,
and RSA-PSS</li>
</ul>
</div>
<p>Generate signature of image and convert it to a base64 representation:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openssl dgst -sha256 -sign private_key.pem -sigopt rsa_padding_mode:pss <span class="se">\</span>
  -out image-file.signature cirros-0.3.4-x86_64-disk.img
<span class="gp">$</span> base64 -w <span class="m">0</span> image-file.signature &gt; signature_64
<span class="gp">$</span> cat signature_64
<span class="go">&#39;c4br5f3FYQV6Nu20cRUSnx75R/VcW3diQdsUN2nhPw+UcQRDoGx92hwMgRxzFYeUyydRTWCcUS2ZLudPR9X7rM</span>
<span class="go">THFInA54Zj1TwEIbJTkHwlqbWBMU4+k5IUIjXxHO6RuH3Z5f/SlSt7ajsNVXaIclWqIw5YvEkgXTIEuDPE+C4=&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Using Image API v1 requires &#8216;-w 0&#8217; above, since multiline image
properties are not supported.</li>
<li>Image API v2 supports multiline properties, so this option is not
required for v2 but it can still be used.</li>
</ul>
</div>
</li>
<li><p class="first">Create context</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> python
<span class="gp">&gt;</span>&gt;&gt; from keystoneclient.v3 import client
<span class="gp">&gt;</span>&gt;&gt; <span class="nv">keystone_client</span> <span class="o">=</span> client.Client<span class="o">(</span><span class="nv">username</span><span class="o">=</span><span class="s1">&#39;demo&#39;</span>,
<span class="go">                                    user_domain_name=&#39;Default&#39;,</span>
<span class="go">                                    password=&#39;password&#39;,</span>
<span class="go">                                    project_name=&#39;demo&#39;,</span>
<span class="go">                                    auth_url=&#39;http://localhost:5000/v3&#39;)</span>

<span class="gp">&gt;</span>&gt;&gt; from oslo_context import context
<span class="gp">&gt;</span>&gt;&gt; <span class="nv">context</span> <span class="o">=</span> context.RequestContext<span class="o">(</span><span class="nv">auth_token</span><span class="o">=</span>keystone_client.auth_token,
<span class="go">                                     tenant=keystone_client.project_id)</span>
</pre></div>
</div>
</li>
<li><p class="first">Encode certificate in DER format</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cryptography</span> <span class="kn">import</span> <span class="n">x509</span> <span class="k">as</span> <span class="n">cryptography_x509</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cryptography.hazmat</span> <span class="kn">import</span> <span class="n">backends</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;new_cert.crt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cert_file</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>     <span class="n">cert</span> <span class="o">=</span> <span class="n">cryptography_x509</span><span class="o">.</span><span class="n">load_pem_x509_certificate</span><span class="p">(</span>
<span class="go">                  cert_file.read(),</span>
<span class="go">                  backend=backends.default_backend()</span>
<span class="go">                  )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">certificate_der</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">DER</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Upload Certificate in DER format to Castellan</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">castellan.common.objects</span> <span class="kn">import</span> <span class="n">x_509</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">castellan</span> <span class="kn">import</span> <span class="n">key_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">castellan_cert</span> <span class="o">=</span> <span class="n">x_509</span><span class="o">.</span><span class="n">X509</span><span class="p">(</span><span class="n">certificate_der</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">key_API</span> <span class="o">=</span> <span class="n">key_manager</span><span class="o">.</span><span class="n">API</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cert_uuid</span> <span class="o">=</span> <span class="n">key_API</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">castellan_cert</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cert_uuid</span>
<span class="go">u&#39;62a33f41-f061-44ba-9a69-4fc247d3bfce&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Upload Image to Image service, with Signature Metadata</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The following signature properties are used:</p>
<ul class="last simple">
<li>img_signature uses the signature called signature_64</li>
<li>img_signature_certificate_uuid uses the value from cert_uuid
in section 5 above</li>
<li>img_signature_hash_method matches &#8216;SHA-256&#8217; in section 2 above</li>
<li>img_signature_key_type matches &#8216;RSA-PSS&#8217; in section 2 above</li>
</ul>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> . openrc demo
<span class="gp">$</span> <span class="nb">export</span> <span class="nv">OS_IMAGE_API_VERSION</span><span class="o">=</span><span class="m">2</span>
<span class="gp">$</span> openstack image create --property <span class="nv">name</span><span class="o">=</span>cirrosSignedImage_goodSignature <span class="se">\</span>
  --property is-public<span class="o">=</span><span class="nb">true</span> --container-format bare --disk-format qcow2 <span class="se">\</span>
  --property <span class="nv">img_signature</span><span class="o">=</span><span class="s1">&#39;c4br5f3FYQV6Nu20cRUSnx75R/VcW3diQdsUN2nhPw+UcQRDoGx92hwMgRxzFYeUyydRTWCcUS2ZLudPR9X7rMTHFInA54Zj1TwEIbJTkHwlqbWBMU4+k5IUIjXxHO6RuH3Z5fSlSt7ajsNVXaIclWqIw5YvEkgXTIEuDPE+C4=&#39;</span> <span class="se">\</span>
  --property <span class="nv">img_signature_certificate_uuid</span><span class="o">=</span><span class="s1">&#39;62a33f41-f061-44ba-9a69-4fc247d3bfce&#39;</span> <span class="se">\</span>
  --property <span class="nv">img_signature_hash_method</span><span class="o">=</span><span class="s1">&#39;SHA-256&#39;</span> <span class="se">\</span>
  --property <span class="nv">img_signature_key_type</span><span class="o">=</span><span class="s1">&#39;RSA-PSS&#39;</span> &lt; ~/cirros-0.3.4-x86_64-disk.img
</pre></div>
</div>
</li>
<li><p class="first">Signature verification will occur when Compute boots the signed image</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>nova-compute servers first need to be updated by the following steps:</p>
<ul class="last simple">
<li>Ensure that cryptsetup is installed, and ensure that
<code class="docutils literal"><span class="pre">pythin-barbicanclient</span></code> Python package is installed</li>
<li>Set up the Key Manager service by editing /etc/nova/nova.conf and
adding the entries in the codeblock below</li>
<li>The flag verify_glance_signatures enables Compute to automatically
validate signed instances prior to its launch.  This validation
feature is enabled when the value is set to TRUE</li>
</ul>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">[key_manager]</span>
<span class="go">api_class = castellan.key_manager.barbican_key_manager.BarbicanKeyManager</span>
<span class="go">[glance]</span>
<span class="go">verify_glance_signatures = TRUE</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The api_class [keymgr] is deprecated as of Newton, so it
should not be included in this release or beyond.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="sharing-images-between-projects">
<h3>Sharing Images Between Projects<a class="headerlink" href="#sharing-images-between-projects" title="Permalink to this headline">¶</a></h3>
<p>In a multi-tenant cloud environment, users sometimes want to share their
personal images or snapshots with other projects. This can be done on
the command line with the <code class="docutils literal"><span class="pre">glance</span></code> tool by the owner of the image.</p>
<p>To share an image or snapshot with another project, do the following:</p>
<ol class="arabic">
<li><p class="first">Obtain the UUID of the image:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image list
</pre></div>
</div>
</li>
<li><p class="first">Obtain the UUID of the project with which you want to share your image,
let&#8217;s call it target project.
Unfortunately, non-admin users are unable to use the <strong class="command">openstack</strong>
command to do this. The easiest solution is to obtain the UUID either
from an administrator of the cloud or from a user located in the
target project.</p>
</li>
<li><p class="first">Once you have both pieces of information, run
the <strong class="command">openstack image add project</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image add project IMAGE_NAME_OR_UUID PROJECT_NAME_OR_UUID
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image add project 733d1c44-a2ea-414b-aca7-69decf20d810 <span class="se">\</span>
  771ed149ef7e4b2b88665cc1c98f77ca
</pre></div>
</div>
</li>
<li><p class="first">You now need to act in the target project scope.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will not see the shared image yet.
Therefore the sharing needs to be accepted.</p>
</div>
<p>To accept the sharing, you need to update the member status:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance member-update IMAGE_UUID PROJECT_UUID accepted
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance member-update 733d1c44-a2ea-414b-aca7-69decf20d810 <span class="se">\</span>
  771ed149ef7e4b2b88665cc1c98f77ca accepted
</pre></div>
</div>
<p>Project <code class="docutils literal"><span class="pre">771ed149ef7e4b2b88665cc1c98f77ca</span></code> will now have access to image
<code class="docutils literal"><span class="pre">733d1c44-a2ea-414b-aca7-69decf20d810</span></code>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>You can explicitly ask for pending member status to view shared images not yet accepted:</p>
<div class="last highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance image-list --member-status pending
</pre></div>
</div>
</div>
</li>
</ol>
</div>
<div class="section" id="deleting-images">
<h3>Deleting Images<a class="headerlink" href="#deleting-images" title="Permalink to this headline">¶</a></h3>
<p>To delete an image, just execute:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image delete IMAGE_NAME_OR_UUID
</pre></div>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">Generally, deleting an image does not affect instances or snapshots that were
based on the image. However, some drivers may require the original image to be
present to perform a migration. For example, XenAPI live-migrate will work
fine if the image is deleted, but libvirt will fail.</p>
</div>
</div>
<div class="section" id="other-cli-options">
<h3>Other CLI Options<a class="headerlink" href="#other-cli-options" title="Permalink to this headline">¶</a></h3>
<p>A full set of options can be found using:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> glance <span class="nb">help</span>
</pre></div>
</div>
<p>or the <a class="reference external" href="https://docs.openstack.org/cli-reference/glance.html">Command-Line Interface
Reference</a>.</p>
</div>
<div class="section" id="the-image-service-and-the-database">
<h3>The Image service and the Database<a class="headerlink" href="#the-image-service-and-the-database" title="Permalink to this headline">¶</a></h3>
<p>The only thing the Image service does not store in a database is
the image itself. The Image service database has two main
tables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">images</span></code></li>
<li><code class="docutils literal"><span class="pre">image_properties</span></code></li>
</ul>
<p>Working directly with the database and SQL queries can provide you with
custom lists and reports of images. Technically, you can update
properties about images through the database, although this is not
generally recommended.</p>
</div>
<div class="section" id="example-image-service-database-queries">
<h3>Example Image service Database Queries<a class="headerlink" href="#example-image-service-database-queries" title="Permalink to this headline">¶</a></h3>
<p>One interesting example is modifying the table of images and the owner
of that image. This can be easily done if you simply display the unique
ID of the owner. This example goes one
step further and displays the readable name of the owner:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">glance</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
              <span class="n">glance</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">keystone</span><span class="p">.</span><span class="n">tenant</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">is_public</span> <span class="k">from</span>
              <span class="n">glance</span><span class="p">.</span><span class="n">images</span> <span class="k">inner</span> <span class="k">join</span> <span class="n">keystone</span><span class="p">.</span><span class="n">tenant</span> <span class="k">on</span>
              <span class="n">glance</span><span class="p">.</span><span class="n">images</span><span class="p">.</span><span class="n">owner</span><span class="o">=</span><span class="n">keystone</span><span class="p">.</span><span class="n">tenant</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</pre></div>
</div>
<p>Another example is displaying all properties for a certain image:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="k">from</span>
              <span class="n">image_properties</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">image_id</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="flavors">
<h2>Flavors<a class="headerlink" href="#flavors" title="Permalink to this headline">¶</a></h2>
<p>Virtual hardware templates are called &#8220;flavors&#8221; in OpenStack, defining
sizes for RAM, disk, number of cores, and so on. The default install
provides five flavors.</p>
<p>These are configurable by admin users (the rights may also be delegated
to other users by redefining the access controls for
<code class="docutils literal"><span class="pre">compute_extension:flavormanage</span></code> in <code class="docutils literal"><span class="pre">/etc/nova/policy.json</span></code> on the
<code class="docutils literal"><span class="pre">nova-api</span></code> server). To get the list of available flavors on your
system, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack flavor list
<span class="go">+----+-----------+-------+------+-----------+-------+-----------+</span>
<span class="go">| ID | Name      |   RAM | Disk | Ephemeral | VCPUs | Is Public |</span>
<span class="go">+----+-----------+-------+------+-----------+-------+-----------+</span>
<span class="go">| 1  | m1.tiny   |   512 |    1 |         0 |     1 | True      |</span>
<span class="go">| 2  | m1.small  |  2048 |   20 |         0 |     1 | True      |</span>
<span class="go">| 3  | m1.medium |  4096 |   40 |         0 |     2 | True      |</span>
<span class="go">| 4  | m1.large  |  8192 |   80 |         0 |     4 | True      |</span>
<span class="go">| 5  | m1.xlarge | 16384 |  160 |         0 |     8 | True      |</span>
<span class="go">+----+-----------+-------+------+-----------+-------+-----------+</span>
</pre></div>
</div>
<p>The <strong class="command">openstack flavor create</strong> command allows authorized users to
create new flavors. Additional flavor manipulation commands can be shown with
the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack <span class="nb">help</span> <span class="p">|</span> grep flavor
</pre></div>
</div>
<p>Flavors define a number of parameters, resulting in the user having a
choice of what type of virtual machine to run—just like they would have
if they were purchasing a physical server.
<a class="reference internal" href="#table-flavor-params"><span class="std std-ref">Table. Flavor parameters</span></a> lists the elements that can be set.
Note in particular <code class="docutils literal"><span class="pre">extra_specs</span></code>, which can be used to
define free-form characteristics, giving a lot of flexibility beyond just the
size of RAM, CPU, and Disk.</p>
<table border="1" class="docutils" id="id3">
<span id="table-flavor-params"></span><caption><span class="caption-text">Table. Flavor parameters</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Column</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ID</td>
<td>Unique ID (integer or UUID) for the flavor.</td>
</tr>
<tr class="row-odd"><td>Name</td>
<td>A descriptive name, such as xx.size_name, is conventional but not required, though some third-party tools may rely on it.</td>
</tr>
<tr class="row-even"><td>Memory_MB</td>
<td>Virtual machine memory in megabytes.</td>
</tr>
<tr class="row-odd"><td>Disk</td>
<td>Virtual root disk size in gigabytes. This is an ephemeral disk the base image is copied into. You don&#8217;t use it when you boot from a persistent volume. The &#8220;0&#8221; size is a special case that uses the native base image size as the size of the ephemeral root volume.</td>
</tr>
<tr class="row-even"><td>Ephemeral</td>
<td>Specifies the size of a secondary ephemeral data disk. This is an empty, unformatted disk and exists only for the life of the instance.</td>
</tr>
<tr class="row-odd"><td>Swap</td>
<td>Optional swap space allocation for the instance.</td>
</tr>
<tr class="row-even"><td>VCPUs</td>
<td>Number of virtual CPUs presented to the instance.</td>
</tr>
<tr class="row-odd"><td>RXTX_Factor</td>
<td>Optional property that allows created servers to have a different
bandwidth cap from that defined in the network
they are attached to. This factor is multiplied by the rxtx_base
property of the network.
Default value is 1.0 (that is, the same as the attached network).</td>
</tr>
<tr class="row-even"><td>Is_Public</td>
<td>Boolean value that indicates whether the flavor is available to
all users or private. Private flavors do not get the current
tenant assigned to them. Defaults to <code class="docutils literal"><span class="pre">True</span></code>.</td>
</tr>
<tr class="row-odd"><td>extra_specs</td>
<td>Additional optional restrictions on which compute nodes the
flavor can run on. This is implemented as key-value pairs that must
match against the corresponding key-value pairs on compute nodes.
Can be used to implement things like special resources (such as
flavors that can run only on compute nodes with GPU hardware).</td>
</tr>
</tbody>
</table>
<div class="section" id="private-flavors">
<h3>Private Flavors<a class="headerlink" href="#private-flavors" title="Permalink to this headline">¶</a></h3>
<p>A user might need a custom flavor that is uniquely tuned for a project
she is working on. For example, the user might require 128 GB of memory.
If you create a new flavor as described above, the user would have
access to the custom flavor, but so would all other tenants in your
cloud. Sometimes this sharing isn&#8217;t desirable. In this scenario,
allowing all users to have access to a flavor with 128 GB of memory
might cause your cloud to reach full capacity very quickly. To prevent
this, you can restrict access to the custom flavor using the
<strong class="command">nova flavor-access-add</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova flavor-access-add FLAVOR_ID PROJECT_ID
</pre></div>
</div>
<p>To view a flavor&#8217;s access list, do the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova flavor-access-list <span class="o">[</span>--flavor FLAVOR_ID<span class="o">]</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Once access to a flavor has been restricted, no other projects
besides the ones granted explicit access will be able to see the
flavor. This includes the admin project. Make sure to add the admin
project in addition to the original project.</p>
<p class="last">It&#8217;s also helpful to allocate a specific numeric range for custom
and private flavors. On UNIX-based systems, nonsystem accounts
usually have a UID starting at 500. A similar approach can be taken
with custom flavors. This helps you easily identify which flavors
are custom, private, and public for the entire cloud.</p>
</div>
</div>
<div class="section" id="how-do-i-modify-an-existing-flavor">
<h3>How Do I Modify an Existing Flavor?<a class="headerlink" href="#how-do-i-modify-an-existing-flavor" title="Permalink to this headline">¶</a></h3>
<p>The OpenStack dashboard simulates the ability to modify a flavor by
deleting an existing flavor and creating a new one with the same name.</p>
</div>
</div>
<div class="section" id="security-groups">
<h2>Security Groups<a class="headerlink" href="#security-groups" title="Permalink to this headline">¶</a></h2>
<p>A common new-user issue with OpenStack is failing to set an appropriate
security group when launching an instance. As a result, the user is
unable to contact the instance on the network.</p>
<p>Security groups are sets of IP filter rules that are applied to an
instance&#8217;s networking. They are project specific, and project members
can edit the default rules for their group and add new rules sets. All
projects have a &#8220;default&#8221; security group, which is applied to instances
that have no other security group defined. Unless changed, this security
group denies all incoming traffic.</p>
<div class="section" id="general-security-groups-configuration">
<h3>General Security Groups Configuration<a class="headerlink" href="#general-security-groups-configuration" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">nova.conf</span></code> option <code class="docutils literal"><span class="pre">allow_same_net_traffic</span></code> (which defaults to
<code class="docutils literal"><span class="pre">true</span></code>) globally controls whether the rules apply to hosts that share
a network. When set to <code class="docutils literal"><span class="pre">true</span></code>, hosts on the same subnet are not
filtered and are allowed to pass all types of traffic between them. On a
flat network, this allows all instances from all projects unfiltered
communication. With VLAN networking, this allows access between
instances within the same project. If <code class="docutils literal"><span class="pre">allow_same_net_traffic</span></code> is set
to <code class="docutils literal"><span class="pre">false</span></code>, security groups are enforced for all connections. In this
case, it is possible for projects to simulate <code class="docutils literal"><span class="pre">allow_same_net_traffic</span></code>
by configuring their default security group to allow all traffic from
their subnet.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">As noted in the previous chapter, the number of rules per security
group is controlled by the <code class="docutils literal"><span class="pre">quota_security_group_rules</span></code>, and the
number of allowed security groups per project is controlled by the
<code class="docutils literal"><span class="pre">quota_security_groups</span></code> quota.</p>
</div>
</div>
<div class="section" id="end-user-configuration-of-security-groups">
<h3>End-User Configuration of Security Groups<a class="headerlink" href="#end-user-configuration-of-security-groups" title="Permalink to this headline">¶</a></h3>
<p>Security groups for the current project can be found on the OpenStack
dashboard under <span class="guilabel">Access &amp; Security</span>. To see details of an
existing group, select the <span class="guilabel">Edit Security Group</span> action for that
security group. Obviously, modifying existing groups can be done from this
edit interface. There is a <span class="guilabel">Create Security Group</span> button on the
main <span class="guilabel">Access &amp; Security</span> page for creating new groups.
We discuss the terms used in these fields when we explain the
command-line equivalents.</p>
<p><strong>Setting with openstack command</strong></p>
<p>If your environment is using Neutron, you can configure security groups
settings using the <strong class="command">openstack</strong> command. Get a list of security groups
for the project you are acting in, by using following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group list
<span class="go">+------------------------+---------+------------------------+-------------------------+</span>
<span class="go">| ID                     | Name    | Description            | Project                 |</span>
<span class="go">+------------------------+---------+------------------------+-------------------------+</span>
<span class="go">| 3bef30ed-442d-4cf1     | default | Default security group | 35e3820f7490493ca9e3a5e |</span>
<span class="go">| -b84d-2ba50a395599     |         |                        | 685393298               |</span>
<span class="go">| aaf1d0b7-98a0-41a3-ae1 | default | Default security group | 32e9707393c34364923edf8 |</span>
<span class="go">| 6-a58b94503289         |         |                        | f5029cbfe               |</span>
<span class="go">+------------------------+---------+------------------------+-------------------------+</span>
</pre></div>
</div>
<p>To view the details of a security group:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group show 3bef30ed-442d-4cf1-b84d-2ba50a395599
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field           | Value                                                                                                                                                                                  |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| created_at      | 2016-11-08T21:55:19Z                                                                                                                                                                   |</span>
<span class="go">| description     | Default security group                                                                                                                                                                 |</span>
<span class="go">| id              | 3bef30ed-442d-4cf1-b84d-2ba50a395599                                                                                                                                                   |</span>
<span class="go">| name            | default                                                                                                                                                                                |</span>
<span class="go">| project_id      | 35e3820f7490493ca9e3a5e685393298                                                                                                                                                       |</span>
<span class="go">| project_id      | 35e3820f7490493ca9e3a5e685393298                                                                                                                                                       |</span>
<span class="go">| revision_number | 1                                                                                                                                                                                      |</span>
<span class="go">| rules           | created_at=&#39;2016-11-08T21:55:19Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv6&#39;, id=&#39;1dca4cac-d4f2-46f5-b757-d53c01a87bdf&#39;, project_id=&#39;35e3820f7490493ca9e3a5e685393298&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-08T21:55:19Z&#39;                                                                                                                                 |</span>
<span class="go">|                 | created_at=&#39;2016-11-08T21:55:19Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv4&#39;, id=&#39;2d83d6f2-424e-4b7c-b9c4-1ede89c00aab&#39;, project_id=&#39;35e3820f7490493ca9e3a5e685393298&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-08T21:55:19Z&#39;                                                                                                                                 |</span>
<span class="go">|                 | created_at=&#39;2016-11-08T21:55:19Z&#39;, direction=&#39;ingress&#39;, ethertype=&#39;IPv4&#39;, id=&#39;62b7d1eb-b98d-4707-a29f-6df379afdbaa&#39;, project_id=&#39;35e3820f7490493ca9e3a5e685393298&#39;, remote_group_id    |</span>
<span class="go">|                 | =&#39;3bef30ed-442d-4cf1-b84d-2ba50a395599&#39;, revision_number=&#39;1&#39;, updated_at=&#39;2016-11-08T21:55:19Z&#39;                                                                                        |</span>
<span class="go">|                 | created_at=&#39;2016-11-08T21:55:19Z&#39;, direction=&#39;ingress&#39;, ethertype=&#39;IPv6&#39;, id=&#39;f0d4b8d6-32d4-4f93-813d-3ede9d698fbb&#39;, project_id=&#39;35e3820f7490493ca9e3a5e685393298&#39;, remote_group_id    |</span>
<span class="go">|                 | =&#39;3bef30ed-442d-4cf1-b84d-2ba50a395599&#39;, revision_number=&#39;1&#39;, updated_at=&#39;2016-11-08T21:55:19Z&#39;                                                                                        |</span>
<span class="go">| updated_at      | 2016-11-08T21:55:19Z                                                                                                                                                                   |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>These rules are all &#8220;allow&#8221; type rules, as the default is deny. This
example shows the full port range for all protocols allowed from all
IPs. This section describes the most common security group rule
parameters:</p>
<dl class="docutils">
<dt>direction</dt>
<dd>The direction in which the security group rule is applied. Valid
values are <code class="docutils literal"><span class="pre">ingress</span></code> or <code class="docutils literal"><span class="pre">egress</span></code>.</dd>
<dt>remote_ip_prefix</dt>
<dd>This attribute value matches the specified IP prefix as the source
IP address of the IP packet.</dd>
<dt>protocol</dt>
<dd>The protocol that is matched by the security group rule. Valid
values are <code class="docutils literal"><span class="pre">null</span></code>, <code class="docutils literal"><span class="pre">tcp</span></code>, <code class="docutils literal"><span class="pre">udp</span></code>, <code class="docutils literal"><span class="pre">icmp</span></code>, and <code class="docutils literal"><span class="pre">icmpv6</span></code>.</dd>
<dt>port_range_min</dt>
<dd>The minimum port number in the range that is matched by the security
group rule. If the protocol is TCP or UDP, this value must be less
than or equal to the <code class="docutils literal"><span class="pre">port_range_max</span></code> attribute value. If the
protocol is ICMP or ICMPv6, this value must be an ICMP or ICMPv6
type, respectively.</dd>
<dt>port_range_max</dt>
<dd>The maximum port number in the range that is matched by the security
group rule. The <code class="docutils literal"><span class="pre">port_range_min</span></code> attribute constrains the
<code class="docutils literal"><span class="pre">port_range_max</span></code> attribute. If the protocol is ICMP or ICMPv6,
this value must be an ICMP or ICMPv6 type, respectively.</dd>
<dt>ethertype</dt>
<dd>Must be <code class="docutils literal"><span class="pre">IPv4</span></code> or <code class="docutils literal"><span class="pre">IPv6</span></code>, and addresses represented in CIDR must
match the ingress or egress rules.</dd>
</dl>
<p>When adding a new security group, you should pick a descriptive but
brief name. This name shows up in brief descriptions of the instances
that use it where the longer description field often does not. Seeing
that an instance is using security group <code class="docutils literal"><span class="pre">http</span></code> is much easier to
understand than <code class="docutils literal"><span class="pre">bobs_group</span></code> or <code class="docutils literal"><span class="pre">secgrp1</span></code>.</p>
<p>This example creates a security group that allows web traffic anywhere
on the Internet. We&#8217;ll call this group <code class="docutils literal"><span class="pre">global_http</span></code>, which is clear
and reasonably concise, encapsulating what is allowed and from where.
From the command line, do:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group create global_http --description <span class="s2">&quot;allow web traffic from the Internet&quot;</span>
<span class="go">Created a new security_group:</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field           | Value                                                                                                                                                                                  |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| created_at      | 2016-11-10T16:09:18Z                                                                                                                                                                   |</span>
<span class="go">| description     | allow web traffic from the Internet                                                                                                                                                    |</span>
<span class="go">| headers         |                                                                                                                                                                                        |</span>
<span class="go">| id              | 70675447-1b92-4102-a7ea-6a3ca99d2290                                                                                                                                                   |</span>
<span class="go">| name            | global_http                                                                                                                                                                            |</span>
<span class="go">| project_id      | 32e9707393c34364923edf8f5029cbfe                                                                                                                                                       |</span>
<span class="go">| project_id      | 32e9707393c34364923edf8f5029cbfe                                                                                                                                                       |</span>
<span class="go">| revision_number | 1                                                                                                                                                                                      |</span>
<span class="go">| rules           | created_at=&#39;2016-11-10T16:09:18Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv4&#39;, id=&#39;e440b13a-e74f-4700-a36f-9ecc0de76612&#39;, project_id=&#39;32e9707393c34364923edf8f5029cbfe&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-10T16:09:18Z&#39;                                                                                                                                 |</span>
<span class="go">|                 | created_at=&#39;2016-11-10T16:09:18Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv6&#39;, id=&#39;0debf8cb-9f1d-45e5-98db-ee169c0715fe&#39;, project_id=&#39;32e9707393c34364923edf8f5029cbfe&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-10T16:09:18Z&#39;                                                                                                                                 |</span>
<span class="go">| updated_at      | 2016-11-10T16:09:18Z                                                                                                                                                                   |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>Immediately after create, the security group has only an allow egress
rule. To make it do what we want, we need to add some rules:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group rule create --help
<span class="go">usage: openstack security group rule create [-h]</span>
<span class="go">                                            [-f {json,shell,table,value,yaml}]</span>
<span class="go">                                            [-c COLUMN]</span>
<span class="go">                                            [--max-width &lt;integer&gt;]</span>
<span class="go">                                            [--noindent] [--prefix PREFIX]</span>
<span class="go">                                            [--remote-ip &lt;ip-address&gt; | --remote-group &lt;group&gt;]</span>
<span class="go">                                            [--dst-port &lt;port-range&gt;]</span>
<span class="go">                                            [--icmp-type &lt;icmp-type&gt;]</span>
<span class="go">                                            [--icmp-code &lt;icmp-code&gt;]</span>
<span class="go">                                            [--protocol &lt;protocol&gt;]</span>
<span class="go">                                            [--ingress | --egress]</span>
<span class="go">                                            [--ethertype &lt;ethertype&gt;]</span>
<span class="go">                                            [--project &lt;project&gt;]</span>
<span class="go">                                            [--project-domain &lt;project-domain&gt;]</span>
<span class="go">                                            &lt;group&gt;</span>

<span class="gp">$</span> openstack security group rule create --ingress --ethertype IPv4 <span class="se">\</span>
  --protocol tcp --remote-ip <span class="m">0</span>.0.0.0/0 global_http

<span class="go">Created a new security group rule:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| created_at        | 2016-11-10T16:12:27Z                 |</span>
<span class="go">| description       |                                      |</span>
<span class="go">| direction         | ingress                              |</span>
<span class="go">| ethertype         | IPv4                                 |</span>
<span class="go">| headers           |                                      |</span>
<span class="go">| id                | 694d30b1-1c4d-4bb8-acbe-7f1b3de2b20f |</span>
<span class="go">| port_range_max    | None                                 |</span>
<span class="go">| port_range_min    | None                                 |</span>
<span class="go">| project_id        | 32e9707393c34364923edf8f5029cbfe     |</span>
<span class="go">| project_id        | 32e9707393c34364923edf8f5029cbfe     |</span>
<span class="go">| protocol          | tcp                                  |</span>
<span class="go">| remote_group_id   | None                                 |</span>
<span class="go">| remote_ip_prefix  | 0.0.0.0/0                            |</span>
<span class="go">| revision_number   | 1                                    |</span>
<span class="go">| security_group_id | 70675447-1b92-4102-a7ea-6a3ca99d2290 |</span>
<span class="go">| updated_at        | 2016-11-10T16:12:27Z                 |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Despite only outputting the newly added rule, this operation is
additive:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group show global_http
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field           | Value                                                                                                                                                                                  |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| created_at      | 2016-11-10T16:09:18Z                                                                                                                                                                   |</span>
<span class="go">| description     | allow web traffic from the Internet                                                                                                                                                    |</span>
<span class="go">| id              | 70675447-1b92-4102-a7ea-6a3ca99d2290                                                                                                                                                   |</span>
<span class="go">| name            | global_http                                                                                                                                                                            |</span>
<span class="go">| project_id      | 32e9707393c34364923edf8f5029cbfe                                                                                                                                                       |</span>
<span class="go">| project_id      | 32e9707393c34364923edf8f5029cbfe                                                                                                                                                       |</span>
<span class="go">| revision_number | 2                                                                                                                                                                                      |</span>
<span class="go">| rules           | created_at=&#39;2016-11-10T16:09:18Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv6&#39;, id=&#39;0debf8cb-9f1d-45e5-98db-ee169c0715fe&#39;, project_id=&#39;32e9707393c34364923edf8f5029cbfe&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-10T16:09:18Z&#39;                                                                                                                                 |</span>
<span class="go">|                 | created_at=&#39;2016-11-10T16:12:27Z&#39;, direction=&#39;ingress&#39;, ethertype=&#39;IPv4&#39;, id=&#39;694d30b1-1c4d-4bb8-acbe-7f1b3de2b20f&#39;, project_id=&#39;32e9707393c34364923edf8f5029cbfe&#39;, protocol=&#39;tcp&#39;,    |</span>
<span class="go">|                 | remote_ip_prefix=&#39;0.0.0.0/0&#39;, revision_number=&#39;1&#39;, updated_at=&#39;2016-11-10T16:12:27Z&#39;                                                                                                   |</span>
<span class="go">|                 | created_at=&#39;2016-11-10T16:09:18Z&#39;, direction=&#39;egress&#39;, ethertype=&#39;IPv4&#39;, id=&#39;e440b13a-e74f-4700-a36f-9ecc0de76612&#39;, project_id=&#39;32e9707393c34364923edf8f5029cbfe&#39;,                     |</span>
<span class="go">|                 | revision_number=&#39;1&#39;, updated_at=&#39;2016-11-10T16:09:18Z&#39;                                                                                                                                 |</span>
<span class="go">| updated_at      | 2016-11-10T16:12:27Z                                                                                                                                                                   |</span>
<span class="go">+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>The inverse operation is called
<strong class="command">openstack security group rule delete</strong>,
specifying security-group-rule ID. Whole security groups can be removed
with <strong class="command">openstack security group delete</strong>.</p>
<p>To create security group rules for a cluster of instances, use
RemoteGroups.</p>
<p>RemoteGroups are a dynamic way of defining the CIDR of allowed sources.
The user specifies a RemoteGroup (security group name) and then all the
users&#8217; other instances using the specified RemoteGroup are selected
dynamically. This dynamic selection alleviates the need for individual
rules to allow each new member of the cluster.</p>
<p>The code is similar to the above example of
<strong class="command">openstack security group rule create</strong>. To use RemoteGroup, specify
<code class="docutils literal"><span class="pre">--remote-group</span></code> instead of <code class="docutils literal"><span class="pre">--remote-ip</span></code>.
For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack security group rule create --ingress <span class="se">\</span>
  --ethertype IPv4 --protocol tcp <span class="se">\</span>
  --remote-group global_http cluster
</pre></div>
</div>
<p>The &#8220;cluster&#8221; rule allows SSH access from any other instance that uses
the <code class="docutils literal"><span class="pre">global-http</span></code> group.</p>
</div>
</div>
<div class="section" id="block-storage">
<h2>Block Storage<a class="headerlink" href="#block-storage" title="Permalink to this headline">¶</a></h2>
<p>OpenStack volumes are persistent block-storage devices that may be
attached and detached from instances, but they can be attached to only
one instance at a time. Similar to an external hard drive, they do not
provide shared storage in the way a network file system or object store
does. It is left to the operating system in the instance to put a file
system on the block device and mount it, or not.</p>
<p>As with other removable disk technology, it is important that the
operating system is not trying to make use of the disk before removing
it. On Linux instances, this typically involves unmounting any file
systems mounted from the volume. The OpenStack volume service cannot
tell whether it is safe to remove volumes from an instance, so it does
what it is told. If a user tells the volume service to detach a volume
from an instance while it is being written to, you can expect some level
of file system corruption as well as faults from whatever process within
the instance was using the device.</p>
<p>There is nothing OpenStack-specific in being aware of the steps needed
to access block devices from within the instance operating system,
potentially formatting them for first use and being cautious when
removing them. What is specific is how to create new volumes and attach
and detach them from instances. These operations can all be done from
the <span class="guilabel">Volumes</span> page of the dashboard or by using the <code class="docutils literal"><span class="pre">openstack</span></code>
command-line client.</p>
<p>To add new volumes, you need only a volume size in gigabytes.
Either put these into the <span class="guilabel">Create Volume</span> web form or use the command
line:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack volume create volume1 --size <span class="m">10</span>
</pre></div>
</div>
<p>This creates a 10 GB volume. To list existing
volumes and the instances they are connected to, if any:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack volume list
<span class="go">+--------------------------------------+--------------+--------+------+-------------+</span>
<span class="go">| ID                                   | Display Name | Status | Size | Attached to |</span>
<span class="go">+--------------------------------------+--------------+--------+------+-------------+</span>
<span class="go">| 6cf4114a-56b2-476b-acf7-7359d8334aa2 | volume1      | error  |   10 |             |</span>
<span class="go">+------------+-----------+-------------+------+-------------+----------+------------+</span>
</pre></div>
</div>
<p>OpenStack Block Storage also allows creating snapshots of volumes.
Remember that this is a block-level snapshot that is crash consistent,
so it is best if the volume is not connected to an instance when the
snapshot is taken and second best if the volume is not in use on the
instance it is attached to. If the volume is under heavy use, the
snapshot may have an inconsistent file system. In fact, by default, the
volume service does not take a snapshot of a volume that is attached to
an image, though it can be forced to. To take a volume snapshot, either
select <span class="guilabel">Create Snapshot</span> from the actions column
next to the volume name on the dashboard <span class="guilabel">Volumes</span> page,
or run this from the command line:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack <span class="nb">help</span> snapshot create
<span class="go">usage: openstack snapshot create [-h] [-f {json,shell,table,value,yaml}]</span>
<span class="go">                                 [-c COLUMN] [--max-width &lt;integer&gt;]</span>
<span class="go">                                 [--noindent] [--prefix PREFIX]</span>
<span class="go">                                 [--name &lt;name&gt;] [--description &lt;description&gt;]</span>
<span class="go">                                 [--force] [--property &lt;key=value&gt;]</span>
<span class="go">                                 &lt;volume&gt;</span>

<span class="go">Create new snapshot</span>

<span class="go">positional arguments:</span>
<span class="go">  &lt;volume&gt;              Volume to snapshot (name or ID)</span>

<span class="go">optional arguments:</span>
<span class="go">  -h, --help            show this help message and exit</span>
<span class="go">  --name &lt;name&gt;         Name of the snapshot</span>
<span class="go">  --description &lt;description&gt;</span>
<span class="go">                        Description of the snapshot</span>
<span class="go">  --force               Create a snapshot attached to an instance. Default is</span>
<span class="go">                        False</span>
<span class="go">  --property &lt;key=value&gt;</span>
<span class="go">                        Set a property to this snapshot (repeat option to set</span>
<span class="go">                        multiple properties)</span>

<span class="go">output formatters:</span>
<span class="go">  output formatter options</span>

<span class="go">  -f {json,shell,table,value,yaml}, --format {json,shell,table,value,yaml}</span>
<span class="go">                        the output format, defaults to table</span>
<span class="go">  -c COLUMN, --column COLUMN</span>
<span class="go">                        specify the column(s) to include, can be repeated</span>

<span class="go">table formatter:</span>
<span class="go">  --max-width &lt;integer&gt;</span>
<span class="go">                        Maximum display width, &lt;1 to disable. You can also use</span>
<span class="go">                        the CLIFF_MAX_TERM_WIDTH environment variable, but the</span>
<span class="go">                        parameter takes precedence.</span>

<span class="go">json formatter:</span>
<span class="go">  --noindent            whether to disable indenting the JSON</span>

<span class="go">shell formatter:</span>
<span class="go">  a format a UNIX shell can parse (variable=&quot;value&quot;)</span>

<span class="go">  --prefix PREFIX       add a prefix to all variable names</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more information about updating Block Storage volumes (for
example, resizing or transferring), see the <a class="reference external" href="https://docs.openstack.org/user-guide/common/cli-manage-volumes.html">OpenStack End User
Guide</a>.</p>
</div>
<div class="section" id="block-storage-creation-failures">
<h3>Block Storage Creation Failures<a class="headerlink" href="#block-storage-creation-failures" title="Permalink to this headline">¶</a></h3>
<p>If a user tries to create a volume and the volume immediately goes into
an error state, the best way to troubleshoot is to grep the cinder log
files for the volume&#8217;s UUID. First try the log files on the cloud
controller, and then try the storage node where the volume was attempted
to be created:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> grep 903b85d0-bacc-4855-a261-10843fc2d65b /var/log/cinder/*.log
</pre></div>
</div>
</div>
</div>
<div class="section" id="shared-file-systems-service">
<h2>Shared File Systems Service<a class="headerlink" href="#shared-file-systems-service" title="Permalink to this headline">¶</a></h2>
<p>Similar to Block Storage, the Shared File System is a persistent
storage, called share, that can be used in multi-tenant environments.
Users create and mount a share as a remote file system on any machine
that allows mounting shares, and has network access to share exporter.
This share can then be used for storing, sharing, and exchanging files.
The default configuration of the Shared File Systems service depends on
the back-end driver the admin chooses when starting the Shared File
Systems service. For more information about existing back-end drivers,
see <a class="reference external" href="https://docs.openstack.org/developer/manila/devref/index.html#share-backends">Share Backends</a>
of Shared File Systems service Developer Guide. For example, in case of
OpenStack Block Storage based back-end is used, the Shared File Systems
service cares about everything, including VMs, networking, keypairs, and
security groups. Other configurations require more detailed knowledge of
shares functionality to set up and tune specific parameters and modes of
shares functioning.</p>
<p>Shares are a remote mountable file system, so users can mount a share to
multiple hosts, and have it accessed from multiple hosts by multiple
users at a time. With the Shared File Systems service, you can perform a
large number of operations with shares:</p>
<ul class="simple">
<li>Create, update, delete, and force-delete shares</li>
<li>Change access rules for shares, reset share state</li>
<li>Specify quotas for existing users or tenants</li>
<li>Create share networks</li>
<li>Define new share types</li>
<li>Perform operations with share snapshots:
create, change name, create a share from a snapshot, delete</li>
<li>Operate with consistency groups</li>
<li>Use security services</li>
</ul>
<p>For more information on share management see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-share-management.html">Share management</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide.
As to Security services, you should remember that different drivers
support different authentication methods, while generic driver does not
support Security Services at all (see section <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-security-services.html">Security services</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>You can create a share in a network, list shares, and show information
for, update, and delete a specified share. You can also create snapshots
of shares (see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-snapshots.html">Share snapshots</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>There are default and specific share types that allow you to filter or
choose back-ends before you create a share. Functions and behaviour of
share type is similar to Block Storage volume type (see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-share-types.html">Share types</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>To help users keep and restore their data, Shared File Systems service
provides a mechanism to create and operate snapshots (see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-snapshots.html">Share snapshots</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>A security service stores configuration information for clients for
authentication and authorization. Inside Manila a share network can be
associated with up to three security types (for detailed information see
<a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-security-services.html">Security services</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide):</p>
<ul class="simple">
<li>LDAP</li>
<li>Kerberos</li>
<li>Microsoft Active Directory</li>
</ul>
<p>Shared File Systems service differs from the principles implemented in
Block Storage. Shared File Systems service can work in two modes:</p>
<ul class="simple">
<li>Without interaction with share networks, in so called &#8220;no share
servers&#8221; mode.</li>
<li>Interacting with share networks.</li>
</ul>
<p>Networking service is used by the Shared File Systems service to
directly operate with share servers. For switching interaction with
Networking service on, create a share specifying a share network. To use
&#8220;share servers&#8221; mode even being out of OpenStack, a network plugin
called StandaloneNetworkPlugin is used. In this case, provide network
information in the configuration: IP range, network type, and
segmentation ID. Also you can add security services to a share network
(see section
<a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-networking.html">“Networking”</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>The main idea of consistency groups is to enable you to create snapshots
at the exact same point in time from multiple file system shares. Those
snapshots can be then used for restoring all shares that were associated
with the consistency group (see section <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-cgroups.html">“Consistency
groups”</a>
of chapter “Shared File Systems” in OpenStack Administrator Guide).</p>
<p>Shared File System storage allows administrators to set limits and
quotas for specific tenants and users. Limits are the resource
limitations that are allowed for each tenant or user. Limits consist of:</p>
<ul class="simple">
<li>Rate limits</li>
<li>Absolute limits</li>
</ul>
<p>Rate limits control the frequency at which users can issue specific API
requests. Rate limits are configured by administrators in a config file.
Also, administrator can specify quotas also known as max values of
absolute limits per tenant. Whereas users can see only the amount of
their consumed resources. Administrator can specify rate limits or
quotas for the following resources:</p>
<ul class="simple">
<li>Max amount of space available for all shares</li>
<li>Max number of shares</li>
<li>Max number of shared networks</li>
<li>Max number of share snapshots</li>
<li>Max total amount of all snapshots</li>
<li>Type and number of API calls that can be made in a specific time interval</li>
</ul>
<p>User can see his rate limits and absolute limits by running commands
<strong class="command">manila rate-limits</strong> and <strong class="command">manila absolute-limits</strong>
respectively. For more details on limits and quotas see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-quotas.html">Quotas and limits</a>
of &#8220;Share management&#8221; section of OpenStack Administrator Guide document.</p>
<p>This section lists several of the most important Use Cases that
demonstrate the main functions and abilities of Shared File Systems
service:</p>
<ul class="simple">
<li>Create share</li>
<li>Operating with a share</li>
<li>Manage access to shares</li>
<li>Create snapshots</li>
<li>Create a share network</li>
<li>Manage a share network</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Shared File Systems service cannot warn you beforehand if it is safe
to write a specific large amount of data onto a certain share or to
remove a consistency group if it has a number of shares assigned to
it. In such a potentially erroneous situations, if a mistake
happens, you can expect some error message or even failing of shares
or consistency groups into an incorrect status. You can also expect
some level of system corruption if a user tries to unmount an
unmanaged share while a process is using it for data transfer.</p>
</div>
<div class="section" id="create-share">
<span id="id1"></span><h3>Create Share<a class="headerlink" href="#create-share" title="Permalink to this headline">¶</a></h3>
<p>In this section, we examine the process of creating a simple share. It
consists of several steps:</p>
<ul class="simple">
<li>Check if there is an appropriate share type defined in the Shared
File Systems service</li>
<li>If such a share type does not exist, an Admin should create it using
<strong class="command">manila type-create</strong> command before other users are able to use it</li>
<li>Using a share network is optional. However if you need one, check if
there is an appropriate network defined in Shared File Systems
service by using <strong class="command">manila share-network-list</strong> command. For the
information on creating a share network, see
<a class="reference internal" href="#create-a-share-network"><span class="std std-ref">Create a Share Network</span></a> below in this chapter.</li>
<li>Create a public share using <strong class="command">manila create</strong>.</li>
<li>Make sure that the share has been created successfully and is ready
to use (check the share status and see the share export location)</li>
</ul>
<p>Below is the same whole procedure described step by step and in more
detail.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before you start, make sure that Shared File Systems service is
installed on your OpenStack cluster and is ready to use.</p>
</div>
<p>By default, there are no share types defined in Shared File Systems
service, so you can check if a required one has been already created:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila type-list
<span class="go">+------+--------+-----------+-----------+----------------------------------+----------------------+</span>
<span class="go">| ID   | Name   | Visibility| is_default| required_extra_specs             | optional_extra_specs |</span>
<span class="go">+------+--------+-----------+-----------+----------------------------------+----------------------+</span>
<span class="go">| c0...| default| public    | YES       | driver_handles_share_servers:True| snapshot_support:True|</span>
<span class="go">+------+--------+-----------+-----------+----------------------------------+----------------------+</span>
</pre></div>
</div>
<p>If the share types list is empty or does not contain a type you need,
create the required share type using this command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila type-create netapp1 False --is_public True
</pre></div>
</div>
<p>This command will create a public share with the following parameters:
<code class="docutils literal"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">netapp1</span></code>, <code class="docutils literal"><span class="pre">spec_driver_handles_share_servers</span> <span class="pre">=</span> <span class="pre">False</span></code></p>
<p>You can now create a public share with my_share_net network, default
share type, NFS shared file systems protocol, and 1 GB size:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila create nfs <span class="m">1</span> --name <span class="s2">&quot;Share1&quot;</span> --description <span class="s2">&quot;My first share&quot;</span> <span class="se">\</span>
  --share-type default --share-network my_share_net --metadata <span class="nv">aim</span><span class="o">=</span>testing --public
<span class="go">+-----------------------------+--------------------------------------+</span>
<span class="go">| Property                    | Value                                |</span>
<span class="go">+-----------------------------+--------------------------------------+</span>
<span class="go">| status                      | creating                             |</span>
<span class="go">| share_type_name             | default                              |</span>
<span class="go">| description                 | My first share                       |</span>
<span class="go">| availability_zone           | None                                 |</span>
<span class="go">| share_network_id            | 9c187d23-7e1d-4d91-92d0-77ea4b9b9496 |</span>
<span class="go">| share_server_id             | None                                 |</span>
<span class="go">| host                        |                                      |</span>
<span class="go">| access_rules_status         | active                               |</span>
<span class="go">| snapshot_id                 | None                                 |</span>
<span class="go">| is_public                   | True                                 |</span>
<span class="go">| task_state                  | None                                 |</span>
<span class="go">| snapshot_support            | True                                 |</span>
<span class="go">| id                          | edd82179-587e-4a87-9601-f34b2ca47e5b |</span>
<span class="go">| size                        | 1                                    |</span>
<span class="go">| name                        | Share1                               |</span>
<span class="go">| share_type                  | e031d5e9-f113-491a-843f-607128a5c649 |</span>
<span class="go">| has_replicas                | False                                |</span>
<span class="go">| replication_type            | None                                 |</span>
<span class="go">| created_at                  | 2016-03-20T00:00:00.000000           |</span>
<span class="go">| share_proto                 | NFS                                  |</span>
<span class="go">| consistency_group_id        | None                                 |</span>
<span class="go">| source_cgsnapshot_member_id | None                                 |</span>
<span class="go">| project_id                  | e81908b1bfe8468abb4791eae0ef6dd9     |</span>
<span class="go">| metadata                    | {u&#39;aim&#39;: u&#39;testing&#39;}                 |</span>
<span class="go">+-----------------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>To confirm that creation has been successful, see the share in the share
list:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila list
<span class="go">+----+-------+-----+------------+-----------+-------------------------------+----------------------+</span>
<span class="go">| ID | Name  | Size| Share Proto| Share Type| Export location               | Host                 |</span>
<span class="go">+----+-------+-----+------------+-----------+-------------------------------+----------------------+</span>
<span class="go">| a..| Share1| 1   | NFS        | c0086...  | 10.254.0.3:/shares/share-2d5..| manila@generic1#GEN..|</span>
<span class="go">+----+-------+-----+------------+-----------+-------------------------------+----------------------+</span>
</pre></div>
</div>
<p>Check the share status and see the share export location. After
creation, the share status should become <code class="docutils literal"><span class="pre">available</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila show Share1
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
<span class="go">| Property                    | Value                                                                |</span>
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
<span class="go">| status                      | available                                                            |</span>
<span class="go">| share_type_name             | default                                                              |</span>
<span class="go">| description                 | My first share                                                       |</span>
<span class="go">| availability_zone           | nova                                                                 |</span>
<span class="go">| share_network_id            | 9c187d23-7e1d-4d91-92d0-77ea4b9b9496                                 |</span>
<span class="go">| export_locations            |                                                                      |</span>
<span class="go">|                             | path = 10.254.0.3:/shares/share-18cb05be-eb69-4cb2-810f-91c75ef30f90 |</span>
<span class="go">|                             | preferred = False                                                    |</span>
<span class="go">|                             | is_admin_only = False                                                |</span>
<span class="go">|                             | id = d6a82c0d-36b0-438b-bf34-63f3932ddf4e                            |</span>
<span class="go">|                             | share_instance_id = 18cb05be-eb69-4cb2-810f-91c75ef30f90             |</span>
<span class="go">|                             | path = 10.0.0.3:/shares/share-18cb05be-eb69-4cb2-810f-91c75ef30f90   |</span>
<span class="go">|                             | preferred = False                                                    |</span>
<span class="go">|                             | is_admin_only = True                                                 |</span>
<span class="go">|                             | id = 51672666-06b8-4741-99ea-64f2286f52e2                            |</span>
<span class="go">|                             | share_instance_id = 18cb05be-eb69-4cb2-810f-91c75ef30f90             |</span>
<span class="go">| share_server_id             | ea8b3a93-ab41-475e-9df1-0f7d49b8fa54                                 |</span>
<span class="go">| host                        | manila@generic1#GENERIC1                                             |</span>
<span class="go">| access_rules_status         | active                                                               |</span>
<span class="go">| snapshot_id                 | None                                                                 |</span>
<span class="go">| is_public                   | True                                                                 |</span>
<span class="go">| task_state                  | None                                                                 |</span>
<span class="go">| snapshot_support            | True                                                                 |</span>
<span class="go">| id                          | e7364bcc-3821-49bf-82d6-0c9f0276d4ce                                 |</span>
<span class="go">| size                        | 1                                                                    |</span>
<span class="go">| name                        | Share1                                                               |</span>
<span class="go">| share_type                  | e031d5e9-f113-491a-843f-607128a5c649                                 |</span>
<span class="go">| has_replicas                | False                                                                |</span>
<span class="go">| replication_type            | None                                                                 |</span>
<span class="go">| created_at                  | 2016-03-20T00:00:00.000000                                           |</span>
<span class="go">| share_proto                 | NFS                                                                  |</span>
<span class="go">| consistency_group_id        | None                                                                 |</span>
<span class="go">| source_cgsnapshot_member_id | None                                                                 |</span>
<span class="go">| project_id                  | e81908b1bfe8468abb4791eae0ef6dd9                                     |</span>
<span class="go">| metadata                    | {u&#39;aim&#39;: u&#39;testing&#39;}                                                 |</span>
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>The value <code class="docutils literal"><span class="pre">is_public</span></code> defines the level of visibility for the share:
whether other tenants can or cannot see the share. By default, the share
is private. Now you can mount the created share like a remote file
system and use it for your purposes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-share-management.html">Share Management</a>
of “Shared File Systems” section of OpenStack Administrator Guide
document for the details on share management operations.</p>
</div>
</div>
<div class="section" id="manage-access-to-shares">
<h3>Manage Access To Shares<a class="headerlink" href="#manage-access-to-shares" title="Permalink to this headline">¶</a></h3>
<p>Currently, you have a share and would like to control access to this
share for other users. For this, you have to perform a number of steps
and operations. Before getting to manage access to the share, pay
attention to the following important parameters. To grant or deny access
to a share, specify one of these supported share access levels:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">rw</span></code>: read and write (RW) access. This is the default value.</li>
<li><code class="docutils literal"><span class="pre">ro:</span></code> read-only (RO) access.</li>
</ul>
<p>Additionally, you should also specify one of these supported
authentication methods:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ip</span></code>: authenticates an instance through its IP address. A valid
format is XX.XX.XX.XX orXX.XX.XX.XX/XX. For example 0.0.0.0/0.</li>
<li><code class="docutils literal"><span class="pre">cert</span></code>: authenticates an instance through a TLS certificate.
Specify the TLS identity as the IDENTKEY. A valid value is any string
up to 64 characters long in the common name (CN) of the certificate.
The meaning of a string depends on its interpretation.</li>
<li><code class="docutils literal"><span class="pre">user</span></code>: authenticates by a specified user or group name. A valid
value is an alphanumeric string that can contain some special
characters and is from 4 to 32 characters long.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not mount a share without an access rule! This can lead to an
exception.</p>
</div>
<p>Allow access to the share with IP access type and 10.254.0.4 IP address:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila access-allow Share1 ip <span class="m">10</span>.254.0.4 --access-level rw
<span class="go">+--------------+--------------------------------------+</span>
<span class="go">| Property     | Value                                |</span>
<span class="go">+--------------+--------------------------------------+</span>
<span class="go">| share_id     | 7bcd888b-681b-4836-ac9c-c3add4e62537 |</span>
<span class="go">| access_type  | ip                                   |</span>
<span class="go">| access_to    | 10.254.0.4                           |</span>
<span class="go">| access_level | rw                                   |</span>
<span class="go">| state        | new                                  |</span>
<span class="go">| id           | de715226-da00-4cfc-b1ab-c11f3393745e |</span>
<span class="go">+--------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Mount the Share:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo mount -v -t nfs <span class="m">10</span>.254.0.5:/shares/share-5789ddcf-35c9-4b64-a28a-7f6a4a574b6a /mnt/
</pre></div>
</div>
<p>Then check if the share mounted successfully and according to the
specified access rules:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila access-list Share1
<span class="go">+--------------------------------------+-------------+------------+--------------+--------+</span>
<span class="go">| id                                   | access type | access to  | access level | state  |</span>
<span class="go">+--------------------------------------+-------------+------------+--------------+--------+</span>
<span class="go">| 4f391c6b-fb4f-47f5-8b4b-88c5ec9d568a | user        | demo       | rw           | error  |</span>
<span class="go">| de715226-da00-4cfc-b1ab-c11f3393745e | ip          | 10.254.0.4 | rw           | active |</span>
<span class="go">+--------------------------------------+-------------+------------+--------------+--------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Different share features are supported by different share drivers.
In these examples there was used generic (Cinder as a back-end)
driver that does not support <code class="docutils literal"><span class="pre">user</span></code> and <code class="docutils literal"><span class="pre">cert</span></code> authentication
methods.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For the details of features supported by different drivers see
<a class="reference external" href="https://docs.openstack.org/developer/manila/devref/share_back_ends_feature_support_mapping.html">Manila share features support mapping</a>
of Manila Developer Guide document.</p>
</div>
</div>
<div class="section" id="manage-shares">
<h3>Manage Shares<a class="headerlink" href="#manage-shares" title="Permalink to this headline">¶</a></h3>
<p>There are several other useful operations you would perform when working
with shares.</p>
</div>
<div class="section" id="update-share">
<h3>Update Share<a class="headerlink" href="#update-share" title="Permalink to this headline">¶</a></h3>
<p>To change the name of a share, or update its description, or level of
visibility for other tenants, use this command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila update Share1 --description <span class="s2">&quot;My first share. Updated&quot;</span> --is-public False
</pre></div>
</div>
<p>Check the attributes of the updated Share1:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila show Share1
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
<span class="go">| Property                    | Value                                                                |</span>
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
<span class="go">| status                      | available                                                            |</span>
<span class="go">| share_type_name             | default                                                              |</span>
<span class="go">| description                 | My first share. Updated                                              |</span>
<span class="go">| availability_zone           | nova                                                                 |</span>
<span class="go">| share_network_id            | 9c187d23-7e1d-4d91-92d0-77ea4b9b9496                                 |</span>
<span class="go">| export_locations            |                                                                      |</span>
<span class="go">|                             | path = 10.254.0.3:/shares/share-18cb05be-eb69-4cb2-810f-91c75ef30f90 |</span>
<span class="go">|                             | preferred = False                                                    |</span>
<span class="go">|                             | is_admin_only = False                                                |</span>
<span class="go">|                             | id = d6a82c0d-36b0-438b-bf34-63f3932ddf4e                            |</span>
<span class="go">|                             | share_instance_id = 18cb05be-eb69-4cb2-810f-91c75ef30f90             |</span>
<span class="go">|                             | path = 10.0.0.3:/shares/share-18cb05be-eb69-4cb2-810f-91c75ef30f90   |</span>
<span class="go">|                             | preferred = False                                                    |</span>
<span class="go">|                             | is_admin_only = True                                                 |</span>
<span class="go">|                             | id = 51672666-06b8-4741-99ea-64f2286f52e2                            |</span>
<span class="go">|                             | share_instance_id = 18cb05be-eb69-4cb2-810f-91c75ef30f90             |</span>
<span class="go">| share_server_id             | ea8b3a93-ab41-475e-9df1-0f7d49b8fa54                                 |</span>
<span class="go">| host                        | manila@generic1#GENERIC1                                             |</span>
<span class="go">| access_rules_status         | active                                                               |</span>
<span class="go">| snapshot_id                 | None                                                                 |</span>
<span class="go">| is_public                   | False                                                                |</span>
<span class="go">| task_state                  | None                                                                 |</span>
<span class="go">| snapshot_support            | True                                                                 |</span>
<span class="go">| id                          | e7364bcc-3821-49bf-82d6-0c9f0276d4ce                                 |</span>
<span class="go">| size                        | 1                                                                    |</span>
<span class="go">| name                        | Share1                                                               |</span>
<span class="go">| share_type                  | e031d5e9-f113-491a-843f-607128a5c649                                 |</span>
<span class="go">| has_replicas                | False                                                                |</span>
<span class="go">| replication_type            | None                                                                 |</span>
<span class="go">| created_at                  | 2016-03-20T00:00:00.000000                                           |</span>
<span class="go">| share_proto                 | NFS                                                                  |</span>
<span class="go">| consistency_group_id        | None                                                                 |</span>
<span class="go">| source_cgsnapshot_member_id | None                                                                 |</span>
<span class="go">| project_id                  | e81908b1bfe8468abb4791eae0ef6dd9                                     |</span>
<span class="go">| metadata                    | {u&#39;aim&#39;: u&#39;testing&#39;}                                                 |</span>
<span class="go">+-----------------------------+----------------------------------------------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="reset-share-state">
<h3>Reset Share State<a class="headerlink" href="#reset-share-state" title="Permalink to this headline">¶</a></h3>
<p>Sometimes a share may appear and then hang in an erroneous or a
transitional state. Unprivileged users do not have the appropriate
access rights to correct this situation. However, having cloud
administrator&#8217;s permissions, you can reset the share&#8217;s state by using</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila reset-state <span class="o">[</span>–state state<span class="o">]</span> share_name
</pre></div>
</div>
<p>command to reset share state, where state indicates which state to
assign the share to. Options include:
<code class="docutils literal"><span class="pre">available,</span> <span class="pre">error,</span> <span class="pre">creating,</span> <span class="pre">deleting,</span> <span class="pre">error_deleting</span></code> states.</p>
<p>After running</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila reset-state Share2 --state deleting
</pre></div>
</div>
<p>check the share&#8217;s status:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila show Share2
<span class="go">+-----------------------------+-------------------------------------------+</span>
<span class="go">| Property                    | Value                                     |</span>
<span class="go">+-----------------------------+-------------------------------------------+</span>
<span class="go">| status                      | deleting                                  |</span>
<span class="go">| share_type_name             | default                                   |</span>
<span class="go">| description                 | share from a snapshot.                    |</span>
<span class="go">| availability_zone           | nova                                      |</span>
<span class="go">| share_network_id            | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a      |</span>
<span class="go">| export_locations            | []                                        |</span>
<span class="go">| share_server_id             | 41b7829d-7f6b-4c96-aea5-d106c2959961      |</span>
<span class="go">| host                        | manila@generic1#GENERIC1                  |</span>
<span class="go">| snapshot_id                 | 962e8126-35c3-47bb-8c00-f0ee37f42ddd      |</span>
<span class="go">| is_public                   | False                                     |</span>
<span class="go">| task_state                  | None                                      |</span>
<span class="go">| snapshot_support            | True                                      |</span>
<span class="go">| id                          | b6b0617c-ea51-4450-848e-e7cff69238c7      |</span>
<span class="go">| size                        | 1                                         |</span>
<span class="go">| name                        | Share2                                    |</span>
<span class="go">| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86      |</span>
<span class="go">| created_at                  | 2015-09-25T06:25:50.000000                |</span>
<span class="go">| export_location             | 10.254.0.3:/shares/share-1dc2a471-3d47-...|</span>
<span class="go">| share_proto                 | NFS                                       |</span>
<span class="go">| consistency_group_id        | None                                      |</span>
<span class="go">| source_cgsnapshot_member_id | None                                      |</span>
<span class="go">| project_id                  | 20787a7ba11946adad976463b57d8a2f          |</span>
<span class="go">| metadata                    | {u&#39;source&#39;: u&#39;snapshot&#39;}                  |</span>
<span class="go">+-----------------------------+-------------------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-share">
<h3>Delete Share<a class="headerlink" href="#delete-share" title="Permalink to this headline">¶</a></h3>
<p>If you do not need a share any more, you can delete it using
<strong class="command">manila delete share_name_or_ID</strong> command like:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila delete Share2
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you specified the consistency group while creating a share, you
should provide the &#8211;consistency-group parameter to delete the
share:</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila delete ba52454e-2ea3-47fa-a683-3176a01295e6 --consistency-group <span class="se">\</span>
  ffee08d9-c86c-45e5-861e-175c731daca2
</pre></div>
</div>
<p>Sometimes it appears that a share hangs in one of transitional states
(i.e.
<code class="docutils literal"><span class="pre">creating,</span> <span class="pre">deleting,</span> <span class="pre">managing,</span> <span class="pre">unmanaging,</span> <span class="pre">extending,</span> <span class="pre">and</span> <span class="pre">shrinking</span></code>).
In that case, to delete it, you need
<strong class="command">manila force-delete share_name_or_ID</strong> command and administrative
permissions to run it:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila force-delete b6b0617c-ea51-4450-848e-e7cff69238c7
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For more details and additional information about other cases,
features, API commands etc, see <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-share-management.html">Share Management</a>
of “Shared File Systems” section of OpenStack Administrator Guide document.</p>
</div>
</div>
<div class="section" id="create-snapshots">
<h3>Create Snapshots<a class="headerlink" href="#create-snapshots" title="Permalink to this headline">¶</a></h3>
<p>The Shared File Systems service provides a mechanism of snapshots to
help users to restore their own data. To create a snapshot, use
<strong class="command">manila snapshot-create</strong> command like:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila snapshot-create Share1 --name Snapshot1 --description <span class="s2">&quot;Snapshot of Share1&quot;</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Property          | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| status            | creating                             |</span>
<span class="go">| share_id          | e7364bcc-3821-49bf-82d6-0c9f0276d4ce |</span>
<span class="go">| description       | Snapshot of Share1                   |</span>
<span class="go">| created_at        | 2016-03-20T00:00:00.000000           |</span>
<span class="go">| share_proto       | NFS                                  |</span>
<span class="go">| provider_location | None                                 |</span>
<span class="go">| id                | a96cf025-92d1-4012-abdd-bb0f29e5aa8f |</span>
<span class="go">| size              | 1                                    |</span>
<span class="go">| share_size        | 1                                    |</span>
<span class="go">| name              | Snapshot1                            |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Then, if needed, update the name and description of the created
snapshot:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila snapshot-rename Snapshot1 Snapshot_1 --description <span class="s2">&quot;Snapshot of Share1. Updated.&quot;</span>
</pre></div>
</div>
<p>To make sure that the snapshot is available, run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila snapshot-show Snapshot1
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Property          | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| status            | available                            |</span>
<span class="go">| share_id          | e7364bcc-3821-49bf-82d6-0c9f0276d4ce |</span>
<span class="go">| description       | Snapshot of Share1                   |</span>
<span class="go">| created_at        | 2016-03-30T10:53:19.000000           |</span>
<span class="go">| share_proto       | NFS                                  |</span>
<span class="go">| provider_location | 3ca7a3b2-9f9f-46af-906f-6a565bf8ee37 |</span>
<span class="go">| id                | a96cf025-92d1-4012-abdd-bb0f29e5aa8f |</span>
<span class="go">| size              | 1                                    |</span>
<span class="go">| share_size        | 1                                    |</span>
<span class="go">| name              | Snapshot1                            |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For more details and additional information on snapshots, see
<a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-snapshots.html">Share Snapshots</a>
of “Shared File Systems” section of “OpenStack Administrator Guide” document.</p>
</div>
</div>
<div class="section" id="create-a-share-network">
<span id="id2"></span><h3>Create a Share Network<a class="headerlink" href="#create-a-share-network" title="Permalink to this headline">¶</a></h3>
<p>To control a share network, Shared File Systems service requires
interaction with Networking service to manage share servers on its own.
If the selected driver runs in a mode that requires such kind of
interaction, you need to specify the share network when a share is
created. For the information on share creation,
see <a class="reference internal" href="#create-share"><span class="std std-ref">Create Share</span></a> earlier in this chapter. Initially, check
the existing share networks type list by:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila share-network-list
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| id                                   | name         |</span>
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">+--------------------------------------+--------------+</span>
</pre></div>
</div>
<p>If share network list is empty or does not contain a required network,
just create, for example, a share network with a private network and
subnetwork.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila share-network-create --neutron-net-id 5ed5a854-21dc-4ed3-870a-117b7064eb21 <span class="se">\</span>
  --neutron-subnet-id 74dcfb5a-b4d7-4855-86f5-a669729428dc --name my_share_net <span class="se">\</span>
  --description <span class="s2">&quot;My first share network&quot;</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Property          | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| name              | my_share_net                         |</span>
<span class="go">| segmentation_id   | None                                 |</span>
<span class="go">| created_at        | 2015-09-24T12:06:32.602174           |</span>
<span class="go">| neutron_subnet_id | 74dcfb5a-b4d7-4855-86f5-a669729428dc |</span>
<span class="go">| updated_at        | None                                 |</span>
<span class="go">| network_type      | None                                 |</span>
<span class="go">| neutron_net_id    | 5ed5a854-21dc-4ed3-870a-117b7064eb21 |</span>
<span class="go">| ip_version        | None                                 |</span>
<span class="go">| nova_net_id       | None                                 |</span>
<span class="go">| cidr              | None                                 |</span>
<span class="go">| project_id        | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| id                | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |</span>
<span class="go">| description       | My first share network               |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">segmentation_id</span></code>, <code class="docutils literal"><span class="pre">cidr</span></code>, <code class="docutils literal"><span class="pre">ip_version</span></code>, and <code class="docutils literal"><span class="pre">network_type</span></code>
share network attributes are automatically set to the values determined
by the network provider.</p>
<p>Then check if the network became created by requesting the networks list
once again:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila share-network-list
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| id                                   | name         |</span>
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| 5c3cbabb-f4da-465f-bc7f-fadbe047b85a | my_share_net |</span>
<span class="go">+--------------------------------------+--------------+</span>
</pre></div>
</div>
<p>Finally, to create a share that uses this share network, get to Create
Share use case described earlier in this chapter.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">See <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-share-networks.html">Share Networks</a>
of “Shared File Systems” section of OpenStack Administrator Guide
document for more details.</p>
</div>
</div>
<div class="section" id="manage-a-share-network">
<h3>Manage a Share Network<a class="headerlink" href="#manage-a-share-network" title="Permalink to this headline">¶</a></h3>
<p>There is a pair of useful commands that help manipulate share networks.
To start, check the network list:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila share-network-list
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| id                                   | name         |</span>
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| 5c3cbabb-f4da-465f-bc7f-fadbe047b85a | my_share_net |</span>
<span class="go">+--------------------------------------+--------------+</span>
</pre></div>
</div>
<p>If you configured the back-end with
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span> <span class="pre">=</span> <span class="pre">True</span></code> (with the share servers) and had
already some operations in the Shared File Systems service, you can see
<code class="docutils literal"><span class="pre">manila_service_network</span></code> in the neutron list of networks. This network
was created by the share driver for internal usage.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network list
<span class="go">+--------------+------------------------+------------------------------------+</span>
<span class="go">| ID           | Name                   | Subnets                            |</span>
<span class="go">+--------------+------------------------+------------------------------------+</span>
<span class="go">| 3b5a629a-e...| manila_service_network | 4f366100-50... 10.254.0.0/28       |</span>
<span class="go">| bee7411d-d...| public                 | 884a6564-01... 2001:db8::/64       |</span>
<span class="go">|              |                        | e6da81fa-55... 172.24.4.0/24       |</span>
<span class="go">| 5ed5a854-2...| private                | 74dcfb5a-bd... 10.0.0.0/24         |</span>
<span class="go">|              |                        | cc297be2-51... fd7d:177d:a48b::/64 |</span>
<span class="go">+--------------+------------------------+------------------------------------+</span>
</pre></div>
</div>
<p>You also can see detailed information about the share network including
<code class="docutils literal"><span class="pre">network_type,</span> <span class="pre">segmentation_id</span></code> fields:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network show manila_service_network
<span class="go">+---------------------------+--------------------------------------+</span>
<span class="go">| Field                     | Value                                |</span>
<span class="go">+---------------------------+--------------------------------------+</span>
<span class="go">| admin_state_up            | True                                 |</span>
<span class="go">| availability_zone_hints   |                                      |</span>
<span class="go">| availability_zones        | nova                                 |</span>
<span class="go">| created_at                | 2016-03-20T00:00:00                  |</span>
<span class="go">| description               |                                      |</span>
<span class="go">| id                        | ef5282ab-dbf9-4d47-91d4-b0cc9b164567 |</span>
<span class="go">| ipv4_address_scope        |                                      |</span>
<span class="go">| ipv6_address_scope        |                                      |</span>
<span class="go">| mtu                       | 1450                                 |</span>
<span class="go">| name                      | manila_service_network               |</span>
<span class="go">| port_security_enabled     | True                                 |</span>
<span class="go">| provider:network_type     | vxlan                                |</span>
<span class="go">| provider:physical_network |                                      |</span>
<span class="go">| provider:segmentation_id  | 1047                                 |</span>
<span class="go">| router:external           | False                                |</span>
<span class="go">| shared                    | False                                |</span>
<span class="go">| status                    | ACTIVE                               |</span>
<span class="go">| subnets                   | aba49c7d-c7eb-44b9-9c8f-f6112b05a2e0 |</span>
<span class="go">| tags                      |                                      |</span>
<span class="go">| tenant_id                 | f121b3ee03804266af2959e56671b24a     |</span>
<span class="go">| updated_at                | 2016-03-20T00:00:00                  |</span>
<span class="go">+---------------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>You also can add and remove the security services to the share network.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For details, see subsection <a class="reference external" href="https://docs.openstack.org/admin-guide/shared-file-systems-security-services.html">Security Services</a>
of “Shared File Systems” section of OpenStack Administrator Guide document.</p>
</div>
</div>
</div>
<div class="section" id="instances">
<h2>Instances<a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h2>
<p>Instances are the running virtual machines within an OpenStack cloud.
This section deals with how to work with them and their underlying
images, their network properties, and how they are represented in the
database.</p>
<div class="section" id="starting-instances">
<h3>Starting Instances<a class="headerlink" href="#starting-instances" title="Permalink to this headline">¶</a></h3>
<p>To launch an instance, you need to select an image, a flavor, and a
name. The name needn&#8217;t be unique, but your life will be simpler if it is
because many tools will use the name in place of the UUID so long as the
name is unique. You can start an instance from the dashboard from the
<span class="guilabel">Launch Instance</span> button on the <span class="guilabel">Instances</span> page
or by selecting the <span class="guilabel">Launch</span> action next to an
image or a snapshot on the <span class="guilabel">Images</span> page.</p>
<p>On the command line, do this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --flavor FLAVOR --image IMAGE_NAME_OR_ID
</pre></div>
</div>
<p>There are a number of optional items that can be specified. You should
read the rest of this section before trying to start an instance, but
this is the base command that later details are layered upon.</p>
<p>To delete instances from the dashboard, select the
<span class="guilabel">Delete Instance</span> action next to the
instance on the <span class="guilabel">Instances</span> page.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In releases prior to Mitaka, select the equivalent <span class="guilabel">Terminate
instance</span> action.</p>
</div>
<p>From the command line, do this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server delete INSTANCE_ID
</pre></div>
</div>
<p>It is important to note that powering off an instance does not terminate
it in the OpenStack sense.</p>
</div>
<div class="section" id="instance-boot-failures">
<h3>Instance Boot Failures<a class="headerlink" href="#instance-boot-failures" title="Permalink to this headline">¶</a></h3>
<p>If an instance fails to start and immediately moves to an error state,
there are a few different ways to track down what has gone wrong. Some
of these can be done with normal user access, while others require
access to your log server or compute nodes.</p>
<p>The simplest reasons for nodes to fail to launch are quota violations or
the scheduler being unable to find a suitable compute node on which to
run the instance. In these cases, the error is apparent when you run a
<strong class="command">openstack server show</strong> on the faulted instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server show test-instance
<span class="go">+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field                                | Value                                                                                                                                 |</span>
<span class="go">+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| OS-DCF:diskConfig                    | AUTO                                                                                                                                  |</span>
<span class="go">| OS-EXT-AZ:availability_zone          | nova                                                                                                                                  |</span>
<span class="go">| OS-EXT-SRV-ATTR:host                 | None                                                                                                                                  |</span>
<span class="go">| OS-EXT-SRV-ATTR:hypervisor_hostname  | None                                                                                                                                  |</span>
<span class="go">| OS-EXT-SRV-ATTR:instance_name        | instance-0000000a                                                                                                                     |</span>
<span class="go">| OS-EXT-STS:power_state               | NOSTATE                                                                                                                               |</span>
<span class="go">| OS-EXT-STS:task_state                | None                                                                                                                                  |</span>
<span class="go">| OS-EXT-STS:vm_state                  | error                                                                                                                                 |</span>
<span class="go">| OS-SRV-USG:launched_at               | None                                                                                                                                  |</span>
<span class="go">| OS-SRV-USG:terminated_at             | None                                                                                                                                  |</span>
<span class="go">| accessIPv4                           |                                                                                                                                       |</span>
<span class="go">| accessIPv6                           |                                                                                                                                       |</span>
<span class="go">| addresses                            |                                                                                                                                       |</span>
<span class="go">| config_drive                         |                                                                                                                                       |</span>
<span class="go">| created                              | 2016-11-23T07:51:53Z                                                                                                                  |</span>
<span class="go">| fault                                | {u&#39;message&#39;: u&#39;Build of instance 6ec42311-a121-4887-aece-48fb93a4a098 aborted: Failed to allocate the network(s), not rescheduling.&#39;, |</span>
<span class="go">|                                      | u&#39;code&#39;: 500, u&#39;details&#39;: u&#39;  File &quot;/usr/lib/python2.7/site-packages/nova/compute/manager.py&quot;, line 1779, in                          |</span>
<span class="go">|                                      | _do_build_and_run_instance\n    filter_properties)\n  File &quot;/usr/lib/python2.7/site-packages/nova/compute/manager.py&quot;, line 1960, in  |</span>
<span class="go">|                                      | _build_and_run_instance\n    reason=msg)\n&#39;, u&#39;created&#39;: u&#39;2016-11-23T07:57:04Z&#39;}                                                     |</span>
<span class="go">| flavor                               | m1.tiny (1)                                                                                                                           |</span>
<span class="go">| hostId                               |                                                                                                                                       |</span>
<span class="go">| id                                   | 6ec42311-a121-4887-aece-48fb93a4a098                                                                                                  |</span>
<span class="go">| image                                | cirros (9fef3b2d-c35d-4b61-bea8-09cc6dc41829)                                                                                         |</span>
<span class="go">| key_name                             | None                                                                                                                                  |</span>
<span class="go">| name                                 | test-instance                                                                                                                         |</span>
<span class="go">| os-extended-volumes:volumes_attached | []                                                                                                                                    |</span>
<span class="go">| project_id                           | 5669caad86a04256994cdf755df4d3c1                                                                                                      |</span>
<span class="go">| properties                           |                                                                                                                                       |</span>
<span class="go">| status                               | ERROR                                                                                                                                 |</span>
<span class="go">| updated                              | 2016-11-23T07:57:04Z                                                                                                                  |</span>
<span class="go">| user_id                              | c36cec73b0e44876a4478b1e6cd749bb                                                                                                      |</span>
<span class="go">+--------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<p>In this case, looking at the <code class="docutils literal"><span class="pre">fault</span></code> message shows <code class="docutils literal"><span class="pre">NoValidHost</span></code>,
indicating that the scheduler was unable to match the instance
requirements.</p>
<p>If <strong class="command">openstack server show</strong> does not sufficiently explain the failure,
searching for the instance UUID in the <code class="docutils literal"><span class="pre">nova-compute.log</span></code> on the compute
node it was scheduled on or the <code class="docutils literal"><span class="pre">nova-scheduler.log</span></code> on your scheduler hosts
is a good place to start looking for lower-level problems.</p>
<p>Using <strong class="command">openstack server show</strong> as an admin user will show the compute
node the instance was scheduled on as <code class="docutils literal"><span class="pre">hostId</span></code>. If the instance failed
during scheduling, this field is blank.</p>
</div>
<div class="section" id="using-instance-specific-data">
<h3>Using Instance-Specific Data<a class="headerlink" href="#using-instance-specific-data" title="Permalink to this headline">¶</a></h3>
<p>There are two main types of instance-specific data: metadata and user
data.</p>
</div>
<div class="section" id="instance-metadata">
<h3>Instance metadata<a class="headerlink" href="#instance-metadata" title="Permalink to this headline">¶</a></h3>
<p>For Compute, instance metadata is a collection of key-value pairs
associated with an instance. Compute reads and writes to these key-value
pairs any time during the instance lifetime, from inside and outside the
instance, when the end user uses the Compute API to do so. However, you
cannot query the instance-associated key-value pairs with the metadata
service that is compatible with the Amazon EC2 metadata service.</p>
<p>For an example of instance metadata, users can generate and register SSH
keys using the <strong class="command">openstack keypair create</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack keypair create mykey &gt; mykey.pem
</pre></div>
</div>
<p>This creates a key named <code class="docutils literal"><span class="pre">mykey</span></code>, which you can associate with
instances. The file <code class="docutils literal"><span class="pre">mykey.pem</span></code> is the private key, which should be
saved to a secure location because it allows root access to instances
the <code class="docutils literal"><span class="pre">mykey</span></code> key is associated with.</p>
<p>Use this command to register an existing key with OpenStack:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack keypair create --public-key mykey.pub mykey
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must have the matching private key to access instances
associated with this key.</p>
</div>
<p>To associate a key with an instance on boot, add <code class="docutils literal"><span class="pre">--key-name</span> <span class="pre">mykey</span></code> to
your command line. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image ubuntu-cloudimage --flavor <span class="m">2</span> <span class="se">\</span>
  --key-name mykey myimage
</pre></div>
</div>
<p>When booting a server, you can also add arbitrary metadata so that you
can more easily identify it among other running instances. Use the
<code class="docutils literal"><span class="pre">--property</span></code> option with a key-value pair, where you can make up
the string for both the key and the value. For example, you could add a
description and also the creator of the server:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image<span class="o">=</span>test-image --flavor<span class="o">=</span><span class="m">1</span> <span class="se">\</span>
  --property <span class="nv">description</span><span class="o">=</span><span class="s1">&#39;Small test image&#39;</span> smallimage
</pre></div>
</div>
<p>When viewing the server information, you can see the metadata included
on the metadata line:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server show smallimage

<span class="go">+--------------------------------------+----------------------------------------------------------+</span>
<span class="go">| Field                                | Value                                                    |</span>
<span class="go">+--------------------------------------+----------------------------------------------------------+</span>
<span class="go">| OS-DCF:diskConfig                    | MANUAL                                                   |</span>
<span class="go">| OS-EXT-AZ:availability_zone          | nova                                                     |</span>
<span class="go">| OS-EXT-SRV-ATTR:host                 | rdo-newton.novalocal                                     |</span>
<span class="go">| OS-EXT-SRV-ATTR:hypervisor_hostname  | rdo-newton.novalocal                                     |</span>
<span class="go">| OS-EXT-SRV-ATTR:instance_name        | instance-00000002                                        |</span>
<span class="go">| OS-EXT-STS:power_state               | Running                                                  |</span>
<span class="go">| OS-EXT-STS:task_state                | None                                                     |</span>
<span class="go">| OS-EXT-STS:vm_state                  | active                                                   |</span>
<span class="go">| OS-SRV-USG:launched_at               | 2016-12-07T11:20:08.000000                               |</span>
<span class="go">| OS-SRV-USG:terminated_at             | None                                                     |</span>
<span class="go">| accessIPv4                           |                                                          |</span>
<span class="go">| accessIPv6                           |                                                          |</span>
<span class="go">| addresses                            | public=172.24.4.227                                      |</span>
<span class="go">| config_drive                         |                                                          |</span>
<span class="go">| created                              | 2016-12-07T11:17:44Z                                     |</span>
<span class="go">| flavor                               | m1.tiny (1)                                              |</span>
<span class="go">| hostId                               | aca973d5b7981faaf8c713a0130713bbc1e64151be65c8dfb53039f7 |</span>
<span class="go">| id                                   | 4f7c6b2c-f27e-4ccd-a606-6bfc9d7c0d91                     |</span>
<span class="go">| image                                | cirros (01bcb649-45d7-4e3d-8a58-1fcc87816907)            |</span>
<span class="go">| key_name                             | None                                                     |</span>
<span class="go">| name                                 | smallimage                                               |</span>
<span class="go">| os-extended-volumes:volumes_attached | []                                                       |</span>
<span class="go">| progress                             | 0                                                        |</span>
<span class="go">| project_id                           | 2daf82a578e9437cab396c888ff0ca57                         |</span>
<span class="go">| properties                           | description=&#39;Small test image&#39;                           |</span>
<span class="go">| security_groups                      | [{u&#39;name&#39;: u&#39;default&#39;}]                                  |</span>
<span class="go">| status                               | ACTIVE                                                   |</span>
<span class="go">| updated                              | 2016-12-07T11:20:08Z                                     |</span>
<span class="go">| user_id                              | 8cbea24666ae49bbb8c1641f9b12d2d2                         |</span>
<span class="go">+--------------------------------------+----------------------------------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="instance-user-data">
<h3>Instance user data<a class="headerlink" href="#instance-user-data" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">user-data</span></code> key is a special key in the metadata service that
holds a file that cloud-aware applications within the guest instance can
access. For example,
<a class="reference external" href="https://help.ubuntu.com/community/CloudInit">cloudinit</a> is an open
source package from Ubuntu, but available in most distributions, that
handles early initialization of a cloud instance that makes use of this
user data.</p>
<p>This user data can be put in a file on your local system and then passed
in at instance creation with the flag
<code class="docutils literal"><span class="pre">--user-data</span> <span class="pre">&lt;user-data-file&gt;</span></code>.</p>
<p>For example</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image ubuntu-cloudimage --flavor <span class="m">1</span> <span class="se">\</span>
  --user-data mydata.file mydatainstance
</pre></div>
</div>
<p>To understand the difference between user data and metadata, realize
that user data is created before an instance is started. User data is
accessible from within the instance when it is running. User data can be
used to store configuration, a script, or anything the tenant wants.</p>
</div>
<div class="section" id="file-injection">
<h3>File injection<a class="headerlink" href="#file-injection" title="Permalink to this headline">¶</a></h3>
<p>Arbitrary local files can also be placed into the instance file system
at creation time by using the <code class="docutils literal"><span class="pre">--file</span> <span class="pre">&lt;dst-path=src-path&gt;</span></code> option.
You may store up to five files.</p>
<p>For example, let&#8217;s say you have a special <code class="docutils literal"><span class="pre">authorized_keys</span></code> file named
special_authorized_keysfile that for some reason you want to put on
the instance instead of using the regular SSH key injection. In this
case, you can use the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image ubuntu-cloudimage --flavor <span class="m">1</span>  <span class="se">\</span>
  --file /root/.ssh/authorized_keys<span class="o">=</span>special_authorized_keysfile <span class="se">\</span>
  authkeyinstance
</pre></div>
</div>
</div>
</div>
<div class="section" id="associating-security-groups">
<h2>Associating Security Groups<a class="headerlink" href="#associating-security-groups" title="Permalink to this headline">¶</a></h2>
<p>Security groups, as discussed earlier, are typically required to allow
network traffic to an instance, unless the default security group for a
project has been modified to be more permissive.</p>
<p>Adding security groups is typically done on instance boot. When
launching from the dashboard, you do this on the
<span class="guilabel">Access &amp; Security</span> tab of the <span class="guilabel">Launch Instance</span> dialog.
When launching from the command line, append <code class="docutils literal"><span class="pre">--security-groups</span></code>
with a comma-separated list of security groups.</p>
<p>It is also possible to add and remove security groups when an instance
is running. Currently this is only available through the command-line
tools. Here is an example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server add security group SERVER SECURITY_GROUP_NAME_OR_ID
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server remove security group SERVER SECURITY_GROUP_NAME_OR_ID
</pre></div>
</div>
</div>
<div class="section" id="floating-ips">
<h2>Floating IPs<a class="headerlink" href="#floating-ips" title="Permalink to this headline">¶</a></h2>
<p>Where floating IPs are configured in a deployment, each project will
have a limited number of floating IPs controlled by a quota. However,
these need to be allocated to the project from the central pool prior to
their use—usually by the administrator of the project. To allocate a
floating IP to a project, use the <span class="guilabel">Allocate IP To Project</span> button
on the <span class="guilabel">Floating IPs</span> tab of the <span class="guilabel">Access &amp; Security</span> page
of the dashboard. The command line can also be used:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack floating ip create NETWORK_NAME_OR_ID
</pre></div>
</div>
<p>Once allocated, a floating IP can be assigned to running instances from
the dashboard either by selecting <span class="guilabel">Associate</span> from the
actions drop-down next to the IP on the <span class="guilabel">Floating IPs</span> tab of the
<span class="guilabel">Access &amp; Security</span> page or by making this selection next to the
instance you want to associate it with on the Instances page. The inverse
action, Dissociate Floating IP, is available from the <span class="guilabel">Floating IPs</span>
tab of the <span class="guilabel">Access &amp; Security</span> page and from the
<span class="guilabel">Instances</span> page.</p>
<p>To associate or disassociate a floating IP with a server from the
command line, use the following commands:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server add floating ip SERVER IP_ADDRESS
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server remove floating ip SERVER IP_ADDRESS
</pre></div>
</div>
</div>
<div class="section" id="attaching-block-storage">
<h2>Attaching Block Storage<a class="headerlink" href="#attaching-block-storage" title="Permalink to this headline">¶</a></h2>
<p>You can attach block storage to instances from the dashboard on the
<span class="guilabel">Volumes</span> page. Click the <span class="guilabel">Manage Attachments</span> action
next to the volume you want to attach.</p>
<p>To perform this action from command line, run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server add volume SERVER VOLUME_NAME_OR_ID --device DEVICE
</pre></div>
</div>
<p>You can also specify block deviceblock device mapping at instance boot
time through the nova command-line client with this option set:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">--block-device-mapping &lt;dev-name=mapping&gt;</span>
</pre></div>
</div>
<p>The block device mapping format is
<code class="docutils literal"><span class="pre">&lt;dev-name&gt;=&lt;id&gt;:&lt;type&gt;:&lt;size(GB)&gt;:&lt;delete-on-terminate&gt;</span></code>,
where:</p>
<dl class="docutils">
<dt>dev-name</dt>
<dd>A device name where the volume is attached in the system at
<code class="docutils literal"><span class="pre">/dev/dev_name</span></code></dd>
<dt>id</dt>
<dd>The ID of the volume to boot from, as shown in the output of
<strong class="command">openstack volume list</strong></dd>
<dt>type</dt>
<dd>Either <code class="docutils literal"><span class="pre">snap</span></code>, which means that the volume was created from a
snapshot, or anything other than <code class="docutils literal"><span class="pre">snap</span></code> (a blank string is valid).
In the preceding example, the volume was not created from a
snapshot, so we leave this field blank in our following example.</dd>
<dt>size (GB)</dt>
<dd>The size of the volume in gigabytes. It is safe to leave this blank
and have the Compute Service infer the size.</dd>
<dt>delete-on-terminate</dt>
<dd>A boolean to indicate whether the volume should be deleted when the
instance is terminated. True can be specified as <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">1</span></code>.
False can be specified as <code class="docutils literal"><span class="pre">False</span></code> or <code class="docutils literal"><span class="pre">0</span></code>.</dd>
</dl>
<p>The following command will boot a new instance and attach a volume at
the same time. The volume of ID 13 will be attached as <code class="docutils literal"><span class="pre">/dev/vdc</span></code>. It
is not a snapshot, does not specify a size, and will not be deleted when
the instance is terminated:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack server create --image 4042220e-4f5e-4398-9054-39fbd75a5dd7 <span class="se">\</span>
  --flavor <span class="m">2</span> --key-name mykey --block-device-mapping <span class="nv">vdc</span><span class="o">=</span><span class="m">13</span>:::0 <span class="se">\</span>
  boot-with-vol-test
</pre></div>
</div>
<p>If you have previously prepared block storage with a bootable file
system image, it is even possible to boot from persistent block storage.
The following command boots an image from the specified volume. It is
similar to the previous command, but the image is omitted and the volume
is now attached as <code class="docutils literal"><span class="pre">/dev/vda</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstck server create --flavor <span class="m">2</span> --key-name mykey <span class="se">\</span>
  --block-device-mapping <span class="nv">vda</span><span class="o">=</span><span class="m">13</span>:::0 boot-from-vol-test
</pre></div>
</div>
<p>Read more detailed instructions for launching an instance from a
bootable volume in the <a class="reference external" href="https://docs.openstack.org/user-guide/cli-nova-launch-instance-from-volume.html">OpenStack End User
Guide</a>.</p>
<p>To boot normally from an image and attach block storage, map to a device
other than vda. You can find instructions for launching an instance and
attaching a volume to the instance and for copying the image to the
attached volume in the <a class="reference external" href="https://docs.openstack.org/user-guide/dashboard-launch-instances.html">OpenStack End User
Guide</a>.</p>
</div>
<div class="section" id="taking-snapshots">
<h2>Taking Snapshots<a class="headerlink" href="#taking-snapshots" title="Permalink to this headline">¶</a></h2>
<p>The OpenStack snapshot mechanism allows you to create new images from
running instances. This is very convenient for upgrading base images or
for taking a published image and customizing it for local use. To
snapshot a running instance to an image using the CLI, do this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image create IMAGE_NAME --volume VOLUME_NAME_OR_ID
</pre></div>
</div>
<p>The dashboard interface for snapshots can be confusing because the
snapshots and images are displayed in the <span class="guilabel">Images</span> page. However, an
instance snapshot <em>is</em> an image. The only difference between an image
that you upload directly to the Image Service and an image that you
create by snapshot is that an image created by snapshot has additional
properties in the glance database. These properties are found in the
<code class="docutils literal"><span class="pre">image_properties</span></code> table and include:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">image_type</span></code></td>
<td>snapshot</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">instance_uuid</span></code></td>
<td>&lt;uuid of instance that was snapshotted&gt;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">base_image_ref</span></code></td>
<td>&lt;uuid of original image of instance that was snapshotted&gt;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">image_location</span></code></td>
<td>snapshot</td>
</tr>
</tbody>
</table>
<div class="section" id="live-snapshots">
<h3>Live Snapshots<a class="headerlink" href="#live-snapshots" title="Permalink to this headline">¶</a></h3>
<p>Live snapshots is a feature that allows users to snapshot the running
virtual machines without pausing them. These snapshots are simply
disk-only snapshots. Snapshotting an instance can now be performed with
no downtime (assuming QEMU 1.3+ and libvirt 1.0+ are used).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you use libvirt version <code class="docutils literal"><span class="pre">1.2.2</span></code>, you may experience
intermittent problems with live snapshot creation.</p>
<p>To effectively disable the libvirt live snapshotting, until the
problem is resolved, add the below setting to nova.conf.</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="k">[workarounds]</span>
    <span class="na">disable_libvirt_livesnapshot</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
</div>
<p><strong>Ensuring Snapshots of Linux Guests Are Consistent</strong></p>
<p>The following section is from Sébastien Han&#8217;s <a class="reference external" href="http://www.sebastien-han.fr/blog/2012/12/10/openstack-perform-consistent-snapshots/">“OpenStack: Perform
Consistent Snapshots” blog
entry</a>.</p>
<p>A snapshot captures the state of the file system, but not the state of
the memory. Therefore, to ensure your snapshot contains the data that
you want, before your snapshot you need to ensure that:</p>
<ul class="simple">
<li>Running programs have written their contents to disk</li>
<li>The file system does not have any &#8220;dirty&#8221; buffers: where programs
have issued the command to write to disk, but the operating system
has not yet done the write</li>
</ul>
<p>To ensure that important services have written their contents to disk
(such as databases), we recommend that you read the documentation for
those applications to determine what commands to issue to have them sync
their contents to disk. If you are unsure how to do this, the safest
approach is to simply stop these running services normally.</p>
<p>To deal with the &#8220;dirty&#8221; buffer issue, we recommend using the sync
command before snapshotting:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> sync
</pre></div>
</div>
<p>Running <code class="docutils literal"><span class="pre">sync</span></code> writes dirty buffers (buffered blocks that have been
modified but not written yet to the disk block) to disk.</p>
<p>Just running <code class="docutils literal"><span class="pre">sync</span></code> is not enough to ensure that the file system is
consistent. We recommend that you use the <code class="docutils literal"><span class="pre">fsfreeze</span></code> tool, which halts
new access to the file system, and create a stable image on disk that is
suitable for snapshotting. The <code class="docutils literal"><span class="pre">fsfreeze</span></code> tool supports several file
systems, including ext3, ext4, and XFS. If your virtual machine instance
is running on Ubuntu, install the util-linux package to get
<code class="docutils literal"><span class="pre">fsfreeze</span></code>:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the very common case where the underlying snapshot is done via
LVM, the filesystem freeze is automatically handled by LVM.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install util-linux
</pre></div>
</div>
<p>If your operating system doesn&#8217;t have a version of <code class="docutils literal"><span class="pre">fsfreeze</span></code>
available, you can use <code class="docutils literal"><span class="pre">xfs_freeze</span></code> instead, which is available on
Ubuntu in the xfsprogs package. Despite the &#8220;xfs&#8221; in the name,
xfs_freeze also works on ext3 and ext4 if you are using a Linux kernel
version 2.6.29 or greater, since it works at the virtual file system
(VFS) level starting at 2.6.29. The xfs_freeze version supports the
same command-line arguments as <code class="docutils literal"><span class="pre">fsfreeze</span></code>.</p>
<p>Consider the example where you want to take a snapshot of a persistent
block storage volume, detected by the guest operating system as
<code class="docutils literal"><span class="pre">/dev/vdb</span></code> and mounted on <code class="docutils literal"><span class="pre">/mnt</span></code>. The fsfreeze command accepts two
arguments:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-f</span></kbd></td>
<td>Freeze the system</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-u</span></kbd></td>
<td>Thaw (unfreeze) the system</td></tr>
</tbody>
</table>
<p>To freeze the volume in preparation for snapshotting, you would do the
following, as root, inside the instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> fsfreeze -f /mnt
</pre></div>
</div>
<p>You <em>must mount the file system</em> before you run the <strong class="command">fsfreeze</strong>
command.</p>
<p>When the <strong class="command">fsfreeze -f</strong> command is issued, all ongoing transactions in
the file system are allowed to complete, new write system calls are
halted, and other calls that modify the file system are halted. Most
importantly, all dirty data, metadata, and log information are written
to disk.</p>
<p>Once the volume has been frozen, do not attempt to read from or write to
the volume, as these operations hang. The operating system stops every
I/O operation and any I/O attempts are delayed until the file system has
been unfrozen.</p>
<p>Once you have issued the <strong class="command">fsfreeze</strong> command, it is safe to perform
the snapshot. For example, if the volume of your instance was named
<code class="docutils literal"><span class="pre">mon-volume</span></code> and you wanted to snapshot it to an image named
<code class="docutils literal"><span class="pre">mon-snapshot</span></code>, you could now run the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image create mon-snapshot --volume mon-volume
</pre></div>
</div>
<p>When the snapshot is done, you can thaw the file system with the
following command, as root, inside of the instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> fsfreeze -u /mnt
</pre></div>
</div>
<p>If you want to back up the root file system, you can&#8217;t simply run the
preceding command because it will freeze the prompt. Instead, run the
following one-liner, as root, inside the instance:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> fsfreeze -f / <span class="o">&amp;&amp;</span> <span class="nb">read</span> x<span class="p">;</span> fsfreeze -u /
</pre></div>
</div>
<p>After this command it is common practice
to call <strong class="command">openstack image create</strong> from your workstation, and
once done press enter in your instance shell to unfreeze it.
Obviously you could automate this, but at least it will let you
properly synchronize.</p>
<p><strong>Ensuring Snapshots of Windows Guests Are Consistent</strong></p>
<p>Obtaining consistent snapshots of Windows VMs is conceptually similar to
obtaining consistent snapshots of Linux VMs, although it requires
additional utilities to coordinate with a Windows-only subsystem
designed to facilitate consistent backups.</p>
<p>Windows XP and later releases include a Volume Shadow Copy Service (VSS)
which provides a framework so that compliant applications can be
consistently backed up on a live filesystem. To use this framework, a
VSS requestor is run that signals to the VSS service that a consistent
backup is needed. The VSS service notifies compliant applications
(called VSS writers) to quiesce their data activity. The VSS service
then tells the copy provider to create a snapshot. Once the snapshot has
been made, the VSS service unfreezes VSS writers and normal I/O activity
resumes.</p>
<p>QEMU provides a guest agent that can be run in guests running on KVM
hypervisors. This guest agent, on Windows VMs, coordinates with the
Windows VSS service to facilitate a workflow which ensures consistent
snapshots. This feature requires at least QEMU 1.7. The relevant guest
agent commands are:</p>
<dl class="docutils">
<dt>guest-file-flush</dt>
<dd>Write out &#8220;dirty&#8221; buffers to disk, similar to the Linux <code class="docutils literal"><span class="pre">sync</span></code>
operation.</dd>
<dt>guest-fsfreeze</dt>
<dd>Suspend I/O to the disks, similar to the Linux <code class="docutils literal"><span class="pre">fsfreeze</span> <span class="pre">-f</span></code>
operation.</dd>
<dt>guest-fsfreeze-thaw</dt>
<dd>Resume I/O to the disks, similar to the Linux <code class="docutils literal"><span class="pre">fsfreeze</span> <span class="pre">-u</span></code>
operation.</dd>
</dl>
<p>To obtain snapshots of a Windows VM these commands can be scripted in
sequence: flush the filesystems, freeze the filesystems, snapshot the
filesystems, then unfreeze the filesystems. As with scripting similar
workflows against Linux VMs, care must be used when writing such a
script to ensure error handling is thorough and filesystems will not be
left in a frozen state.</p>
</div>
</div>
<div class="section" id="instances-in-the-database">
<h2>Instances in the Database<a class="headerlink" href="#instances-in-the-database" title="Permalink to this headline">¶</a></h2>
<p>While instance information is stored in a number of database tables, the
table you most likely need to look at in relation to user instances is
the instances table.</p>
<p>The instances table carries most of the information related to both
running and deleted instances. It has a bewildering array of fields; for
an exhaustive list, look at the database. These are the most useful
fields for operators looking to form queries:</p>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">deleted</span></code> field is set to <code class="docutils literal"><span class="pre">1</span></code> if the instance has been
deleted and <code class="docutils literal"><span class="pre">NULL</span></code> if it has not been deleted. This field is
important for excluding deleted instances from your queries.</li>
<li>The <code class="docutils literal"><span class="pre">uuid</span></code> field is the UUID of the instance and is used throughout
other tables in the database as a foreign key. This ID is also
reported in logs, the dashboard, and command-line tools to uniquely
identify an instance.</li>
<li>A collection of foreign keys are available to find relations to the
instance. The most useful of these — <code class="docutils literal"><span class="pre">user_id</span></code> and <code class="docutils literal"><span class="pre">project_id</span></code>
are the UUIDs of the user who launched the instance
and the project it was launched in.</li>
<li>The <code class="docutils literal"><span class="pre">host</span></code> field tells which compute node is hosting the instance.</li>
<li>The <code class="docutils literal"><span class="pre">hostname</span></code> field holds the name of the instance when it is
launched. The display-name is initially the same as hostname but can
be reset using the nova rename command.</li>
</ul>
<p>A number of time-related fields are useful for tracking when state
changes happened on an instance:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">created_at</span></code></li>
<li><code class="docutils literal"><span class="pre">updated_at</span></code></li>
<li><code class="docutils literal"><span class="pre">deleted_at</span></code></li>
<li><code class="docutils literal"><span class="pre">scheduled_at</span></code></li>
<li><code class="docutils literal"><span class="pre">launched_at</span></code></li>
<li><code class="docutils literal"><span class="pre">terminated_at</span></code></li>
</ul>
</div>
<div class="section" id="good-luck">
<h2>Good Luck!<a class="headerlink" href="#good-luck" title="Permalink to this headline">¶</a></h2>
<p>This section was intended as a brief introduction to some of the most
useful of many OpenStack commands. For an exhaustive list, please refer
to the <a class="reference external" href="https://docs.openstack.org/admin-guide/">OpenStack Administrator Guide</a>.
We hope your users remain happy and recognize your hard work!
(For more hard work, turn the page to the next chapter, where we discuss
the system-facing operations: maintenance, failures and debugging.)</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="ops-projects-users-summary.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Summary"></i></a>
          
          
            <a href="ops-maintenance.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Maintenance, Failures, and Debugging"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 08:41</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="operations.html">Operations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ops-lay-of-the-land.html">Lay of the Land</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-projects-users.html">Managing Projects and Users</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">User-Facing Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-maintenance.html">Maintenance, Failures, and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-network-troubleshooting.html">Network Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-logging-monitoring.html">Logging and Monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-backup-recovery.html">Backup and Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-customize.html">Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-advanced-configuration.html">Advanced Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops-upgrades.html">Upgrades</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app-usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-crypt.html">Tales From the Cryp^H^H^H^H Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-roadmaps.html">Working with Roadmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "ops-user-facing-operations" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/ops-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 0719207c6d82d2c215b9c13234f3a27478e0c0f3";
        var bugProject = "openstack-manuals";
        var bugTitle = "User-Facing Operations in Operations Guide";
    var fieldTags = "ops-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.0.1 on 2017-02-14 08:41";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>