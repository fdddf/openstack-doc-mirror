<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Scaling</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Scaling</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="arch-compute-nodes.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Compute Nodes"></i></a>
    
    
    <a href="arch-storage.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Storage Decisions"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:54</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Scaling</a><ul>
<li><a class="reference internal" href="#the-starting-point">The Starting Point</a></li>
<li><a class="reference internal" href="#adding-cloud-controller-nodes">Adding Cloud Controller Nodes</a></li>
<li><a class="reference internal" href="#segregating-your-cloud">Segregating Your Cloud</a><ul>
<li><a class="reference internal" href="#cells-and-regions">Cells and Regions</a></li>
<li><a class="reference internal" href="#availability-zones-and-host-aggregates">Availability Zones and Host Aggregates</a><ul>
<li><a class="reference internal" href="#availability-zone">Availability zone</a></li>
<li><a class="reference internal" href="#host-aggregates-zone">Host aggregates zone</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#scalable-hardware">Scalable Hardware</a><ul>
<li><a class="reference internal" href="#hardware-procurement">Hardware Procurement</a></li>
<li><a class="reference internal" href="#capacity-planning">Capacity Planning</a></li>
<li><a class="reference internal" href="#burn-in-testing">Burn-in Testing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="scaling">
<h1>Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h1>
<p>Whereas traditional applications required larger hardware to scale
(&#8220;vertical scaling&#8221;), cloud-based applications typically request more,
discrete hardware (&#8220;horizontal scaling&#8221;). If your cloud is successful,
eventually you must add resources to meet the increasing demand.</p>
<p>To suit the cloud paradigm, OpenStack itself is designed to be
horizontally scalable. Rather than switching to larger servers, you
procure more servers and simply install identically configured services.
Ideally, you scale out and load balance among groups of functionally
identical services (for example, compute nodes or <code class="docutils literal"><span class="pre">nova-api</span></code> nodes),
that communicate on a message bus.</p>
<div class="section" id="the-starting-point">
<h2>The Starting Point<a class="headerlink" href="#the-starting-point" title="Permalink to this headline">¶</a></h2>
<p>Determining the scalability of your cloud and how to improve it is an
exercise with many variables to balance. No one solution meets
everyone&#8217;s scalability goals. However, it is helpful to track a number
of metrics. Since you can define virtual hardware templates, called
&#8220;flavors&#8221; in OpenStack, you can start to make scaling decisions based on
the flavors you&#8217;ll provide. These templates define sizes for memory in
RAM, root disk size, amount of ephemeral data disk space available, and
number of cores for starters.</p>
<p>The default OpenStack flavors are shown in <a class="reference internal" href="#table-default-flavors"><span class="std std-ref">Table. OpenStack default flavors</span></a>.</p>
<table border="1" class="docutils" id="id1">
<span id="table-default-flavors"></span><caption><span class="caption-text">Table. OpenStack default flavors</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Virtual cores</th>
<th class="head">Memory</th>
<th class="head">Disk</th>
<th class="head">Ephemeral</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>m1.tiny</td>
<td>1</td>
<td>512 MB</td>
<td>1 GB</td>
<td>0 GB</td>
</tr>
<tr class="row-odd"><td>m1.small</td>
<td>1</td>
<td>2 GB</td>
<td>10 GB</td>
<td>20 GB</td>
</tr>
<tr class="row-even"><td>m1.medium</td>
<td>2</td>
<td>4 GB</td>
<td>10 GB</td>
<td>40 GB</td>
</tr>
<tr class="row-odd"><td>m1.large</td>
<td>4</td>
<td>8 GB</td>
<td>10 GB</td>
<td>80 GB</td>
</tr>
<tr class="row-even"><td>m1.xlarge</td>
<td>8</td>
<td>16 GB</td>
<td>10 GB</td>
<td>160 GB</td>
</tr>
</tbody>
</table>
<p>The starting point for most is the core count of your cloud. By applying
some ratios, you can gather information about:</p>
<ul class="simple">
<li>The number of virtual machines (VMs) you expect to run,
<code class="docutils literal"><span class="pre">((overcommit</span> <span class="pre">fraction</span> <span class="pre">×</span> <span class="pre">cores)</span> <span class="pre">/</span> <span class="pre">virtual</span> <span class="pre">cores</span> <span class="pre">per</span> <span class="pre">instance)</span></code></li>
<li>How much storage is required <code class="docutils literal"><span class="pre">(flavor</span> <span class="pre">disk</span> <span class="pre">size</span> <span class="pre">×</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">instances)</span></code></li>
</ul>
<p>You can use these ratios to determine how much additional infrastructure
you need to support your cloud.</p>
<p>Here is an example using the ratios for gathering scalability
information for the number of VMs expected as well as the storage
needed. The following numbers support (200 / 2) × 16 = 1600 VM instances
and require 80 TB of storage for <code class="docutils literal"><span class="pre">/var/lib/nova/instances</span></code>:</p>
<ul class="simple">
<li>200 physical cores.</li>
<li>Most instances are size m1.medium (two virtual cores, 50 GB of
storage).</li>
<li>Default CPU overcommit ratio (<code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> in nova.conf)
of 16:1.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Regardless of the overcommit ratio, an instance can not be placed
on any physical node with fewer raw (pre-overcommit) resources than
instance flavor requires.</p>
</div>
<p>However, you need more than the core count alone to estimate the load
that the API services, database servers, and queue servers are likely to
encounter. You must also consider the usage patterns of your cloud.</p>
<p>As a specific example, compare a cloud that supports a managed
web-hosting platform with one running integration tests for a
development project that creates one VM per code commit. In the former,
the heavy work of creating a VM happens only every few months, whereas
the latter puts constant heavy load on the cloud controller. You must
consider your average VM lifetime, as a larger number generally means
less load on the cloud controller.</p>
<p>Aside from the creation and termination of VMs, you must consider the
impact of users accessing the service—particularly on <code class="docutils literal"><span class="pre">nova-api</span></code> and
its associated database. Listing instances garners a great deal of
information and, given the frequency with which users run this
operation, a cloud with a large number of users can increase the load
significantly. This can occur even without their knowledge—leaving the
OpenStack dashboard instances tab open in the browser refreshes the list
of VMs every 30 seconds.</p>
<p>After you consider these factors, you can determine how many cloud
controller cores you require. A typical eight core, 8 GB of RAM server
is sufficient for up to a rack of compute nodes — given the above
caveats.</p>
<p>You must also consider key hardware specifications for the performance
of user VMs, as well as budget and performance needs, including storage
performance (spindles/core), memory availability (RAM/core), network
bandwidth (Gbps/core), and overall CPU performance (CPU/core).</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For a discussion of metric tracking, including how to extract
metrics from your cloud, see <a class="reference internal" href="ops-logging-monitoring.html"><span class="doc">Logging and Monitoring</span></a>.</p>
</div>
</div>
<div class="section" id="adding-cloud-controller-nodes">
<h2>Adding Cloud Controller Nodes<a class="headerlink" href="#adding-cloud-controller-nodes" title="Permalink to this headline">¶</a></h2>
<p>You can facilitate the horizontal expansion of your cloud by adding
nodes. Adding compute nodes is straightforward—they are easily picked up
by the existing installation. However, you must consider some important
points when you design your cluster to be highly available.</p>
<p>Recall that a cloud controller node runs several different services. You
can install services that communicate only using the message queue
internally—<code class="docutils literal"><span class="pre">nova-scheduler</span></code> and <code class="docutils literal"><span class="pre">nova-console</span></code>—on a new server for
expansion. However, other integral parts require more care.</p>
<p>You should load balance user-facing services such as dashboard,
<code class="docutils literal"><span class="pre">nova-api</span></code>, or the Object Storage proxy. Use any standard HTTP
load-balancing method (DNS round robin, hardware load balancer, or
software such as Pound or HAProxy). One caveat with dashboard is the VNC
proxy, which uses the WebSocket protocol—something that an L7 load
balancer might struggle with. See also <a class="reference external" href="https://docs.openstack.org/developer/horizon/topics/deployment.html#session-storage">Horizon session storage</a>.</p>
<p>You can configure some services, such as <code class="docutils literal"><span class="pre">nova-api</span></code> and
<code class="docutils literal"><span class="pre">glance-api</span></code>, to use multiple processes by changing a flag in their
configuration file—allowing them to share work between multiple cores on
the one machine.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Several options are available for MySQL load balancing, and the
supported AMQP brokers have built-in clustering support. Information
on how to configure these and many of the other services can be
found in <a class="reference internal" href="operations.html"><span class="doc">Operations</span></a>.</p>
</div>
</div>
<div class="section" id="segregating-your-cloud">
<h2>Segregating Your Cloud<a class="headerlink" href="#segregating-your-cloud" title="Permalink to this headline">¶</a></h2>
<p>When you want to offer users different regions to provide legal
considerations for data storage, redundancy across earthquake fault
lines, or for low-latency API calls, you segregate your cloud. Use one
of the following OpenStack methods to segregate your cloud: <em>cells</em>,
<em>regions</em>, <em>availability zones</em>, or <em>host aggregates</em>.</p>
<p>Each method provides different functionality and can be best divided
into two groups:</p>
<ul class="simple">
<li>Cells and regions, which segregate an entire cloud and result in
running separate Compute deployments.</li>
<li><a class="reference internal" href="common/glossary.html#term-availability-zone"><span class="xref std std-term">Availability zones</span></a> and host aggregates,
which merely divide a single Compute deployment.</li>
</ul>
<p><a class="reference internal" href="#table-segregation-methods"><span class="std std-ref">Table. OpenStack segregation methods</span></a> provides a comparison view of each
segregation method currently provided by OpenStack Compute.</p>
<table border="1" class="docutils" id="id2">
<span id="table-segregation-methods"></span><caption><span class="caption-text">Table. OpenStack segregation methods</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">Cells</th>
<th class="head">Regions</th>
<th class="head">Availability zones</th>
<th class="head">Host aggregates</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Use when you need</strong></td>
<td>A single <a class="reference internal" href="common/glossary.html#term-api-endpoint"><span class="xref std std-term">API endpoint</span></a> for compute, or you require a second
level of scheduling.</td>
<td>Discrete regions with separate API endpoints and no coordination
between regions.</td>
<td>Logical separation within your nova deployment for physical isolation
or redundancy.</td>
<td>To schedule a group of hosts with common features.</td>
</tr>
<tr class="row-odd"><td><strong>Example</strong></td>
<td>A cloud with multiple sites where you can schedule VMs &#8220;anywhere&#8221; or on
a particular site.</td>
<td>A cloud with multiple sites, where you schedule VMs to a particular
site and you want a shared infrastructure.</td>
<td>A single-site cloud with equipment fed by separate power supplies.</td>
<td>Scheduling to hosts with trusted hardware support.</td>
</tr>
<tr class="row-even"><td><strong>Overhead</strong></td>
<td>Considered experimental. A new service, nova-cells. Each cell has a full
nova installation except nova-api.</td>
<td>A different API endpoint for every region. Each region has a full nova
installation.</td>
<td>Configuration changes to <code class="docutils literal"><span class="pre">nova.conf</span></code>.</td>
<td>Configuration changes to <code class="docutils literal"><span class="pre">nova.conf</span></code>.</td>
</tr>
<tr class="row-odd"><td><strong>Shared services</strong></td>
<td>Keystone, <code class="docutils literal"><span class="pre">nova-api</span></code></td>
<td>Keystone</td>
<td>Keystone, All nova services</td>
<td>Keystone, All nova services</td>
</tr>
</tbody>
</table>
<div class="section" id="cells-and-regions">
<h3>Cells and Regions<a class="headerlink" href="#cells-and-regions" title="Permalink to this headline">¶</a></h3>
<p>OpenStack Compute cells are designed to allow running the cloud in a
distributed fashion without having to use more complicated technologies,
or be invasive to existing nova installations. Hosts in a cloud are
partitioned into groups called <em>cells</em>. Cells are configured in a tree.
The top-level cell (&#8220;API cell&#8221;) has a host that runs the <code class="docutils literal"><span class="pre">nova-api</span></code>
service, but no <code class="docutils literal"><span class="pre">nova-compute</span></code> services. Each child cell runs all of
the other typical <code class="docutils literal"><span class="pre">nova-*</span></code> services found in a regular installation,
except for the <code class="docutils literal"><span class="pre">nova-api</span></code> service. Each cell has its own message queue
and database service and also runs <code class="docutils literal"><span class="pre">nova-cells</span></code>, which manages the
communication between the API cell and child cells.</p>
<p>This allows for a single API server being used to control access to
multiple cloud installations. Introducing a second level of scheduling
(the cell selection), in addition to the regular <code class="docutils literal"><span class="pre">nova-scheduler</span></code>
selection of hosts, provides greater flexibility to control where
virtual machines are run.</p>
<p>Unlike having a single API endpoint, regions have a separate API
endpoint per installation, allowing for a more discrete separation.
Users wanting to run instances across sites have to explicitly select a
region. However, the additional complexity of a running a new service is
not required.</p>
<p>The OpenStack dashboard (horizon) can be configured to use multiple
regions. This can be configured through the <code class="docutils literal"><span class="pre">AVAILABLE_REGIONS</span></code>
parameter.</p>
</div>
<div class="section" id="availability-zones-and-host-aggregates">
<h3>Availability Zones and Host Aggregates<a class="headerlink" href="#availability-zones-and-host-aggregates" title="Permalink to this headline">¶</a></h3>
<p>You can use availability zones, host aggregates, or both to partition a
nova deployment.</p>
<p>Availability zones are implemented through and configured in a similar
way to host aggregates.</p>
<p>However, you use them for different reasons.</p>
<div class="section" id="availability-zone">
<h4>Availability zone<a class="headerlink" href="#availability-zone" title="Permalink to this headline">¶</a></h4>
<p>This enables you to arrange OpenStack compute hosts into logical groups
and provides a form of physical isolation and redundancy from other
availability zones, such as by using a separate power supply or network
equipment.</p>
<p>You define the availability zone in which a specified compute host
resides locally on each server. An availability zone is commonly used to
identify a set of servers that have a common attribute. For instance, if
some of the racks in your data center are on a separate power source,
you can put servers in those racks in their own availability zone.
Availability zones can also help separate different classes of hardware.</p>
<p>When users provision resources, they can specify from which availability
zone they want their instance to be built. This allows cloud consumers
to ensure that their application resources are spread across disparate
machines to achieve high availability in the event of hardware failure.</p>
</div>
<div class="section" id="host-aggregates-zone">
<h4>Host aggregates zone<a class="headerlink" href="#host-aggregates-zone" title="Permalink to this headline">¶</a></h4>
<p>This enables you to partition OpenStack Compute deployments into logical
groups for load balancing and instance distribution. You can use host
aggregates to further partition an availability zone. For example, you
might use host aggregates to partition an availability zone into groups
of hosts that either share common resources, such as storage and
network, or have a special property, such as trusted computing
hardware.</p>
<p>A common use of host aggregates is to provide information for use with
the <code class="docutils literal"><span class="pre">nova-scheduler</span></code>. For example, you might use a host aggregate to
group a set of hosts that share specific flavors or images.</p>
<p>The general case for this is setting key-value pairs in the aggregate
metadata and matching key-value pairs in flavor&#8217;s <code class="docutils literal"><span class="pre">extra_specs</span></code>
metadata. The <code class="docutils literal"><span class="pre">AggregateInstanceExtraSpecsFilter</span></code> in the filter
scheduler will enforce that instances be scheduled only on hosts in
aggregates that define the same key to the same value.</p>
<p>An advanced use of this general concept allows different flavor types to
run with different CPU and RAM allocation ratios so that high-intensity
computing loads and low-intensity development and testing systems can
share the same cloud without either starving the high-use systems or
wasting resources on low-utilization systems. This works by setting
<code class="docutils literal"><span class="pre">metadata</span></code> in your host aggregates and matching <code class="docutils literal"><span class="pre">extra_specs</span></code> in
your flavor types.</p>
<p>The first step is setting the aggregate metadata keys
<code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> and <code class="docutils literal"><span class="pre">ram_allocation_ratio</span></code> to a
floating-point value. The filter schedulers <code class="docutils literal"><span class="pre">AggregateCoreFilter</span></code> and
<code class="docutils literal"><span class="pre">AggregateRamFilter</span></code> will use those values rather than the global
defaults in <code class="docutils literal"><span class="pre">nova.conf</span></code> when scheduling to hosts in the aggregate. It
is important to be cautious when using this feature, since each host can
be in multiple aggregates but should have only one allocation ratio for
each resources. It is up to you to avoid putting a host in multiple
aggregates that define different values for the same resource.</p>
<p>This is the first half of the equation. To get flavor types that are
guaranteed a particular ratio, you must set the <code class="docutils literal"><span class="pre">extra_specs</span></code> in the
flavor type to the key-value pair you want to match in the aggregate.
For example, if you define <code class="docutils literal"><span class="pre">extra_specs</span></code> <code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> to
&#8220;1.0&#8221;, then instances of that type will run in aggregates only where the
metadata key <code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> is also defined as &#8220;1.0.&#8221; In
practice, it is better to define an additional key-value pair in the
aggregate metadata to match on rather than match directly on
<code class="docutils literal"><span class="pre">cpu_allocation_ratio</span></code> or <code class="docutils literal"><span class="pre">core_allocation_ratio</span></code>. This allows
better abstraction. For example, by defining a key <code class="docutils literal"><span class="pre">overcommit</span></code> and
setting a value of &#8220;high,&#8221; &#8220;medium,&#8221; or &#8220;low,&#8221; you could then tune the
numeric allocation ratios in the aggregates without also needing to
change all flavor types relating to them.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Previously, all services had an availability zone. Currently, only
the <code class="docutils literal"><span class="pre">nova-compute</span></code> service has its own availability zone. Services
such as <code class="docutils literal"><span class="pre">nova-scheduler</span></code> and <code class="docutils literal"><span class="pre">nova-conductor</span></code> span all
availability zones.</p>
<p>When you run any of the following operations, the services appear in
their own internal availability zone
(CONF.internal_service_availability_zone):</p>
<ul class="simple">
<li><strong class="command">openstack host list</strong> (os-hosts)</li>
<li><strong class="command">euca-describe-availability-zones verbose</strong></li>
<li><strong class="command">openstack compute service list</strong></li>
</ul>
<p>The internal availability zone is hidden in
euca-describe-availability_zones (nonverbose).</p>
<p>CONF.node_availability_zone has been renamed to
CONF.default_availability_zone and is used only by the
<code class="docutils literal"><span class="pre">nova-api</span></code> and <code class="docutils literal"><span class="pre">nova-scheduler</span></code> services.</p>
<p class="last">CONF.node_availability_zone still works but is deprecated.</p>
</div>
</div>
</div>
</div>
<div class="section" id="scalable-hardware">
<h2>Scalable Hardware<a class="headerlink" href="#scalable-hardware" title="Permalink to this headline">¶</a></h2>
<p>While several resources already exist to help with deploying and
installing OpenStack, it&#8217;s very important to make sure that you have
your deployment planned out ahead of time. This guide presumes that you
have at least set aside a rack for the OpenStack cloud but also offers
suggestions for when and what to scale.</p>
<div class="section" id="hardware-procurement">
<h3>Hardware Procurement<a class="headerlink" href="#hardware-procurement" title="Permalink to this headline">¶</a></h3>
<p>“The Cloud” has been described as a volatile environment where servers
can be created and terminated at will. While this may be true, it does
not mean that your servers must be volatile. Ensuring that your cloud&#8217;s
hardware is stable and configured correctly means that your cloud
environment remains up and running. Basically, put effort into creating
a stable hardware environment so that you can host a cloud that users
may treat as unstable and volatile.</p>
<p>OpenStack can be deployed on any hardware supported by an
OpenStack-compatible Linux distribution.</p>
<p>Hardware does not have to be consistent, but it should at least have the
same type of CPU to support instance migration.</p>
<p>The typical hardware recommended for use with OpenStack is the standard
value-for-money offerings that most hardware vendors stock. It should be
straightforward to divide your procurement into building blocks such as
&#8220;compute,&#8221; &#8220;object storage,&#8221; and &#8220;cloud controller,&#8221; and request as many
of these as you need. Alternatively, should you be unable to spend more,
if you have existing servers—provided they meet your performance
requirements and virtualization technology—they are quite likely to be
able to support OpenStack.</p>
</div>
<div class="section" id="capacity-planning">
<h3>Capacity Planning<a class="headerlink" href="#capacity-planning" title="Permalink to this headline">¶</a></h3>
<p>OpenStack is designed to increase in size in a straightforward manner.
Taking into account the considerations that we&#8217;ve mentioned in this
chapter—particularly on the sizing of the cloud controller—it should be
possible to procure additional compute or object storage nodes as
needed. New nodes do not need to be the same specification, or even
vendor, as existing nodes.</p>
<p>For compute nodes, <code class="docutils literal"><span class="pre">nova-scheduler</span></code> will take care of differences in
sizing having to do with core count and RAM amounts; however, you should
consider that the user experience changes with differing CPU speeds.
When adding object storage nodes, a <a class="reference internal" href="common/glossary.html#term-weight"><span class="xref std std-term">weight</span></a> should be specified
that reflects the <a class="reference internal" href="common/glossary.html#term-capability"><span class="xref std std-term">capability</span></a> of the node.</p>
<p>Monitoring the resource usage and user growth will enable you to know
when to procure. <a class="reference internal" href="ops-logging-monitoring.html"><span class="doc">Logging and Monitoring</span></a> details some useful metrics.</p>
</div>
<div class="section" id="burn-in-testing">
<h3>Burn-in Testing<a class="headerlink" href="#burn-in-testing" title="Permalink to this headline">¶</a></h3>
<p>The chances of failure for the server&#8217;s hardware are high at the start
and the end of its life. As a result, dealing with hardware failures
while in production can be avoided by appropriate burn-in testing to
attempt to trigger the early-stage failures. The general principle is to
stress the hardware to its limits. Examples of burn-in tests include
running a CPU or disk benchmark for several days.</p>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="arch-compute-nodes.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Compute Nodes"></i></a>
          
          
            <a href="arch-storage.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Storage Decisions"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:54</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="architecture.html">Architecture</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="arch-examples.html">Architecture Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-provision.html">Provisioning and Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-cloud-controller.html">Designing for Cloud Controllers and Cloud Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-compute-nodes.html">Compute Nodes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-storage.html">Storage Decisions</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch-network-design.html">Network Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app-usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-crypt.html">Tales From the Cryp^H^H^H^H Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-roadmaps.html">Working with Roadmaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-resources.html">Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "arch-scaling" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/ops-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 3993c81360ea23a2e599faf5f3de0d288b10c20a";
        var bugProject = "openstack-manuals";
        var bugTitle = "Scaling in Operations Guide";
    var fieldTags = "ops-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.0.1 on 2017-02-14 13:54";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>