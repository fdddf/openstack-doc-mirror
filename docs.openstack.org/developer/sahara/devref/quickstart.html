<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quickstart guide &mdash; Sahara</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.0.0.0rc2.dev34',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Sahara" href="../index.html" />
    <link rel="next" title="How to Participate" href="how_to_participate.html" />
    <link rel="prev" title="Setup DevStack" href="devstack.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="quickstart-guide">
<h1>Quickstart guide<a class="headerlink" href="#quickstart-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="launching-a-cluster-via-sahara-cli-commands">
<h2>Launching a cluster via Sahara CLI commands<a class="headerlink" href="#launching-a-cluster-via-sahara-cli-commands" title="Permalink to this headline">¶</a></h2>
<p>This guide will help you setup a vanilla Hadoop cluster using a combination
of OpenStack command line tools and the sahara <a class="reference internal" href="../restapi.html"><em>REST API</em></a>.</p>
<div class="section" id="install-sahara">
<h3>1. Install sahara<a class="headerlink" href="#install-sahara" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If you want to hack the code follow
<a class="reference internal" href="development.environment.html"><em>Setting Up a Development Environment</em></a>.</li>
</ul>
<p>OR</p>
<ul class="simple">
<li>If you just want to install and use sahara follow
<a class="reference internal" href="../userdoc/installation.guide.html"><em>Sahara Installation Guide</em></a>.</li>
</ul>
</div>
<div class="section" id="identity-service-configuration">
<h3>2. Identity service configuration<a class="headerlink" href="#identity-service-configuration" title="Permalink to this headline">¶</a></h3>
<p>To use the OpenStack command line tools you should specify
environment variables with the configuration details for your OpenStack
installation. The following example assumes that the Identity service is
at <code class="docutils literal"><span class="pre">127.0.0.1:5000</span></code>, with a user <code class="docutils literal"><span class="pre">admin</span></code> in the <code class="docutils literal"><span class="pre">admin</span></code> project
whose password is <code class="docutils literal"><span class="pre">nova</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">export</span> <span class="nv">OS_AUTH_URL</span><span class="o">=</span>http://127.0.0.1:5000/v2.0/
<span class="gp">$</span> <span class="nb">export</span> <span class="nv">OS_PROJECT_NAME</span><span class="o">=</span>admin
<span class="gp">$</span> <span class="nb">export</span> <span class="nv">OS_USERNAME</span><span class="o">=</span>admin
<span class="gp">$</span> <span class="nb">export</span> <span class="nv">OS_PASSWORD</span><span class="o">=</span>nova
</pre></div>
</div>
</div>
<div class="section" id="upload-an-image-to-the-image-service">
<h3>3. Upload an image to the Image service<a class="headerlink" href="#upload-an-image-to-the-image-service" title="Permalink to this headline">¶</a></h3>
<p>You will need to upload a virtual machine image to the OpenStack Image
service. You can download pre-built images with vanilla Apache Hadoop
installed, or build the images yourself. This guide uses the latest available
Ubuntu upstream image, referred to as <code class="docutils literal"><span class="pre">sahara-vanilla-latest-ubuntu.qcow2</span></code>
and the latest version of vanilla plugin as an example.
Sample images are available here:</p>
<p><a class="reference external" href="http://sahara-files.mirantis.com/images/upstream/">Sample Images</a></p>
<ul class="simple">
<li>Download a pre-built image</li>
</ul>
<p><strong>Note:</strong> For the steps below, substitute <code class="docutils literal"><span class="pre">&lt;openstack_release&gt;</span></code> with the
appropriate OpenStack release and <code class="docutils literal"><span class="pre">&lt;sahara_image&gt;</span></code> with the image of your
choice.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ssh user@hostname
<span class="gp">$</span> wget http://sahara-files.mirantis.com/images/upstream/&lt;openstack_release&gt;/&lt;sahara_image&gt;.qcow2
</pre></div>
</div>
<p>Upload the image downloaded above into the OpenStack Image service:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image create sahara-vanilla-latest-ubuntu --disk-format qcow2 <span class="se">\</span>
    --container-format bare --file sahara-vanilla-latest-ubuntu.qcow2
<span class="go">+------------------+--------------------------------------+</span>
<span class="go">| Field            | Value                                |</span>
<span class="go">+------------------+--------------------------------------+</span>
<span class="go">| checksum         | 3da49911332fc46db0c5fb7c197e3a77     |</span>
<span class="go">| container_format | bare                                 |</span>
<span class="go">| created_at       | 2016-02-29T10:15:04.000000           |</span>
<span class="go">| deleted          | False                                |</span>
<span class="go">| deleted_at       | None                                 |</span>
<span class="go">| disk_format      | qcow2                                |</span>
<span class="go">| id               | 71b9eeac-c904-4170-866a-1f833ea614f3 |</span>
<span class="go">| is_public        | False                                |</span>
<span class="go">| min_disk         | 0                                    |</span>
<span class="go">| min_ram          | 0                                    |</span>
<span class="go">| name             | sahara-vanilla-latest-ubuntu         |</span>
<span class="go">| owner            | 057d23cddb864759bfa61d730d444b1f     |</span>
<span class="go">| properties       |                                      |</span>
<span class="go">| protected        | False                                |</span>
<span class="go">| size             | 1181876224                           |</span>
<span class="go">| status           | active                               |</span>
<span class="go">| updated_at       | 2016-02-29T10:15:41.000000           |</span>
<span class="go">| virtual_size     | None                                 |</span>
<span class="go">+------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>OR</p>
<ul class="simple">
<li>Build the image using: <a class="reference external" href="https://github.com/openstack/sahara-image-elements/blob/master/diskimage-create/README.rst">diskimage-builder script</a></li>
</ul>
<p>Remember the image name or save the image ID. This will be used during the
image registration with sahara. You can get the image ID using the
<code class="docutils literal"><span class="pre">openstack</span></code> command line tool as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image list --property <span class="nv">name</span><span class="o">=</span>sahara-vanilla-latest-ubuntu
<span class="go">+--------------------------------------+------------------------------+</span>
<span class="go">| ID                                   | Name                         |</span>
<span class="go">+--------------------------------------+------------------------------+</span>
<span class="go">| 71b9eeac-c904-4170-866a-1f833ea614f3 | sahara-vanilla-latest-ubuntu |</span>
<span class="go">+--------------------------------------+------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="register-the-image-with-the-sahara-image-registry">
<h3>4. Register the image with the sahara image registry<a class="headerlink" href="#register-the-image-with-the-sahara-image-registry" title="Permalink to this headline">¶</a></h3>
<p>Now you will begin to interact with sahara by registering the virtual
machine image in the sahara image registry.</p>
<p>Register the image with the username <code class="docutils literal"><span class="pre">ubuntu</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The username will vary depending on the source image used, as follows:
Ubuntu: <code class="docutils literal"><span class="pre">ubuntu</span></code>
CentOS 7: <code class="docutils literal"><span class="pre">centos</span></code>
CentOS 6: <code class="docutils literal"><span class="pre">cloud-user</span></code>
Fedora: <code class="docutils literal"><span class="pre">fedora</span></code>
Note that the Sahara team recommends using CentOS 7 instead of CentOS 6 as
a base OS wherever possible; it is better supported throughout OpenStack
image maintenance infrastructure and its more modern filesystem is much
more appropriate for large-scale data processing. For more please see
<a class="reference internal" href="../userdoc/vanilla_plugin.html"><em>Vanilla Plugin</em></a></p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing image register sahara-vanilla-latest-ubuntu <span class="se">\</span>
    --username ubuntu
</pre></div>
</div>
<p>Tag the image to inform sahara about the plugin and the version with which
it shall be used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the steps below and the rest of this guide, substitute
<code class="docutils literal"><span class="pre">&lt;plugin_version&gt;</span></code> with the appropriate version of your plugin.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing image tags add sahara-vanilla-latest-ubuntu <span class="se">\</span>
    --tags vanilla &lt;plugin_version&gt;
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| Field       | Value                                |</span>
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| Description | None                                 |</span>
<span class="go">| Id          | 71b9eeac-c904-4170-866a-1f833ea614f3 |</span>
<span class="go">| Name        | sahara-vanilla-latest-ubuntu         |</span>
<span class="go">| Status      | ACTIVE                               |</span>
<span class="go">| Tags        | &lt;plugin_version&gt;, vanilla            |</span>
<span class="go">| Username    | ubuntu                               |</span>
<span class="go">+-------------+--------------------------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="create-node-group-templates">
<h3>5. Create node group templates<a class="headerlink" href="#create-node-group-templates" title="Permalink to this headline">¶</a></h3>
<p>Node groups are the building blocks of clusters in sahara. Before you can
begin provisioning clusters you must define a few node group templates to
describe node group configurations.</p>
<p>You can get information about available plugins with the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing plugin list
</pre></div>
</div>
<p>Also you can get information about available services for a particular plugin
with the <code class="docutils literal"><span class="pre">plugin</span> <span class="pre">show</span></code> command. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing plugin show vanilla --plugin-version &lt;plugin_version&gt;
<span class="go">+---------------------+-----------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field               | Value                                                                                                                 |</span>
<span class="go">+---------------------+-----------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| Description         | The Apache Vanilla plugin provides the ability to launch upstream Vanilla Apache Hadoop cluster without any           |</span>
<span class="go">|                     | management consoles. It can also deploy the Oozie component.                                                          |</span>
<span class="go">| Name                | vanilla                                                                                                               |</span>
<span class="go">| Required image tags | &lt;plugin_version&gt;, vanilla                                                                                             |</span>
<span class="go">| Title               | Vanilla Apache Hadoop                                                                                                 |</span>
<span class="go">|                     |                                                                                                                       |</span>
<span class="go">| Service:            | Available processes:                                                                                                  |</span>
<span class="go">|                     |                                                                                                                       |</span>
<span class="go">| HDFS                | datanode, namenode, secondarynamenode                                                                                 |</span>
<span class="go">| Hadoop              |                                                                                                                       |</span>
<span class="go">| Hive                | hiveserver                                                                                                            |</span>
<span class="go">| JobFlow             | oozie                                                                                                                 |</span>
<span class="go">| Spark               | spark history server                                                                                                  |</span>
<span class="go">| MapReduce           | historyserver                                                                                                         |</span>
<span class="go">| YARN                | nodemanager, resourcemanager                                                                                          |</span>
<span class="go">+---------------------+-----------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These commands assume that floating IP addresses are being used. For more
details on floating IP please see <a class="reference internal" href="../userdoc/configuration.guide.html#floating-ip-management"><span>Floating IP management</span></a>.</p>
</div>
<p>Create a master node group template with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing node group template create <span class="se">\</span>
    --name vanilla-default-master --plugin vanilla <span class="se">\</span>
    --plugin-version &lt;plugin_version&gt; --processes namenode resourcemanager <span class="se">\</span>
    --flavor <span class="m">2</span> --auto-security-group --floating-ip-pool &lt;pool-id&gt;
<span class="go">+---------------------+--------------------------------------+</span>
<span class="go">| Field               | Value                                |</span>
<span class="go">+---------------------+--------------------------------------+</span>
<span class="go">| Auto security group | True                                 |</span>
<span class="go">| Availability zone   | None                                 |</span>
<span class="go">| Flavor id           | 2                                    |</span>
<span class="go">| Floating ip pool    | dbd8d1aa-6e8e-4a35-a77b-966c901464d5 |</span>
<span class="go">| Id                  | 0f066e14-9a73-4379-bbb4-9d9347633e31 |</span>
<span class="go">| Is default          | False                                |</span>
<span class="go">| Is protected        | False                                |</span>
<span class="go">| Is proxy gateway    | False                                |</span>
<span class="go">| Is public           | False                                |</span>
<span class="go">| Name                | vanilla-default-master               |</span>
<span class="go">| Node processes      | namenode, resourcemanager            |</span>
<span class="go">| Plugin name         | vanilla                              |</span>
<span class="go">| Security groups     | None                                 |</span>
<span class="go">| Use autoconfig      | False                                |</span>
<span class="go">| Version             | &lt;plugin_version&gt;                     |</span>
<span class="go">| Volumes per node    | 0                                    |</span>
<span class="go">+---------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Create a worker node group template with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing node group template create <span class="se">\</span>
    --name vanilla-default-worker --plugin vanilla <span class="se">\</span>
    --plugin-version &lt;plugin_version&gt; --processes datanode nodemanager <span class="se">\</span>
    --flavor <span class="m">2</span> --auto-security-group --floating-ip-pool &lt;pool-id&gt;
<span class="go">+---------------------+--------------------------------------+</span>
<span class="go">| Field               | Value                                |</span>
<span class="go">+---------------------+--------------------------------------+</span>
<span class="go">| Auto security group | True                                 |</span>
<span class="go">| Availability zone   | None                                 |</span>
<span class="go">| Flavor id           | 2                                    |</span>
<span class="go">| Floating ip pool    | dbd8d1aa-6e8e-4a35-a77b-966c901464d5 |</span>
<span class="go">| Id                  | 6546bf44-0590-4539-bfcb-99f8e2c11efc |</span>
<span class="go">| Is default          | False                                |</span>
<span class="go">| Is protected        | False                                |</span>
<span class="go">| Is proxy gateway    | False                                |</span>
<span class="go">| Is public           | False                                |</span>
<span class="go">| Name                | vanilla-default-worker               |</span>
<span class="go">| Node processes      | datanode, nodemanager                |</span>
<span class="go">| Plugin name         | vanilla                              |</span>
<span class="go">| Security groups     | None                                 |</span>
<span class="go">| Use autoconfig      | False                                |</span>
<span class="go">| Version             | &lt;plugin_version&gt;                     |</span>
<span class="go">| Volumes per node    | 0                                    |</span>
<span class="go">+---------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Alternatively you can create node group templates from JSON files:</p>
<p>If your environment does not use floating IPs, omit defining floating IP in
the template below.</p>
<p>Sample templates can be found here:</p>
<p><a class="reference external" href="https://github.com/openstack/sahara/tree/master/sahara/plugins/default_templates/">Sample Templates</a></p>
<p>Create a file named <code class="docutils literal"><span class="pre">my_master_template_create.json</span></code> with the following
content:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;plugin_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hadoop_version&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;plugin_version&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;node_processes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;namenode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;resourcemanager&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla-default-master&quot;</span><span class="p">,</span>
    <span class="nt">&quot;floating_ip_pool&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;floating_ip_pool_id&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;flavor_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="nt">&quot;auto_security_group&quot;</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Create a file named <code class="docutils literal"><span class="pre">my_worker_template_create.json</span></code> with the following
content:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;plugin_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hadoop_version&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;plugin_version&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;node_processes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nodemanager&quot;</span><span class="p">,</span>
        <span class="s2">&quot;datanode&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla-default-worker&quot;</span><span class="p">,</span>
    <span class="nt">&quot;floating_ip_pool&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;floating_ip_pool_id&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;flavor_id&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="nt">&quot;auto_security_group&quot;</span><span class="p">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal"><span class="pre">openstack</span></code> client to upload the node group templates:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing node group template create <span class="se">\</span>
    --json my_master_template_create.json
<span class="gp">$</span> openstack dataprocessing node group template create <span class="se">\</span>
    --json my_worker_template_create.json
</pre></div>
</div>
<p>List the available node group templates to ensure that they have been
added properly:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing node group template list --name vanilla-default
<span class="go">+------------------------+--------------------------------------+-------------+--------------------+</span>
<span class="go">| Name                   | Id                                   | Plugin name | Version            |</span>
<span class="go">+------------------------+--------------------------------------+-------------+--------------------+</span>
<span class="go">| vanilla-default-master | 0f066e14-9a73-4379-bbb4-9d9347633e31 | vanilla     | &lt;plugin_version&gt;   |</span>
<span class="go">| vanilla-default-worker | 6546bf44-0590-4539-bfcb-99f8e2c11efc | vanilla     | &lt;plugin_version&gt;   |</span>
<span class="go">+------------------------+--------------------------------------+-------------+--------------------+</span>
</pre></div>
</div>
<p>Remember the name or save the ID for the master and worker node group
templates, as they will be used during cluster template creation.</p>
<p>For example:</p>
<ul class="simple">
<li>vanilla-default-master: <code class="docutils literal"><span class="pre">0f066e14-9a73-4379-bbb4-9d9347633e31</span></code></li>
<li>vanilla-default-worker: <code class="docutils literal"><span class="pre">6546bf44-0590-4539-bfcb-99f8e2c11efc</span></code></li>
</ul>
</div>
<div class="section" id="create-a-cluster-template">
<h3>6. Create a cluster template<a class="headerlink" href="#create-a-cluster-template" title="Permalink to this headline">¶</a></h3>
<p>The last step before provisioning the cluster is to create a template
that describes the node groups of the cluster.</p>
<p>Create a cluster template with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster template create <span class="se">\</span>
    --name vanilla-default-cluster <span class="se">\</span>
    --node-groups vanilla-default-master:1 vanilla-default-worker:3

<span class="go">+----------------+----------------------------------------------------+</span>
<span class="go">| Field          | Value                                              |</span>
<span class="go">+----------------+----------------------------------------------------+</span>
<span class="go">| Anti affinity  |                                                    |</span>
<span class="go">| Description    | None                                               |</span>
<span class="go">| Id             | 9d871ebd-88a9-40af-ae3e-d8c8f292401c               |</span>
<span class="go">| Is default     | False                                              |</span>
<span class="go">| Is protected   | False                                              |</span>
<span class="go">| Is public      | False                                              |</span>
<span class="go">| Name           | vanilla-default-cluster                            |</span>
<span class="go">| Node groups    | vanilla-default-master:1, vanilla-default-worker:3 |</span>
<span class="go">| Plugin name    | vanilla                                            |</span>
<span class="go">| Use autoconfig | False                                              |</span>
<span class="go">| Version        | &lt;plugin_version&gt;                                   |</span>
<span class="go">+----------------+----------------------------------------------------+</span>
</pre></div>
</div>
<p>Alternatively you can create cluster template from JSON file:</p>
<p>Create a file named <code class="docutils literal"><span class="pre">my_cluster_template_create.json</span></code> with the following
content:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;plugin_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hadoop_version&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;plugin_version&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;node_groups&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
            <span class="nt">&quot;count&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="nt">&quot;node_group_template_id&quot;</span><span class="p">:</span> <span class="s2">&quot;6546bf44-0590-4539-bfcb-99f8e2c11efc&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;master&quot;</span><span class="p">,</span>
            <span class="nt">&quot;count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;node_group_template_id&quot;</span><span class="p">:</span> <span class="s2">&quot;0f066e14-9a73-4379-bbb4-9d9347633e31&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla-default-cluster&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cluster_configs&quot;</span><span class="p">:</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Upload the cluster template using the <code class="docutils literal"><span class="pre">openstack</span></code> command line tool:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster template create --json my_cluster_template_create.json
</pre></div>
</div>
<p>Remember the cluster template name or save the cluster template ID for use in
the cluster provisioning command. The cluster ID can be found in the output of
the creation command or by listing the cluster templates as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster template list --name vanilla-default
<span class="go">+-------------------------+--------------------------------------+-------------+--------------------+</span>
<span class="go">| Name                    | Id                                   | Plugin name | Version            |</span>
<span class="go">+-------------------------+--------------------------------------+-------------+--------------------+</span>
<span class="go">| vanilla-default-cluster | 9d871ebd-88a9-40af-ae3e-d8c8f292401c | vanilla     | &lt;plugin_version&gt;   |</span>
<span class="go">+-------------------------+--------------------------------------+-------------+--------------------+</span>
</pre></div>
</div>
</div>
<div class="section" id="create-cluster">
<h3>7. Create cluster<a class="headerlink" href="#create-cluster" title="Permalink to this headline">¶</a></h3>
<p>Now you are ready to provision the cluster. This step requires a few pieces of
information that can be found by querying various OpenStack services.</p>
<p>Create a cluster with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster create --name my-cluster-1 <span class="se">\</span>
    --cluster-template vanilla-default-cluster --user-keypair my_stack <span class="se">\</span>
    --neutron-network private --image sahara-vanilla-latest-ubuntu

<span class="go">+----------------------------+----------------------------------------------------+</span>
<span class="go">| Field                      | Value                                              |</span>
<span class="go">+----------------------------+----------------------------------------------------+</span>
<span class="go">| Anti affinity              |                                                    |</span>
<span class="go">| Cluster template id        | 9d871ebd-88a9-40af-ae3e-d8c8f292401c               |</span>
<span class="go">| Description                |                                                    |</span>
<span class="go">| Id                         | 1f0dc6f7-6600-495f-8f3a-8ac08cdb3afc               |</span>
<span class="go">| Image                      | 71b9eeac-c904-4170-866a-1f833ea614f3               |</span>
<span class="go">| Is protected               | False                                              |</span>
<span class="go">| Is public                  | False                                              |</span>
<span class="go">| Is transient               | False                                              |</span>
<span class="go">| Name                       | my-cluster-1                                       |</span>
<span class="go">| Neutron management network | fabe9dae-6fbd-47ca-9eb1-1543de325efc               |</span>
<span class="go">| Node groups                | vanilla-default-master:1, vanilla-default-worker:3 |</span>
<span class="go">| Plugin name                | vanilla                                            |</span>
<span class="go">| Status                     | Validating                                         |</span>
<span class="go">| Use autoconfig             | False                                              |</span>
<span class="go">| User keypair id            | my_stack                                           |</span>
<span class="go">| Version                    | &lt;plugin_version&gt;                                   |</span>
<span class="go">+----------------------------+----------------------------------------------------+</span>
</pre></div>
</div>
<p>Alternatively you can create a cluster template from a JSON file:</p>
<p>Create a file named <code class="docutils literal"><span class="pre">my_cluster_create.json</span></code> with the following content:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-cluster-1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;plugin_name&quot;</span><span class="p">:</span> <span class="s2">&quot;vanilla&quot;</span><span class="p">,</span>
    <span class="nt">&quot;hadoop_version&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;plugin_version&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;cluster_template_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;9d871ebd-88a9-40af-ae3e-d8c8f292401c&quot;</span><span class="p">,</span>
    <span class="nt">&quot;user_keypair_id&quot;</span><span class="p">:</span> <span class="s2">&quot;my_stack&quot;</span><span class="p">,</span>
    <span class="nt">&quot;default_image_id&quot;</span><span class="p">:</span> <span class="s2">&quot;71b9eeac-c904-4170-866a-1f833ea614f3&quot;</span><span class="p">,</span>
    <span class="nt">&quot;neutron_management_network&quot;</span><span class="p">:</span> <span class="s2">&quot;fabe9dae-6fbd-47ca-9eb1-1543de325efc&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal"><span class="pre">user_keypair_id</span></code> with the value <code class="docutils literal"><span class="pre">my_stack</span></code> is generated by
creating a keypair. You can create your own keypair in the OpenStack
Dashboard, or through the <code class="docutils literal"><span class="pre">openstack</span></code> command line client as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack keypair create my_stack --public-key <span class="nv">$PATH_TO_PUBLIC_KEY</span>
</pre></div>
</div>
<p>If sahara is configured to use neutron for networking, you will also need to
include the <code class="docutils literal"><span class="pre">--neutron-network</span></code> argument in the <code class="docutils literal"><span class="pre">cluster</span> <span class="pre">create</span></code> command
or the <code class="docutils literal"><span class="pre">neutron_management_network</span></code> parameter in <code class="docutils literal"><span class="pre">my_cluster_create.json</span></code>.
If your environment does not use neutron, you should omit these arguments. You
can determine the neutron network id with the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network list
</pre></div>
</div>
<p>Create and start the cluster:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster create --json my_cluster_create.json
</pre></div>
</div>
<p>Verify the cluster status by using the <code class="docutils literal"><span class="pre">openstack</span></code> command
line tool as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack dataprocessing cluster show my-cluster-1 -c Status
<span class="go">+--------+--------+</span>
<span class="go">| Field  | Value  |</span>
<span class="go">+--------+--------+</span>
<span class="go">| Status | Active |</span>
<span class="go">+--------+--------+</span>
</pre></div>
</div>
<p>The cluster creation operation may take several minutes to complete. During
this time the &#8220;status&#8221; returned from the previous command may show states
other than <code class="docutils literal"><span class="pre">Active</span></code>. A cluster also can be created with the <code class="docutils literal"><span class="pre">wait</span></code> flag.
In that case the cluster creation command will not be finished until the
cluster is moved to the <code class="docutils literal"><span class="pre">Active</span></code> state.</p>
</div>
<div class="section" id="run-a-mapreduce-job-to-check-hadoop-installation">
<h3>8. Run a MapReduce job to check Hadoop installation<a class="headerlink" href="#run-a-mapreduce-job-to-check-hadoop-installation" title="Permalink to this headline">¶</a></h3>
<p>Check that your Hadoop installation is working properly by running an
example job on the cluster manually.</p>
<ul class="simple">
<li>Login to the NameNode (usually the master node) via ssh with the ssh-key
used above:</li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ssh -i my_stack.pem ubuntu@&lt;namenode_ip&gt;
</pre></div>
</div>
<ul class="simple">
<li>Switch to the hadoop user:</li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo su hadoop
</pre></div>
</div>
<ul class="simple">
<li>Go to the shared hadoop directory and run the simplest MapReduce example:</li>
</ul>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> /opt/hadoop-&lt;plugin_version&gt;/share/hadoop/mapreduce
<span class="gp">$</span> /opt/hadoop-&lt;plugin_version&gt;/bin/hadoop jar hadoop-mapreduce-examples-&lt;plugin_version&gt;.jar pi <span class="m">10</span> <span class="m">100</span>
</pre></div>
</div>
<p>Congratulations! Your Hadoop cluster is ready to use, running on your
OpenStack cloud.</p>
</div>
</div>
<div class="section" id="elastic-data-processing-edp">
<h2>Elastic Data Processing (EDP)<a class="headerlink" href="#elastic-data-processing-edp" title="Permalink to this headline">¶</a></h2>
<p>Job Binaries are the entities you define/upload the source code
(mains and libraries) for your job.
First you need to download your binary file or script to swift container
and register your file in Sahara with the command:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>(openstack) dataprocessing job binary create --url &quot;swift://integration.sahara/hive.sql&quot; \
  --username username --password password --description &quot;My first job binary&quot; hive-binary
</pre></div>
</div>
<div class="section" id="data-sources">
<h3>Data Sources<a class="headerlink" href="#data-sources" title="Permalink to this headline">¶</a></h3>
<p>Data Sources are entities where the input and output from your jobs are housed.
You can create data sources which are related to Swift, Manila or HDFS.
You need to set the type of data source (swift, hdfs, manila, maprfs),
name and url.
The next two commands will create input and output data sources in swift.</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>$ openstack dataprocessing data source create --type swift --username admin --password admin \
   --url &quot;swift://integration.sahara/input.txt&quot; input

$ openstack dataprocessing data source create --type swift --username admin --password admin \
   --url &quot;swift://integration.sahara/output.txt&quot; input
</pre></div>
</div>
<p>If you want to create data sources in hdfs, use valid hdfs urls:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>$ openstack dataprocessing data source create --type hdfs --url &quot;hdfs://tmp/input.txt&quot; input

$ openstack dataprocessing data source create --type hdfs --url &quot;hdfs://tmp/output.txt&quot; output
</pre></div>
</div>
</div>
<div class="section" id="job-templates-jobs-in-api">
<h3>Job Templates (Jobs in API)<a class="headerlink" href="#job-templates-jobs-in-api" title="Permalink to this headline">¶</a></h3>
<p>In this step you need to create a job template. You have to set
the type of the job template using the <cite>type</cite> parameter. Choose
the main library using the job binary which was created
in the previous step and set a name for the job template.</p>
<p>Example of the command:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>$ openstack dataprocessing job template create --type Hive \
   --name hive-job-template --main hive-binary
</pre></div>
</div>
</div>
<div class="section" id="jobs-job-executions-in-api">
<h3>Jobs (Job Executions in API)<a class="headerlink" href="#jobs-job-executions-in-api" title="Permalink to this headline">¶</a></h3>
<p>This is the last step in our guide. In this step you need to launch your job.
You need to pass the following arguments:</p>
<blockquote>
<div><ul class="simple">
<li>The name or ID of input/output data sources for the job</li>
<li>The name or ID of the job template</li>
<li>The name or ID of the cluster on which to run the job</li>
</ul>
</div></blockquote>
<p>For instance:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>$ openstack dataprocessing job execute --input input --output output \
  --job-template hive-job-template --cluster my-first-cluster
</pre></div>
</div>
<p>You can check status of your job with the command:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span></span>$ openstack dataprocessing job show &lt;id_of_your_job&gt;
</pre></div>
</div>
<p>Once the job is marked as successful you can check the output data source.
It will contain the output data of this job. Congratulations!</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Quickstart guide</a><ul>
<li><a class="reference internal" href="#launching-a-cluster-via-sahara-cli-commands">Launching a cluster via Sahara CLI commands</a><ul>
<li><a class="reference internal" href="#install-sahara">1. Install sahara</a></li>
<li><a class="reference internal" href="#identity-service-configuration">2. Identity service configuration</a></li>
<li><a class="reference internal" href="#upload-an-image-to-the-image-service">3. Upload an image to the Image service</a></li>
<li><a class="reference internal" href="#register-the-image-with-the-sahara-image-registry">4. Register the image with the sahara image registry</a></li>
<li><a class="reference internal" href="#create-node-group-templates">5. Create node group templates</a></li>
<li><a class="reference internal" href="#create-a-cluster-template">6. Create a cluster template</a></li>
<li><a class="reference internal" href="#create-cluster">7. Create cluster</a></li>
<li><a class="reference internal" href="#run-a-mapreduce-job-to-check-hadoop-installation">8. Run a MapReduce job to check Hadoop installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#elastic-data-processing-edp">Elastic Data Processing (EDP)</a><ul>
<li><a class="reference internal" href="#data-sources">Data Sources</a></li>
<li><a class="reference internal" href="#job-templates-jobs-in-api">Job Templates (Jobs in API)</a></li>
<li><a class="reference internal" href="#jobs-job-executions-in-api">Jobs (Job Executions in API)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="devstack.html"
                                  title="previous chapter">Setup DevStack</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="how_to_participate.html"
                                  title="next chapter">How to Participate</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/sahara
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/devref/quickstart.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="how_to_participate.html" title="How to Participate"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="devstack.html" title="Setup DevStack"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Sahara</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, OpenStack Foundation.
      Last updated on &#39;Mon Feb 13 17:36:11 2017, commit 23ee18f&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/sahara");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>