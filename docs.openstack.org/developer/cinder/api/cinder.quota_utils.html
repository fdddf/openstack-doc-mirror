<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The cinder.quota_utils Module &mdash; cinder 10.0.0.0rc2.dev77 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '10.0.0.0rc2.dev77',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="cinder 10.0.0.0rc2.dev77 documentation" href="../index.html" />
    <link rel="up" title="&lt;no title&gt;" href="autoindex.html" />
    <link rel="next" title="The cinder.rpc Module" href="cinder.rpc.html" />
    <link rel="prev" title="The cinder.quota Module" href="cinder.quota.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-cinder.quota_utils">
<span id="the-cinder-quota-utils-module"></span><h1>The <a class="reference internal" href="#module-cinder.quota_utils" title="cinder.quota_utils"><code class="xref py py-mod docutils literal"><span class="pre">cinder.quota_utils</span></code></a> Module<a class="headerlink" href="#module-cinder.quota_utils" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="cinder.quota_utils.GenericProjectInfo">
<em class="property">class </em><code class="descname">GenericProjectInfo</code><span class="sig-paren">(</span><em>project_id</em>, <em>project_keystone_api_version</em>, <em>project_parent_id=None</em>, <em>project_subtree=None</em>, <em>project_parent_tree=None</em>, <em>is_admin_project=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.GenericProjectInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Abstraction layer for Keystone V2 and V3 project objects</p>
</dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.get_all_projects">
<code class="descname">get_all_projects</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.get_all_projects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.get_all_root_project_ids">
<code class="descname">get_all_root_project_ids</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.get_all_root_project_ids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.get_parent_project_id">
<code class="descname">get_parent_project_id</code><span class="sig-paren">(</span><em>context</em>, <em>project_id</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.get_parent_project_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.get_project_hierarchy">
<code class="descname">get_project_hierarchy</code><span class="sig-paren">(</span><em>context</em>, <em>project_id</em>, <em>subtree_as_ids=False</em>, <em>parents_as_ids=False</em>, <em>is_admin_project=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.get_project_hierarchy" title="Permalink to this definition">¶</a></dt>
<dd><p>A Helper method to get the project hierarchy.</p>
<p>Along with hierarchical multitenancy in keystone API v3, projects can be
hierarchically organized. Therefore, we need to know the project
hierarchy, if any, in order to do nested quota operations properly.
If the domain is being used as the top most parent, it is filtered out from
the parent tree and parent_id.</p>
</dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.get_volume_type_reservation">
<code class="descname">get_volume_type_reservation</code><span class="sig-paren">(</span><em>ctxt</em>, <em>volume</em>, <em>type_id</em>, <em>reserve_vol_type_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.get_volume_type_reservation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.process_reserve_over_quota">
<code class="descname">process_reserve_over_quota</code><span class="sig-paren">(</span><em>context</em>, <em>over_quota_exception</em>, <em>resource</em>, <em>size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.process_reserve_over_quota" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle OverQuota exception.</p>
<p>Analyze OverQuota exception, and raise new exception related to
resource type. If there are unexpected items in overs,
UnexpectedOverQuota is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; security context</li>
<li><strong>over_quota_exception</strong> &#8211; OverQuota exception</li>
<li><strong>resource</strong> &#8211; can be backups, snapshots, and volumes</li>
<li><strong>size</strong> &#8211; requested size in reservation</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.update_alloc_to_next_hard_limit">
<code class="descname">update_alloc_to_next_hard_limit</code><span class="sig-paren">(</span><em>context</em>, <em>resources</em>, <em>deltas</em>, <em>res</em>, <em>expire</em>, <em>project_id</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.update_alloc_to_next_hard_limit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="cinder.quota_utils.validate_setup_for_nested_quota_use">
<code class="descname">validate_setup_for_nested_quota_use</code><span class="sig-paren">(</span><em>ctxt</em>, <em>resources</em>, <em>nested_quota_driver</em>, <em>fix_allocated_quotas=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.quota_utils.validate_setup_for_nested_quota_use" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates the setup supports using nested quotas.</p>
<p>Ensures that Keystone v3 or greater is being used, that the current
user is of the cloud admin role, and that the existing quotas make sense to
nest in the current hierarchy (e.g. that no child quota would be larger
than it&#8217;s parent).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>resources</strong> &#8211; the quota resources to validate</li>
<li><strong>nested_quota_driver</strong> &#8211; nested quota driver used to validate each tree</li>
<li><strong>fix_allocated_quotas</strong> &#8211; if True, parent projects &#8220;allocated&#8221; total
will be calculated based on the existing child limits and the DB will
be updated. If False, an exception is raised reporting any parent
allocated quotas are currently incorrect.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="cinder.quota.html"
                                  title="previous chapter">The <code class="docutils literal"><span class="pre">cinder.quota</span></code> Module</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="cinder.rpc.html"
                                  title="next chapter">The <code class="docutils literal"><span class="pre">cinder.rpc</span></code> Module</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/cinder
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/api/cinder.quota_utils.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cinder.rpc.html" title="The cinder.rpc Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cinder.quota.html" title="The cinder.quota Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">cinder 10.0.0.0rc2.dev77 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../devref/index.html" >Developer Guide</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="autoindex.html" accesskey="U">&lt;no title&gt;</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-present, OpenStack Foundation.
      Last updated on Tue Feb 14 19:31:55 2017, commit e7efdb6.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/cinder");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>