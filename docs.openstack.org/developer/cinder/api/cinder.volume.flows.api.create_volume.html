<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The cinder.volume.flows.api.create_volume Module &mdash; cinder 10.0.0.0rc2.dev77 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '10.0.0.0rc2.dev77',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="cinder 10.0.0.0rc2.dev77 documentation" href="../index.html" />
    <link rel="up" title="&lt;no title&gt;" href="autoindex.html" />
    <link rel="next" title="The cinder.volume.flows.api.manage_existing Module" href="cinder.volume.flows.api.manage_existing.html" />
    <link rel="prev" title="The cinder.volume.drivers.zte.zte_pub Module" href="cinder.volume.drivers.zte.zte_pub.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-cinder.volume.flows.api.create_volume">
<span id="the-cinder-volume-flows-api-create-volume-module"></span><h1>The <a class="reference internal" href="#module-cinder.volume.flows.api.create_volume" title="cinder.volume.flows.api.create_volume"><code class="xref py py-mod docutils literal"><span class="pre">cinder.volume.flows.api.create_volume</span></code></a> Module<a class="headerlink" href="#module-cinder.volume.flows.api.create_volume" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="cinder.volume.flows.api.create_volume.EntryCreateTask">
<em class="property">class </em><code class="descname">EntryCreateTask</code><a class="headerlink" href="#cinder.volume.flows.api.create_volume.EntryCreateTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cinder.flow_utils.html#cinder.flow_utils.CinderTask" title="cinder.flow_utils.CinderTask"><code class="xref py py-class docutils literal"><span class="pre">cinder.flow_utils.CinderTask</span></code></a></p>
<p>Creates an entry for the given volume creation in the database.</p>
<p>Reversion strategy: remove the volume_id created from the database.</p>
<dl class="attribute">
<dt id="cinder.volume.flows.api.create_volume.EntryCreateTask.default_provides">
<code class="descname">default_provides</code><em class="property"> = set(['volume', 'volume_properties', 'volume_id'])</em><a class="headerlink" href="#cinder.volume.flows.api.create_volume.EntryCreateTask.default_provides" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.EntryCreateTask.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>context</em>, <em>optional_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.EntryCreateTask.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a database entry for the given inputs and returns details.</p>
<p>Accesses the database and creates a new entry for the to be created
volume using the given volume properties which are extracted from the
input kwargs (and associated requirements this task needs). These
requirements should be previously satisfied and validated by a
pre-cursor task.</p>
</dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.EntryCreateTask.revert">
<code class="descname">revert</code><span class="sig-paren">(</span><em>context</em>, <em>result</em>, <em>optional_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.EntryCreateTask.revert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask">
<em class="property">class </em><code class="descname">ExtractVolumeRequestTask</code><span class="sig-paren">(</span><em>image_service</em>, <em>availability_zones</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cinder.flow_utils.html#cinder.flow_utils.CinderTask" title="cinder.flow_utils.CinderTask"><code class="xref py py-class docutils literal"><span class="pre">cinder.flow_utils.CinderTask</span></code></a></p>
<p>Processes an api request values into a validated set of values.</p>
<p>This tasks responsibility is to take in a set of inputs that will form
a potential volume request and validates those values against a set of
conditions and/or translates those values into a valid set and then returns
the validated/translated values for use by other tasks.</p>
<p>Reversion strategy: N/A</p>
<dl class="attribute">
<dt id="cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask.default_provides">
<code class="descname">default_provides</code><em class="property"> = set(['volume_type_id', 'availability_zone', 'source_replicaid', 'volume_type', 'cgsnapshot_id', 'qos_specs', 'encryption_key_id', 'source_volid', 'snapshot_id', 'consistencygroup_id', 'group_id', 'size'])</em><a class="headerlink" href="#cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask.default_provides" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>context</em>, <em>size</em>, <em>snapshot</em>, <em>image_id</em>, <em>source_volume</em>, <em>availability_zone</em>, <em>volume_type</em>, <em>metadata</em>, <em>key_manager</em>, <em>source_replica</em>, <em>consistencygroup</em>, <em>cgsnapshot</em>, <em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.ExtractVolumeRequestTask.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cinder.volume.flows.api.create_volume.QuotaCommitTask">
<em class="property">class </em><code class="descname">QuotaCommitTask</code><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaCommitTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cinder.flow_utils.html#cinder.flow_utils.CinderTask" title="cinder.flow_utils.CinderTask"><code class="xref py py-class docutils literal"><span class="pre">cinder.flow_utils.CinderTask</span></code></a></p>
<p>Commits the reservation.</p>
<p>Reversion strategy: N/A (the rollback will be handled by the task that did
the initial reservation (see: QuotaReserveTask).</p>
<p>Warning Warning: if the process that is running this reserve and commit
process fails (or is killed before the quota is rolled back or committed
it does appear like the quota will never be rolled back). This makes
software upgrades hard (inflight operations will need to be stopped or
allowed to complete before the upgrade can occur). <em>In the future</em> when
taskflow has persistence built-in this should be easier to correct via
an automated or manual process.</p>
<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.QuotaCommitTask.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>context</em>, <em>reservations</em>, <em>volume_properties</em>, <em>optional_args</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaCommitTask.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.QuotaCommitTask.revert">
<code class="descname">revert</code><span class="sig-paren">(</span><em>context</em>, <em>result</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaCommitTask.revert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cinder.volume.flows.api.create_volume.QuotaReserveTask">
<em class="property">class </em><code class="descname">QuotaReserveTask</code><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaReserveTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cinder.flow_utils.html#cinder.flow_utils.CinderTask" title="cinder.flow_utils.CinderTask"><code class="xref py py-class docutils literal"><span class="pre">cinder.flow_utils.CinderTask</span></code></a></p>
<p>Reserves a single volume with the given size &amp; the given volume type.</p>
<p>Reversion strategy: rollback the quota reservation.</p>
<p>Warning Warning: if the process that is running this reserve and commit
process fails (or is killed before the quota is rolled back or committed
it does appear like the quota will never be rolled back). This makes
software upgrades hard (inflight operations will need to be stopped or
allowed to complete before the upgrade can occur). <em>In the future</em> when
taskflow has persistence built-in this should be easier to correct via
an automated or manual process.</p>
<dl class="attribute">
<dt id="cinder.volume.flows.api.create_volume.QuotaReserveTask.default_provides">
<code class="descname">default_provides</code><em class="property"> = set(['reservations'])</em><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaReserveTask.default_provides" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.QuotaReserveTask.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>context</em>, <em>size</em>, <em>volume_type_id</em>, <em>optional_args</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaReserveTask.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.QuotaReserveTask.revert">
<code class="descname">revert</code><span class="sig-paren">(</span><em>context</em>, <em>result</em>, <em>optional_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.QuotaReserveTask.revert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="cinder.volume.flows.api.create_volume.VolumeCastTask">
<em class="property">class </em><code class="descname">VolumeCastTask</code><span class="sig-paren">(</span><em>scheduler_rpcapi</em>, <em>volume_rpcapi</em>, <em>db</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.VolumeCastTask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cinder.flow_utils.html#cinder.flow_utils.CinderTask" title="cinder.flow_utils.CinderTask"><code class="xref py py-class docutils literal"><span class="pre">cinder.flow_utils.CinderTask</span></code></a></p>
<p>Performs a volume create cast to the scheduler or to the volume manager.</p>
<p>This will signal a transition of the api workflow to another child and/or
related workflow on another component.</p>
<p>Reversion strategy: rollback source volume status and error out newly
created volume.</p>
<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.VolumeCastTask.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>context</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.VolumeCastTask.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cinder.volume.flows.api.create_volume.VolumeCastTask.revert">
<code class="descname">revert</code><span class="sig-paren">(</span><em>context</em>, <em>result</em>, <em>flow_failures</em>, <em>volume</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.VolumeCastTask.revert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="cinder.volume.flows.api.create_volume.get_flow">
<code class="descname">get_flow</code><span class="sig-paren">(</span><em>db_api</em>, <em>image_service_api</em>, <em>availability_zones</em>, <em>create_what</em>, <em>scheduler_rpcapi=None</em>, <em>volume_rpcapi=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cinder.volume.flows.api.create_volume.get_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs and returns the api entrypoint flow.</p>
<p>This flow will do the following:</p>
<ol class="arabic simple">
<li>Inject keys &amp; values for dependent tasks.</li>
<li>Extracts and validates the input keys &amp; values.</li>
<li>Reserves the quota (reverts quota on any failures).</li>
<li>Creates the database entry.</li>
<li>Commits the quota.</li>
<li>Casts to volume manager or scheduler for further processing.</li>
</ol>
</dd></dl>

</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="cinder.volume.drivers.zte.zte_pub.html"
                                  title="previous chapter">The <code class="docutils literal"><span class="pre">cinder.volume.drivers.zte.zte_pub</span></code> Module</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="cinder.volume.flows.api.manage_existing.html"
                                  title="next chapter">The <code class="docutils literal"><span class="pre">cinder.volume.flows.api.manage_existing</span></code> Module</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/cinder
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/api/cinder.volume.flows.api.create_volume.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cinder.volume.flows.api.manage_existing.html" title="The cinder.volume.flows.api.manage_existing Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cinder.volume.drivers.zte.zte_pub.html" title="The cinder.volume.drivers.zte.zte_pub Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">cinder 10.0.0.0rc2.dev77 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../devref/index.html" >Developer Guide</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="autoindex.html" accesskey="U">&lt;no title&gt;</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-present, OpenStack Foundation.
      Last updated on Tue Feb 14 19:31:55 2017, commit e7efdb6.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/cinder");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>