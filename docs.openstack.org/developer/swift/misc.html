<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Misc &mdash; swift 2.12.1.dev102 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.12.1.dev102',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="swift 2.12.1.dev102 documentation" href="index.html" />
    <link rel="next" title="Middleware" href="middleware.html" />
    <link rel="prev" title="Object" href="object.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="misc">
<span id="id1"></span><h1>Misc<a class="headerlink" href="#misc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="acls">
<span id="id2"></span><h2>ACLs<a class="headerlink" href="#acls" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.middleware.acl"></span><dl class="function">
<dt id="swift.common.middleware.acl.acls_from_account_info">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">acls_from_account_info</code><span class="sig-paren">(</span><em>info</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.acls_from_account_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the account ACLs from the given account_info, and return the ACLs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>info</strong> &#8211; a dict of the form returned by get_account_info</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None (no ACL system metadata is set), or a dict of the form::
{&#8216;admin&#8217;: [...], &#8216;read-write&#8217;: [...], &#8216;read-only&#8217;: [...]}</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> &#8211; on a syntactically invalid header</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.clean_acl">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">clean_acl</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.clean_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a cleaned ACL header value, validating that it meets the formatting
requirements for standard Swift ACL strings.</p>
<p>The ACL format is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[item[,item...]]
</pre></div>
</div>
<p>Each item can be a group name to give access to or a referrer designation
to grant or deny based on the HTTP Referer header.</p>
<p>The referrer designation format is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>.r:[-]value
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">.r</span></code> can also be <code class="docutils literal"><span class="pre">.ref</span></code>, <code class="docutils literal"><span class="pre">.referer</span></code>, or <code class="docutils literal"><span class="pre">.referrer</span></code>; though it
will be shortened to just <code class="docutils literal"><span class="pre">.r</span></code> for decreased character count usage.</p>
<p>The value can be <code class="docutils literal"><span class="pre">*</span></code> to specify any referrer host is allowed access, a
specific host name like <code class="docutils literal"><span class="pre">www.example.com</span></code>, or if it has a leading period
<code class="docutils literal"><span class="pre">.</span></code> or leading <code class="docutils literal"><span class="pre">*.</span></code> it is a domain name specification, like
<code class="docutils literal"><span class="pre">.example.com</span></code> or <code class="docutils literal"><span class="pre">*.example.com</span></code>. The leading minus sign <code class="docutils literal"><span class="pre">-</span></code>
indicates referrer hosts that should be denied access.</p>
<p>Referrer access is applied in the order they are specified. For example,
.r:.example.com,.r:-thief.example.com would allow all hosts ending with
.example.com except for the specific host thief.example.com.</p>
<p>Example valid ACLs:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>.r:*
.r:*,.r:-.thief.com
.r:*,.r:.example.com,.r:-thief.example.com
.r:*,.r:-.thief.com,bobs_account,sues_account:sue
bobs_account,sues_account:sue
</pre></div>
</div>
<p>Example invalid ACLs:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>.r:
.r:-
</pre></div>
</div>
<p>By default, allowing read access via .r will not allow listing objects in
the container &#8211; just retrieving objects from the container. To turn on
listings, use the .rlistings directive.</p>
<p>Also, .r designations aren&#8217;t allowed in headers whose names include the
word &#8216;write&#8217;.</p>
<p>ACLs that are &#8220;messy&#8221; will be cleaned up. Examples:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Original</td>
<td>Cleaned</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bob,</span> <span class="pre">sue</span></code></td>
<td><code class="docutils literal"><span class="pre">bob,sue</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">bob</span> <span class="pre">,</span> <span class="pre">sue</span></code></td>
<td><code class="docutils literal"><span class="pre">bob,sue</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">bob,,,sue</span></code></td>
<td><code class="docutils literal"><span class="pre">bob,sue</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">.referrer</span> <span class="pre">:</span> <span class="pre">*</span></code></td>
<td><code class="docutils literal"><span class="pre">.r:*</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">.ref:*.example.com</span></code></td>
<td><code class="docutils literal"><span class="pre">.r:.example.com</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">.r:*,</span> <span class="pre">.rlistings</span></code></td>
<td><code class="docutils literal"><span class="pre">.r:*,.rlistings</span></code></td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; The name of the header being cleaned, such as X-Container-Read
or X-Container-Write.</li>
<li><strong>value</strong> &#8211; The value of the header being cleaned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The value, cleaned of extraneous formatting.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> &#8211; If the value does not meet the ACL formatting
requirements; the error message will indicate why.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.format_acl">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">format_acl</code><span class="sig-paren">(</span><em>version=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.format_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compatibility wrapper to help migrate ACL syntax from version 1 to 2.
Delegates to the appropriate version-specific format_acl method, defaulting
to version 1 for backward compatibility.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> &#8211; keyword args appropriate for the selected ACL syntax version
(see <a class="reference internal" href="#swift.common.middleware.acl.format_acl_v1" title="swift.common.middleware.acl.format_acl_v1"><code class="xref py py-func docutils literal"><span class="pre">format_acl_v1()</span></code></a> or <a class="reference internal" href="#swift.common.middleware.acl.format_acl_v2" title="swift.common.middleware.acl.format_acl_v2"><code class="xref py py-func docutils literal"><span class="pre">format_acl_v2()</span></code></a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.format_acl_v1">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">format_acl_v1</code><span class="sig-paren">(</span><em>groups=None</em>, <em>referrers=None</em>, <em>header_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.format_acl_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a standard Swift ACL string for the given inputs.</p>
<p>Caller is responsible for ensuring that :referrers: parameter is only given
if the ACL is being generated for X-Container-Read.  (X-Container-Write
and the account ACL headers don&#8217;t support referrers.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>groups</strong> &#8211; a list of groups (and/or members in most auth systems) to
grant access</li>
<li><strong>referrers</strong> &#8211; a list of referrer designations (without the leading .r:)</li>
<li><strong>header_name</strong> &#8211; (optional) header name of the ACL we&#8217;re preparing, for
clean_acl; if None, returned ACL won&#8217;t be cleaned</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a Swift ACL string for use in X-Container-{Read,Write},
X-Account-Access-Control, etc.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.format_acl_v2">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">format_acl_v2</code><span class="sig-paren">(</span><em>acl_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.format_acl_v2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a version-2 Swift ACL JSON string.</p>
<dl class="docutils">
<dt>HTTP headers for Version 2 ACLs have the following form:</dt>
<dd>Header-Name: {&#8220;arbitrary&#8221;:&#8221;json&#8221;,&#8221;encoded&#8221;:&#8221;string&#8221;}</dd>
</dl>
<p>JSON will be forced ASCII (containing six-char uNNNN sequences rather
than UTF-8; UTF-8 is valid JSON but clients vary in their support for
UTF-8 headers), and without extraneous whitespace.</p>
<p>Advantages over V1: forward compatibility (new keys don&#8217;t cause parsing
exceptions); Unicode support; no reserved words (you can have a user
named .rlistings if you want).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>acl_dict</strong> &#8211; dict of arbitrary data to put in the ACL; see specific
auth systems such as tempauth for supported values</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a JSON string which encodes the ACL</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.parse_acl">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">parse_acl</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.parse_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compatibility wrapper to help migrate ACL syntax from version 1 to 2.
Delegates to the appropriate version-specific parse_acl method, attempting
to determine the version from the types of args/kwargs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; positional args for the selected ACL syntax version</li>
<li><strong>kwargs</strong> &#8211; keyword args for the selected ACL syntax version
(see <a class="reference internal" href="#swift.common.middleware.acl.parse_acl_v1" title="swift.common.middleware.acl.parse_acl_v1"><code class="xref py py-func docutils literal"><span class="pre">parse_acl_v1()</span></code></a> or <a class="reference internal" href="#swift.common.middleware.acl.parse_acl_v2" title="swift.common.middleware.acl.parse_acl_v2"><code class="xref py py-func docutils literal"><span class="pre">parse_acl_v2()</span></code></a>)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the return value of <a class="reference internal" href="#swift.common.middleware.acl.parse_acl_v1" title="swift.common.middleware.acl.parse_acl_v1"><code class="xref py py-func docutils literal"><span class="pre">parse_acl_v1()</span></code></a> or <a class="reference internal" href="#swift.common.middleware.acl.parse_acl_v2" title="swift.common.middleware.acl.parse_acl_v2"><code class="xref py py-func docutils literal"><span class="pre">parse_acl_v2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.parse_acl_v1">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">parse_acl_v1</code><span class="sig-paren">(</span><em>acl_string</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.parse_acl_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a standard Swift ACL string into a referrers list and groups list.</p>
<p>See <a class="reference internal" href="#swift.common.middleware.acl.clean_acl" title="swift.common.middleware.acl.clean_acl"><code class="xref py py-func docutils literal"><span class="pre">clean_acl()</span></code></a> for documentation of the standard Swift ACL format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>acl_string</strong> &#8211; The standard Swift ACL string to parse.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A tuple of (referrers, groups) where referrers is a list of
referrer designations (without the leading .r:) and groups is a
list of groups to allow access.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.parse_acl_v2">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">parse_acl_v2</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.parse_acl_v2" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a version-2 Swift ACL string and returns a dict of ACL info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> &#8211; string containing the ACL data in JSON format</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict (possibly empty) containing ACL info, e.g.:
{&#8220;groups&#8221;: [...], &#8220;referrers&#8221;: [...]}</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None if data is None, is not valid JSON or does not parse
as a dict</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">empty dictionary if data is an empty string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.middleware.acl.referrer_allowed">
<code class="descclassname">swift.common.middleware.acl.</code><code class="descname">referrer_allowed</code><span class="sig-paren">(</span><em>referrer</em>, <em>referrer_acl</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.middleware.acl.referrer_allowed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the referrer should be allowed based on the referrer_acl
list (as returned by <a class="reference internal" href="#swift.common.middleware.acl.parse_acl" title="swift.common.middleware.acl.parse_acl"><code class="xref py py-func docutils literal"><span class="pre">parse_acl()</span></code></a>).</p>
<p>See <a class="reference internal" href="#swift.common.middleware.acl.clean_acl" title="swift.common.middleware.acl.clean_acl"><code class="xref py py-func docutils literal"><span class="pre">clean_acl()</span></code></a> for documentation of the standard Swift ACL format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>referrer</strong> &#8211; The value of the HTTP Referer header.</li>
<li><strong>referrer_acl</strong> &#8211; The list of referrer designations as returned by
<a class="reference internal" href="#swift.common.middleware.acl.parse_acl" title="swift.common.middleware.acl.parse_acl"><code class="xref py py-func docutils literal"><span class="pre">parse_acl()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if the referrer should be allowed; False if not.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-swift.common.bufferedhttp">
<span id="id3"></span><span id="buffered-http"></span><h2>Buffered HTTP<a class="headerlink" href="#module-swift.common.bufferedhttp" title="Permalink to this headline">¶</a></h2>
<p>Monkey Patch httplib.HTTPResponse to buffer reads of headers. This can improve
performance when making large numbers of small HTTP requests.  This module
also provides helper functions to make HTTP connections using
BufferedHTTPResponse.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you use this, be sure that the libraries you are using do not access
the socket directly (xmlrpclib, I&#8217;m looking at you :/), and instead
make all calls through httplib.</p>
</div>
<dl class="class">
<dt id="swift.common.bufferedhttp.BufferedHTTPConnection">
<em class="property">class </em><code class="descclassname">swift.common.bufferedhttp.</code><code class="descname">BufferedHTTPConnection</code><span class="sig-paren">(</span><em>host</em>, <em>port=None</em>, <em>strict=None</em>, <em>timeout=&lt;object object&gt;</em>, <em>source_address=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.bufferedhttp.BufferedHTTPConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">httplib.HTTPConnection</span></code></p>
<p>HTTPConnection class that uses BufferedHTTPResponse</p>
<dl class="attribute">
<dt id="swift.common.bufferedhttp.BufferedHTTPConnection.response_class">
<code class="descname">response_class</code><a class="headerlink" href="#swift.common.bufferedhttp.BufferedHTTPConnection.response_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#swift.common.bufferedhttp.BufferedHTTPResponse" title="swift.common.bufferedhttp.BufferedHTTPResponse"><code class="xref py py-class docutils literal"><span class="pre">BufferedHTTPResponse</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.bufferedhttp.BufferedHTTPResponse">
<em class="property">class </em><code class="descclassname">swift.common.bufferedhttp.</code><code class="descname">BufferedHTTPResponse</code><span class="sig-paren">(</span><em>sock</em>, <em>debuglevel=0</em>, <em>strict=0</em>, <em>method=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.bufferedhttp.BufferedHTTPResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">httplib.HTTPResponse</span></code></p>
<p>HTTPResponse class that buffers reading of headers</p>
<dl class="method">
<dt id="swift.common.bufferedhttp.BufferedHTTPResponse.nuke_from_orbit">
<code class="descname">nuke_from_orbit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.bufferedhttp.BufferedHTTPResponse.nuke_from_orbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Terminate the socket with extreme prejudice.</p>
<p>Closes the underlying socket regardless of whether or not anyone else
has references to it. Use this when you are certain that nobody else
you care about has a reference to this socket.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.common.bufferedhttp.http_connect">
<code class="descclassname">swift.common.bufferedhttp.</code><code class="descname">http_connect</code><span class="sig-paren">(</span><em>ipaddr</em>, <em>port</em>, <em>device</em>, <em>partition</em>, <em>method</em>, <em>path</em>, <em>headers=None</em>, <em>query_string=None</em>, <em>ssl=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.bufferedhttp.http_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to create an HTTPConnection object. If ssl is set True,
HTTPSConnection will be used. However, if ssl=False, BufferedHTTPConnection
will be used, which is buffered for backend Swift services.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ipaddr</strong> &#8211; IPv4 address to connect to</li>
<li><strong>port</strong> &#8211; port to connect to</li>
<li><strong>device</strong> &#8211; device of the node to query</li>
<li><strong>partition</strong> &#8211; partition on the device</li>
<li><strong>method</strong> &#8211; HTTP method to request (&#8216;GET&#8217;, &#8216;PUT&#8217;, &#8216;POST&#8217;, etc.)</li>
<li><strong>path</strong> &#8211; request path</li>
<li><strong>headers</strong> &#8211; dictionary of headers</li>
<li><strong>query_string</strong> &#8211; request query string</li>
<li><strong>ssl</strong> &#8211; set True if SSL should be used (default: False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">HTTPConnection object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.bufferedhttp.http_connect_raw">
<code class="descclassname">swift.common.bufferedhttp.</code><code class="descname">http_connect_raw</code><span class="sig-paren">(</span><em>ipaddr</em>, <em>port</em>, <em>method</em>, <em>path</em>, <em>headers=None</em>, <em>query_string=None</em>, <em>ssl=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.bufferedhttp.http_connect_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to create an HTTPConnection object. If ssl is set True,
HTTPSConnection will be used. However, if ssl=False, BufferedHTTPConnection
will be used, which is buffered for backend Swift services.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ipaddr</strong> &#8211; IPv4 address to connect to</li>
<li><strong>port</strong> &#8211; port to connect to</li>
<li><strong>method</strong> &#8211; HTTP method to request (&#8216;GET&#8217;, &#8216;PUT&#8217;, &#8216;POST&#8217;, etc.)</li>
<li><strong>path</strong> &#8211; request path</li>
<li><strong>headers</strong> &#8211; dictionary of headers</li>
<li><strong>query_string</strong> &#8211; request query string</li>
<li><strong>ssl</strong> &#8211; set True if SSL should be used (default: False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">HTTPConnection object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="constraints">
<span id="id4"></span><h2>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.constraints"></span><dl class="data">
<dt id="swift.common.constraints.FORMAT2CONTENT_TYPE">
<code class="descclassname">swift.common.constraints.</code><code class="descname">FORMAT2CONTENT_TYPE</code><em class="property"> = {'json': 'application/json', 'xml': 'application/xml', 'plain': 'text/plain'}</em><a class="headerlink" href="#swift.common.constraints.FORMAT2CONTENT_TYPE" title="Permalink to this definition">¶</a></dt>
<dd><p>Query string format= values to their corresponding content-type values</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_delete_headers">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_delete_headers</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_delete_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate if &#8216;x-delete&#8217; headers are have correct values
values should be positive integers and correspond to
a time in the future.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; the swob request object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HTTPBadRequest in case of invalid values
or None if values are ok</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_dir">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_dir</code><span class="sig-paren">(</span><em>root</em>, <em>drive</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that the path to the device is a directory and is a lesser
constraint that is enforced when a full mount_check isn&#8217;t possible
with, for instance, a VM using loopback or partitions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>root</strong> &#8211; base path where the dir is</li>
<li><strong>drive</strong> &#8211; drive name to be checked</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if it is a valid directoy, False otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_float">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_float</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for checking if a string can be converted to a float.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> &#8211; string to be verified as a float</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the string can be converted to a float, False otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_metadata">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_metadata</code><span class="sig-paren">(</span><em>req</em>, <em>target_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Check metadata sent in the request headers.  This should only check
that the metadata in the request given is valid.  Checks against
account/container overall metadata should be forwarded on to its
respective server to be checked.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; request object</li>
<li><strong>target_type</strong> &#8211; str: one of: object, container, or account: indicates
which type the target storage for the metadata is</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">HTTPBadRequest with bad metadata otherwise None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_mount">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_mount</code><span class="sig-paren">(</span><em>root</em>, <em>drive</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_mount" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify that the path to the device is a mount point and mounted.  This
allows us to fast fail on drives that have been unmounted because of
issues, and also prevents us for accidentally filling up the root
partition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>root</strong> &#8211; base path where the devices are mounted</li>
<li><strong>drive</strong> &#8211; drive name to be checked</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if it is a valid mounted device, False otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_name_format">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_name_format</code><span class="sig-paren">(</span><em>req</em>, <em>name</em>, <em>target_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_name_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate that the header contains valid account or container name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; HTTP request object</li>
<li><strong>name</strong> &#8211; header value to validate</li>
<li><strong>target_type</strong> &#8211; which header is being validated (Account or Container)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A properly encoded account name or container name</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raise:</th><td class="field-body"><p class="first last">HTTPPreconditionFailed if account header
is not well formatted.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_object_creation">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_object_creation</code><span class="sig-paren">(</span><em>req</em>, <em>object_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_object_creation" title="Permalink to this definition">¶</a></dt>
<dd><p>Check to ensure that everything is alright about an object to be created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; HTTP request object</li>
<li><strong>object_name</strong> &#8211; name of object to be created</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HTTPRequestEntityTooLarge &#8211; the object is too large</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HTTPLengthRequired &#8211; missing content-length header and not
a chunked request</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HTTPBadRequest &#8211; missing or bad content-type header, or
bad metadata</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">HTTPNotImplemented &#8211; unsupported transfer-encoding header value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.check_utf8">
<code class="descclassname">swift.common.constraints.</code><code class="descname">check_utf8</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.check_utf8" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate if a string is valid UTF-8 str or unicode and that it
does not contain any null character.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>string</strong> &#8211; string to be validated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the string is valid utf-8 str or unicode and
contains no null characters, False otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.reload_constraints">
<code class="descclassname">swift.common.constraints.</code><code class="descname">reload_constraints</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.reload_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse SWIFT_CONF_FILE and reset module level global constraint attrs,
populating OVERRIDE_CONSTRAINTS AND EFFECTIVE_CONSTRAINTS along the way.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.valid_api_version">
<code class="descclassname">swift.common.constraints.</code><code class="descname">valid_api_version</code><span class="sig-paren">(</span><em>version</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.valid_api_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the requested version is valid.</p>
<p>Currently Swift only supports &#8220;v1&#8221; and &#8220;v1.0&#8221;.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.constraints.valid_timestamp">
<code class="descclassname">swift.common.constraints.</code><code class="descname">valid_timestamp</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.constraints.valid_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to extract a timestamp from requests that require one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; the swob request object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a valid Timestamp instance</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">HTTPBadRequest on missing or invalid X-Timestamp</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-swift.common.container_sync_realms">
<span id="container-sync-realms"></span><h2>Container Sync Realms<a class="headerlink" href="#module-swift.common.container_sync_realms" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms">
<em class="property">class </em><code class="descclassname">swift.common.container_sync_realms.</code><code class="descname">ContainerSyncRealms</code><span class="sig-paren">(</span><em>conf_path</em>, <em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Loads and parses the container-sync-realms.conf, occasionally
checking the file&#8217;s mtime to see if it needs to be reloaded.</p>
<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.clusters">
<code class="descname">clusters</code><span class="sig-paren">(</span><em>realm</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of clusters for the realm.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.endpoint">
<code class="descname">endpoint</code><span class="sig-paren">(</span><em>realm</em>, <em>cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.endpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the endpoint for the cluster in the realm.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.get_sig">
<code class="descname">get_sig</code><span class="sig-paren">(</span><em>request_method</em>, <em>path</em>, <em>x_timestamp</em>, <em>nonce</em>, <em>realm_key</em>, <em>user_key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.get_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hexdigest string of the HMAC-SHA1 (RFC 2104) for
the information given.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>request_method</strong> &#8211; HTTP method of the request.</li>
<li><strong>path</strong> &#8211; The path to the resource.</li>
<li><strong>x_timestamp</strong> &#8211; The X-Timestamp header value for the request.</li>
<li><strong>nonce</strong> &#8211; A unique value for the request.</li>
<li><strong>realm_key</strong> &#8211; Shared secret at the cluster operator level.</li>
<li><strong>user_key</strong> &#8211; Shared secret at the user&#8217;s container level.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">hexdigest str of the HMAC-SHA1 for the request.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.key">
<code class="descname">key</code><span class="sig-paren">(</span><em>realm</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.key" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the key for the realm.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.key2">
<code class="descname">key2</code><span class="sig-paren">(</span><em>realm</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.key2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the key2 for the realm.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.realms">
<code class="descname">realms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.realms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of realms.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.container_sync_realms.ContainerSyncRealms.reload">
<code class="descname">reload</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.container_sync_realms.ContainerSyncRealms.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces a reload of the conf file.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swift.common.direct_client">
<span id="id5"></span><span id="direct-client"></span><h2>Direct Client<a class="headerlink" href="#module-swift.common.direct_client" title="Permalink to this headline">¶</a></h2>
<p>Internal client library for making calls directly to the servers rather than
through the proxy.</p>
<dl class="exception">
<dt id="swift.common.direct_client.DirectClientException">
<em class="property">exception </em><code class="descclassname">swift.common.direct_client.</code><code class="descname">DirectClientException</code><span class="sig-paren">(</span><em>stype</em>, <em>method</em>, <em>node</em>, <em>part</em>, <em>path</em>, <em>resp</em>, <em>host=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.DirectClientException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.ClientException" title="swift.common.exceptions.ClientException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.ClientException</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_delete_account">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_delete_account</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_delete_account" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_delete_container">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_delete_container</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_delete_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete container directly from the container server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>headers</strong> &#8211; dict to be passed into HTTPConnection headers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP DELETE request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_delete_container_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_delete_container_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_delete_container_object" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_delete_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_delete_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_delete_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete object directly from the object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>obj</strong> &#8211; object name</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP DELETE request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_get_account">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_get_account</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>marker=None</em>, <em>limit=None</em>, <em>prefix=None</em>, <em>delimiter=None</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>end_marker=None</em>, <em>reverse=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_get_account" title="Permalink to this definition">¶</a></dt>
<dd><p>Get listings directly from the account server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the account is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>marker</strong> &#8211; marker query</li>
<li><strong>limit</strong> &#8211; query limit</li>
<li><strong>prefix</strong> &#8211; prefix query</li>
<li><strong>delimiter</strong> &#8211; delimiter for the query</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>end_marker</strong> &#8211; end_marker query</li>
<li><strong>reverse</strong> &#8211; reverse the returned listing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a tuple of (response headers, a list of containers) The response
headers will HeaderKeyDict.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_get_container">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_get_container</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>marker=None</em>, <em>limit=None</em>, <em>prefix=None</em>, <em>delimiter=None</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>end_marker=None</em>, <em>reverse=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_get_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Get container listings directly from the container server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>marker</strong> &#8211; marker query</li>
<li><strong>limit</strong> &#8211; query limit</li>
<li><strong>prefix</strong> &#8211; prefix query</li>
<li><strong>delimiter</strong> &#8211; delimiter for the query</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>end_marker</strong> &#8211; end_marker query</li>
<li><strong>reverse</strong> &#8211; reverse the returned listing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a tuple of (response headers, a list of objects) The response
headers will be a HeaderKeyDict.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_get_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_get_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>resp_chunk_size=None</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_get_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Get object directly from the object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>obj</strong> &#8211; object name</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>resp_chunk_size</strong> &#8211; if defined, chunk size of data to read.</li>
<li><strong>headers</strong> &#8211; dict to be passed into HTTPConnection headers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a tuple of (response headers, the object&#8217;s contents) The response
headers will be a HeaderKeyDict.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP GET request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_get_suffix_hashes">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_get_suffix_hashes</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>suffixes</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_get_suffix_hashes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get suffix hashes directly from the object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>headers</strong> &#8211; dict to be passed into HTTPConnection headers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict of suffix hashes</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP REPLICATE request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_head_container">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_head_container</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_head_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Request container information directly from the container server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a dict containing the response&#8217;s headers in a HeaderKeyDict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP HEAD request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_head_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_head_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_head_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Request object information directly from the object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>obj</strong> &#8211; object name</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>headers</strong> &#8211; dict to be passed into HTTPConnection headers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a dict containing the response&#8217;s headers in a HeaderKeyDict</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP HEAD request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_post_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_post_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>name</em>, <em>headers</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_post_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Direct update to object metadata on object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>name</strong> &#8211; object name</li>
<li><strong>headers</strong> &#8211; headers to store as metadata</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP POST request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_put_container_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_put_container_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_put_container_object" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.direct_put_object">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">direct_put_object</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>account</em>, <em>container</em>, <em>name</em>, <em>contents</em>, <em>content_length=None</em>, <em>etag=None</em>, <em>content_type=None</em>, <em>headers=None</em>, <em>conn_timeout=5</em>, <em>response_timeout=15</em>, <em>chunk_size=65535</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.direct_put_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Put object directly from the object server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>node</strong> &#8211; node dictionary from the ring</li>
<li><strong>part</strong> &#8211; partition the container is on</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>name</strong> &#8211; object name</li>
<li><strong>contents</strong> &#8211; an iterable or string to read object data from</li>
<li><strong>content_length</strong> &#8211; value to send as content-length header</li>
<li><strong>etag</strong> &#8211; etag of contents</li>
<li><strong>content_type</strong> &#8211; value to send as content-type header</li>
<li><strong>headers</strong> &#8211; additional headers to include in the request</li>
<li><strong>conn_timeout</strong> &#8211; timeout in seconds for establishing the connection</li>
<li><strong>response_timeout</strong> &#8211; timeout in seconds for getting the response</li>
<li><strong>chunk_size</strong> &#8211; if defined, chunk size of data to send.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">etag from the server response</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; HTTP PUT request failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.gen_headers">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">gen_headers</code><span class="sig-paren">(</span><em>hdrs_in=None</em>, <em>add_ts=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.gen_headers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.direct_client.retry">
<code class="descclassname">swift.common.direct_client.</code><code class="descname">retry</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.direct_client.retry" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to retry a given function a number of times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>func</strong> &#8211; callable to be called</li>
<li><strong>retries</strong> &#8211; number of retries</li>
<li><strong>error_log</strong> &#8211; logger for errors</li>
<li><strong>args</strong> &#8211; arguments to send to func</li>
<li><strong>kwargs</strong> &#8211; keyward arguments to send to func (if retries or
error_log are sent, they will be deleted from kwargs
before sending on to func)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result of func</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ClientException</strong> &#8211; all retries failed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="exceptions">
<span id="id6"></span><h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.exceptions"></span><dl class="exception">
<dt id="swift.common.exceptions.APIVersionError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">APIVersionError</code><a class="headerlink" href="#swift.common.exceptions.APIVersionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ChunkReadError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ChunkReadError</code><a class="headerlink" href="#swift.common.exceptions.ChunkReadError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ChunkReadTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ChunkReadTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>exception=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ChunkReadTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.timeout.Timeout</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ChunkWriteTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ChunkWriteTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>exception=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ChunkWriteTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.timeout.Timeout</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ClientException">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ClientException</code><span class="sig-paren">(</span><em>msg</em>, <em>http_scheme=''</em>, <em>http_host=''</em>, <em>http_port=''</em>, <em>http_path=''</em>, <em>http_query=''</em>, <em>http_status=None</em>, <em>http_reason=''</em>, <em>http_device=''</em>, <em>http_response_content=''</em>, <em>http_headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ClientException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ConnectionTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ConnectionTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>exception=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ConnectionTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.timeout.Timeout</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DeviceUnavailable">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DeviceUnavailable</code><a class="headerlink" href="#swift.common.exceptions.DeviceUnavailable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileCollision">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileCollision</code><a class="headerlink" href="#swift.common.exceptions.DiskFileCollision" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileDeleted">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileDeleted</code><span class="sig-paren">(</span><em>metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.DiskFileDeleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileNotExist" title="swift.common.exceptions.DiskFileNotExist"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileNotExist</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileDeviceUnavailable">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileDeviceUnavailable</code><a class="headerlink" href="#swift.common.exceptions.DiskFileDeviceUnavailable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileError</code><a class="headerlink" href="#swift.common.exceptions.DiskFileError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileExpired">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileExpired</code><span class="sig-paren">(</span><em>metadata=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.DiskFileExpired" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileDeleted" title="swift.common.exceptions.DiskFileDeleted"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileDeleted</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileNoSpace">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileNoSpace</code><a class="headerlink" href="#swift.common.exceptions.DiskFileNoSpace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileNotExist">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileNotExist</code><a class="headerlink" href="#swift.common.exceptions.DiskFileNotExist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileNotOpen">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileNotOpen</code><a class="headerlink" href="#swift.common.exceptions.DiskFileNotOpen" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileQuarantined">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileQuarantined</code><a class="headerlink" href="#swift.common.exceptions.DiskFileQuarantined" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DiskFileXattrNotSupported">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DiskFileXattrNotSupported</code><a class="headerlink" href="#swift.common.exceptions.DiskFileXattrNotSupported" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.DiskFileError" title="swift.common.exceptions.DiskFileError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.DiskFileError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DriveNotMounted">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DriveNotMounted</code><a class="headerlink" href="#swift.common.exceptions.DriveNotMounted" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.DuplicateDeviceError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">DuplicateDeviceError</code><a class="headerlink" href="#swift.common.exceptions.DuplicateDeviceError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.RingBuilderError" title="swift.common.exceptions.RingBuilderError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.RingBuilderError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.EmptyRingError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">EmptyRingError</code><a class="headerlink" href="#swift.common.exceptions.EmptyRingError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.RingBuilderError" title="swift.common.exceptions.RingBuilderError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.RingBuilderError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.EncryptionException">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">EncryptionException</code><a class="headerlink" href="#swift.common.exceptions.EncryptionException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.FileNotFoundError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">FileNotFoundError</code><a class="headerlink" href="#swift.common.exceptions.FileNotFoundError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.FooterNotSupported">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">FooterNotSupported</code><a class="headerlink" href="#swift.common.exceptions.FooterNotSupported" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.InsufficientStorage">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">InsufficientStorage</code><a class="headerlink" href="#swift.common.exceptions.InsufficientStorage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.InvalidAccountInfo">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">InvalidAccountInfo</code><a class="headerlink" href="#swift.common.exceptions.InvalidAccountInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.InvalidPidFileException">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">InvalidPidFileException</code><a class="headerlink" href="#swift.common.exceptions.InvalidPidFileException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.InvalidTimestamp">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">InvalidTimestamp</code><a class="headerlink" href="#swift.common.exceptions.InvalidTimestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ListingIterError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ListingIterError</code><a class="headerlink" href="#swift.common.exceptions.ListingIterError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ListingIterNotAuthorized">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ListingIterNotAuthorized</code><span class="sig-paren">(</span><em>aresp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ListingIterNotAuthorized" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.ListingIterError" title="swift.common.exceptions.ListingIterError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.ListingIterError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ListingIterNotFound">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ListingIterNotFound</code><a class="headerlink" href="#swift.common.exceptions.ListingIterNotFound" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.ListingIterError" title="swift.common.exceptions.ListingIterError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.ListingIterError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.LockTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">LockTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>msg=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.LockTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.MessageTimeout" title="swift.common.exceptions.MessageTimeout"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.MessageTimeout</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.MessageTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">MessageTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>msg=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.MessageTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.timeout.Timeout</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.MimeInvalid">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">MimeInvalid</code><a class="headerlink" href="#swift.common.exceptions.MimeInvalid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.MultiphasePUTNotSupported">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">MultiphasePUTNotSupported</code><a class="headerlink" href="#swift.common.exceptions.MultiphasePUTNotSupported" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.PathNotDir">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">PathNotDir</code><a class="headerlink" href="#swift.common.exceptions.PathNotDir" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.OSError</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.PermissionError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">PermissionError</code><a class="headerlink" href="#swift.common.exceptions.PermissionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.PutterConnectError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">PutterConnectError</code><span class="sig-paren">(</span><em>status=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.PutterConnectError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.RangeAlreadyComplete">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">RangeAlreadyComplete</code><a class="headerlink" href="#swift.common.exceptions.RangeAlreadyComplete" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ReplicationException">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ReplicationException</code><a class="headerlink" href="#swift.common.exceptions.ReplicationException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ReplicationLockTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ReplicationLockTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>msg=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ReplicationLockTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.LockTimeout" title="swift.common.exceptions.LockTimeout"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.LockTimeout</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.ResponseTimeout">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">ResponseTimeout</code><span class="sig-paren">(</span><em>seconds=None</em>, <em>exception=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.exceptions.ResponseTimeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.timeout.Timeout</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.RingBuilderError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">RingBuilderError</code><a class="headerlink" href="#swift.common.exceptions.RingBuilderError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.RingLoadError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">RingLoadError</code><a class="headerlink" href="#swift.common.exceptions.RingLoadError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.RingValidationError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">RingValidationError</code><a class="headerlink" href="#swift.common.exceptions.RingValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.RingBuilderError" title="swift.common.exceptions.RingBuilderError"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.RingBuilderError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.SegmentError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">SegmentError</code><a class="headerlink" href="#swift.common.exceptions.SegmentError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.SuffixSyncError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">SuffixSyncError</code><a class="headerlink" href="#swift.common.exceptions.SuffixSyncError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.SwiftException">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">SwiftException</code><a class="headerlink" href="#swift.common.exceptions.SwiftException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
</dd></dl>

<dl class="exception">
<dt id="swift.common.exceptions.UnPicklingError">
<em class="property">exception </em><code class="descclassname">swift.common.exceptions.</code><code class="descname">UnPicklingError</code><a class="headerlink" href="#swift.common.exceptions.UnPicklingError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.exceptions.SwiftException" title="swift.common.exceptions.SwiftException"><code class="xref py py-class docutils literal"><span class="pre">swift.common.exceptions.SwiftException</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-swift.common.internal_client">
<span id="id7"></span><span id="internal-client"></span><h2>Internal Client<a class="headerlink" href="#module-swift.common.internal_client" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.common.internal_client.CompressingFileReader">
<em class="property">class </em><code class="descclassname">swift.common.internal_client.</code><code class="descname">CompressingFileReader</code><span class="sig-paren">(</span><em>file_obj</em>, <em>compresslevel=9</em>, <em>chunk_size=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.CompressingFileReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrapper for file object to compress object while reading.</p>
<p>Can be used to wrap file objects passed to InternalClient.upload_object().</p>
<p>Used in testing of InternalClient.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file_obj</strong> &#8211; File object to wrap.</li>
<li><strong>compresslevel</strong> &#8211; Compression level, defaults to 9.</li>
<li><strong>chunk_size</strong> &#8211; Size of chunks read when iterating using object,
defaults to 4096.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.internal_client.CompressingFileReader.next">
<code class="descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.CompressingFileReader.next" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.CompressingFileReader.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.CompressingFileReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a chunk from the file object.</p>
<p>Params are passed directly to the underlying file object&#8217;s read().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Compressed chunk from file object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.CompressingFileReader.seek">
<code class="descname">seek</code><span class="sig-paren">(</span><em>offset</em>, <em>whence=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.CompressingFileReader.seek" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.CompressingFileReader.set_initial_state">
<code class="descname">set_initial_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.CompressingFileReader.set_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the object to the state needed for the first read.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.internal_client.InternalClient">
<em class="property">class </em><code class="descclassname">swift.common.internal_client.</code><code class="descname">InternalClient</code><span class="sig-paren">(</span><em>conf_path</em>, <em>user_agent</em>, <em>request_tries</em>, <em>allow_modify_pipeline=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An internal client that uses a swift proxy app to make requests to Swift.</p>
<p>This client will exponentially slow down for retries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conf_path</strong> &#8211; Full path to proxy config.</li>
<li><strong>user_agent</strong> &#8211; User agent to be sent to requests to Swift.</li>
<li><strong>request_tries</strong> &#8211; Number of tries before InternalClient.make_request()
gives up.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="swift.common.internal_client.InternalClient.account_ring">
<code class="descname">account_ring</code><a class="headerlink" href="#swift.common.internal_client.InternalClient.account_ring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.common.internal_client.InternalClient.auto_create_account_prefix">
<code class="descname">auto_create_account_prefix</code><a class="headerlink" href="#swift.common.internal_client.InternalClient.auto_create_account_prefix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.container_exists">
<code class="descname">container_exists</code><span class="sig-paren">(</span><em>account</em>, <em>container</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.container_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks to see if a container exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to check.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if container exists, false otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.internal_client.InternalClient.container_ring">
<code class="descname">container_ring</code><a class="headerlink" href="#swift.common.internal_client.InternalClient.container_ring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.create_container">
<code class="descname">create_container</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>headers=None</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.create_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to create.</li>
<li><strong>headers</strong> &#8211; Defaults to empty dict.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.delete_container">
<code class="descname">delete_container</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>acceptable_statuses=(2</em>, <em>404)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.delete_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to delete.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2, HTTP_NOT_FOUND).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.delete_object">
<code class="descname">delete_object</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>obj</em>, <em>acceptable_statuses=(2</em>, <em>404)</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.delete_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes an object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The object&#8217;s account.</li>
<li><strong>container</strong> &#8211; The object&#8217;s container.</li>
<li><strong>obj</strong> &#8211; The object.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2, HTTP_NOT_FOUND).</li>
<li><strong>headers</strong> &#8211; extra headers to send with request</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.get_account_info">
<code class="descname">get_account_info</code><span class="sig-paren">(</span><em>account</em>, <em>acceptable_statuses=(2</em>, <em>404)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_account_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (container_count, object_count) for an account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; Account on which to get the information.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2, HTTP_NOT_FOUND).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.get_account_metadata">
<code class="descname">get_account_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_account_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets account metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; Account on which to get the metadata.</li>
<li><strong>metadata_prefix</strong> &#8211; Used to filter values from the headers
returned.  Will strip that prefix from the
keys in the dict returned.  Defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns dict of account metadata.  Keys will be lowercase.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.get_container_metadata">
<code class="descname">get_container_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_container_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets container metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to get metadata on.</li>
<li><strong>metadata_prefix</strong> &#8211; Used to filter values from the headers
returned.  Will strip that prefix from the
keys in the dict returned.  Defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns dict of container metadata.  Keys will be lowercase.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.get_object">
<code class="descname">get_object</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>obj</em>, <em>headers</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 3-tuple (status, headers, iterator of object body)</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.get_object_metadata">
<code class="descname">get_object_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>obj</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_object_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets object metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The object&#8217;s account.</li>
<li><strong>container</strong> &#8211; The object&#8217;s container.</li>
<li><strong>obj</strong> &#8211; The object.</li>
<li><strong>metadata_prefix</strong> &#8211; Used to filter values from the headers
returned.  Will strip that prefix from the
keys in the dict returned.  Defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
<li><strong>headers</strong> &#8211; extra headers to send with request</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dict of object metadata.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.internal_client.InternalClient.get_object_ring">
<code class="descname">get_object_ring</code><a class="headerlink" href="#swift.common.internal_client.InternalClient.get_object_ring" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.iter_containers">
<code class="descname">iter_containers</code><span class="sig-paren">(</span><em>account</em>, <em>marker=''</em>, <em>end_marker=''</em>, <em>acceptable_statuses=(2</em>, <em>404)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.iter_containers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of containers dicts from an account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; Account on which to do the container listing.</li>
<li><strong>marker</strong> &#8211; Prefix of first desired item, defaults to &#8216;&#8217;.</li>
<li><strong>end_marker</strong> &#8211; Last item returned will be &#8216;less&#8217; than this,
defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2, HTTP_NOT_FOUND).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.iter_object_lines">
<code class="descname">iter_object_lines</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>obj</em>, <em>headers=None</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.iter_object_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of object lines from an uncompressed or compressed
text object.</p>
<p>Uncompress object as it is read if the object&#8217;s name ends with &#8216;.gz&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The object&#8217;s account.</li>
<li><strong>container</strong> &#8211; The object&#8217;s container.</li>
<li><strong>obj</strong> &#8211; The object.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.iter_objects">
<code class="descname">iter_objects</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>marker=''</em>, <em>end_marker=''</em>, <em>acceptable_statuses=(2</em>, <em>404)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.iter_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of object dicts from a container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to iterate objects on.</li>
<li><strong>marker</strong> &#8211; Prefix of first desired item, defaults to &#8216;&#8217;.</li>
<li><strong>end_marker</strong> &#8211; Last item returned will be &#8216;less&#8217; than this,
defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2, HTTP_NOT_FOUND).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.make_path">
<code class="descname">make_path</code><span class="sig-paren">(</span><em>account</em>, <em>container=None</em>, <em>obj=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.make_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a swift path for a request quoting and utf-8 encoding the path
parts as need be.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; swift account</li>
<li><strong>container</strong> &#8211; container, defaults to None</li>
<li><strong>obj</strong> &#8211; object, defaults to None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> &#8211; Is raised if obj is specified and container is
not.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.make_request">
<code class="descname">make_request</code><span class="sig-paren">(</span><em>method</em>, <em>path</em>, <em>headers</em>, <em>acceptable_statuses</em>, <em>body_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.make_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a request to Swift with retries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>method</strong> &#8211; HTTP method of request.</li>
<li><strong>path</strong> &#8211; Path of request.</li>
<li><strong>headers</strong> &#8211; Headers to be sent with request.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of acceptable statuses for request.</li>
<li><strong>body_file</strong> &#8211; Body file to be passed along with request,
defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Response object on success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when make_request() fails
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.set_account_metadata">
<code class="descname">set_account_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>metadata</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.set_account_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets account metadata.  A call to this will add to the account
metadata and not overwrite all of it with values in the metadata dict.
To clear an account metadata value, pass an empty string as
the value for the key in the metadata dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; Account on which to get the metadata.</li>
<li><strong>metadata</strong> &#8211; Dict of metadata to set.</li>
<li><strong>metadata_prefix</strong> &#8211; Prefix used to set metadata values in headers
of requests, used to prefix keys in metadata
when setting metadata, defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.set_container_metadata">
<code class="descname">set_container_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>metadata</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.set_container_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets container metadata.  A call to this will add to the container
metadata and not overwrite all of it with values in the metadata dict.
To clear a container metadata value, pass an empty string as the value
for the key in the metadata dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The container&#8217;s account.</li>
<li><strong>container</strong> &#8211; Container to set metadata on.</li>
<li><strong>metadata</strong> &#8211; Dict of metadata to set.</li>
<li><strong>metadata_prefix</strong> &#8211; Prefix used to set metadata values in headers
of requests, used to prefix keys in metadata
when setting metadata, defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.set_object_metadata">
<code class="descname">set_object_metadata</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>obj</em>, <em>metadata</em>, <em>metadata_prefix=''</em>, <em>acceptable_statuses=(2</em>, <em>)</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.set_object_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets an object&#8217;s metadata.  The object&#8217;s metadata will be overwritten
by the values in the metadata dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; The object&#8217;s account.</li>
<li><strong>container</strong> &#8211; The object&#8217;s container.</li>
<li><strong>obj</strong> &#8211; The object.</li>
<li><strong>metadata</strong> &#8211; Dict of metadata to set.</li>
<li><strong>metadata_prefix</strong> &#8211; Prefix used to set metadata values in headers
of requests, used to prefix keys in metadata
when setting metadata, defaults to &#8216;&#8217;.</li>
<li><strong>acceptable_statuses</strong> &#8211; List of status for valid responses,
defaults to (2,).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.InternalClient.upload_object">
<code class="descname">upload_object</code><span class="sig-paren">(</span><em>fobj</em>, <em>account</em>, <em>container</em>, <em>obj</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.InternalClient.upload_object" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fobj</strong> &#8211; File object to read object&#8217;s content from.</li>
<li><strong>account</strong> &#8211; The object&#8217;s account.</li>
<li><strong>container</strong> &#8211; The object&#8217;s container.</li>
<li><strong>obj</strong> &#8211; The object.</li>
<li><strong>headers</strong> &#8211; Headers to send with request, defaults ot empty dict.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>UnexpectedResponse</strong> &#8211; Exception raised when requests fail
to get a response with an acceptable status</li>
<li><strong>Exception</strong> &#8211; Exception is raised when code fails in an
unexpected way.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.internal_client.SimpleClient">
<em class="property">class </em><code class="descclassname">swift.common.internal_client.</code><code class="descname">SimpleClient</code><span class="sig-paren">(</span><em>url=None</em>, <em>token=None</em>, <em>starting_backoff=1</em>, <em>max_backoff=5</em>, <em>retries=5</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Simple client that is used in bin/swift-dispersion-* and container sync</p>
<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.base_request">
<code class="descname">base_request</code><span class="sig-paren">(</span><em>method</em>, <em>container=None</em>, <em>name=None</em>, <em>prefix=None</em>, <em>headers=None</em>, <em>proxy=None</em>, <em>contents=None</em>, <em>full_listing=None</em>, <em>logger=None</em>, <em>additional_info=None</em>, <em>timeout=None</em>, <em>marker=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.base_request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.get_account">
<code class="descname">get_account</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.get_account" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.get_container">
<code class="descname">get_container</code><span class="sig-paren">(</span><em>container</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.get_container" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.put_container">
<code class="descname">put_container</code><span class="sig-paren">(</span><em>container</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.put_container" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.put_object">
<code class="descname">put_object</code><span class="sig-paren">(</span><em>container</em>, <em>name</em>, <em>contents</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.put_object" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.common.internal_client.SimpleClient.retry_request">
<code class="descname">retry_request</code><span class="sig-paren">(</span><em>method</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.SimpleClient.retry_request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="exception">
<dt id="swift.common.internal_client.UnexpectedResponse">
<em class="property">exception </em><code class="descclassname">swift.common.internal_client.</code><code class="descname">UnexpectedResponse</code><span class="sig-paren">(</span><em>message</em>, <em>resp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.UnexpectedResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>Exception raised on invalid responses to InternalClient.make_request().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>message</strong> &#8211; Exception message.</li>
<li><strong>resp</strong> &#8211; The unexpected response.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.internal_client.delete_object">
<code class="descclassname">swift.common.internal_client.</code><code class="descname">delete_object</code><span class="sig-paren">(</span><em>url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.delete_object" title="Permalink to this definition">¶</a></dt>
<dd><p>For usage with container sync</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.internal_client.get_auth">
<code class="descclassname">swift.common.internal_client.</code><code class="descname">get_auth</code><span class="sig-paren">(</span><em>url</em>, <em>user</em>, <em>key</em>, <em>auth_version='1.0'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.get_auth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.internal_client.head_object">
<code class="descclassname">swift.common.internal_client.</code><code class="descname">head_object</code><span class="sig-paren">(</span><em>url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.head_object" title="Permalink to this definition">¶</a></dt>
<dd><p>For usage with container sync</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.internal_client.put_object">
<code class="descclassname">swift.common.internal_client.</code><code class="descname">put_object</code><span class="sig-paren">(</span><em>url</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.internal_client.put_object" title="Permalink to this definition">¶</a></dt>
<dd><p>For usage with container sync</p>
</dd></dl>

</div>
<div class="section" id="module-swift.common.manager">
<span id="manager"></span><h2>Manager<a class="headerlink" href="#module-swift.common.manager" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.common.manager.Manager">
<em class="property">class </em><code class="descclassname">swift.common.manager.</code><code class="descname">Manager</code><span class="sig-paren">(</span><em>servers</em>, <em>run_dir='/var/run/swift'</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Main class for performing commands on groups of servers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>servers</strong> &#8211; list of server names as strings</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.manager.Manager.force_reload">
<code class="descname">force_reload</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.force_reload" title="Permalink to this definition">¶</a></dt>
<dd><p>alias for reload</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.get_command">
<code class="descname">get_command</code><span class="sig-paren">(</span><em>cmd</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.get_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Find and return the decorated method named like cmd</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cmd</strong> &#8211; the command to get, a string, if not found raises
UnknownCommandError</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.kill">
<code class="descname">kill</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.kill" title="Permalink to this definition">¶</a></dt>
<dd><p>stop a server (no error if not running)</p>
</dd></dl>

<dl class="classmethod">
<dt id="swift.common.manager.Manager.list_commands">
<em class="property">classmethod </em><code class="descname">list_commands</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.list_commands" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all publicly accessible commands</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of string tuples (cmd, help), the method names who are
decorated as commands</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.no_daemon">
<code class="descname">no_daemon</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.no_daemon" title="Permalink to this definition">¶</a></dt>
<dd><p>start a server interactively</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.no_wait">
<code class="descname">no_wait</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.no_wait" title="Permalink to this definition">¶</a></dt>
<dd><p>spawn server and return immediately</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.once">
<code class="descname">once</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.once" title="Permalink to this definition">¶</a></dt>
<dd><p>start server and run one pass on supporting daemons</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.reload">
<code class="descname">reload</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.reload" title="Permalink to this definition">¶</a></dt>
<dd><p>graceful shutdown then restart on supporting servers</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.restart">
<code class="descname">restart</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.restart" title="Permalink to this definition">¶</a></dt>
<dd><p>stops then restarts server</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.run_command">
<code class="descname">run_command</code><span class="sig-paren">(</span><em>cmd</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.run_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the named command and run it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cmd</strong> &#8211; the command name to run</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.shutdown">
<code class="descname">shutdown</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>allow current requests to finish on supporting servers</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.start" title="Permalink to this definition">¶</a></dt>
<dd><p>starts a server</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.status">
<code class="descname">status</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.status" title="Permalink to this definition">¶</a></dt>
<dd><p>display status of tracked pids for server</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Manager.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Manager.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>stops a server</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.manager.Server">
<em class="property">class </em><code class="descclassname">swift.common.manager.</code><code class="descname">Server</code><span class="sig-paren">(</span><em>server</em>, <em>run_dir='/var/run/swift'</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Manage operations on a server or group of servers of similar type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server</strong> &#8211; name of server</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.manager.Server.conf_files">
<code class="descname">conf_files</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.conf_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Get conf files for this server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">number, if supplied will only lookup the nth server</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of conf files</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.get_conf_file_name">
<code class="descname">get_conf_file_name</code><span class="sig-paren">(</span><em>pid_file</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.get_conf_file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate pid_file to a corresponding conf_file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid_file</strong> &#8211; a pid_file for this server, a string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the conf_file for this pid_file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.get_pid_file_name">
<code class="descname">get_pid_file_name</code><span class="sig-paren">(</span><em>conf_file</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.get_pid_file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate conf_file to a corresponding pid_file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conf_file</strong> &#8211; an conf_file for this server, a string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the pid_file for this conf_file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.get_running_pids">
<code class="descname">get_running_pids</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.get_running_pids" title="Permalink to this definition">¶</a></dt>
<dd><p>Get running pids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dict mapping pids (ints) to pid_files (paths)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.interact">
<code class="descname">interact</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.interact" title="Permalink to this definition">¶</a></dt>
<dd><p>wait on spawned procs to terminate</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.iter_pid_files">
<code class="descname">iter_pid_files</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.iter_pid_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator, yields (pid_file, pids)</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.kill_running_pids">
<code class="descname">kill_running_pids</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.kill_running_pids" title="Permalink to this definition">¶</a></dt>
<dd><p>Kill running pids</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>graceful</strong> &#8211; if True, attempt SIGHUP on supporting servers</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a dict mapping pids (ints) to pid_files (paths)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.launch">
<code class="descname">launch</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.launch" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect conf files and attempt to spawn the processes for this server</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.pid_files">
<code class="descname">pid_files</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.pid_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pid files for this server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">number, if supplied will only lookup the nth server</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of pid files</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.signal_pids">
<code class="descname">signal_pids</code><span class="sig-paren">(</span><em>sig</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.signal_pids" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a signal to pids for this server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sig</strong> &#8211; signal to send</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a dict mapping pids (ints) to pid_files (paths)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.spawn">
<code class="descname">spawn</code><span class="sig-paren">(</span><em>conf_file</em>, <em>once=False</em>, <em>wait=True</em>, <em>daemon=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.spawn" title="Permalink to this definition">¶</a></dt>
<dd><p>Launch a subprocess for this server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf_file</strong> &#8211; path to conf_file to use as first arg</li>
<li><strong>once</strong> &#8211; boolean, add once argument to command</li>
<li><strong>wait</strong> &#8211; boolean, if true capture stdout with a pipe</li>
<li><strong>daemon</strong> &#8211; boolean, if false ask server to log to console</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the pid of the spawned process</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.status">
<code class="descname">status</code><span class="sig-paren">(</span><em>pids=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Display status of server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Param:</th><td class="field-body">pids, if not supplied pids will be populated automatically</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">number, if supplied will only lookup the nth server</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">1 if server is not running, 0 otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Send stop signals to pids for this server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a dict mapping pids (ints) to pid_files (paths)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.manager.Server.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.Server.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>wait on spawned procs to start</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.common.manager.command">
<code class="descclassname">swift.common.manager.</code><code class="descname">command</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.command" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to declare which methods are accessible as commands, commands
always return 1 or 0, where 0 should indicate success.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> &#8211; function to make public</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.manager.kill_group">
<code class="descclassname">swift.common.manager.</code><code class="descname">kill_group</code><span class="sig-paren">(</span><em>pid</em>, <em>sig</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.kill_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Send signal to process group</p>
<p>: param pid: process id
: param sig: signal to send</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.manager.safe_kill">
<code class="descclassname">swift.common.manager.</code><code class="descname">safe_kill</code><span class="sig-paren">(</span><em>pid</em>, <em>sig</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.safe_kill" title="Permalink to this definition">¶</a></dt>
<dd><p>Send signal to process and check process name</p>
<p>: param pid: process id
: param sig: signal to send
: param name: name to ensure target process</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.manager.setup_env">
<code class="descclassname">swift.common.manager.</code><code class="descname">setup_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.setup_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to increase resource limits of the OS. Move PYTHON_EGG_CACHE to /tmp</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.manager.watch_server_pids">
<code class="descclassname">swift.common.manager.</code><code class="descname">watch_server_pids</code><span class="sig-paren">(</span><em>server_pids</em>, <em>interval=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.manager.watch_server_pids" title="Permalink to this definition">¶</a></dt>
<dd><p>Monitor a collection of server pids yielding back those pids that
aren&#8217;t responding to signals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server_pids</strong> &#8211; a dict, lists of pids [int,...] keyed on
Server objects</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-swift.common.memcached">
<span id="memcached"></span><h2>MemCacheD<a class="headerlink" href="#module-swift.common.memcached" title="Permalink to this headline">¶</a></h2>
<p>Why our own memcache client?
By Michael Barton</p>
<p>python-memcached doesn&#8217;t use consistent hashing, so adding or
removing a memcache server from the pool invalidates a huge
percentage of cached items.</p>
<p>If you keep a pool of python-memcached client objects, each client
object has its own connection to every memcached server, only one of
which is ever in use.  So you wind up with n * m open sockets and
almost all of them idle. This client effectively has a pool for each
server, so the number of backend connections is hopefully greatly
reduced.</p>
<p>python-memcache uses pickle to store things, and there was already a
huge stink about Swift using pickles in memcache
(<a class="reference external" href="http://osvdb.org/show/osvdb/86581">http://osvdb.org/show/osvdb/86581</a>).  That seemed sort of unfair,
since nova and keystone and everyone else use pickles for memcache
too, but it&#8217;s hidden behind a &#8220;standard&#8221; library. But changing would
be a security regression at this point.</p>
<p>Also, pylibmc wouldn&#8217;t work for us because it needs to use python
sockets in order to play nice with eventlet.</p>
<p>Lucid comes with memcached: v1.4.2.  Protocol documentation for that
version is at:</p>
<p><a class="reference external" href="http://github.com/memcached/memcached/blob/1.4.2/doc/protocol.txt">http://github.com/memcached/memcached/blob/1.4.2/doc/protocol.txt</a></p>
<dl class="class">
<dt id="swift.common.memcached.MemcacheConnPool">
<em class="property">class </em><code class="descclassname">swift.common.memcached.</code><code class="descname">MemcacheConnPool</code><span class="sig-paren">(</span><em>server</em>, <em>size</em>, <em>connect_timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheConnPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.pools.Pool</span></code></p>
<p>Connection pool for Memcache Connections</p>
<p>The <em>server</em> parameter can be a hostname, an IPv4 address, or an IPv6
address with an optional port. See
<a class="reference internal" href="#swift.common.utils.parse_socket_string" title="swift.common.utils.parse_socket_string"><code class="xref py py-func docutils literal"><span class="pre">swift.common.utils.parse_socket_string()</span></code></a> for details.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.memcached.MemcacheRing">
<em class="property">class </em><code class="descclassname">swift.common.memcached.</code><code class="descname">MemcacheRing</code><span class="sig-paren">(</span><em>servers</em>, <em>connect_timeout=0.3</em>, <em>io_timeout=2.0</em>, <em>pool_timeout=1.0</em>, <em>tries=3</em>, <em>allow_pickle=False</em>, <em>allow_unpickle=False</em>, <em>max_conns=2</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Simple, consistent-hashed memcache client.</p>
<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.decr">
<code class="descname">decr</code><span class="sig-paren">(</span><em>key</em>, <em>delta=1</em>, <em>time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.decr" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrements a key which has a numeric value by delta. Calls incr with
-delta.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> &#8211; key</li>
<li><strong>delta</strong> &#8211; amount to subtract to the value of key (or set the
value to 0 if the key is not found) will be cast to
an int</li>
<li><strong>time</strong> &#8211; the time to live</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result of decrementing</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>MemcacheConnectionError</strong> &#8211; </p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes a key/value pair from memcache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> &#8211; key to be deleted</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the object specified by key.  It will also unserialize the object
before returning if it is serialized in memcache with JSON, or if it
is pickled and unpickling is allowed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> &#8211; key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">value of the key in memcache</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.get_multi">
<code class="descname">get_multi</code><span class="sig-paren">(</span><em>keys</em>, <em>server_key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.get_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets multiple values from memcache for the given keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keys</strong> &#8211; keys for values to be retrieved from memcache</li>
<li><strong>servery_key</strong> &#8211; key to use in determining which server in the ring
is used</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.incr">
<code class="descname">incr</code><span class="sig-paren">(</span><em>key</em>, <em>delta=1</em>, <em>time=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.incr" title="Permalink to this definition">¶</a></dt>
<dd><p>Increments a key which has a numeric value by delta.
If the key can&#8217;t be found, it&#8217;s added as delta or 0 if delta &lt; 0.
If passed a negative number, will use memcached&#8217;s decr. Returns
the int stored in memcached
Note: The data memcached stores as the result of incr/decr is
an unsigned int.  decr&#8217;s that result in a number below 0 are
stored as 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> &#8211; key</li>
<li><strong>delta</strong> &#8211; amount to add to the value of key (or set as the value
if the key is not found) will be cast to an int</li>
<li><strong>time</strong> &#8211; the time to live</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result of incrementing</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>MemcacheConnectionError</strong> &#8211; </p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.set">
<code class="descname">set</code><span class="sig-paren">(</span><em>key</em>, <em>value</em>, <em>serialize=True</em>, <em>time=0</em>, <em>min_compress_len=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a key/value pair in memcache</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> &#8211; key</li>
<li><strong>value</strong> &#8211; value</li>
<li><strong>serialize</strong> &#8211; if True, value is serialized with JSON before sending
to memcache, or with pickle if configured to use
pickle instead of JSON (to avoid cache poisoning)</li>
<li><strong>time</strong> &#8211; the time to live</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Min_compress_len:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">minimum compress length, this parameter was added
to keep the signature compatible with
python-memcached interface. This implementation
ignores it.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.memcached.MemcacheRing.set_multi">
<code class="descname">set_multi</code><span class="sig-paren">(</span><em>mapping</em>, <em>server_key</em>, <em>serialize=True</em>, <em>time=0</em>, <em>min_compress_len=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.MemcacheRing.set_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets multiple key/value pairs in memcache.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mapping</strong> &#8211; dictionary of keys and values to be set in memcache</li>
<li><strong>server_key</strong> &#8211; key to use in determining which server in the ring
is used</li>
<li><strong>serialize</strong> &#8211; if True, value is serialized with JSON before sending
to memcache, or with pickle if configured to use
pickle instead of JSON (to avoid cache poisoning)</li>
<li><strong>time</strong> &#8211; the time to live</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Min_compress_len:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first last">minimum compress length, this parameter was added
to keep the signature compatible with
python-memcached interface. This implementation
ignores it</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.common.memcached.sanitize_timeout">
<code class="descclassname">swift.common.memcached.</code><code class="descname">sanitize_timeout</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.memcached.sanitize_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanitize a timeout value to use an absolute expiration time if the delta
is greater than 30 days (in seconds). Note that the memcached server
translates negative values to mean a delta of 30 days in seconds (and 1
additional second), client beware.</p>
</dd></dl>

</div>
<div class="section" id="module-swift.common.request_helpers">
<span id="id8"></span><span id="request-helpers"></span><h2>Request Helpers<a class="headerlink" href="#module-swift.common.request_helpers" title="Permalink to this headline">¶</a></h2>
<p>Miscellaneous utility functions for use in generating responses.</p>
<p>Why not swift.common.utils, you ask? Because this way we can import things
from swob in here without creating circular imports.</p>
<dl class="class">
<dt id="swift.common.request_helpers.SegmentedIterable">
<em class="property">class </em><code class="descclassname">swift.common.request_helpers.</code><code class="descname">SegmentedIterable</code><span class="sig-paren">(</span><em>req</em>, <em>app</em>, <em>listing_iter</em>, <em>max_get_time</em>, <em>logger</em>, <em>ua_suffix</em>, <em>swift_source</em>, <em>name='&lt;not specified&gt;'</em>, <em>response_body_length=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.SegmentedIterable" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Iterable that returns the object contents for a large object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>req</strong> &#8211; original request object</li>
<li><strong>app</strong> &#8211; WSGI application from which segments will come</li>
<li><strong>listing_iter</strong> &#8211; <p>iterable yielding the object segments to fetch,
along with the byte subranges to fetch, in the form of a 5-tuple
(object-path, object-etag, object-size, first-byte, last-byte).</p>
<p>If object-etag is None, no MD5 verification will be done.</p>
<p>If object-size is None, no length verification will be done.</p>
<p>If first-byte and last-byte are None, then the entire object will be
fetched.</p>
</li>
<li><strong>max_get_time</strong> &#8211; maximum permitted duration of a GET request (seconds)</li>
<li><strong>logger</strong> &#8211; logger object</li>
<li><strong>swift_source</strong> &#8211; value of swift.source in subrequest environ
(just for logging)</li>
<li><strong>ua_suffix</strong> &#8211; string to append to user-agent.</li>
<li><strong>name</strong> &#8211; name of manifest (used in logging only)</li>
<li><strong>response_body_length</strong> &#8211; optional response body length for
the response being sent to the client.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.request_helpers.SegmentedIterable.app_iter_range">
<code class="descname">app_iter_range</code><span class="sig-paren">(</span><em>*a</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.SegmentedIterable.app_iter_range" title="Permalink to this definition">¶</a></dt>
<dd><p>swob.Response will only respond with a 206 status in certain cases; one
of those is if the body iterator responds to .app_iter_range().</p>
<p>However, this object (or really, its listing iter) is smart enough to
handle the range stuff internally, so we just no-op this out for swob.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.request_helpers.SegmentedIterable.app_iter_ranges">
<code class="descname">app_iter_ranges</code><span class="sig-paren">(</span><em>ranges</em>, <em>content_type</em>, <em>boundary</em>, <em>content_size</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.SegmentedIterable.app_iter_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>This method assumes that iter(self) yields all the data bytes that
go into the response, but none of the MIME stuff. For example, if
the response will contain three MIME docs with data &#8220;abcd&#8221;, &#8220;efgh&#8221;,
and &#8220;ijkl&#8221;, then iter(self) will give out the bytes &#8220;abcdefghijkl&#8221;.</p>
<p>This method inserts the MIME stuff around the data bytes.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.request_helpers.SegmentedIterable.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.SegmentedIterable.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the client disconnect. Ensure that the connection to the
backend server is closed.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.request_helpers.SegmentedIterable.validate_first_segment">
<code class="descname">validate_first_segment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.SegmentedIterable.validate_first_segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Start fetching object data to ensure that the first segment (if any) is
valid. This is to catch cases like &#8220;first segment is missing&#8221; or
&#8220;first segment&#8217;s etag doesn&#8217;t match manifest&#8221;.</p>
<p>Note: this does not validate that you have any segments. A
zero-segment large object is not erroneous; it is just empty.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.copy_header_subset">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">copy_header_subset</code><span class="sig-paren">(</span><em>from_r</em>, <em>to_r</em>, <em>condition</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.copy_header_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Will copy desired subset of headers from from_r to to_r.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>from_r</strong> &#8211; a swob Request or Response</li>
<li><strong>to_r</strong> &#8211; a swob Request or Response</li>
<li><strong>condition</strong> &#8211; a function that will be passed the header key as a
single argument and should return True if the header
is to be copied.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_listing_content_type">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_listing_content_type</code><span class="sig-paren">(</span><em>req</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_listing_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the content type to use for an account or container listing
response.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>req</strong> &#8211; request object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">content type as a string (e.g. text/plain, application/json)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">HTTPNotAcceptable if the requested content type is not acceptable</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">HTTPBadRequest if the &#8216;format&#8217; query param is provided and
not valid UTF-8</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_name_and_placement">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_name_and_placement</code><span class="sig-paren">(</span><em>request</em>, <em>minsegs=1</em>, <em>maxsegs=None</em>, <em>rest_with_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_name_and_placement" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to split and validate the request path and storage
policy.  The storage policy index is extracted from the headers of
the request and converted to a StoragePolicy instance.  The
remaining args are passed through to
<a class="reference internal" href="#swift.common.request_helpers.split_and_validate_path" title="swift.common.request_helpers.split_and_validate_path"><code class="xref py py-meth docutils literal"><span class="pre">split_and_validate_path()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list, result of <a class="reference internal" href="#swift.common.request_helpers.split_and_validate_path" title="swift.common.request_helpers.split_and_validate_path"><code class="xref py py-meth docutils literal"><span class="pre">split_and_validate_path()</span></code></a> with
the BaseStoragePolicy instance appended on the end</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">HTTPServiceUnavailable if the path is invalid or no policy exists
with the extracted policy_index.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_object_transient_sysmeta">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_object_transient_sysmeta</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_object_transient_sysmeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Object Transient System Metadata header for key.
The Object Transient System Metadata namespace will be persisted by
backend object servers. These headers are treated in the same way as
object user metadata i.e. all headers in this namespace will be
replaced on every POST request.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> &#8211; metadata key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the entire object transient system metadata header for key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_param">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_param</code><span class="sig-paren">(</span><em>req</em>, <em>name</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters from an HTTP request ensuring proper handling UTF-8
encoding.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; request object</li>
<li><strong>name</strong> &#8211; parameter name</li>
<li><strong>default</strong> &#8211; result to return if the parameter is not found</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">HTTP request parameter value
(as UTF-8 encoded str, not unicode object)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">HTTPBadRequest if param not valid UTF-8 byte sequence</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_sys_meta_prefix">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_sys_meta_prefix</code><span class="sig-paren">(</span><em>server_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_sys_meta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prefix for system metadata headers for given server type.</p>
<p>This prefix defines the namespace for headers that will be persisted
by backend servers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">prefix string for server type&#8217;s system metadata headers</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.get_user_meta_prefix">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">get_user_meta_prefix</code><span class="sig-paren">(</span><em>server_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.get_user_meta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prefix for user metadata headers for given server type.</p>
<p>This prefix defines the namespace for headers that will be persisted
by backend servers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">prefix string for server type&#8217;s user metadata headers</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.http_response_to_document_iters">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">http_response_to_document_iters</code><span class="sig-paren">(</span><em>response</em>, <em>read_chunk_size=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.http_response_to_document_iters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a successful object-GET HTTP response and turns it into an
iterator of (first-byte, last-byte, length, headers, body-file)
5-tuples.</p>
<p>The response must either be a 200 or a 206; if you feed in a 204 or
something similar, this probably won&#8217;t work.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>response</strong> &#8211; HTTP response, like from bufferedhttp.http_connect(),
not a swob.Response.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.is_object_transient_sysmeta">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">is_object_transient_sysmeta</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.is_object_transient_sysmeta" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a header key starts with and is longer than the prefix for object
transient system metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> &#8211; header key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if the key satisfies the test, False otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.is_sys_meta">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">is_sys_meta</code><span class="sig-paren">(</span><em>server_type</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.is_sys_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a header key starts with and is longer than the system
metadata prefix for given server type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</li>
<li><strong>key</strong> &#8211; header key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if the key satisfies the test, False otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.is_sys_or_user_meta">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">is_sys_or_user_meta</code><span class="sig-paren">(</span><em>server_type</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.is_sys_or_user_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a header key starts with and is longer than the user or system
metadata prefix for given server type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</li>
<li><strong>key</strong> &#8211; header key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if the key satisfies the test, False otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.is_user_meta">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">is_user_meta</code><span class="sig-paren">(</span><em>server_type</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.is_user_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if a header key starts with and is longer than the user
metadata prefix for given server type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</li>
<li><strong>key</strong> &#8211; header key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if the key satisfies the test, False otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.remove_items">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">remove_items</code><span class="sig-paren">(</span><em>headers</em>, <em>condition</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.remove_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes items from a dict whose keys satisfy
the given condition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>headers</strong> &#8211; a dict of headers</li>
<li><strong>condition</strong> &#8211; a function that will be passed the header key as a
single argument and should return True if the header
is to be removed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a dict, possibly empty, of headers that have been removed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.resolve_etag_is_at_header">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">resolve_etag_is_at_header</code><span class="sig-paren">(</span><em>req</em>, <em>metadata</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.resolve_etag_is_at_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to resolve an alternative etag value that may be stored in
metadata under an alternate name.</p>
<p>The value of the request&#8217;s X-Backend-Etag-Is-At header (if it exists) is a
comma separated list of alternate names in the metadata at which an
alternate etag value may be found. This list is processed in order until an
alternate etag is found.</p>
<p>The left most value in X-Backend-Etag-Is-At will have been set by the left
most middleware, or if no middleware, by ECObjectController, if an EC
policy is in use. The left most middleware is assumed to be the authority
on what the etag value of the object content is.</p>
<p>The resolver will work from left to right in the list until it finds a
value that is a name in the given metadata. So the left most wins, IF it
exists in the metadata.</p>
<p>By way of example, assume the encrypter middleware is installed. If an
object is <em>not</em> encrypted then the resolver will not find the encrypter
middleware&#8217;s alternate etag sysmeta (X-Object-Sysmeta-Crypto-Etag) but will
then find the EC alternate etag (if EC policy). But if the object <em>is</em>
encrypted then X-Object-Sysmeta-Crypto-Etag is found and used, which is
correct because it should be preferred over X-Object-Sysmeta-Crypto-Etag.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; a swob Request</li>
<li><strong>metadata</strong> &#8211; a dict containing object metadata</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">an alternate etag value if any is found, otherwise None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.split_and_validate_path">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">split_and_validate_path</code><span class="sig-paren">(</span><em>request</em>, <em>minsegs=1</em>, <em>maxsegs=None</em>, <em>rest_with_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.split_and_validate_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to split and validate the request path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of <a class="reference internal" href="#swift.common.utils.split_path" title="swift.common.utils.split_path"><code class="xref py py-meth docutils literal"><span class="pre">split_path()</span></code></a> if
everything&#8217;s okay</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">HTTPBadRequest if something&#8217;s not okay</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.strip_object_transient_sysmeta_prefix">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">strip_object_transient_sysmeta_prefix</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.strip_object_transient_sysmeta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the object transient system metadata prefix from the start of a
header key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> &#8211; header key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">stripped header key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.strip_sys_meta_prefix">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">strip_sys_meta_prefix</code><span class="sig-paren">(</span><em>server_type</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.strip_sys_meta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the system metadata prefix for a given server type from the start
of a header key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</li>
<li><strong>key</strong> &#8211; header key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">stripped header key</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.strip_user_meta_prefix">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">strip_user_meta_prefix</code><span class="sig-paren">(</span><em>server_type</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.strip_user_meta_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the user metadata prefix for a given server type from the start
of a header key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>server_type</strong> &#8211; type of backend server i.e. [account|container|object]</li>
<li><strong>key</strong> &#8211; header key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">stripped header key</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.request_helpers.update_etag_is_at_header">
<code class="descclassname">swift.common.request_helpers.</code><code class="descname">update_etag_is_at_header</code><span class="sig-paren">(</span><em>req</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.request_helpers.update_etag_is_at_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to update an X-Backend-Etag-Is-At header whose value is a
list of alternative header names at which the actual object etag may be
found. This informs the object server where to look for the actual object
etag when processing conditional requests.</p>
<p>Since the proxy server and/or middleware may set alternative etag header
names, the value of X-Backend-Etag-Is-At is a comma separated list which
the object server inspects in order until it finds an etag value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>req</strong> &#8211; a swob Request</li>
<li><strong>name</strong> &#8211; name of a sysmeta where alternative etag may be found</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="swob">
<span id="id9"></span><h2>Swob<a class="headerlink" href="#swob" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.swob"></span><p>Implementation of WSGI Request and Response objects.</p>
<p>This library has a very similar API to Webob.  It wraps WSGI request
environments and response values into objects that are more friendly to
interact with.</p>
<p>Why Swob and not just use WebOb?
By Michael Barton</p>
<p>We used webob for years. The main problem was that the interface
wasn&#8217;t stable. For a while, each of our several test suites required
a slightly different version of webob to run, and none of them worked
with the then-current version. It was a huge headache, so we just
scrapped it.</p>
<p>This is kind of a ton of code, but it&#8217;s also been a huge relief to
not have to scramble to add a bunch of code branches all over the
place to keep Swift working every time webob decides some interface
needs to change.</p>
<dl class="class">
<dt id="swift.common.swob.Accept">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">Accept</code><span class="sig-paren">(</span><em>headerval</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Accept" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wraps a Request&#8217;s Accept header as a friendly object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>headerval</strong> &#8211; value of the header as a str</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.swob.Accept.best_match">
<code class="descname">best_match</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Accept.best_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the item from &#8220;options&#8221; that best matches the accept header.
Returns None if no available options are acceptable to the client.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> &#8211; a list of content-types the server can respond with</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.swob.HeaderEnvironProxy">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">HeaderEnvironProxy</code><span class="sig-paren">(</span><em>environ</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.HeaderEnvironProxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">_abcoll.MutableMapping</span></code></p>
<p>A dict-like object that proxies requests to a wsgi environ,
rewriting header keys to environ keys.</p>
<p>For example, headers[&#8216;Content-Range&#8217;] sets and gets the value of
headers.environ[&#8216;HTTP_CONTENT_RANGE&#8217;]</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.swob.Match">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">Match</code><span class="sig-paren">(</span><em>headerval</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Match" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wraps a Request&#8217;s If-[None-]Match header as a friendly object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>headerval</strong> &#8211; value of the header as a str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="swift.common.swob.Range">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">Range</code><span class="sig-paren">(</span><em>headerval</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Range" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wraps a Request&#8217;s Range header as a friendly object.
After initialization, &#8220;range.ranges&#8221; is populated with a list
of (start, end) tuples denoting the requested ranges.</p>
<p>If there were any syntactically-invalid byte-range-spec values, the
constructor will raise a ValueError, per the relevant RFC:</p>
<p>&#8220;The recipient of a byte-range-set that includes one or more syntactically
invalid byte-range-spec values MUST ignore the header field that includes
that byte-range-set.&#8221;</p>
<p>According to the RFC 2616 specification, the following cases will be all
considered as syntactically invalid, thus, a ValueError is thrown so that
the range header will be ignored. If the range value contains at least
one of the following cases, the entire range is considered invalid,
ValueError will be thrown so that the header will be ignored.</p>
<ol class="arabic simple">
<li>value not starts with bytes=</li>
<li>range value start is greater than the end, eg. bytes=5-3</li>
<li>range does not have start or end, eg. bytes=-</li>
<li>range does not have hyphen, eg. bytes=45</li>
<li>range value is non numeric</li>
<li>any combination of the above</li>
</ol>
<p>Every syntactically valid range will be added into the ranges list
even when some of the ranges may not be satisfied by underlying content.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>headerval</strong> &#8211; value of the header as a str</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.swob.Range.ranges_for_length">
<code class="descname">ranges_for_length</code><span class="sig-paren">(</span><em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Range.ranges_for_length" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is used to return multiple ranges for a given length
which should represent the length of the underlying content.
The constructor method __init__ made sure that any range in ranges
list is syntactically valid. So if length is None or size of the
ranges is zero, then the Range header should be ignored which will
eventually make the response to be 200.</p>
<p>If an empty list is returned by this method, it indicates that there
are unsatisfiable ranges found in the Range header, 416 will be
returned.</p>
<p>if a returned list has at least one element, the list indicates that
there is at least one range valid and the server should serve the
request with a 206 status code.</p>
<p>The start value of each range represents the starting position in
the content, the end value represents the ending position. This
method purposely adds 1 to the end number because the spec defines
the Range to be inclusive.</p>
<p>The Range spec can be found at the following link:
<a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.1</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>length</strong> &#8211; length of the underlying content</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.swob.Request">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">Request</code><span class="sig-paren">(</span><em>environ</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>WSGI Request object.</p>
<dl class="attribute">
<dt id="swift.common.swob.Request.accept">
<code class="descname">accept</code><a class="headerlink" href="#swift.common.swob.Request.accept" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the accept property in the WSGI environ, as a Accept object</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.acl">
<code class="descname">acl</code><a class="headerlink" href="#swift.common.swob.Request.acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the swob.ACL property in the WSGI environment</p>
</dd></dl>

<dl class="classmethod">
<dt id="swift.common.swob.Request.blank">
<em class="property">classmethod </em><code class="descname">blank</code><span class="sig-paren">(</span><em>path</em>, <em>environ=None</em>, <em>headers=None</em>, <em>body=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.blank" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new request object with the given parameters, and an
environment otherwise filled in with non-surprising default values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> &#8211; encoded, parsed, and unquoted into PATH_INFO</li>
<li><strong>environ</strong> &#8211; WSGI environ dictionary</li>
<li><strong>headers</strong> &#8211; HTTP headers</li>
<li><strong>body</strong> &#8211; stuffed in a WsgiBytesIO and hung on wsgi.input</li>
<li><strong>kwargs</strong> &#8211; any environ key with an property setter</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.body">
<code class="descname">body</code><a class="headerlink" href="#swift.common.swob.Request.body" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the request body str</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.body_file">
<code class="descname">body_file</code><a class="headerlink" href="#swift.common.swob.Request.body_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the wsgi.input property in the WSGI environment</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.call_application">
<code class="descname">call_application</code><span class="sig-paren">(</span><em>application</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.call_application" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the application with this request&#8217;s environment.  Returns the
status, headers, and app_iter for the response as a tuple.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>application</strong> &#8211; the WSGI application to call</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.content_length">
<code class="descname">content_length</code><a class="headerlink" href="#swift.common.swob.Request.content_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the content-length header as an int</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.copy_get">
<code class="descname">copy_get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.copy_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a copy of the request, converting it to a GET.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.get_response">
<code class="descname">get_response</code><span class="sig-paren">(</span><em>application</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.get_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the application with this request&#8217;s environment.  Returns a
Response object that wraps up the application&#8217;s result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>application</strong> &#8211; the WSGI application to call</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.host">
<code class="descname">host</code><a class="headerlink" href="#swift.common.swob.Request.host" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the HTTP_HOST property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.host_url">
<code class="descname">host_url</code><a class="headerlink" href="#swift.common.swob.Request.host_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Get url for request/response up to path</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.if_match">
<code class="descname">if_match</code><a class="headerlink" href="#swift.common.swob.Request.if_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the if-match property in the WSGI environ, as a Match object</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.if_modified_since">
<code class="descname">if_modified_since</code><a class="headerlink" href="#swift.common.swob.Request.if_modified_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the if-modified-since header as a datetime, set it with a datetime, int, or str</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.if_none_match">
<code class="descname">if_none_match</code><a class="headerlink" href="#swift.common.swob.Request.if_none_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the if-none-match property in the WSGI environ, as a Match object</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.if_unmodified_since">
<code class="descname">if_unmodified_since</code><a class="headerlink" href="#swift.common.swob.Request.if_unmodified_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the if-unmodified-since header as a datetime, set it with a datetime, int, or str</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.message_length">
<code class="descname">message_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.message_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Properly determine the message length for this request. It will return
an integer if the headers explicitly contain the message length, or
None if the headers don&#8217;t contain a length. The ValueError exception
will be raised if the headers are invalid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>ValueError</strong> &#8211; if either transfer-encoding or content-length
headers have bad values</li>
<li><strong>AttributeError</strong> &#8211; if the last value of the transfer-encoding
header is not &#8220;chunked&#8221;</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.method">
<code class="descname">method</code><a class="headerlink" href="#swift.common.swob.Request.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the REQUEST_METHOD property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.params">
<code class="descname">params</code><a class="headerlink" href="#swift.common.swob.Request.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides QUERY_STRING parameters as a dictionary</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.path">
<code class="descname">path</code><a class="headerlink" href="#swift.common.swob.Request.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the full path of the request, excluding the QUERY_STRING</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.path_info">
<code class="descname">path_info</code><a class="headerlink" href="#swift.common.swob.Request.path_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the PATH_INFO property in the WSGI environment</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.path_info_pop">
<code class="descname">path_info_pop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.path_info_pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes one path portion (delineated by slashes) from the
path_info, and appends it to the script_name.  Returns
the path segment.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.path_qs">
<code class="descname">path_qs</code><a class="headerlink" href="#swift.common.swob.Request.path_qs" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the request, without host but with query string.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.query_string">
<code class="descname">query_string</code><a class="headerlink" href="#swift.common.swob.Request.query_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the QUERY_STRING property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.range">
<code class="descname">range</code><a class="headerlink" href="#swift.common.swob.Request.range" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the range property in the WSGI environ, as a Range object</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.referer">
<code class="descname">referer</code><a class="headerlink" href="#swift.common.swob.Request.referer" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the HTTP_REFERER property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.referrer">
<code class="descname">referrer</code><a class="headerlink" href="#swift.common.swob.Request.referrer" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the HTTP_REFERER property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.remote_addr">
<code class="descname">remote_addr</code><a class="headerlink" href="#swift.common.swob.Request.remote_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the REMOTE_ADDR property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.remote_user">
<code class="descname">remote_user</code><a class="headerlink" href="#swift.common.swob.Request.remote_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the REMOTE_USER property in the WSGI environment</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.script_name">
<code class="descname">script_name</code><a class="headerlink" href="#swift.common.swob.Request.script_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the SCRIPT_NAME property in the WSGI environment</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Request.split_path">
<code class="descname">split_path</code><span class="sig-paren">(</span><em>minsegs=1</em>, <em>maxsegs=None</em>, <em>rest_with_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Request.split_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate and split the Request&#8217;s path.</p>
<p><strong>Examples</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a/c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;o/r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a/c/o/r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>minsegs</strong> &#8211; Minimum number of segments to be extracted</li>
<li><strong>maxsegs</strong> &#8211; Maximum number of segments to be extracted</li>
<li><strong>rest_with_last</strong> &#8211; If True, trailing data will be returned as part
of last segment.  If False, and there is
trailing data, raises ValueError.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of segments with a length of maxsegs (non-existent
segments will return as None)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if given an invalid path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.str_params">
<code class="descname">str_params</code><a class="headerlink" href="#swift.common.swob.Request.str_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides QUERY_STRING parameters as a dictionary</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.swift_entity_path">
<code class="descname">swift_entity_path</code><a class="headerlink" href="#swift.common.swob.Request.swift_entity_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the account/container/object path, sans API version.</p>
<p>This can be useful when constructing a path to send to a backend
server, as that path will need everything after the &#8220;/v1&#8221;.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.timestamp">
<code class="descname">timestamp</code><a class="headerlink" href="#swift.common.swob.Request.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides HTTP_X_TIMESTAMP as a <a class="reference internal" href="#swift.common.utils.Timestamp" title="swift.common.utils.Timestamp"><code class="xref py py-class docutils literal"><span class="pre">Timestamp</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.url">
<code class="descname">url</code><a class="headerlink" href="#swift.common.swob.Request.url" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the full url of the request</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Request.user_agent">
<code class="descname">user_agent</code><a class="headerlink" href="#swift.common.swob.Request.user_agent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set the HTTP_USER_AGENT property in the WSGI environment</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.swob.Response">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">Response</code><span class="sig-paren">(</span><em>body=None</em>, <em>status=200</em>, <em>headers=None</em>, <em>app_iter=None</em>, <em>request=None</em>, <em>conditional_response=False</em>, <em>conditional_etag=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Response" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>WSGI Response object.</p>
<dl class="method">
<dt id="swift.common.swob.Response.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>env</em>, <em>start_response</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Response.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Respond to the WSGI request.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This will translate any relative Location header value to an
absolute URL using the WSGI environment&#8217;s HOST_URL as a
prefix, as RFC 2616 specifies.</p>
<p>However, it is quite common to use relative redirects,
especially when it is difficult to know the exact HOST_URL
the browser would have used when behind several CNAMEs, CDN
services, etc. All modern browsers support relative
redirects.</p>
<p class="last">To skip over RFC enforcement of the Location header value,
you may set <code class="docutils literal"><span class="pre">env['swift.leave_relative_location']</span> <span class="pre">=</span> <span class="pre">True</span></code>
in the WSGI environment.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Response.absolute_location">
<code class="descname">absolute_location</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Response.absolute_location" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to construct an absolute location.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.accept_ranges">
<code class="descname">accept_ranges</code><a class="headerlink" href="#swift.common.swob.Response.accept_ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the accept-ranges header</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.app_iter">
<code class="descname">app_iter</code><a class="headerlink" href="#swift.common.swob.Response.app_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the response app_iter</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.body">
<code class="descname">body</code><a class="headerlink" href="#swift.common.swob.Response.body" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the Response body str</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.charset">
<code class="descname">charset</code><a class="headerlink" href="#swift.common.swob.Response.charset" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the response charset</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.conditional_etag">
<code class="descname">conditional_etag</code><a class="headerlink" href="#swift.common.swob.Response.conditional_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>The conditional_etag keyword argument for Response will allow the
conditional match value of a If-Match request to be compared to a
non-standard value.</p>
<p>This is available for Storage Policies that do not store the client
object data verbatim on the storage nodes, but still need support
conditional requests.</p>
<p>It&#8217;s most effectively used with X-Backend-Etag-Is-At which would
define the additional Metadata key(s) where the original ETag of the
clear-form client request data may be found.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.content_length">
<code class="descname">content_length</code><a class="headerlink" href="#swift.common.swob.Response.content_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the content-length header as an int</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.content_range">
<code class="descname">content_range</code><a class="headerlink" href="#swift.common.swob.Response.content_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the content-range header</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.content_type">
<code class="descname">content_type</code><a class="headerlink" href="#swift.common.swob.Response.content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the response Content-Type header</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.etag">
<code class="descname">etag</code><a class="headerlink" href="#swift.common.swob.Response.etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the response Etag header</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Response.fix_conditional_response">
<code class="descname">fix_conditional_response</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Response.fix_conditional_response" title="Permalink to this definition">¶</a></dt>
<dd><p>You may call this once you have set the content_length to the whole
object length and body or app_iter to reset the content_length
properties on the request.</p>
<p>It is ok to not call this method, the conditional response will be
maintained for you when you __call__ the response.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.host_url">
<code class="descname">host_url</code><a class="headerlink" href="#swift.common.swob.Response.host_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Get url for request/response up to path</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.last_modified">
<code class="descname">last_modified</code><a class="headerlink" href="#swift.common.swob.Response.last_modified" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the last-modified header as a datetime, set it with a datetime, int, or str</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.location">
<code class="descname">location</code><a class="headerlink" href="#swift.common.swob.Response.location" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the location header</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.swob.Response.status">
<code class="descname">status</code><a class="headerlink" href="#swift.common.swob.Response.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve and set the Response status, e.g. &#8216;200 OK&#8217;</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.swob.Response.www_authenticate">
<code class="descname">www_authenticate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.Response.www_authenticate" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a suitable value for WWW-Authenticate response header</p>
<p>If we have a request and a valid-looking path, the realm
is the account; otherwise we set it to &#8216;unknown&#8217;.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.swob.StatusMap">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">StatusMap</code><a class="headerlink" href="#swift.common.swob.StatusMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A dict-like object that returns HTTPException subclasses/factory functions
where the given key is the status code.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.swob.WsgiBytesIO">
<em class="property">class </em><code class="descclassname">swift.common.swob.</code><code class="descname">WsgiBytesIO</code><span class="sig-paren">(</span><em>buf=''</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.WsgiBytesIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">StringIO.StringIO</span></code></p>
<p>This class adds support for the additional wsgi.input methods defined on
eventlet.wsgi.Input to the BytesIO class which would otherwise be a fine
stand-in for the file-like object in the WSGI environment.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.swob.wsgify">
<code class="descclassname">swift.common.swob.</code><code class="descname">wsgify</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.swob.wsgify" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator for translating functions which take a swob Request object and
return a Response object into WSGI callables.  Also catches any raised
HTTPExceptions and treats them as a returned Response.</p>
</dd></dl>

</div>
<div class="section" id="utils">
<span id="id10"></span><h2>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.utils"></span><p>Miscellaneous utility functions for use with Swift.</p>
<dl class="class">
<dt id="swift.common.utils.CloseableChain">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">CloseableChain</code><span class="sig-paren">(</span><em>*iterables</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.CloseableChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Like itertools.chain, but with a close method that will attempt to invoke
its sub-iterators&#8217; close methods, if any.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.ContextPool">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">ContextPool</code><span class="sig-paren">(</span><em>size=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.ContextPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.greenpool.GreenPool</span></code></p>
<p>GreenPool subclassed to kill its coros when it gets gc&#8217;ed</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.GreenAsyncPile">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">GreenAsyncPile</code><span class="sig-paren">(</span><em>size_or_pool</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.GreenAsyncPile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Runs jobs in a pool of green threads, and the results can be retrieved by
using this object as an iterator.</p>
<p>This is very similar in principle to eventlet.GreenPile, except it returns
results as they become available rather than in the order they were
launched.</p>
<p>Correlating results with jobs (if necessary) is left to the caller.</p>
<dl class="method">
<dt id="swift.common.utils.GreenAsyncPile.spawn">
<code class="descname">spawn</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.GreenAsyncPile.spawn" title="Permalink to this definition">¶</a></dt>
<dd><p>Spawn a job in a green thread on the pile.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.GreenAsyncPile.waitall">
<code class="descname">waitall</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.GreenAsyncPile.waitall" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait timeout seconds for any results to come in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> &#8211; seconds to wait for results</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of results accrued in that time</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.GreenAsyncPile.waitfirst">
<code class="descname">waitfirst</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.GreenAsyncPile.waitfirst" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait up to timeout seconds for first result to come in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timeout</strong> &#8211; seconds to wait for results</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">first item to come back, or None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.utils.GreenthreadSafeIterator">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">GreenthreadSafeIterator</code><span class="sig-paren">(</span><em>unsafe_iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.GreenthreadSafeIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrap an iterator to ensure that only one greenthread is inside its next()
method at a time.</p>
<p>This is useful if an iterator&#8217;s next() method may perform network IO, as
that may trigger a greenthread context switch (aka trampoline), which can
give another greenthread a chance to call next(). At that point, you get
an error like &#8220;ValueError: generator already executing&#8221;. By wrapping calls
to next() with a mutex, we avoid that error.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.InputProxy">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">InputProxy</code><span class="sig-paren">(</span><em>wsgi_input</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.InputProxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>File-like object that counts bytes read.
To be swapped in for wsgi.input for accounting purposes.</p>
<dl class="method">
<dt id="swift.common.utils.InputProxy.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.InputProxy.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass read request to the underlying file-like object and
add bytes read to total.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.InputProxy.readline">
<code class="descname">readline</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.InputProxy.readline" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass readline request to the underlying file-like object and
add bytes read to total.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.utils.LRUCache">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">LRUCache</code><span class="sig-paren">(</span><em>maxsize=1000</em>, <em>maxtime=3600</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LRUCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Decorator for size/time bound memoization that evicts the least
recently used members.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.LogAdapter">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">LogAdapter</code><span class="sig-paren">(</span><em>logger</em>, <em>server</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LogAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">logging.LoggerAdapter</span></code>, <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A Logger like object which performs some reformatting on calls to
<code class="xref py py-meth docutils literal"><span class="pre">exception()</span></code>.  Can be used to store a threadlocal transaction id and
client ip.</p>
<dl class="method">
<dt id="swift.common.utils.LogAdapter.notice">
<code class="descname">notice</code><span class="sig-paren">(</span><em>msg</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LogAdapter.notice" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for syslog priority LOG_NOTICE. The python
logging lvl is set to 25, just above info.  SysLogHandler is
monkey patched to map this log lvl to the LOG_NOTICE syslog
priority.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.LogAdapter.process">
<code class="descname">process</code><span class="sig-paren">(</span><em>msg</em>, <em>kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LogAdapter.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Add extra info to message</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.LogAdapter.set_statsd_prefix">
<code class="descname">set_statsd_prefix</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LogAdapter.set_statsd_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>The StatsD client prefix defaults to the &#8220;name&#8221; of the logger.  This
method may override that default with a specific value.  Currently used
in the proxy-server to differentiate the Account, Container, and Object
controllers.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.utils.LogAdapter.statsd_delegate">
<code class="descname">statsd_delegate</code><span class="sig-paren">(</span><em>statsd_func_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.LogAdapter.statsd_delegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory to create methods which delegate to methods on
self.logger.statsd_client (an instance of StatsdClient).  The
created methods conditionally delegate to a method whose name is given
in &#8216;statsd_func_name&#8217;.  The created delegate methods are a no-op when
StatsD logging is not configured.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>statsd_func_name</strong> &#8211; the name of a method on StatsdClient.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.utils.ModifiedParseResult">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">ModifiedParseResult</code><a class="headerlink" href="#swift.common.utils.ModifiedParseResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">urlparse.ParseResult</span></code></p>
<p>Parse results class for urlparse.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.NR_ioprio_set">
<code class="descclassname">swift.common.utils.</code><code class="descname">NR_ioprio_set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.NR_ioprio_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Give __NR_ioprio_set value for your system.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.NullLogger">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">NullLogger</code><a class="headerlink" href="#swift.common.utils.NullLogger" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A no-op logger for eventlet wsgi.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.RateLimitedIterator">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">RateLimitedIterator</code><span class="sig-paren">(</span><em>iterable</em>, <em>elements_per_second</em>, <em>limit_after=0</em>, <em>ratelimit_if=&lt;function &lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.RateLimitedIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrap an iterator to only yield elements at a rate of N per second.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iterable</strong> &#8211; iterable to wrap</li>
<li><strong>elements_per_second</strong> &#8211; the rate at which to yield elements</li>
<li><strong>limit_after</strong> &#8211; rate limiting kicks in only after yielding
this many elements; default is 0 (rate limit
immediately)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.Spliterator">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">Spliterator</code><span class="sig-paren">(</span><em>source_iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.Spliterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Takes an iterator yielding sliceable things (e.g. strings or lists) and
yields subiterators, each yielding up to the requested number of items
from the source.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">si</span> <span class="o">=</span> <span class="n">Spliterator</span><span class="p">([</span><span class="s2">&quot;abcde&quot;</span><span class="p">,</span> <span class="s2">&quot;fg&quot;</span><span class="p">,</span> <span class="s2">&quot;hijkl&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">&quot;abcd&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">&quot;efg&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&quot;h&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">&quot;ijk&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">&quot;l&quot;  # shorter than requested; this can happen with the last iterator</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.StreamingPile">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">StreamingPile</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.StreamingPile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.utils.GreenAsyncPile" title="swift.common.utils.GreenAsyncPile"><code class="xref py py-class docutils literal"><span class="pre">swift.common.utils.GreenAsyncPile</span></code></a></p>
<p>Runs jobs in a pool of green threads, spawning more jobs as results are
retrieved and worker threads become available.</p>
<p>When used as a context manager, has the same worker-killing properties as
<a class="reference internal" href="#swift.common.utils.ContextPool" title="swift.common.utils.ContextPool"><code class="xref py py-class docutils literal"><span class="pre">ContextPool</span></code></a>.</p>
<dl class="method">
<dt id="swift.common.utils.StreamingPile.asyncstarmap">
<code class="descname">asyncstarmap</code><span class="sig-paren">(</span><em>func</em>, <em>args_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.StreamingPile.asyncstarmap" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the same as <code class="xref py py-func docutils literal"><span class="pre">itertools.starmap()</span></code>, except that <em>func</em> is
executed in a separate green thread for each item, and results won&#8217;t
necessarily have the same order as inputs.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.utils.SwiftLogFormatter">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">SwiftLogFormatter</code><span class="sig-paren">(</span><em>fmt=None</em>, <em>datefmt=None</em>, <em>max_line_length=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.SwiftLogFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></code></p>
<p>Custom logging.Formatter will append txn_id to a log message if the
record has one and the message does not. Optionally it can shorten
overly long log lines.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.utils.Timestamp">
<em class="property">class </em><code class="descclassname">swift.common.utils.</code><code class="descname">Timestamp</code><span class="sig-paren">(</span><em>timestamp</em>, <em>offset=0</em>, <em>delta=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.Timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Internal Representation of Swift Time.</p>
<p>The normalized form of the X-Timestamp header looks like a float
with a fixed width to ensure stable string sorting - normalized
timestamps look like &#8220;1402464677.04188&#8221;</p>
<p>To support overwrites of existing data without modifying the original
timestamp but still maintain consistency a second internal offset vector
is append to the normalized timestamp form which compares and sorts
greater than the fixed width float format but less than a newer timestamp.
The internalized format of timestamps looks like
&#8220;1402464677.04188_0000000000000000&#8221; - the portion after the underscore is
the offset and is a formatted hexadecimal integer.</p>
<p>The internalized form is not exposed to clients in responses from
Swift.  Normal client operations will not create a timestamp with an
offset.</p>
<p>The Timestamp class in common.utils supports internalized and
normalized formatting of timestamps and also comparison of timestamp
values.  When the offset value of a Timestamp is 0 - it&#8217;s considered
insignificant and need not be represented in the string format; to
support backwards compatibility during a Swift upgrade the
internalized and normalized form of a Timestamp with an
insignificant offset are identical.  When a timestamp includes an
offset it will always be represented in the internalized form, but
is still excluded from the normalized form.  Timestamps with an
equivalent timestamp portion (the float part) will compare and order
by their offset.  Timestamps with a greater timestamp portion will
always compare and order greater than a Timestamp with a lesser
timestamp regardless of it&#8217;s offset.  String comparison and ordering
is guaranteed for the internalized string format, and is backwards
compatible for normalized timestamps which do not include an offset.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.affinity_key_function">
<code class="descclassname">swift.common.utils.</code><code class="descname">affinity_key_function</code><span class="sig-paren">(</span><em>affinity_str</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.affinity_key_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns an affinity config value into a function suitable for passing to
sort(). After doing so, the array will be sorted with respect to the given
ordering.</p>
<p>For example, if affinity_str is &#8220;r1=1, r2z7=2, r2z8=2&#8221;, then the array
will be sorted with all nodes from region 1 (r1=1) first, then all the
nodes from region 2 zones 7 and 8 (r2z7=2 and r2z8=2), then everything
else.</p>
<p>Note that the order of the pieces of affinity_str is irrelevant; the
priority values are what comes after the equals sign.</p>
<p>If affinity_str is empty or all whitespace, then the resulting function
will not alter the ordering of the nodes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>affinity_str</strong> &#8211; affinity config value, e.g. &#8220;r1z2=3&#8221;
or &#8220;r1=1, r2z1=2, r2z2=2&#8221;</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">single-argument function</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">ValueError if argument invalid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.affinity_locality_predicate">
<code class="descclassname">swift.common.utils.</code><code class="descname">affinity_locality_predicate</code><span class="sig-paren">(</span><em>write_affinity_str</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.affinity_locality_predicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns a write-affinity config value into a predicate function for nodes.
The returned value will be a 1-arg function that takes a node dictionary
and returns a true value if it is &#8220;local&#8221; and a false value otherwise. The
definition of &#8220;local&#8221; comes from the affinity_str argument passed in here.</p>
<p>For example, if affinity_str is &#8220;r1, r2z2&#8221;, then only nodes where region=1
or where (region=2 and zone=2) are considered local.</p>
<p>If affinity_str is empty or all whitespace, then the resulting function
will consider everything local</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>affinity_str</strong> &#8211; affinity config value, e.g. &#8220;r1z2&#8221;
or &#8220;r1, r2z1, r2z2&#8221;</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">single-argument function, or None if affinity_str is empty</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">ValueError if argument invalid</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.audit_location_generator">
<code class="descclassname">swift.common.utils.</code><code class="descname">audit_location_generator</code><span class="sig-paren">(</span><em>devices</em>, <em>datadir</em>, <em>suffix=''</em>, <em>mount_check=True</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.audit_location_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a devices path and a data directory, yield (path, device,
partition) for all files in that directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>devices</strong> &#8211; parent directory of the devices to be audited</li>
<li><strong>datadir</strong> &#8211; a directory located under self.devices. This should be
one of the DATADIR constants defined in the account,
container, and object servers.</li>
<li><strong>suffix</strong> &#8211; path name suffix required for all names returned</li>
<li><strong>mount_check</strong> &#8211; Flag to check if a mount check should be performed
on devices</li>
<li><strong>logger</strong> &#8211; a logger object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.backward">
<code class="descclassname">swift.common.utils.</code><code class="descname">backward</code><span class="sig-paren">(</span><em>f</em>, <em>blocksize=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>A generator returning lines from a file starting with the last line,
then the second last line, etc. i.e., it reads lines backwards.
Stops when the first line (if any) is read.
This is useful when searching for recent activity in very
large files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>f</strong> &#8211; file object to read</li>
<li><strong>blocksize</strong> &#8211; no of characters to go backwards at each block</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.cache_from_env">
<code class="descclassname">swift.common.utils.</code><code class="descname">cache_from_env</code><span class="sig-paren">(</span><em>env</em>, <em>allow_none=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.cache_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Get memcache connection pool from the environment (which had been
previously set by the memcache middleware</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>env</strong> &#8211; wsgi environment dict</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">swift.common.memcached.MemcacheRing from environment</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.capture_stdio">
<code class="descclassname">swift.common.utils.</code><code class="descname">capture_stdio</code><span class="sig-paren">(</span><em>logger</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.capture_stdio" title="Permalink to this definition">¶</a></dt>
<dd><p>Log unhandled exceptions, close stdio, capture stdout and stderr.</p>
<p>param logger: Logger object to use</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.closing_if_possible">
<code class="descclassname">swift.common.utils.</code><code class="descname">closing_if_possible</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.closing_if_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Like contextlib.closing(), but doesn&#8217;t crash if the object lacks a close()
method.</p>
<p>PEP 333 (WSGI) says: &#8220;If the iterable returned by the application has a
close() method, the server or gateway must call that method upon
completion of the current request[.]&#8221; This function makes that easier.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.compute_eta">
<code class="descclassname">swift.common.utils.</code><code class="descname">compute_eta</code><span class="sig-paren">(</span><em>start_time</em>, <em>current_value</em>, <em>final_value</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.compute_eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an ETA.  Now only if we could also have a progress bar...</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_time</strong> &#8211; Unix timestamp when the operation began</li>
<li><strong>current_value</strong> &#8211; Current value</li>
<li><strong>final_value</strong> &#8211; Final value</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">ETA as a tuple of (length of time, unit of time) where unit of
time is one of (&#8216;h&#8217;, &#8216;m&#8217;, &#8216;s&#8217;)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.config_auto_int_value">
<code class="descclassname">swift.common.utils.</code><code class="descname">config_auto_int_value</code><span class="sig-paren">(</span><em>value</em>, <em>default</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.config_auto_int_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns default if value is None or &#8216;auto&#8217;.
Returns value as an int or raises ValueError otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.config_fallocate_value">
<code class="descclassname">swift.common.utils.</code><code class="descname">config_fallocate_value</code><span class="sig-paren">(</span><em>reserve_value</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.config_fallocate_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns fallocate reserve_value as an int or float.
Returns is_percent as a boolean.
Returns a ValueError on invalid fallocate value.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.config_read_prefixed_options">
<code class="descclassname">swift.common.utils.</code><code class="descname">config_read_prefixed_options</code><span class="sig-paren">(</span><em>conf</em>, <em>prefix_name</em>, <em>defaults</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.config_read_prefixed_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Read prefixed options from configuration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf</strong> &#8211; the configuration</li>
<li><strong>prefix_name</strong> &#8211; the prefix (including, if needed, an underscore)</li>
<li><strong>defaults</strong> &#8211; a dict of default values. The dict supplies the
option name and type (string or comma separated string)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a dict containing the options</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.config_read_reseller_options">
<code class="descclassname">swift.common.utils.</code><code class="descname">config_read_reseller_options</code><span class="sig-paren">(</span><em>conf</em>, <em>defaults</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.config_read_reseller_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Read reseller_prefix option and associated options from configuration</p>
<p>Reads the reseller_prefix option, then reads options that may be
associated with a specific reseller prefix. Reads options such that an
option without a prefix applies to all reseller prefixes unless an option
has an explicit prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf</strong> &#8211; the configuration</li>
<li><strong>defaults</strong> &#8211; a dict of default values. The key is the option
name. The value is either an array of strings or a string</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple of an array of reseller prefixes and a dict of option values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.config_true_value">
<code class="descclassname">swift.common.utils.</code><code class="descname">config_true_value</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.config_true_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the value is either True or a string in TRUE_VALUES.
Returns False otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.csv_append">
<code class="descclassname">swift.common.utils.</code><code class="descname">csv_append</code><span class="sig-paren">(</span><em>csv_string</em>, <em>item</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.csv_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends an item to a comma-separated string.</p>
<p>If the comma-separated string is empty/None, just returns item.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.decode_timestamps">
<code class="descclassname">swift.common.utils.</code><code class="descname">decode_timestamps</code><span class="sig-paren">(</span><em>encoded</em>, <em>explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.decode_timestamps" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a string of the form generated by encode_timestamps and returns
a tuple of the three component timestamps. If explicit is False, component
timestamps that are not explicitly encoded will be assumed to have zero
delta from the previous component and therefore take the value of the
previous component. If explicit is True, component timestamps that are
not explicitly encoded will be returned with value None.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.document_iters_to_http_response_body">
<code class="descclassname">swift.common.utils.</code><code class="descname">document_iters_to_http_response_body</code><span class="sig-paren">(</span><em>ranges_iter</em>, <em>boundary</em>, <em>multipart</em>, <em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.document_iters_to_http_response_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an iterator of range iters and turns it into an appropriate
HTTP response body, whether that&#8217;s multipart/byteranges or not.</p>
<p>This is almost, but not quite, the inverse of
request_helpers.http_response_to_document_iters(). This function only
yields chunks of the body, not any headers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ranges_iter</strong> &#8211; <p>an iterator of dictionaries, one per range.
Each dictionary must contain at least the following key:
&#8220;part_iter&#8221;: iterator yielding the bytes in the range</p>
<p>Additionally, if multipart is True, then the following other keys
are required:</p>
<p>&#8220;start_byte&#8221;: index of the first byte in the range
&#8220;end_byte&#8221;: index of the last byte in the range
&#8220;content_type&#8221;: value for the range&#8217;s Content-Type header</p>
<dl class="docutils">
<dt>Finally, there is one optional key that is used in the</dt>
<dd>multipart/byteranges case:</dd>
<dt>&#8220;entity_length&#8221;: length of the requested entity (not necessarily</dt>
<dd>equal to the response length). If omitted, &#8220;*&#8221; will be used.</dd>
</dl>
<p>Each part_iter will be exhausted prior to calling next(ranges_iter).</p>
</li>
<li><strong>boundary</strong> &#8211; MIME boundary to use, sans dashes (e.g. &#8220;boundary&#8221;, not
&#8220;&#8211;boundary&#8221;).</li>
<li><strong>multipart</strong> &#8211; True if the response should be multipart/byteranges,
False otherwise. This should be True if and only if you have 2 or
more ranges.</li>
<li><strong>logger</strong> &#8211; a logger</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.document_iters_to_multipart_byteranges">
<code class="descclassname">swift.common.utils.</code><code class="descname">document_iters_to_multipart_byteranges</code><span class="sig-paren">(</span><em>ranges_iter</em>, <em>boundary</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.document_iters_to_multipart_byteranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an iterator of range iters and yields a multipart/byteranges MIME
document suitable for sending as the body of a multi-range 206 response.</p>
<p>See document_iters_to_http_response_body for parameter descriptions.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.drop_buffer_cache">
<code class="descclassname">swift.common.utils.</code><code class="descname">drop_buffer_cache</code><span class="sig-paren">(</span><em>fd</em>, <em>offset</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.drop_buffer_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop &#8216;buffer&#8217; cache for the given range of the given file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> &#8211; file descriptor</li>
<li><strong>offset</strong> &#8211; start offset</li>
<li><strong>length</strong> &#8211; length</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.drop_privileges">
<code class="descclassname">swift.common.utils.</code><code class="descname">drop_privileges</code><span class="sig-paren">(</span><em>user</em>, <em>call_setsid=True</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.drop_privileges" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the userid/groupid of the current process, get session leader, etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>user</strong> &#8211; User name to change privileges to</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.dump_recon_cache">
<code class="descclassname">swift.common.utils.</code><code class="descname">dump_recon_cache</code><span class="sig-paren">(</span><em>cache_dict</em>, <em>cache_file</em>, <em>logger</em>, <em>lock_timeout=2</em>, <em>set_owner=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.dump_recon_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update recon cache values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cache_dict</strong> &#8211; Dictionary of cache key/value pairs to write out</li>
<li><strong>cache_file</strong> &#8211; cache file to update</li>
<li><strong>logger</strong> &#8211; the logger to use to log an encountered error</li>
<li><strong>lock_timeout</strong> &#8211; timeout (in seconds)</li>
<li><strong>set_owner</strong> &#8211; Set owner of recon cache file</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.encode_timestamps">
<code class="descclassname">swift.common.utils.</code><code class="descname">encode_timestamps</code><span class="sig-paren">(</span><em>t1</em>, <em>t2=None</em>, <em>t3=None</em>, <em>explicit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.encode_timestamps" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode up to three timestamps into a string. Unlike a Timestamp object, the
encoded string does NOT used fixed width fields and consequently no
relative chronology of the timestamps can be inferred from lexicographic
sorting of encoded timestamp strings.</p>
<dl class="docutils">
<dt>The format of the encoded string is:</dt>
<dd>&lt;t1&gt;[&lt;+/-&gt;&lt;t2 - t1&gt;[&lt;+/-&gt;&lt;t3 - t2&gt;]]</dd>
</dl>
<p>i.e. if t1 = t2 = t3 then just the string representation of t1 is returned,
otherwise the time offsets for t2 and t3 are appended. If explicit is True
then the offsets for t2 and t3 are always appended even if zero.</p>
<p>Note: any offset value in t1 will be preserved, but offsets on t2 and t3
are not preserved. In the anticipated use cases for this method (and the
inverse decode_timestamps method) the timestamps passed as t2 and t3 are
not expected to have offsets as they will be timestamps associated with a
POST request. In the case where the encoding is used in a container objects
table row, t1 could be the PUT or DELETE time but t2 and t3 represent the
content type and metadata times (if different from the data file) i.e.
correspond to POST timestamps. In the case where the encoded form is used
in a .meta file name, t1 and t2 both correspond to POST timestamps.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.expand_ipv6">
<code class="descclassname">swift.common.utils.</code><code class="descname">expand_ipv6</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.expand_ipv6" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand ipv6 address.
:param address: a string indicating valid ipv6 address
:returns: a string indicating fully expanded ipv6 address</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.extract_swift_bytes">
<code class="descclassname">swift.common.utils.</code><code class="descname">extract_swift_bytes</code><span class="sig-paren">(</span><em>content_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.extract_swift_bytes" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Parse a content-type and return a tuple containing:</dt>
<dd><ul class="first last simple">
<li>the content_type string minus any swift_bytes param,</li>
<li>the swift_bytes value or None if the param was not found</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>content_type</strong> &#8211; a content-type string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a tuple of (content-type, swift_bytes or None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.fallocate">
<code class="descclassname">swift.common.utils.</code><code class="descname">fallocate</code><span class="sig-paren">(</span><em>fd</em>, <em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.fallocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pre-allocate disk space for a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> &#8211; file descriptor</li>
<li><strong>size</strong> &#8211; size to allocate (in bytes)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.fdatasync">
<code class="descclassname">swift.common.utils.</code><code class="descname">fdatasync</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.fdatasync" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync modified file data to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fd</strong> &#8211; file descriptor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.fsync">
<code class="descclassname">swift.common.utils.</code><code class="descname">fsync</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.fsync" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync modified file data and metadata to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fd</strong> &#8211; file descriptor</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.fsync_dir">
<code class="descclassname">swift.common.utils.</code><code class="descname">fsync_dir</code><span class="sig-paren">(</span><em>dirpath</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.fsync_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Sync directory entries to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dirpath</strong> &#8211; Path to the directory to be synced.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_expirer_container">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_expirer_container</code><span class="sig-paren">(</span><em>x_delete_at</em>, <em>expirer_divisor</em>, <em>acc</em>, <em>cont</em>, <em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_expirer_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a expiring object container name for given X-Delete-At and
a/c/o.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_hmac">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_hmac</code><span class="sig-paren">(</span><em>request_method</em>, <em>path</em>, <em>expires</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_hmac" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hexdigest string of the HMAC-SHA1 (RFC 2104) for
the request.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>request_method</strong> &#8211; Request method to allow.</li>
<li><strong>path</strong> &#8211; The path to the resource to allow access to.</li>
<li><strong>expires</strong> &#8211; Unix timestamp as an int for when the URL
expires.</li>
<li><strong>key</strong> &#8211; HMAC shared secret.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">hexdigest str of the HMAC-SHA1 for the request.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_hub">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_hub</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_hub" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether poll is available and falls back
on select if it isn&#8217;t.</p>
<p>Note about epoll:</p>
<p>Review: <a class="reference external" href="https://review.openstack.org/#/c/18806/">https://review.openstack.org/#/c/18806/</a></p>
<p>There was a problem where once out of every 30 quadrillion
connections, a coroutine wouldn&#8217;t wake up when the client
closed its end. Epoll was not reporting the event or it was
getting swallowed somewhere. Then when that file descriptor
was re-used, eventlet would freak right out because it still
thought it was waiting for activity from it in some other coro.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_log_line">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_log_line</code><span class="sig-paren">(</span><em>req</em>, <em>res</em>, <em>trans_time</em>, <em>additional_info</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_log_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a line for logging that matches the documented log line format
for backend servers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; the request.</li>
<li><strong>res</strong> &#8211; the response.</li>
<li><strong>trans_time</strong> &#8211; the time the request took to complete, a float.</li>
<li><strong>additional_info</strong> &#8211; a string to log at the end of the line</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a properly formatted line for logging.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_logger">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_logger</code><span class="sig-paren">(</span><em>conf</em>, <em>name=None</em>, <em>log_to_console=False</em>, <em>log_route=None</em>, <em>fmt='%(server)s: %(message)s'</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current system logger using config settings.</p>
<p><strong>Log config and defaults</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>log_facility = LOG_LOCAL0
log_level = INFO
log_name = swift
log_max_line_length = 0
log_udp_host = (disabled)
log_udp_port = logging.handlers.SYSLOG_UDP_PORT
log_address = /dev/log
log_statsd_host = (disabled)
log_statsd_port = 8125
log_statsd_default_sample_rate = 1.0
log_statsd_sample_rate_factor = 1.0
log_statsd_metric_prefix = (empty-string)
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conf</strong> &#8211; Configuration dict to read settings from</li>
<li><strong>name</strong> &#8211; Name of the logger</li>
<li><strong>log_to_console</strong> &#8211; Add handler which writes to console on stderr</li>
<li><strong>log_route</strong> &#8211; Route for the logging, not emitted to the log, just used
to separate logging configurations</li>
<li><strong>fmt</strong> &#8211; Override log format</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_md5_socket">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_md5_socket</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_md5_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an MD5 socket file descriptor. One can MD5 data with it by writing it
to the socket with os.write, then os.read the 16 bytes of the checksum out
later.</p>
<p>NOTE: It is the caller&#8217;s responsibility to ensure that os.close() is
called on the returned file descriptor. This is a bare file descriptor,
not a Python object. It doesn&#8217;t close itself.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_policy_index">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_policy_index</code><span class="sig-paren">(</span><em>req_headers</em>, <em>res_headers</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the appropriate index of the storage policy for the request from
a proxy server</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; dict of the request headers.</li>
<li><strong>res</strong> &#8211; dict of the response headers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">string index of storage policy, or None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_swift_info">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_swift_info</code><span class="sig-paren">(</span><em>admin=False</em>, <em>disallowed_sections=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_swift_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns information about the swift cluster that has been previously
registered with the register_swift_info call.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>admin</strong> &#8211; boolean value, if True will additionally return an &#8216;admin&#8217;
section with information previously registered as admin
info.</li>
<li><strong>disallowed_sections</strong> &#8211; list of section names to be withheld from the
information returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dictionary of information about the swift cluster.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_time_units">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_time_units</code><span class="sig-paren">(</span><em>time_amount</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_time_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a nomralized length of time in the largest unit of time (hours,
minutes, or seconds.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time_amount</strong> &#8211; length of time in seconds</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A touple of (length of time, unit of time) where unit of time is
one of (&#8216;h&#8217;, &#8216;m&#8217;, &#8216;s&#8217;)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.get_valid_utf8_str">
<code class="descclassname">swift.common.utils.</code><code class="descname">get_valid_utf8_str</code><span class="sig-paren">(</span><em>str_or_unicode</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.get_valid_utf8_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Get valid parts of utf-8 str from str, unicode and even invalid utf-8 str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>str_or_unicode</strong> &#8211; a string or an unicode which can be invalid utf-8</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.hash_path">
<code class="descclassname">swift.common.utils.</code><code class="descname">hash_path</code><span class="sig-paren">(</span><em>account</em>, <em>container=None</em>, <em>object=None</em>, <em>raw_digest=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.hash_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the canonical hash for an account/container/object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>account</strong> &#8211; Account</li>
<li><strong>container</strong> &#8211; Container</li>
<li><strong>object</strong> &#8211; Object</li>
<li><strong>raw_digest</strong> &#8211; If True, return the raw version rather than a hex digest</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">hash string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.human_readable">
<code class="descclassname">swift.common.utils.</code><code class="descname">human_readable</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.human_readable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number in a human readable format; for example 1048576 = &#8220;1Mi&#8221;.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.is_valid_ip">
<code class="descclassname">swift.common.utils.</code><code class="descname">is_valid_ip</code><span class="sig-paren">(</span><em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.is_valid_ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the provided ip is a valid IP-address</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.is_valid_ipv4">
<code class="descclassname">swift.common.utils.</code><code class="descname">is_valid_ipv4</code><span class="sig-paren">(</span><em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.is_valid_ipv4" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the provided ip is a valid IPv4-address</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.is_valid_ipv6">
<code class="descclassname">swift.common.utils.</code><code class="descname">is_valid_ipv6</code><span class="sig-paren">(</span><em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.is_valid_ipv6" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the provided ip is a valid IPv6-address</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.ismount">
<code class="descclassname">swift.common.utils.</code><code class="descname">ismount</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.ismount" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether a path is a mount point. This will catch any
exceptions and translate them into a False return value
Use ismount_raw to have the exceptions raised instead.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.ismount_raw">
<code class="descclassname">swift.common.utils.</code><code class="descname">ismount_raw</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.ismount_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether a path is a mount point. Whereas ismount will catch
any exceptions and just return False, this raw version will not
catch exceptions.</p>
<p>This is code hijacked from C Python 2.6.8, adapted to remove the extra
lstat() system call.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.item_from_env">
<code class="descclassname">swift.common.utils.</code><code class="descname">item_from_env</code><span class="sig-paren">(</span><em>env</em>, <em>item_name</em>, <em>allow_none=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.item_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value from the wsgi environment</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env</strong> &#8211; wsgi environment dict</li>
<li><strong>item_name</strong> &#8211; name of item to get</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the value from the environment</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.iter_multipart_mime_documents">
<code class="descclassname">swift.common.utils.</code><code class="descname">iter_multipart_mime_documents</code><span class="sig-paren">(</span><em>wsgi_input</em>, <em>boundary</em>, <em>read_chunk_size=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.iter_multipart_mime_documents" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a multi-part-mime-encoded input file object and boundary,
yield file-like objects for each part. Note that this does not
split each part into headers and body; the caller is responsible
for doing that if necessary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wsgi_input</strong> &#8211; The file-like object to read from.</li>
<li><strong>boundary</strong> &#8211; The mime boundary to separate new file-like
objects on.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A generator of file-like objects for each part.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">MimeInvalid if the document is malformed</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.last_modified_date_to_timestamp">
<code class="descclassname">swift.common.utils.</code><code class="descname">last_modified_date_to_timestamp</code><span class="sig-paren">(</span><em>last_modified_date_str</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.last_modified_date_to_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a last modified date (like you&#8217;d get from a container listing,
e.g. 2014-02-28T23:22:36.698390) to a float.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.link_fd_to_path">
<code class="descclassname">swift.common.utils.</code><code class="descname">link_fd_to_path</code><span class="sig-paren">(</span><em>fd</em>, <em>target_path</em>, <em>dirs_created=0</em>, <em>retries=2</em>, <em>fsync=True</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.link_fd_to_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a link to file descriptor at target_path specified. This method
does not close the fd for you. Unlike rename, as linkat() cannot
overwrite target_path if it exists, we unlink and try again.</p>
<p>Attempts to fix / hide race conditions like empty object directories
being removed by backend processes during uploads, by retrying.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fd</strong> &#8211; File descriptor to be linked</li>
<li><strong>target_path</strong> &#8211; Path in filesystem where fd is to be linked</li>
<li><strong>dirs_created</strong> &#8211; Number of newly created directories that needs to
be fsync&#8217;d.</li>
<li><strong>retries</strong> &#8211; number of retries to make</li>
<li><strong>fsync</strong> &#8211; fsync on containing directory of target_path and also all
the newly created directories.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.list_from_csv">
<code class="descclassname">swift.common.utils.</code><code class="descname">list_from_csv</code><span class="sig-paren">(</span><em>comma_separated_str</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.list_from_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the str given and returns a properly stripped list of the comma
separated values.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.load_libc_function">
<code class="descclassname">swift.common.utils.</code><code class="descname">load_libc_function</code><span class="sig-paren">(</span><em>func_name</em>, <em>log_error=True</em>, <em>fail_if_missing=False</em>, <em>errcheck=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.load_libc_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to find the function in libc, otherwise return a no-op func.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func_name</strong> &#8211; name of the function to pull from libc.</li>
<li><strong>log_error</strong> &#8211; log an error when a function can&#8217;t be found</li>
<li><strong>fail_if_missing</strong> &#8211; raise an exception when a function can&#8217;t be found.
Default behavior is to return a no-op function.</li>
<li><strong>errcheck</strong> &#8211; boolean, if true install a wrapper on the function
to check for a return values of -1 and call
ctype.get_errno and raise an OSError</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.lock_file">
<code class="descclassname">swift.common.utils.</code><code class="descname">lock_file</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.lock_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager that acquires a lock on a file.  This will block until
the lock can be acquired, or the timeout time has expired (whichever occurs
first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; file to be locked</li>
<li><strong>timeout</strong> &#8211; timeout (in seconds)</li>
<li><strong>append</strong> &#8211; True if file should be opened in append mode</li>
<li><strong>unlink</strong> &#8211; True if the file should be unlinked at the end</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.lock_parent_directory">
<code class="descclassname">swift.common.utils.</code><code class="descname">lock_parent_directory</code><span class="sig-paren">(</span><em>filename</em>, <em>timeout=10</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.lock_parent_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager that acquires a lock on the parent directory of the given
file path.  This will block until the lock can be acquired, or the timeout
time has expired (whichever occurs first).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; file path of the parent directory to be locked</li>
<li><strong>timeout</strong> &#8211; timeout (in seconds)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.lock_path">
<code class="descclassname">swift.common.utils.</code><code class="descname">lock_path</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.lock_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager that acquires a lock on a directory.  This will block until
the lock can be acquired, or the timeout time has expired (whichever occurs
first).</p>
<p>For locking exclusively, file or directory has to be opened in Write mode.
Python doesn&#8217;t allow directories to be opened in Write Mode. So we
workaround by locking a hidden file in the directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>directory</strong> &#8211; directory to be locked</li>
<li><strong>timeout</strong> &#8211; timeout (in seconds)</li>
<li><strong>timeout_class</strong> &#8211; The class of the exception to raise if the
lock cannot be granted within the timeout. Will be
constructed as timeout_class(timeout, lockpath). Default:
LockTimeout</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.makedirs_count">
<code class="descclassname">swift.common.utils.</code><code class="descname">makedirs_count</code><span class="sig-paren">(</span><em>path</em>, <em>count=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.makedirs_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as os.makedirs() except that this method returns the number of
new directories that had to be created.</p>
<p>Also, this does not raise an error if target directory already exists.
This behaviour is similar to Python 3.x&#8217;s os.makedirs() called with
exist_ok=True. Also similar to swift.common.utils.mkdirs()</p>
<p><a class="reference external" href="https://hg.python.org/cpython/file/v3.4.2/Lib/os.py#l212">https://hg.python.org/cpython/file/v3.4.2/Lib/os.py#l212</a></p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.maybe_multipart_byteranges_to_document_iters">
<code class="descclassname">swift.common.utils.</code><code class="descname">maybe_multipart_byteranges_to_document_iters</code><span class="sig-paren">(</span><em>app_iter</em>, <em>content_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.maybe_multipart_byteranges_to_document_iters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an iterator that may or may not contain a multipart MIME document
as well as content type and returns an iterator of body iterators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>app_iter</strong> &#8211; iterator that may contain a multipart MIME document</li>
<li><strong>content_type</strong> &#8211; content type of the app_iter, used to determine
whether it conains a multipart document and, if
so, what the boundary is between documents</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.md5_hash_for_file">
<code class="descclassname">swift.common.utils.</code><code class="descname">md5_hash_for_file</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.md5_hash_for_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the MD5 checksum of a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> &#8211; path to file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">MD5 checksum, hex encoded</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.mime_to_document_iters">
<code class="descclassname">swift.common.utils.</code><code class="descname">mime_to_document_iters</code><span class="sig-paren">(</span><em>input_file</em>, <em>boundary</em>, <em>read_chunk_size=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.mime_to_document_iters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a file-like object containing a multipart MIME document and
returns an iterator of (headers, body-file) tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_file</strong> &#8211; file-like object with the MIME doc in it</li>
<li><strong>boundary</strong> &#8211; MIME boundary, sans dashes
(e.g. &#8220;divider&#8221;, not &#8220;&#8211;divider&#8221;)</li>
<li><strong>read_chunk_size</strong> &#8211; size of strings read via input_file.read()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.mkdirs">
<code class="descclassname">swift.common.utils.</code><code class="descname">mkdirs</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.mkdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures the path is a directory or makes it if not. Errors if the path
exists but is a file or on permissions failure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; path to create</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.modify_priority">
<code class="descclassname">swift.common.utils.</code><code class="descname">modify_priority</code><span class="sig-paren">(</span><em>conf</em>, <em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.modify_priority" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify priority by nice and ionice.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.multipart_byteranges_to_document_iters">
<code class="descclassname">swift.common.utils.</code><code class="descname">multipart_byteranges_to_document_iters</code><span class="sig-paren">(</span><em>input_file</em>, <em>boundary</em>, <em>read_chunk_size=4096</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.multipart_byteranges_to_document_iters" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a file-like object containing a multipart/byteranges MIME document
(see RFC 7233, Appendix A) and returns an iterator of (first-byte,
last-byte, length, document-headers, body-file) 5-tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_file</strong> &#8211; file-like object with the MIME doc in it</li>
<li><strong>boundary</strong> &#8211; MIME boundary, sans dashes
(e.g. &#8220;divider&#8221;, not &#8220;&#8211;divider&#8221;)</li>
<li><strong>read_chunk_size</strong> &#8211; size of strings read via input_file.read()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.normalize_delete_at_timestamp">
<code class="descclassname">swift.common.utils.</code><code class="descname">normalize_delete_at_timestamp</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.normalize_delete_at_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a timestamp (string or numeric) into a standardized
xxxxxxxxxx (10) format.</p>
<p>Note that timestamps less than 0000000000 are raised to
0000000000 and values greater than November 20th, 2286 at
17:46:39 UTC will be capped at that date and time, resulting in
no return value exceeding 9999999999.</p>
<p>This cap is because the expirer is already working through a
sorted list of strings that were all a length of 10. Adding
another digit would mess up the sort and cause the expirer to
break from processing early. By 2286, this problem will need to
be fixed, probably by creating an additional .expiring_objects
account to work from with 11 (or more) digit container names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamp</strong> &#8211; unix timestamp</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">normalized timestamp as a string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.normalize_timestamp">
<code class="descclassname">swift.common.utils.</code><code class="descname">normalize_timestamp</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.normalize_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a timestamp (string or numeric) into a standardized
xxxxxxxxxx.xxxxx (10.5) format.</p>
<p>Note that timestamps using values greater than or equal to November 20th,
2286 at 17:46 UTC will use 11 digits to represent the number of
seconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamp</strong> &#8211; unix timestamp</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">normalized timestamp as a string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.o_tmpfile_supported">
<code class="descclassname">swift.common.utils.</code><code class="descname">o_tmpfile_supported</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.o_tmpfile_supported" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if O_TMPFILE flag is supported.</p>
<p>O_TMPFILE was introduced in Linux 3.11 but it also requires support from
underlying filesystem being used. Some common filesystems and linux
versions in which those filesystems added support for O_TMPFILE:
xfs (3.15)
ext4 (3.11)
btrfs (3.16)</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.override_bytes_from_content_type">
<code class="descclassname">swift.common.utils.</code><code class="descname">override_bytes_from_content_type</code><span class="sig-paren">(</span><em>listing_dict</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.override_bytes_from_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a dict from a container listing and overrides the content_type,
bytes fields if swift_bytes is set.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.pairs">
<code class="descclassname">swift.common.utils.</code><code class="descname">pairs</code><span class="sig-paren">(</span><em>item_list</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator of all pairs of elements from item_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>items</strong> &#8211; items (no duplicates allowed)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_content_disposition">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_content_disposition</code><span class="sig-paren">(</span><em>header</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_content_disposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the value of a header like:
Content-Disposition: form-data; name=&#8221;somefile&#8221;; filename=&#8221;test.html&#8221;</p>
<p>Return data like
(&#8220;form-data&#8221;, {&#8220;name&#8221;: &#8220;somefile&#8221;, &#8220;filename&#8221;: &#8220;test.html&#8221;})</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>header</strong> &#8211; Value of a header (the part after the &#8216;: &#8216;).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(value name, dict) of the attribute data parsed (see above).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_content_range">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_content_range</code><span class="sig-paren">(</span><em>content_range</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_content_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a content-range header into (first_byte, last_byte, total_size).</p>
<p>See RFC 7233 section 4.2 for details on the header format, but it&#8217;s
basically &#8220;Content-Range: bytes ${start}-${end}/${total}&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>content_range</strong> &#8211; Content-Range header value to parse,
e.g. &#8220;bytes 100-1249/49004&#8221;</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">3-tuple (start, end, total)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">ValueError if malformed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_content_type">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_content_type</code><span class="sig-paren">(</span><em>content_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a content-type and its parameters into values.
RFC 2616 sec 14.17 and 3.7 are pertinent.</p>
<p><strong>Examples</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>&#39;text/plain; charset=UTF-8&#39; -&gt; (&#39;text/plain&#39;, [(&#39;charset, &#39;UTF-8&#39;)])
&#39;text/plain; charset=UTF-8; level=1&#39; -&gt;
    (&#39;text/plain&#39;, [(&#39;charset, &#39;UTF-8&#39;), (&#39;level&#39;, &#39;1&#39;)])
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>content_type</strong> &#8211; content_type to parse</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a tuple containing (content type, list of k, v parameter tuples)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_mime_headers">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_mime_headers</code><span class="sig-paren">(</span><em>doc_file</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_mime_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a file-like object containing a MIME document and returns a
HeaderKeyDict containing the headers. The body of the message is not
consumed: the position in doc_file is left at the beginning of the body.</p>
<p>This function was inspired by the Python standard library&#8217;s
http.client.parse_headers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>doc_file</strong> &#8211; binary file-like object containing a MIME document</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a swift.common.swob.HeaderKeyDict containing the headers</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_options">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_options</code><span class="sig-paren">(</span><em>parser=None</em>, <em>once=False</em>, <em>test_args=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse standard swift server/daemon options with optparse.OptionParser.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>parser</strong> &#8211; OptionParser to use. If not sent one will be created.</li>
<li><strong>once</strong> &#8211; Boolean indicating the &#8220;once&#8221; option is available</li>
<li><strong>test_args</strong> &#8211; Override sys.argv; used in testing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Tuple of (config, options); config is an absolute path to the
config file, options is the parser options as a dictionary.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>SystemExit</strong> &#8211; First arg (CONFIG) is required, file must exist</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.parse_socket_string">
<code class="descclassname">swift.common.utils.</code><code class="descname">parse_socket_string</code><span class="sig-paren">(</span><em>socket_string</em>, <em>default_port</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.parse_socket_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string representing a socket, returns a tuple of (host, port).
Valid strings are DNS names, IPv4 addresses, or IPv6 addresses, with an
optional port. If an IPv6 address is specified it <strong>must</strong> be enclosed in
[], like <em>[::1]</em> or <em>[::1]:11211</em>. This follows the accepted prescription
for <a class="reference external" href="https://tools.ietf.org/html/rfc3986#section-3.2.2">IPv6 host literals</a>.</p>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>server.org
server.org:1337
127.0.0.1:1337
[::1]:1337
[::1]
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.public">
<code class="descclassname">swift.common.utils.</code><code class="descname">public</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.public" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to declare which methods are publicly accessible as HTTP
requests</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> &#8211; function to make public</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.put_recon_cache_entry">
<code class="descclassname">swift.common.utils.</code><code class="descname">put_recon_cache_entry</code><span class="sig-paren">(</span><em>cache_entry</em>, <em>key</em>, <em>item</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.put_recon_cache_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that will check if item is a dict, and if so put it under
cache_entry[key].  We use nested recon cache entries when the object
auditor runs in parallel or else in &#8216;once&#8217; mode with a specified
subset of devices.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.quorum_size">
<code class="descclassname">swift.common.utils.</code><code class="descname">quorum_size</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.quorum_size" title="Permalink to this definition">¶</a></dt>
<dd><p>quorum size as it applies to services that use &#8216;replication&#8217; for data
integrity  (Account/Container services).  Object quorum_size is defined
on a storage policy basis.</p>
<p>Number of successful backend requests needed for the proxy to consider
the client request successful.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.quote">
<code class="descclassname">swift.common.utils.</code><code class="descname">quote</code><span class="sig-paren">(</span><em>value</em>, <em>safe='/'</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.quote" title="Permalink to this definition">¶</a></dt>
<dd><p>Patched version of urllib.quote that encodes utf-8 strings before quoting</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.random">
<code class="descclassname">swift.common.utils.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#swift.common.utils.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="swift.common.utils.ratelimit_sleep">
<code class="descclassname">swift.common.utils.</code><code class="descname">ratelimit_sleep</code><span class="sig-paren">(</span><em>running_time</em>, <em>max_rate</em>, <em>incr_by=1</em>, <em>rate_buffer=5</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.ratelimit_sleep" title="Permalink to this definition">¶</a></dt>
<dd><p>Will eventlet.sleep() for the appropriate time so that the max_rate
is never exceeded.  If max_rate is 0, will not ratelimit.  The
maximum recommended rate should not exceed (1000 * incr_by) a second
as eventlet.sleep() does involve some overhead.  Returns running_time
that should be used for subsequent calls.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>running_time</strong> &#8211; the running time in milliseconds of the next
allowable request. Best to start at zero.</li>
<li><strong>max_rate</strong> &#8211; The maximum rate per second allowed for the process.</li>
<li><strong>incr_by</strong> &#8211; How much to increment the counter.  Useful if you want
to ratelimit 1024 bytes/sec and have differing sizes
of requests. Must be &gt; 0 to engage rate-limiting
behavior.</li>
<li><strong>rate_buffer</strong> &#8211; Number of seconds the rate counter can drop and be
allowed to catch up (at a faster than listed rate).
A larger number will result in larger spikes in rate
but better average accuracy. Must be &gt; 0 to engage
rate-limiting behavior.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.readconf">
<code class="descclassname">swift.common.utils.</code><code class="descname">readconf</code><span class="sig-paren">(</span><em>conf_path</em>, <em>section_name=None</em>, <em>log_name=None</em>, <em>defaults=None</em>, <em>raw=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.readconf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read config file(s) and return config items as a dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf_path</strong> &#8211; path to config file/directory, or a file-like object
(hasattr readline)</li>
<li><strong>section_name</strong> &#8211; config section to read (will return all sections if
not defined)</li>
<li><strong>log_name</strong> &#8211; name to be used with logging (will use section_name if
not defined)</li>
<li><strong>defaults</strong> &#8211; dict of default values to pre-populate the config with</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict of config items</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>ValueError</strong> &#8211; if section_name does not exist</li>
<li><strong>IOError</strong> &#8211; if reading the file failed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.register_swift_info">
<code class="descclassname">swift.common.utils.</code><code class="descname">register_swift_info</code><span class="sig-paren">(</span><em>name='swift'</em>, <em>admin=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.register_swift_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers information about the swift cluster to be retrieved with calls
to get_swift_info.</p>
<dl class="docutils">
<dt>NOTE: Do not use &#8221;.&#8221; in the param: name or any keys in kwargs. &#8221;.&#8221; is used</dt>
<dd>in the disallowed_sections to remove unwanted keys from /info.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; string, the section name to place the information under.</li>
<li><strong>admin</strong> &#8211; boolean, if True, information will be registered to an
admin section which can optionally be withheld when
requesting the information.</li>
<li><strong>kwargs</strong> &#8211; key value arguments representing the information to be
added.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ValueError</strong> &#8211; if name or any of the keys in kwargs has &#8221;.&#8221; in it</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.reiterate">
<code class="descclassname">swift.common.utils.</code><code class="descname">reiterate</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.reiterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Consume the first item from an iterator, then re-chain it to the rest of
the iterator.  This is useful when you want to make sure the prologue to
downstream generators have been executed before continuing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>iterable</strong> &#8211; an iterable object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.remove_file">
<code class="descclassname">swift.common.utils.</code><code class="descname">remove_file</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.remove_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Quiet wrapper for os.unlink, OSErrors are suppressed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; first and only argument passed to os.unlink</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.renamer">
<code class="descclassname">swift.common.utils.</code><code class="descname">renamer</code><span class="sig-paren">(</span><em>old</em>, <em>new</em>, <em>fsync=True</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.renamer" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to fix / hide race conditions like empty object directories
being removed by backend processes during uploads, by retrying.</p>
<p>The containing directory of &#8216;new&#8217; and of all newly created directories are
fsync&#8217;d by default. This _will_ come at a performance penalty. In cases
where these additional fsyncs are not necessary, it is expected that the
caller of renamer() turn it off explicitly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>old</strong> &#8211; old path to be renamed</li>
<li><strong>new</strong> &#8211; new path to be renamed to</li>
<li><strong>fsync</strong> &#8211; fsync on containing directory of new and also all
the newly created directories.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.replication">
<code class="descclassname">swift.common.utils.</code><code class="descname">replication</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.replication" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to declare which methods are accessible for different
type of servers:</p>
<ul class="simple">
<li>If option replication_server is None then this decorator
doesn&#8217;t matter.</li>
<li>If option replication_server is True then ONLY decorated with
this decorator methods will be started.</li>
<li>If option replication_server is False then decorated with this
decorator methods will NOT be started.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> &#8211; function to mark accessible for replication</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.rsync_ip">
<code class="descclassname">swift.common.utils.</code><code class="descname">rsync_ip</code><span class="sig-paren">(</span><em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.rsync_ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform ip string to an rsync-compatible form</p>
<p>Will return ipv4 addresses unchanged, but will nest ipv6 addresses
inside square brackets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ip</strong> &#8211; an ip string (ipv4 or ipv6)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a string ip address</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.rsync_module_interpolation">
<code class="descclassname">swift.common.utils.</code><code class="descname">rsync_module_interpolation</code><span class="sig-paren">(</span><em>template</em>, <em>device</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.rsync_module_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate devices variables inside a rsync module template</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>template</strong> &#8211; rsync module template as a string</li>
<li><strong>device</strong> &#8211; a device from a ring</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a string with all variables replaced by device attributes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.search_tree">
<code class="descclassname">swift.common.utils.</code><code class="descname">search_tree</code><span class="sig-paren">(</span><em>root</em>, <em>glob_match</em>, <em>ext=''</em>, <em>exts=None</em>, <em>dir_ext=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.search_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Look in root, for any files/dirs matching glob, recursively traversing
any found directories looking for files ending with ext</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>root</strong> &#8211; start of search path</li>
<li><strong>glob_match</strong> &#8211; glob to match in root, matching dirs are traversed with
os.walk</li>
<li><strong>ext</strong> &#8211; only files that end in ext will be returned</li>
<li><strong>exts</strong> &#8211; a list of file extensions; only files that end in one of these
extensions will be returned; if set this list overrides any
extension specified using the &#8216;ext&#8217; param.</li>
<li><strong>dir_ext</strong> &#8211; if present directories that end with dir_ext will not be
traversed and instead will be returned as a matched path</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of full paths to matching files, sorted</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.server_handled_successfully">
<code class="descclassname">swift.common.utils.</code><code class="descname">server_handled_successfully</code><span class="sig-paren">(</span><em>status_int</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.server_handled_successfully" title="Permalink to this definition">¶</a></dt>
<dd><p>True for successful responses <em>or</em> error codes that are not Swift&#8217;s fault,
False otherwise. For example, 500 is definitely the server&#8217;s fault, but
412 is an error code (4xx are all errors) that is due to a header the
client sent.</p>
<p>If one is tracking error rates to monitor server health, one would be
advised to use a function like this one, lest a client cause a flurry of
404s or 416s and make a spurious spike in your errors graph.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.split_path">
<code class="descclassname">swift.common.utils.</code><code class="descname">split_path</code><span class="sig-paren">(</span><em>path</em>, <em>minsegs=1</em>, <em>maxsegs=None</em>, <em>rest_with_last=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.split_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate and split the given HTTP request path.</p>
<p><strong>Examples</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a/c&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;o/r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_path</span><span class="p">(</span><span class="s1">&#39;/a/c/o/r&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> &#8211; HTTP Request path to be split</li>
<li><strong>minsegs</strong> &#8211; Minimum number of segments to be extracted</li>
<li><strong>maxsegs</strong> &#8211; Maximum number of segments to be extracted</li>
<li><strong>rest_with_last</strong> &#8211; If True, trailing data will be returned as part
of last segment.  If False, and there is
trailing data, raises ValueError.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of segments with a length of maxsegs (non-existent
segments will return as None)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if given an invalid path</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.storage_directory">
<code class="descclassname">swift.common.utils.</code><code class="descname">storage_directory</code><span class="sig-paren">(</span><em>datadir</em>, <em>partition</em>, <em>name_hash</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.storage_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the storage directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>datadir</strong> &#8211; Base data directory</li>
<li><strong>partition</strong> &#8211; Partition</li>
<li><strong>name_hash</strong> &#8211; Account, container or object name hash</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Storage directory</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.streq_const_time">
<code class="descclassname">swift.common.utils.</code><code class="descname">streq_const_time</code><span class="sig-paren">(</span><em>s1</em>, <em>s2</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.streq_const_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant-time string comparison.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Params s1:</th><td class="field-body">the first string</td>
</tr>
<tr class="field-even field"><th class="field-name">Params s2:</th><td class="field-body">the second string</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if the strings are equal.</td>
</tr>
</tbody>
</table>
<p>This function takes two strings and compares them.  It is intended to be
used when doing a comparison for authentication purposes to help guard
against timing attacks.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.timing_stats">
<code class="descclassname">swift.common.utils.</code><code class="descname">timing_stats</code><span class="sig-paren">(</span><em>**dec_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.timing_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a decorator that logs timing events or errors for public methods in
swift&#8217;s wsgi server controllers, based on response code.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.tpool_reraise">
<code class="descclassname">swift.common.utils.</code><code class="descname">tpool_reraise</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.tpool_reraise" title="Permalink to this definition">¶</a></dt>
<dd><p>Hack to work around Eventlet&#8217;s tpool not catching and reraising Timeouts.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.unlink_older_than">
<code class="descclassname">swift.common.utils.</code><code class="descname">unlink_older_than</code><span class="sig-paren">(</span><em>path</em>, <em>mtime</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.unlink_older_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any file in a given path that that was last modified before mtime.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> &#8211; path to remove file from</li>
<li><strong>mtime</strong> &#8211; timestamp of oldest file to keep</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.unlink_paths_older_than">
<code class="descclassname">swift.common.utils.</code><code class="descname">unlink_paths_older_than</code><span class="sig-paren">(</span><em>filepaths</em>, <em>mtime</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.unlink_paths_older_than" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any files from the given list that that were
last modified before mtime.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepaths</strong> &#8211; a list of strings, the full paths of files to check</li>
<li><strong>mtime</strong> &#8211; timestamp of oldest file to keep</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.urlparse">
<code class="descclassname">swift.common.utils.</code><code class="descname">urlparse</code><span class="sig-paren">(</span><em>url</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.urlparse" title="Permalink to this definition">¶</a></dt>
<dd><p>urlparse augmentation.
This is necessary because urlparse can&#8217;t handle RFC 2732 URLs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>url</strong> &#8211; URL to parse.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.validate_device_partition">
<code class="descclassname">swift.common.utils.</code><code class="descname">validate_device_partition</code><span class="sig-paren">(</span><em>device</em>, <em>partition</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.validate_device_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate that a device and a partition are valid and won&#8217;t lead to
directory traversal when used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>device</strong> &#8211; device to validate</li>
<li><strong>partition</strong> &#8211; partition to validate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">ValueError if given an invalid device or partition</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.validate_sync_to">
<code class="descclassname">swift.common.utils.</code><code class="descname">validate_sync_to</code><span class="sig-paren">(</span><em>value</em>, <em>allowed_sync_hosts</em>, <em>realms_conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.validate_sync_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates an X-Container-Sync-To header value, returning the
validated endpoint, realm, and realm_key, or an error string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> &#8211; The X-Container-Sync-To header value to validate.</li>
<li><strong>allowed_sync_hosts</strong> &#8211; A list of allowed hosts in endpoints,
if realms_conf does not apply.</li>
<li><strong>realms_conf</strong> &#8211; A instance of
swift.common.container_sync_realms.ContainerSyncRealms to
validate against.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tuple of (error_string, validated_endpoint, realm,
realm_key). The error_string will None if the rest of the
values have been validated. The validated_endpoint will be
the validated endpoint to sync to. The realm and realm_key
will be set if validation was done through realms_conf.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.whataremyips">
<code class="descclassname">swift.common.utils.</code><code class="descname">whataremyips</code><span class="sig-paren">(</span><em>bind_ip=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.whataremyips" title="Permalink to this definition">¶</a></dt>
<dd><p>Get &#8220;our&#8221; IP addresses (&#8220;us&#8221; being the set of services configured by
one <cite>*.conf</cite> file). If our REST listens on a specific address, return it.
Otherwise, if listen on &#8216;0.0.0.0&#8217; or &#8216;::&#8217; return all addresses, including
the loopback.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>bind_ip</strong> (<em>str</em>) &#8211; Optional bind_ip from a config file; may be IP address
or hostname.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of Strings of ip addresses</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.write_file">
<code class="descclassname">swift.common.utils.</code><code class="descname">write_file</code><span class="sig-paren">(</span><em>path</em>, <em>contents</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write contents to file at path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> &#8211; any path, subdirs will be created as needed</li>
<li><strong>contents</strong> &#8211; data to write to file, will be converted to string</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.utils.write_pickle">
<code class="descclassname">swift.common.utils.</code><code class="descname">write_pickle</code><span class="sig-paren">(</span><em>obj</em>, <em>dest</em>, <em>tmp=None</em>, <em>pickle_protocol=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.utils.write_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that a pickle file gets written to disk.  The file
is first written to a tmp location, ensure it is synced to disk, then
perform a move to its final location</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obj</strong> &#8211; python object to be pickled</li>
<li><strong>dest</strong> &#8211; path of final destination file</li>
<li><strong>tmp</strong> &#8211; path to tmp to use, defaults to None</li>
<li><strong>pickle_protocol</strong> &#8211; protocol to pickle the obj with, defaults to 0</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="wsgi">
<span id="id11"></span><h2>WSGI<a class="headerlink" href="#wsgi" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-swift.common.wsgi"></span><p>WSGI tools for use with swift.</p>
<dl class="class">
<dt id="swift.common.wsgi.ConfigDirLoader">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">ConfigDirLoader</code><span class="sig-paren">(</span><em>conf_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ConfigDirLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.wsgi.NamedConfigLoader" title="swift.common.wsgi.NamedConfigLoader"><code class="xref py py-class docutils literal"><span class="pre">swift.common.wsgi.NamedConfigLoader</span></code></a></p>
<p>Read configuration from multiple files under the given path.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.ConfigString">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">ConfigString</code><span class="sig-paren">(</span><em>config_string</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ConfigString" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.wsgi.NamedConfigLoader" title="swift.common.wsgi.NamedConfigLoader"><code class="xref py py-class docutils literal"><span class="pre">swift.common.wsgi.NamedConfigLoader</span></code></a></p>
<p>Wrap a raw config string up for paste.deploy.</p>
<p>If you give one of these to our loadcontext (e.g. give it to our
appconfig) we&#8217;ll intercept it and get it routed to the right loader.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.NamedConfigLoader">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">NamedConfigLoader</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.NamedConfigLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">paste.deploy.loadwsgi.ConfigLoader</span></code></p>
<p>Patch paste.deploy&#8217;s ConfigLoader so each context object will know what
config section it came from.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.PipelineWrapper">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">PipelineWrapper</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PipelineWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class provides a number of utility methods for
modifying the composition of a wsgi pipeline.</p>
<dl class="method">
<dt id="swift.common.wsgi.PipelineWrapper.create_filter">
<code class="descname">create_filter</code><span class="sig-paren">(</span><em>entry_point_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PipelineWrapper.create_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a context for a filter that can subsequently be added
to a pipeline context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>entry_point_name</strong> &#8211; entry point of the middleware (Swift only)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a filter context</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PipelineWrapper.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>entry_point_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PipelineWrapper.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the first index of the given entry point name in the pipeline.</p>
<p>Raises ValueError if the given module is not in the pipeline.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PipelineWrapper.insert_filter">
<code class="descname">insert_filter</code><span class="sig-paren">(</span><em>ctx</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PipelineWrapper.insert_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts a filter module into the pipeline context.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ctx</strong> &#8211; the context to be inserted</li>
<li><strong>index</strong> &#8211; (optional) index at which filter should be
inserted in the list of pipeline filters. Default
is 0, which means the start of the pipeline.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PipelineWrapper.startswith">
<code class="descname">startswith</code><span class="sig-paren">(</span><em>entry_point_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PipelineWrapper.startswith" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the pipeline starts with the given entry point name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>entry_point_name</strong> &#8211; entry point of middleware or app (Swift only)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if entry_point_name is first in pipeline, False
otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.PortPidState">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">PortPidState</code><span class="sig-paren">(</span><em>servers_per_port</em>, <em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A helper class for <a class="reference internal" href="#swift.common.wsgi.ServersPerPortStrategy" title="swift.common.wsgi.ServersPerPortStrategy"><code class="xref py py-class docutils literal"><span class="pre">ServersPerPortStrategy</span></code></a> to track listen
sockets and PIDs for each port.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>servers_per_port</strong> (<em>int</em>) &#8211; The configured number of servers per port.</li>
<li><strong>logger</strong> &#8211; The server&#8217;s <code class="xref py py-class docutils literal"><span class="pre">LogAdaptor</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.wsgi.PortPidState.all_socks">
<code class="descname">all_socks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.all_socks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield all current listen sockets.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.forget_pid">
<code class="descname">forget_pid</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.forget_pid" title="Permalink to this definition">¶</a></dt>
<dd><p>Idempotently forget a PID.  It&#8217;s okay if the PID is no longer in our
data structure (it could have been removed by the &#8220;orphan port&#8221; removal
in <code class="xref py py-meth docutils literal"><span class="pre">new_worker_socks()</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<em>int</em>) &#8211; The PID which exited.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.forget_port">
<code class="descname">forget_port</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.forget_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Idempotently forget a port, closing the listen socket at most once.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.not_tracking">
<code class="descname">not_tracking</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.not_tracking" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the specified port is not being tracked.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>port</strong> (<em>int</em>) &#8211; A port to check.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.port_for_sock">
<code class="descname">port_for_sock</code><span class="sig-paren">(</span><em>sock</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.port_for_sock" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sock</strong> (<em>socket</em>) &#8211; A tracked bound listen socket</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The port the socket is bound to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.port_index_pairs">
<code class="descname">port_index_pairs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.port_index_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns current (port, server index) pairs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A set of (port, server_idx) tuples for currently-tracked
ports, sockets, and PIDs.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.sock_for_port">
<code class="descname">sock_for_port</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.sock_for_port" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>port</strong> (<em>int</em>) &#8211; The port whose socket is desired.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The bound listen socket for the given port.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.PortPidState.track_port">
<code class="descname">track_port</code><span class="sig-paren">(</span><em>port</em>, <em>sock</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.PortPidState.track_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Start tracking servers for the given port and listen socket.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>port</strong> (<em>int</em>) &#8211; The port to start tracking</li>
<li><strong>sock</strong> (<em>socket</em>) &#8211; The bound listen socket for the port.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.RestrictedGreenPool">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">RestrictedGreenPool</code><span class="sig-paren">(</span><em>size=1024</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.RestrictedGreenPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">eventlet.greenpool.GreenPool</span></code></p>
<p>Works the same as GreenPool, but if the size is specified as one, then the
spawn_n() method will invoke waitall() before returning to prevent the
caller from doing any other work (like calling accept()).</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.ServersPerPortStrategy">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">ServersPerPortStrategy</code><span class="sig-paren">(</span><em>conf</em>, <em>logger</em>, <em>servers_per_port</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>WSGI server management strategy object for an object-server with one listen
port per unique local port in the storage policy rings.  The
<cite>servers_per_port</cite> integer config setting determines how many workers are
run per port.</p>
<p>Used in <a class="reference internal" href="#swift.common.wsgi.run_wsgi" title="swift.common.wsgi.run_wsgi"><code class="xref py py-func docutils literal"><span class="pre">run_wsgi()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conf</strong> (<em>dict</em>) &#8211; Server configuration dictionary.</li>
<li><strong>logger</strong> &#8211; The server&#8217;s <code class="xref py py-class docutils literal"><span class="pre">LogAdaptor</span></code>
object.</li>
<li><strong>servers_per_port</strong> (<em>int</em>) &#8211; The number of workers to run per port.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.bind_ports">
<code class="descname">bind_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.bind_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind one listen socket per unique local storage policy ring port.  Then
do all the work of drop_privileges except the actual dropping of
privileges (each forked-off worker will do that post-fork in
<a class="reference internal" href="#swift.common.wsgi.ServersPerPortStrategy.post_fork_hook" title="swift.common.wsgi.ServersPerPortStrategy.post_fork_hook"><code class="xref py py-meth docutils literal"><span class="pre">post_fork_hook()</span></code></a>).</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.log_sock_exit">
<code class="descname">log_sock_exit</code><span class="sig-paren">(</span><em>sock</em>, <em>server_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.log_sock_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a server&#8217;s exit.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.loop_timeout">
<code class="descname">loop_timeout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.loop_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Return timeout before checking for reloaded rings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The time to wait for a child to exit before checking for
reloaded rings (new ports).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.new_worker_socks">
<code class="descname">new_worker_socks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.new_worker_socks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield a sequence of (socket, server_idx) tuples for each server which
should be forked-off and started.</p>
<p>Any sockets for &#8220;orphaned&#8221; ports no longer in any ring will be closed
(causing their associated workers to gracefully exit) after all new
sockets have been yielded.</p>
<p>The server_idx item for each socket will passed into the
<a class="reference internal" href="#swift.common.wsgi.ServersPerPortStrategy.log_sock_exit" title="swift.common.wsgi.ServersPerPortStrategy.log_sock_exit"><code class="xref py py-meth docutils literal"><span class="pre">log_sock_exit()</span></code></a> and <a class="reference internal" href="#swift.common.wsgi.ServersPerPortStrategy.register_worker_start" title="swift.common.wsgi.ServersPerPortStrategy.register_worker_start"><code class="xref py py-meth docutils literal"><span class="pre">register_worker_start()</span></code></a> methods.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.no_fork_sock">
<code class="descname">no_fork_sock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.no_fork_sock" title="Permalink to this definition">¶</a></dt>
<dd><p>This strategy does not support running in the foreground.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.post_fork_hook">
<code class="descname">post_fork_hook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.post_fork_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Called in each child process, prior to starting the actual wsgi server,
to drop privileges.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.register_worker_exit">
<code class="descname">register_worker_exit</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.register_worker_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a worker has exited.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<em>int</em>) &#8211; The PID of the worker that exited.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.register_worker_start">
<code class="descname">register_worker_start</code><span class="sig-paren">(</span><em>sock</em>, <em>server_idx</em>, <em>pid</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.register_worker_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a new worker is started.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sock</strong> (<em>socket</em>) &#8211; The listen socket for the worker just started.</li>
<li><strong>server_idx</strong> &#8211; The socket&#8217;s server_idx as yielded by
<a class="reference internal" href="#swift.common.wsgi.ServersPerPortStrategy.new_worker_socks" title="swift.common.wsgi.ServersPerPortStrategy.new_worker_socks"><code class="xref py py-meth docutils literal"><span class="pre">new_worker_socks()</span></code></a>.</li>
<li><strong>pid</strong> (<em>int</em>) &#8211; The new worker process&#8217; PID</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.ServersPerPortStrategy.shutdown_sockets">
<code class="descname">shutdown_sockets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.ServersPerPortStrategy.shutdown_sockets" title="Permalink to this definition">¶</a></dt>
<dd><p>Shutdown any listen sockets.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.WSGIContext">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">WSGIContext</code><span class="sig-paren">(</span><em>wsgi_app</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WSGIContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class provides a means to provide context (scope) for a middleware
filter to have access to the wsgi start_response results like the request
status and headers.</p>
</dd></dl>

<dl class="class">
<dt id="swift.common.wsgi.WorkersStrategy">
<em class="property">class </em><code class="descclassname">swift.common.wsgi.</code><code class="descname">WorkersStrategy</code><span class="sig-paren">(</span><em>conf</em>, <em>logger</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>WSGI server management strategy object for a single bind port and listen
socket shared by a configured number of forked-off workers.</p>
<p>Used in <a class="reference internal" href="#swift.common.wsgi.run_wsgi" title="swift.common.wsgi.run_wsgi"><code class="xref py py-func docutils literal"><span class="pre">run_wsgi()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conf</strong> (<em>dict</em>) &#8211; Server configuration dictionary.</li>
<li><strong>logger</strong> &#8211; The server&#8217;s <code class="xref py py-class docutils literal"><span class="pre">LogAdaptor</span></code>
object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.bind_ports">
<code class="descname">bind_ports</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.bind_ports" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind the one listen socket for this strategy and drop privileges
(since the parent process will never need to bind again).</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.log_sock_exit">
<code class="descname">log_sock_exit</code><span class="sig-paren">(</span><em>sock</em>, <em>_unused</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.log_sock_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Log a server&#8217;s exit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sock</strong> (<em>socket</em>) &#8211; The listen socket for the worker just started.</li>
<li><strong>_unused</strong> &#8211; The socket&#8217;s opaque_data yielded by
<a class="reference internal" href="#swift.common.wsgi.WorkersStrategy.new_worker_socks" title="swift.common.wsgi.WorkersStrategy.new_worker_socks"><code class="xref py py-meth docutils literal"><span class="pre">new_worker_socks()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.loop_timeout">
<code class="descname">loop_timeout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.loop_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>We want to keep from busy-waiting, but we also need a non-None value so
the main loop gets a chance to tell whether it should keep running or
not (e.g. SIGHUP received).</p>
<p>So we return 0.5.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.new_worker_socks">
<code class="descname">new_worker_socks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.new_worker_socks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield a sequence of (socket, opqaue_data) tuples for each server which
should be forked-off and started.</p>
<p>The opaque_data item for each socket will passed into the
<a class="reference internal" href="#swift.common.wsgi.WorkersStrategy.log_sock_exit" title="swift.common.wsgi.WorkersStrategy.log_sock_exit"><code class="xref py py-meth docutils literal"><span class="pre">log_sock_exit()</span></code></a> and <a class="reference internal" href="#swift.common.wsgi.WorkersStrategy.register_worker_start" title="swift.common.wsgi.WorkersStrategy.register_worker_start"><code class="xref py py-meth docutils literal"><span class="pre">register_worker_start()</span></code></a> methods
where it will be ignored.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.no_fork_sock">
<code class="descname">no_fork_sock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.no_fork_sock" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a server listen socket if the server should run in the
foreground (no fork).</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.post_fork_hook">
<code class="descname">post_fork_hook</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.post_fork_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform any initialization in a forked-off child process prior to
starting the wsgi server.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.register_worker_exit">
<code class="descname">register_worker_exit</code><span class="sig-paren">(</span><em>pid</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.register_worker_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a worker has exited.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pid</strong> (<em>int</em>) &#8211; The PID of the worker that exited.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.register_worker_start">
<code class="descname">register_worker_start</code><span class="sig-paren">(</span><em>sock</em>, <em>_unused</em>, <em>pid</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.register_worker_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a new worker is started.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sock</strong> (<em>socket</em>) &#8211; The listen socket for the worker just started.</li>
<li><strong>_unused</strong> &#8211; The socket&#8217;s opaque_data yielded by new_worker_socks().</li>
<li><strong>pid</strong> (<em>int</em>) &#8211; The new worker process&#8217; PID</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.wsgi.WorkersStrategy.shutdown_sockets">
<code class="descname">shutdown_sockets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.WorkersStrategy.shutdown_sockets" title="Permalink to this definition">¶</a></dt>
<dd><p>Shutdown any listen sockets.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.get_socket">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">get_socket</code><span class="sig-paren">(</span><em>conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.get_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind socket to bind ip:port in conf</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conf</strong> &#8211; Configuration dict to read settings from</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a socket object as returned from socket.listen or
ssl.wrap_socket if conf specifies cert_file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.init_request_processor">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">init_request_processor</code><span class="sig-paren">(</span><em>conf_path</em>, <em>app_section</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.init_request_processor" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads common settings from conf
Sets the logger
Loads the request processor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf_path</strong> &#8211; Path to paste.deploy style configuration file/directory</li>
<li><strong>app_section</strong> &#8211; App name from conf file to load config from</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the loaded application entry point</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><strong>ConfigFileError</strong> &#8211; Exception is raised for config file error</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.loadapp">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">loadapp</code><span class="sig-paren">(</span><em>conf_file</em>, <em>global_conf=None</em>, <em>allow_modify_pipeline=True</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.loadapp" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a context from a config file, and if the context is a pipeline
then presents the app with the opportunity to modify the pipeline.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.make_env">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">make_env</code><span class="sig-paren">(</span><em>env</em>, <em>method=None</em>, <em>path=None</em>, <em>agent='Swift'</em>, <em>query_string=None</em>, <em>swift_source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.make_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new fresh WSGI environment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env</strong> &#8211; The WSGI environment to base the new environment on.</li>
<li><strong>method</strong> &#8211; The new REQUEST_METHOD or None to use the
original.</li>
<li><strong>path</strong> &#8211; The new path_info or none to use the original. path
should NOT be quoted. When building a url, a Webob
Request (in accordance with wsgi spec) will quote
env[&#8216;PATH_INFO&#8217;].  url += quote(environ[&#8216;PATH_INFO&#8217;])</li>
<li><strong>query_string</strong> &#8211; The new query_string or none to use the original.
When building a url, a Webob Request will append
the query string directly to the url.
url += &#8216;?&#8217; + env[&#8216;QUERY_STRING&#8217;]</li>
<li><strong>agent</strong> &#8211; The HTTP user agent to use; default &#8216;Swift&#8217;. You
can put %(orig)s in the agent to have it replaced
with the original env&#8217;s HTTP_USER_AGENT, such as
&#8216;%(orig)s StaticWeb&#8217;. You also set agent to None to
use the original env&#8217;s HTTP_USER_AGENT or &#8216;&#8217; to
have no HTTP_USER_AGENT.</li>
<li><strong>swift_source</strong> &#8211; Used to mark the request as originating out of
middleware. Will be logged in proxy logs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Fresh WSGI environment.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.make_pre_authed_env">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">make_pre_authed_env</code><span class="sig-paren">(</span><em>env</em>, <em>method=None</em>, <em>path=None</em>, <em>agent='Swift'</em>, <em>query_string=None</em>, <em>swift_source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.make_pre_authed_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#swift.common.wsgi.make_env" title="swift.common.wsgi.make_env"><code class="xref py py-func docutils literal"><span class="pre">make_env()</span></code></a> but with preauthorization.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.make_pre_authed_request">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">make_pre_authed_request</code><span class="sig-paren">(</span><em>env</em>, <em>method=None</em>, <em>path=None</em>, <em>body=None</em>, <em>headers=None</em>, <em>agent='Swift'</em>, <em>swift_source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.make_pre_authed_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#swift.common.wsgi.make_subrequest" title="swift.common.wsgi.make_subrequest"><code class="xref py py-func docutils literal"><span class="pre">make_subrequest()</span></code></a> but with preauthorization.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.make_subrequest">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">make_subrequest</code><span class="sig-paren">(</span><em>env</em>, <em>method=None</em>, <em>path=None</em>, <em>body=None</em>, <em>headers=None</em>, <em>agent='Swift'</em>, <em>swift_source=None</em>, <em>make_env=&lt;function make_env&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.make_subrequest" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a new swob.Request based on the current env but with the
parameters specified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>env</strong> &#8211; The WSGI environment to base the new request on.</li>
<li><strong>method</strong> &#8211; HTTP method of new request; default is from
the original env.</li>
<li><strong>path</strong> &#8211; HTTP path of new request; default is from the
original env. path should be compatible with what you
would send to Request.blank. path should be quoted and it
can include a query string. for example:
&#8216;/a%20space?unicode_str%E8%AA%9E=y%20es&#8217;</li>
<li><strong>body</strong> &#8211; HTTP body of new request; empty by default.</li>
<li><strong>headers</strong> &#8211; Extra HTTP headers of new request; None by
default.</li>
<li><strong>agent</strong> &#8211; The HTTP user agent to use; default &#8216;Swift&#8217;. You
can put %(orig)s in the agent to have it replaced
with the original env&#8217;s HTTP_USER_AGENT, such as
&#8216;%(orig)s StaticWeb&#8217;. You also set agent to None to
use the original env&#8217;s HTTP_USER_AGENT or &#8216;&#8217; to
have no HTTP_USER_AGENT.</li>
<li><strong>swift_source</strong> &#8211; Used to mark the request as originating out of
middleware. Will be logged in proxy logs.</li>
<li><strong>make_env</strong> &#8211; make_subrequest calls this make_env to help build the
swob.Request.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Fresh swob.Request object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.monkey_patch_mimetools">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">monkey_patch_mimetools</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.monkey_patch_mimetools" title="Permalink to this definition">¶</a></dt>
<dd><p>mimetools.Message defaults content-type to &#8220;text/plain&#8221;
This changes it to default to None, so we can detect missing headers.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.pipeline_property">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">pipeline_property</code><span class="sig-paren">(</span><em>name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.pipeline_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a property accessor for the given name.  The property will
dig through the bound instance on which it was accessed for an
attribute &#8220;app&#8221; and check that object for an attribute of the given
name.  If the &#8220;app&#8221; object does not have such an attribute, it will
look for an attribute &#8220;app&#8221; on THAT object and continue it&#8217;s search
from there.  If the named attribute cannot be found accessing the
property will raise AttributeError.</p>
<p>If a default kwarg is provided you get that instead of the
AttributeError.  When found the attribute will be cached on instance
with the property accessor using the same name as the attribute
prefixed with a leading underscore.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.run_wsgi">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">run_wsgi</code><span class="sig-paren">(</span><em>conf_path</em>, <em>app_section</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.run_wsgi" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the server according to some strategy.  The default strategy runs a
specified number of workers in pre-fork model.  The object-server (only)
may use a servers-per-port strategy if its config has a servers_per_port
setting with a value greater than zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>conf_path</strong> &#8211; Path to paste.deploy style configuration file/directory</li>
<li><strong>app_section</strong> &#8211; App name from conf file to load config from</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">0 if successful, nonzero otherwise</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.wsgi.wrap_conf_type">
<code class="descclassname">swift.common.wsgi.</code><code class="descname">wrap_conf_type</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.wsgi.wrap_conf_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a function whos first argument is a paste.deploy style config uri,
such that you can pass it an un-adorned raw filesystem path (or config
string) and the config directive (either config:, config_dir:, or
config_str:) will be added automatically based on the type of entity
(either a file or directory, or if no such entity on the file system -
just a string) before passing it through to the paste.deploy function.</p>
</dd></dl>

</div>
<div class="section" id="module-swift.common.storage_policy">
<span id="id12"></span><span id="storage-policy"></span><h2>Storage Policy<a class="headerlink" href="#module-swift.common.storage_policy" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.common.storage_policy.BaseStoragePolicy">
<em class="property">class </em><code class="descclassname">swift.common.storage_policy.</code><code class="descname">BaseStoragePolicy</code><span class="sig-paren">(</span><em>idx</em>, <em>name=''</em>, <em>is_default=False</em>, <em>is_deprecated=False</em>, <em>object_ring=None</em>, <em>aliases=''</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Represents a storage policy.  Not meant to be instantiated directly;
implement a derived subclasses (e.g. StoragePolicy, ECStoragePolicy, etc)
or use <a class="reference internal" href="#swift.common.storage_policy.reload_storage_policies" title="swift.common.storage_policy.reload_storage_policies"><code class="xref py py-func docutils literal"><span class="pre">reload_storage_policies()</span></code></a> to
load POLICIES from <code class="docutils literal"><span class="pre">swift.conf</span></code>.</p>
<p>The object_ring property is lazy loaded once the service&#8217;s <code class="docutils literal"><span class="pre">swift_dir</span></code>
is known via <a class="reference internal" href="#swift.common.storage_policy.StoragePolicyCollection.get_object_ring" title="swift.common.storage_policy.StoragePolicyCollection.get_object_ring"><code class="xref py py-meth docutils literal"><span class="pre">get_object_ring()</span></code></a>, but it may
be over-ridden via object_ring kwarg at create time for testing or
actively loaded with <code class="xref py py-meth docutils literal"><span class="pre">load_ring()</span></code>.</p>
<dl class="method">
<dt id="swift.common.storage_policy.BaseStoragePolicy.add_name">
<code class="descname">add_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.add_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an alias name to the storage policy. Shouldn&#8217;t be called
directly from the storage policy but instead through the
storage policy collection class, so lookups by name resolve
correctly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; a new alias for the storage policy</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.BaseStoragePolicy.change_primary_name">
<code class="descname">change_primary_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.change_primary_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the primary/default name of the policy to a specified name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; a string name to replace the current primary name.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.BaseStoragePolicy.get_info">
<code class="descname">get_info</code><span class="sig-paren">(</span><em>config=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the info dict and conf file options for this policy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>config</strong> &#8211; boolean, if True all config options are returned</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.BaseStoragePolicy.load_ring">
<code class="descname">load_ring</code><span class="sig-paren">(</span><em>swift_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.load_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the ring for this policy immediately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>swift_dir</strong> &#8211; path to rings</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.storage_policy.BaseStoragePolicy.quorum">
<code class="descname">quorum</code><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.quorum" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful backend requests needed for the proxy to
consider the client request successful.</p>
</dd></dl>

<dl class="classmethod">
<dt id="swift.common.storage_policy.BaseStoragePolicy.register">
<em class="property">classmethod </em><code class="descname">register</code><span class="sig-paren">(</span><em>policy_type</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for Storage Policy implementations to register
their StoragePolicy class.  This will also set the policy_type
attribute on the registered implementation.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.BaseStoragePolicy.remove_name">
<code class="descname">remove_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.BaseStoragePolicy.remove_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes an alias name from the storage policy. Shouldn&#8217;t be called
directly from the storage policy but instead through the storage
policy collection class, so lookups by name resolve correctly. If
the name removed is the primary name then the next available alias
will be adopted as the new primary name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; a name assigned to the storage policy</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.storage_policy.ECStoragePolicy">
<em class="property">class </em><code class="descclassname">swift.common.storage_policy.</code><code class="descname">ECStoragePolicy</code><span class="sig-paren">(</span><em>idx</em>, <em>name=''</em>, <em>aliases=''</em>, <em>is_default=False</em>, <em>is_deprecated=False</em>, <em>object_ring=None</em>, <em>ec_segment_size=1048576</em>, <em>ec_type=None</em>, <em>ec_ndata=None</em>, <em>ec_nparity=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.ECStoragePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.storage_policy.BaseStoragePolicy" title="swift.common.storage_policy.BaseStoragePolicy"><code class="xref py py-class docutils literal"><span class="pre">swift.common.storage_policy.BaseStoragePolicy</span></code></a></p>
<p>Represents a storage policy of type &#8216;erasure_coding&#8217;.</p>
<p>Not meant to be instantiated directly; use
<a class="reference internal" href="#swift.common.storage_policy.reload_storage_policies" title="swift.common.storage_policy.reload_storage_policies"><code class="xref py py-func docutils literal"><span class="pre">reload_storage_policies()</span></code></a> to load
POLICIES from <code class="docutils literal"><span class="pre">swift.conf</span></code>.</p>
<dl class="attribute">
<dt id="swift.common.storage_policy.ECStoragePolicy.ec_scheme_description">
<code class="descname">ec_scheme_description</code><a class="headerlink" href="#swift.common.storage_policy.ECStoragePolicy.ec_scheme_description" title="Permalink to this definition">¶</a></dt>
<dd><p>This short hand form of the important parts of the ec schema is stored
in Object System Metadata on the EC Fragment Archives for debugging.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.storage_policy.ECStoragePolicy.fragment_size">
<code class="descname">fragment_size</code><a class="headerlink" href="#swift.common.storage_policy.ECStoragePolicy.fragment_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum length of a fragment, including header.</p>
<p>NB: a fragment archive is a sequence of 0 or more max-length
fragments followed by one possibly-shorter fragment.</p>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.ECStoragePolicy.load_ring">
<code class="descname">load_ring</code><span class="sig-paren">(</span><em>swift_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.ECStoragePolicy.load_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the ring for this policy immediately.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>swift_dir</strong> &#8211; path to rings</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.common.storage_policy.ECStoragePolicy.quorum">
<code class="descname">quorum</code><a class="headerlink" href="#swift.common.storage_policy.ECStoragePolicy.quorum" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful backend requests needed for the proxy to consider
the client request successful.</p>
<p>The quorum size for EC policies defines the minimum number
of data + parity elements required to be able to guarantee
the desired fault tolerance, which is the number of data
elements supplemented by the minimum number of parity
elements required by the chosen erasure coding scheme.</p>
<p>For example, for Reed-Solomon, the minimum number parity
elements required is 1, and thus the quorum_size requirement
is ec_ndata + 1.</p>
<p>Given the number of parity elements required is not the same
for every erasure coding scheme, consult PyECLib for
min_parity_fragments_needed()</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.storage_policy.StoragePolicy">
<em class="property">class </em><code class="descclassname">swift.common.storage_policy.</code><code class="descname">StoragePolicy</code><span class="sig-paren">(</span><em>idx</em>, <em>name=''</em>, <em>is_default=False</em>, <em>is_deprecated=False</em>, <em>object_ring=None</em>, <em>aliases=''</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#swift.common.storage_policy.BaseStoragePolicy" title="swift.common.storage_policy.BaseStoragePolicy"><code class="xref py py-class docutils literal"><span class="pre">swift.common.storage_policy.BaseStoragePolicy</span></code></a></p>
<p>Represents a storage policy of type &#8216;replication&#8217;.  Default storage policy
class unless otherwise overridden from swift.conf.</p>
<p>Not meant to be instantiated directly; use
<a class="reference internal" href="#swift.common.storage_policy.reload_storage_policies" title="swift.common.storage_policy.reload_storage_policies"><code class="xref py py-func docutils literal"><span class="pre">reload_storage_policies()</span></code></a> to load
POLICIES from <code class="docutils literal"><span class="pre">swift.conf</span></code>.</p>
<dl class="attribute">
<dt id="swift.common.storage_policy.StoragePolicy.quorum">
<code class="descname">quorum</code><a class="headerlink" href="#swift.common.storage_policy.StoragePolicy.quorum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Quorum concept in the replication case:</dt>
<dd>floor(number of replica / 2) + 1</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.storage_policy.StoragePolicyCollection">
<em class="property">class </em><code class="descclassname">swift.common.storage_policy.</code><code class="descname">StoragePolicyCollection</code><span class="sig-paren">(</span><em>pols</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class represents the collection of valid storage policies for the
cluster and is instantiated as <a class="reference internal" href="#swift.common.storage_policy.StoragePolicy" title="swift.common.storage_policy.StoragePolicy"><code class="xref py py-class docutils literal"><span class="pre">StoragePolicy</span></code></a> objects are added to
the collection when <code class="docutils literal"><span class="pre">swift.conf</span></code> is parsed by
<a class="reference internal" href="#swift.common.storage_policy.parse_storage_policies" title="swift.common.storage_policy.parse_storage_policies"><code class="xref py py-func docutils literal"><span class="pre">parse_storage_policies()</span></code></a>.</p>
<p>When a StoragePolicyCollection is created, the following validation
is enforced:</p>
<ul class="simple">
<li>If a policy with index 0 is not declared and no other policies defined,
Swift will create one</li>
<li>The policy index must be a non-negative integer</li>
<li>If no policy is declared as the default and no other policies are
defined, the policy with index 0 is set as the default</li>
<li>Policy indexes must be unique</li>
<li>Policy names are required</li>
<li>Policy names are case insensitive</li>
<li>Policy names must contain only letters, digits or a dash</li>
<li>Policy names must be unique</li>
<li>The policy name &#8216;Policy-0&#8217; can only be used for the policy with index 0</li>
<li>If any policies are defined, exactly one policy must be declared default</li>
<li>Deprecated policies can not be declared the default</li>
</ul>
<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.add_policy_alias">
<code class="descname">add_policy_alias</code><span class="sig-paren">(</span><em>policy_index</em>, <em>*aliases</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.add_policy_alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new name or names to a policy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>policy_index</strong> &#8211; index of a policy in this policy collection.</li>
<li><strong>aliases</strong> &#8211; arbitrary number of string policy names to add.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.change_policy_primary_name">
<code class="descname">change_policy_primary_name</code><span class="sig-paren">(</span><em>policy_index</em>, <em>new_name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.change_policy_primary_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the primary or default name of a policy. The new primary
name can be an alias that already belongs to the policy or a
completely new name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>policy_index</strong> &#8211; index of a policy in this policy collection.</li>
<li><strong>new_name</strong> &#8211; a string name to set as the new default name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.get_by_index">
<code class="descname">get_by_index</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.get_by_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a storage policy by its index.</p>
<p>An index of None will be treated as 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> &#8211; numeric index of the storage policy</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">storage policy, or None if no such policy</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.get_by_name">
<code class="descname">get_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.get_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a storage policy by its name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; name of the policy</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">storage policy, or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.get_object_ring">
<code class="descname">get_object_ring</code><span class="sig-paren">(</span><em>policy_idx</em>, <em>swift_dir</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.get_object_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ring object to use to handle a request based on its policy.</p>
<p>An index of None will be treated as 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>policy_idx</strong> &#8211; policy index as defined in swift.conf</li>
<li><strong>swift_dir</strong> &#8211; swift_dir used by the caller</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">appropriate ring object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.get_policy_info">
<code class="descname">get_policy_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.get_policy_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Build info about policies for the /info endpoint</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of dicts containing relevant policy information</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.common.storage_policy.StoragePolicyCollection.remove_policy_alias">
<code class="descname">remove_policy_alias</code><span class="sig-paren">(</span><em>*aliases</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.StoragePolicyCollection.remove_policy_alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a name or names from a policy. If the name removed is the
primary name then the next available alias will be adopted
as the new primary name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>aliases</strong> &#8211; arbitrary number of existing policy names to remove.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.common.storage_policy.StoragePolicySingleton">
<em class="property">class </em><code class="descclassname">swift.common.storage_policy.</code><code class="descname">StoragePolicySingleton</code><a class="headerlink" href="#swift.common.storage_policy.StoragePolicySingleton" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>An instance of this class is the primary interface to storage policies
exposed as a module level global named <code class="docutils literal"><span class="pre">POLICIES</span></code>.  This global
reference wraps <code class="docutils literal"><span class="pre">_POLICIES</span></code> which is normally instantiated by parsing
<code class="docutils literal"><span class="pre">swift.conf</span></code> and will result in an instance of
<a class="reference internal" href="#swift.common.storage_policy.StoragePolicyCollection" title="swift.common.storage_policy.StoragePolicyCollection"><code class="xref py py-class docutils literal"><span class="pre">StoragePolicyCollection</span></code></a>.</p>
<p>You should never patch this instance directly, instead patch the module
level <code class="docutils literal"><span class="pre">_POLICIES</span></code> instance so that swift code which imported
<code class="docutils literal"><span class="pre">POLICIES</span></code> directly will reference the patched
<a class="reference internal" href="#swift.common.storage_policy.StoragePolicyCollection" title="swift.common.storage_policy.StoragePolicyCollection"><code class="xref py py-class docutils literal"><span class="pre">StoragePolicyCollection</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.storage_policy.get_policy_string">
<code class="descclassname">swift.common.storage_policy.</code><code class="descname">get_policy_string</code><span class="sig-paren">(</span><em>base</em>, <em>policy_or_index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.get_policy_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to construct a string from a base and the policy.
Used to encode the policy index into either a file name or a
directory name by various modules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base</strong> &#8211; the base string</li>
<li><strong>policy_or_index</strong> &#8211; StoragePolicy instance, or an index
(string or int), if None the legacy
storage Policy-0 is assumed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">base name with policy index added</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">PolicyError if no policy exists with the given policy_index</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.storage_policy.parse_storage_policies">
<code class="descclassname">swift.common.storage_policy.</code><code class="descname">parse_storage_policies</code><span class="sig-paren">(</span><em>conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.parse_storage_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse storage policies in <code class="docutils literal"><span class="pre">swift.conf</span></code> - note that validation
is done when the <a class="reference internal" href="#swift.common.storage_policy.StoragePolicyCollection" title="swift.common.storage_policy.StoragePolicyCollection"><code class="xref py py-class docutils literal"><span class="pre">StoragePolicyCollection</span></code></a> is instantiated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conf</strong> &#8211; ConfigParser parser object for swift.conf</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="swift.common.storage_policy.reload_storage_policies">
<code class="descclassname">swift.common.storage_policy.</code><code class="descname">reload_storage_policies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.reload_storage_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload POLICIES from <code class="docutils literal"><span class="pre">swift.conf</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="swift.common.storage_policy.split_policy_string">
<code class="descclassname">swift.common.storage_policy.</code><code class="descname">split_policy_string</code><span class="sig-paren">(</span><em>policy_string</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.common.storage_policy.split_policy_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to convert a string representing a base and a
policy.  Used to decode the policy from either a file name or
a directory name by various modules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>policy_string</strong> &#8211; base name with policy index added</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">PolicyError if given index does not map to a valid policy</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a tuple, in the form (base, policy) where base is the base
string and policy is the StoragePolicy instance for the
index encoded in the policy_string.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Misc</a><ul>
<li><a class="reference internal" href="#acls">ACLs</a></li>
<li><a class="reference internal" href="#module-swift.common.bufferedhttp">Buffered HTTP</a></li>
<li><a class="reference internal" href="#constraints">Constraints</a></li>
<li><a class="reference internal" href="#module-swift.common.container_sync_realms">Container Sync Realms</a></li>
<li><a class="reference internal" href="#module-swift.common.direct_client">Direct Client</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#module-swift.common.internal_client">Internal Client</a></li>
<li><a class="reference internal" href="#module-swift.common.manager">Manager</a></li>
<li><a class="reference internal" href="#module-swift.common.memcached">MemCacheD</a></li>
<li><a class="reference internal" href="#module-swift.common.request_helpers">Request Helpers</a></li>
<li><a class="reference internal" href="#swob">Swob</a></li>
<li><a class="reference internal" href="#utils">Utils</a></li>
<li><a class="reference internal" href="#wsgi">WSGI</a></li>
<li><a class="reference internal" href="#module-swift.common.storage_policy">Storage Policy</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="object.html"
                                  title="previous chapter">Object</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="middleware.html"
                                  title="next chapter">Middleware</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/swift
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/misc.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="middleware.html" title="Middleware"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="object.html" title="Object"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">swift 2.12.1.dev102 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2017, OpenStack Foundation.
      Last updated on &#39;Tue Feb 14 07:57:22 2017, commit 7cb6882&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/swift");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>