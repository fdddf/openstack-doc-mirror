<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Container &mdash; swift 2.12.1.dev102 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.12.1.dev102',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="swift 2.12.1.dev102 documentation" href="index.html" />
    <link rel="next" title="Account DB and Container DB" href="db.html" />
    <link rel="prev" title="Account" href="account.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="container">
<span id="id1"></span><h1>Container<a class="headerlink" href="#container" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-swift.container.auditor">
<span id="id2"></span><span id="container-auditor"></span><h2>Container Auditor<a class="headerlink" href="#module-swift.container.auditor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.container.auditor.ContainerAuditor">
<em class="property">class </em><code class="descclassname">swift.container.auditor.</code><code class="descname">ContainerAuditor</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.daemon.Daemon</span></code></p>
<p>Audit containers.</p>
<dl class="method">
<dt id="swift.container.auditor.ContainerAuditor.container_audit">
<code class="descname">container_audit</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor.container_audit" title="Permalink to this definition">¶</a></dt>
<dd><p>Audits the given container path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; the path to a container db</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.auditor.ContainerAuditor.run_forever">
<code class="descname">run_forever</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the container audit until stopped.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.auditor.ContainerAuditor.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.auditor.ContainerAuditor.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the container audit once.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.container.auditor.random">
<code class="descclassname">swift.container.auditor.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#swift.container.auditor.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-swift.container.backend">
<span id="id3"></span><span id="container-backend"></span><h2>Container Backend<a class="headerlink" href="#module-swift.container.backend" title="Permalink to this headline">¶</a></h2>
<p>Pluggable Back-ends for Container Server</p>
<dl class="class">
<dt id="swift.container.backend.ContainerBroker">
<em class="property">class </em><code class="descclassname">swift.container.backend.</code><code class="descname">ContainerBroker</code><span class="sig-paren">(</span><em>db_file</em>, <em>timeout=25</em>, <em>logger=None</em>, <em>account=None</em>, <em>container=None</em>, <em>pending_timeout=None</em>, <em>stale_reads_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db.DatabaseBroker" title="swift.common.db.DatabaseBroker"><code class="xref py py-class docutils literal"><span class="pre">swift.common.db.DatabaseBroker</span></code></a></p>
<p>Encapsulates working with a container database.</p>
<dl class="method">
<dt id="swift.container.backend.ContainerBroker.create_container_info_table">
<code class="descname">create_container_info_table</code><span class="sig-paren">(</span><em>conn</em>, <em>put_timestamp</em>, <em>storage_policy_index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_container_info_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the container_info table which is specific to the container DB.
Not a part of Pluggable Back-ends, internal to the baseline code.
Also creates the container_stat view.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; DB connection object</li>
<li><strong>put_timestamp</strong> &#8211; put timestamp</li>
<li><strong>storage_policy_index</strong> &#8211; storage policy index</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.create_object_table">
<code class="descname">create_object_table</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_object_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object table which is specific to the container DB.
Not a part of Pluggable Back-ends, internal to the baseline code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conn</strong> &#8211; DB connection object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.create_policy_stat_table">
<code class="descname">create_policy_stat_table</code><span class="sig-paren">(</span><em>conn</em>, <em>storage_policy_index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.create_policy_stat_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create policy_stat table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; DB connection object</li>
<li><strong>storage_policy_index</strong> &#8211; the policy_index the container is
being created with</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.backend.ContainerBroker.db_contains_type">
<code class="descname">db_contains_type</code><em class="property"> = 'object'</em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_contains_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.backend.ContainerBroker.db_reclaim_timestamp">
<code class="descname">db_reclaim_timestamp</code><em class="property"> = 'created_at'</em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_reclaim_timestamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.backend.ContainerBroker.db_type">
<code class="descname">db_type</code><em class="property"> = 'container'</em><a class="headerlink" href="#swift.container.backend.ContainerBroker.db_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.delete_object">
<code class="descname">delete_object</code><span class="sig-paren">(</span><em>name</em>, <em>timestamp</em>, <em>storage_policy_index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.delete_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark an object deleted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; object name to be deleted</li>
<li><strong>timestamp</strong> &#8211; timestamp when the object was marked as deleted</li>
<li><strong>storage_policy_index</strong> &#8211; the storage policy index for the object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.empty">
<code class="descname">empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if container DB is empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if the database has no active objects, False otherwise</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_db_version">
<code class="descname">get_db_version</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_db_version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_info">
<code class="descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get global data for the container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict with keys: account, container, created_at,
put_timestamp, delete_timestamp, status_changed_at,
object_count, bytes_used, reported_put_timestamp,
reported_delete_timestamp, reported_object_count,
reported_bytes_used, hash, id, x_container_sync_point1,
x_container_sync_point2, and storage_policy_index.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_info_is_deleted">
<code class="descname">get_info_is_deleted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_info_is_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the is_deleted status and info for the container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a tuple, in the form (info, is_deleted) info is a dict as
returned by get_info and is_deleted is a boolean.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_misplaced_since">
<code class="descname">get_misplaced_since</code><span class="sig-paren">(</span><em>start</em>, <em>count</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_misplaced_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of objects which are in a storage policy different
from the container&#8217;s storage policy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> &#8211; last reconciler sync point</li>
<li><strong>count</strong> &#8211; maximum number of entries to get</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of dicts with keys: name, created_at, size,
content_type, etag, storage_policy_index</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_policy_stats">
<code class="descname">get_policy_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_policy_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.get_reconciler_sync">
<code class="descname">get_reconciler_sync</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.get_reconciler_sync" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.has_multiple_policies">
<code class="descname">has_multiple_policies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.has_multiple_policies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.list_objects_iter">
<code class="descname">list_objects_iter</code><span class="sig-paren">(</span><em>limit</em>, <em>marker</em>, <em>end_marker</em>, <em>prefix</em>, <em>delimiter</em>, <em>path=None</em>, <em>storage_policy_index=0</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.list_objects_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of objects sorted by name starting at marker onward, up
to limit entries.  Entries will begin with the prefix and will not
have the delimiter after the prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>limit</strong> &#8211; maximum number of entries to get</li>
<li><strong>marker</strong> &#8211; marker query</li>
<li><strong>end_marker</strong> &#8211; end marker query</li>
<li><strong>prefix</strong> &#8211; prefix query</li>
<li><strong>delimiter</strong> &#8211; delimiter for query</li>
<li><strong>path</strong> &#8211; if defined, will set the prefix and delimiter based on
the path</li>
<li><strong>storage_policy_index</strong> &#8211; storage policy index for query</li>
<li><strong>reverse</strong> &#8211; reverse the result order.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of tuples of (name, created_at, size, content_type,
etag)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.make_tuple_for_pickle">
<code class="descname">make_tuple_for_pickle</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.make_tuple_for_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.merge_items">
<code class="descname">merge_items</code><span class="sig-paren">(</span><em>item_list</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.merge_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge items into the object table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>item_list</strong> &#8211; list of dictionaries of {&#8216;name&#8217;, &#8216;created_at&#8217;,
&#8216;size&#8217;, &#8216;content_type&#8217;, &#8216;etag&#8217;, &#8216;deleted&#8217;,
&#8216;storage_policy_index&#8217;, &#8216;ctype_timestamp&#8217;,
&#8216;meta_timestamp&#8217;}</li>
<li><strong>source</strong> &#8211; if defined, update incoming_sync with the source</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.put_object">
<code class="descname">put_object</code><span class="sig-paren">(</span><em>name</em>, <em>timestamp</em>, <em>size</em>, <em>content_type</em>, <em>etag</em>, <em>deleted=0</em>, <em>storage_policy_index=0</em>, <em>ctype_timestamp=None</em>, <em>meta_timestamp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.put_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an object in the DB with its metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; object name to be created</li>
<li><strong>timestamp</strong> &#8211; timestamp of when the object was created</li>
<li><strong>size</strong> &#8211; object size</li>
<li><strong>content_type</strong> &#8211; object content-type</li>
<li><strong>etag</strong> &#8211; object etag</li>
<li><strong>deleted</strong> &#8211; if True, marks the object as deleted and sets the
deleted_at timestamp to timestamp</li>
<li><strong>storage_policy_index</strong> &#8211; the storage policy index for the object</li>
<li><strong>ctype_timestamp</strong> &#8211; timestamp of when content_type was last
updated</li>
<li><strong>meta_timestamp</strong> &#8211; timestamp of when metadata was last updated</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.reported">
<code class="descname">reported</code><span class="sig-paren">(</span><em>put_timestamp</em>, <em>delete_timestamp</em>, <em>object_count</em>, <em>bytes_used</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.reported" title="Permalink to this definition">¶</a></dt>
<dd><p>Update reported stats, available with container&#8217;s <cite>get_info</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>put_timestamp</strong> &#8211; put_timestamp to update</li>
<li><strong>delete_timestamp</strong> &#8211; delete_timestamp to update</li>
<li><strong>object_count</strong> &#8211; object_count to update</li>
<li><strong>bytes_used</strong> &#8211; bytes_used to update</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.set_storage_policy_index">
<code class="descname">set_storage_policy_index</code><span class="sig-paren">(</span><em>policy_index</em>, <em>timestamp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_storage_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the container_stat policy_index and status_changed_at.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.set_x_container_sync_points">
<code class="descname">set_x_container_sync_points</code><span class="sig-paren">(</span><em>sync_point1</em>, <em>sync_point2</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.set_x_container_sync_points" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.backend.ContainerBroker.storage_policy_index">
<code class="descname">storage_policy_index</code><a class="headerlink" href="#swift.container.backend.ContainerBroker.storage_policy_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.backend.ContainerBroker.update_reconciler_sync">
<code class="descname">update_reconciler_sync</code><span class="sig-paren">(</span><em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.ContainerBroker.update_reconciler_sync" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.container.backend.update_new_item_from_existing">
<code class="descclassname">swift.container.backend.</code><code class="descname">update_new_item_from_existing</code><span class="sig-paren">(</span><em>new_item</em>, <em>existing</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.backend.update_new_item_from_existing" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the data and meta related timestamps of a new object item with
the timestamps of an existing object record, and update the new item
with data and/or meta related attributes from the existing record if
their timestamps are newer.</p>
<p>The multiple timestamps are encoded into a single string for storing
in the &#8216;created_at&#8217; column of the objects db table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>new_item</strong> &#8211; A dict of object update attributes</li>
<li><strong>existing</strong> &#8211; A dict of existing object attributes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if any attributes of the new item dict were found to be
newer than the existing and therefore not updated, otherwise
False implying that the updated item is equal to the existing.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-swift.container.server">
<span id="id4"></span><span id="container-server"></span><h2>Container Server<a class="headerlink" href="#module-swift.container.server" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.container.server.ContainerController">
<em class="property">class </em><code class="descclassname">swift.container.server.</code><code class="descname">ContainerController</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.base_storage_server.BaseStorageServer</span></code></p>
<p>WSGI Controller for the container server.</p>
<dl class="method">
<dt id="swift.container.server.ContainerController.DELETE">
<code class="descname">DELETE</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP DELETE request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.GET">
<code class="descname">GET</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP GET request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.HEAD">
<code class="descname">HEAD</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.HEAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP HEAD request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.POST">
<code class="descname">POST</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP POST request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.PUT">
<code class="descname">PUT</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP PUT request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.REPLICATE">
<code class="descname">REPLICATE</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.REPLICATE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP REPLICATE request (json-encoded RPC calls for replication.)</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.account_update">
<code class="descname">account_update</code><span class="sig-paren">(</span><em>req</em>, <em>account</em>, <em>container</em>, <em>broker</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.account_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the account server(s) with latest container info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>req</strong> &#8211; swob.Request object</li>
<li><strong>account</strong> &#8211; account name</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>broker</strong> &#8211; container DB broker object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">if all the account requests return a 404 error code,
HTTPNotFound response object,
if the account cannot be updated due to a malformed header,
an HTTPBadRequest response object,
otherwise None.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.server.ContainerController.allowed_sync_hosts">
<code class="descname">allowed_sync_hosts</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.server.ContainerController.allowed_sync_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of hosts we&#8217;re allowed to send syncs to. This can be
overridden by data in self.realms_conf</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.create_listing">
<code class="descname">create_listing</code><span class="sig-paren">(</span><em>req</em>, <em>out_content_type</em>, <em>info</em>, <em>resp_headers</em>, <em>metadata</em>, <em>container_list</em>, <em>container</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.create_listing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.get_and_validate_policy_index">
<code class="descname">get_and_validate_policy_index</code><span class="sig-paren">(</span><em>req</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.get_and_validate_policy_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate that the index supplied maps to a policy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">policy index from request, or None if not present</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body">HTTPBadRequest if the supplied index is bogus</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.server.ContainerController.realms_conf">
<code class="descname">realms_conf</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.server.ContainerController.realms_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncCluster instance for validating sync-to values.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.server.ContainerController.save_headers">
<code class="descname">save_headers</code><em class="property"> = ['x-container-read', 'x-container-write', 'x-container-sync-key', 'x-container-sync-to']</em><a class="headerlink" href="#swift.container.server.ContainerController.save_headers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.server.ContainerController.server_type">
<code class="descname">server_type</code><em class="property"> = 'container-server'</em><a class="headerlink" href="#swift.container.server.ContainerController.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.server.ContainerController.update_data_record">
<code class="descname">update_data_record</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.ContainerController.update_data_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform any mutations to container listing records that are common to
all serialization formats, and returns it as a dict.</p>
<p>Converts created time to iso timestamp.
Replaces size with &#8216;swift_bytes&#8217; content type parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Params record:</th><td class="field-body">object entry record</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">modified record</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.container.server.app_factory">
<code class="descclassname">swift.container.server.</code><code class="descname">app_factory</code><span class="sig-paren">(</span><em>global_conf</em>, <em>**local_conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.app_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>paste.deploy app factory for creating WSGI container server apps</p>
</dd></dl>

<dl class="function">
<dt id="swift.container.server.gen_resp_headers">
<code class="descclassname">swift.container.server.</code><code class="descname">gen_resp_headers</code><span class="sig-paren">(</span><em>info</em>, <em>is_deleted=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.server.gen_resp_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert container info dict to headers.</p>
</dd></dl>

</div>
<div class="section" id="module-swift.container.replicator">
<span id="id5"></span><span id="container-replicator"></span><h2>Container Replicator<a class="headerlink" href="#module-swift.container.replicator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.container.replicator.ContainerReplicator">
<em class="property">class </em><code class="descclassname">swift.container.replicator.</code><code class="descname">ContainerReplicator</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db_replicator.Replicator" title="swift.common.db_replicator.Replicator"><code class="xref py py-class docutils literal"><span class="pre">swift.common.db_replicator.Replicator</span></code></a></p>
<dl class="attribute">
<dt id="swift.container.replicator.ContainerReplicator.brokerclass">
<code class="descname">brokerclass</code><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.brokerclass" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">ContainerBroker</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.replicator.ContainerReplicator.datadir">
<code class="descname">datadir</code><em class="property"> = 'containers'</em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.datadir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.replicator.ContainerReplicator.default_port">
<code class="descname">default_port</code><em class="property"> = 6201</em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.default_port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.delete_db">
<code class="descname">delete_db</code><span class="sig-paren">(</span><em>broker</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.delete_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that reconciler databases are only cleaned up at the end of the
replication run.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.dump_to_reconciler">
<code class="descname">dump_to_reconciler</code><span class="sig-paren">(</span><em>broker</em>, <em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.dump_to_reconciler" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for object rows for objects updates in the wrong storage policy
in broker with a <code class="docutils literal"><span class="pre">ROWID</span></code> greater than the rowid given as point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>broker</strong> &#8211; the container broker with misplaced objects</li>
<li><strong>point</strong> &#8211; the last verified <code class="docutils literal"><span class="pre">reconciler_sync_point</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the last successful enqueued rowid</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.feed_reconciler">
<code class="descname">feed_reconciler</code><span class="sig-paren">(</span><em>container</em>, <em>item_list</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.feed_reconciler" title="Permalink to this definition">¶</a></dt>
<dd><p>Add queue entries for rows in item_list to the local reconciler
container database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>container</strong> &#8211; the name of the reconciler container</li>
<li><strong>item_list</strong> &#8211; the list of rows to enqueue</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True if successfully enqueued</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.find_local_handoff_for_part">
<code class="descname">find_local_handoff_for_part</code><span class="sig-paren">(</span><em>part</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.find_local_handoff_for_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Look through devices in the ring for the first handoff device that was
identified during job creation as available on this node.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a node entry from the ring</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.get_reconciler_broker">
<code class="descname">get_reconciler_broker</code><span class="sig-paren">(</span><em>timestamp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.get_reconciler_broker" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a local instance of the reconciler container broker that is
appropriate to enqueue the given timestamp.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>timestamp</strong> &#8211; the timestamp of the row to be enqueued</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a local reconciler broker</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.replicate_reconcilers">
<code class="descname">replicate_reconcilers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.replicate_reconcilers" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure any items merged to reconciler containers during replication
are pushed out to correct nodes and any reconciler containers that do
not belong on this node are removed.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.report_up_to_date">
<code class="descname">report_up_to_date</code><span class="sig-paren">(</span><em>full_info</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.report_up_to_date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.container.replicator.ContainerReplicator.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.run_once" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.replicator.ContainerReplicator.server_type">
<code class="descname">server_type</code><em class="property"> = 'container'</em><a class="headerlink" href="#swift.container.replicator.ContainerReplicator.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="swift.container.replicator.ContainerReplicatorRpc">
<em class="property">class </em><code class="descclassname">swift.container.replicator.</code><code class="descname">ContainerReplicatorRpc</code><span class="sig-paren">(</span><em>root</em>, <em>datadir</em>, <em>broker_class</em>, <em>mount_check=True</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.replicator.ContainerReplicatorRpc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db_replicator.ReplicatorRpc" title="swift.common.db_replicator.ReplicatorRpc"><code class="xref py py-class docutils literal"><span class="pre">swift.common.db_replicator.ReplicatorRpc</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-swift.container.sync">
<span id="container-sync"></span><span id="container-sync-daemon"></span><h2>Container Sync<a class="headerlink" href="#module-swift.container.sync" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.container.sync.ContainerSync">
<em class="property">class </em><code class="descclassname">swift.container.sync.</code><code class="descname">ContainerSync</code><span class="sig-paren">(</span><em>conf</em>, <em>container_ring=None</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.daemon.Daemon</span></code></p>
<p>Daemon to sync syncable containers.</p>
<p>This is done by scanning the local devices for container databases and
checking for x-container-sync-to and x-container-sync-key metadata values.
If they exist, newer rows since the last sync will trigger PUTs or DELETEs
to the other container.</p>
<p>The actual syncing is slightly more complicated to make use of the three
(or number-of-replicas) main nodes for a container without each trying to
do the exact same work but also without missing work if one node happens to
be down.</p>
<p>Two sync points are kept per container database. All rows between the two
sync points trigger updates. Any rows newer than both sync points cause
updates depending on the node&#8217;s position for the container (primary nodes
do one third, etc. depending on the replica count of course). After a sync
run, the first sync point is set to the newest ROWID known and the second
sync point is set to newest ROWID for which all updates have been sent.</p>
<p>An example may help. Assume replica count is 3 and perfectly matching
ROWIDs starting at 1.</p>
<blockquote>
<div><p>First sync run, database has 6 rows:</p>
<blockquote>
<div><ul class="simple">
<li>SyncPoint1 starts as -1.</li>
<li>SyncPoint2 starts as -1.</li>
<li>No rows between points, so no &#8220;all updates&#8221; rows.</li>
<li>Six rows newer than SyncPoint1, so a third of the rows are sent
by node 1, another third by node 2, remaining third by node 3.</li>
<li>SyncPoint1 is set as 6 (the newest ROWID known).</li>
<li>SyncPoint2 is left as -1 since no &#8220;all updates&#8221; rows were synced.</li>
</ul>
</div></blockquote>
<p>Next sync run, database has 12 rows:</p>
<blockquote>
<div><ul class="simple">
<li>SyncPoint1 starts as 6.</li>
<li>SyncPoint2 starts as -1.</li>
<li>The rows between -1 and 6 all trigger updates (most of which
should short-circuit on the remote end as having already been
done).</li>
<li>Six more rows newer than SyncPoint1, so a third of the rows are
sent by node 1, another third by node 2, remaining third by node
3.</li>
<li>SyncPoint1 is set as 12 (the newest ROWID known).</li>
<li>SyncPoint2 is set as 6 (the newest &#8220;all updates&#8221; ROWID).</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>In this way, under normal circumstances each node sends its share of
updates each run and just sends a batch of older updates to ensure nothing
was missed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conf</strong> &#8211; The dict of configuration values from the [container-sync]
section of the container-server.conf</li>
<li><strong>container_ring</strong> &#8211; If None, the &lt;swift_dir&gt;/container.ring.gz will be
loaded. This is overridden by unit tests.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.allowed_sync_hosts">
<code class="descname">allowed_sync_hosts</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.allowed_sync_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of hosts we&#8217;re allowed to send syncs to. This can be
overridden by data in self.realms_conf</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.conf">
<code class="descname">conf</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.conf" title="Permalink to this definition">¶</a></dt>
<dd><p>The dict of configuration values from the [container-sync] section
of the container-server.conf.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_deletes">
<code class="descname">container_deletes</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_deletes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful DELETEs triggered.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_failures">
<code class="descname">container_failures</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_failures" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers that had a failure of some type.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_puts">
<code class="descname">container_puts</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_puts" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of successful PUTs triggered.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.container_report">
<code class="descname">container_report</code><span class="sig-paren">(</span><em>start</em>, <em>end</em>, <em>sync_point1</em>, <em>sync_point2</em>, <em>info</em>, <em>max_row</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_ring">
<code class="descname">container_ring</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>swift.common.ring.Ring for locating containers.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_skips">
<code class="descname">container_skips</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_skips" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers whose sync has been turned off, but
are not yet cleared from the sync store.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_stats">
<code class="descname">container_stats</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Per container stats. These are collected per container.
puts - the number of puts that were done for the container
deletes - the number of deletes that were fot the container
bytes - the total number of bytes transferred per the container</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.container_sync">
<code class="descname">container_sync</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the given path for a container database, determines if syncing
is turned on for that database and, if so, sends any updates to the
other container.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; the path to a container db</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.container_sync_row">
<code class="descname">container_sync_row</code><span class="sig-paren">(</span><em>row</em>, <em>sync_to</em>, <em>user_key</em>, <em>broker</em>, <em>info</em>, <em>realm</em>, <em>realm_key</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.container_sync_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends the update the row indicates to the sync_to container.
Update can be either delete or put.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> &#8211; The updated row in the local database triggering the sync
update.</li>
<li><strong>sync_to</strong> &#8211; The URL to the remote container.</li>
<li><strong>user_key</strong> &#8211; The X-Container-Sync-Key to use when sending requests
to the other container.</li>
<li><strong>broker</strong> &#8211; The local container database broker.</li>
<li><strong>info</strong> &#8211; The get_info result from the local container database
broker.</li>
<li><strong>realm</strong> &#8211; The realm from self.realms_conf, if there is one.
If None, fallback to using the older allowed_sync_hosts
way of syncing.</li>
<li><strong>realm_key</strong> &#8211; The realm key from self.realms_conf, if there
is one. If None, fallback to using the older
allowed_sync_hosts way of syncing.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True on success</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_syncs">
<code class="descname">container_syncs</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_syncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of containers with sync turned on that were successfully
synced.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.container_time">
<code class="descname">container_time</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.container_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum amount of time to spend syncing a container before moving on
to the next one. If a container sync hasn&#8217;t finished in this time,
it&#8217;ll just be resumed next scan.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.devices">
<code class="descname">devices</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.devices" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the local device mount points.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.interval">
<code class="descname">interval</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum time between full scans. This is to keep the daemon from
running wild on near empty systems.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.logger">
<code class="descname">logger</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Logger to use for container-sync log lines.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.mount_check">
<code class="descname">mount_check</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.mount_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether mount points should be verified as actual mount
points (normally true, false for tests and SAIO).</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.realms_conf">
<code class="descname">realms_conf</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.realms_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncCluster instance for validating sync-to values.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.report">
<code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a report of the stats to the logger and resets the stats for the
next report.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.reported">
<code class="descname">reported</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.reported" title="Permalink to this definition">¶</a></dt>
<dd><p>Time of last stats report.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.run_forever">
<code class="descname">run_forever</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs container sync scans until stopped.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single container sync scan.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.sync.ContainerSync.select_http_proxy">
<code class="descname">select_http_proxy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.sync.ContainerSync.select_http_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.container.sync.ContainerSync.sync_store">
<code class="descname">sync_store</code><em class="property"> = None</em><a class="headerlink" href="#swift.container.sync.ContainerSync.sync_store" title="Permalink to this definition">¶</a></dt>
<dd><p>ContainerSyncStore instance for iterating over synced containers</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.container.sync.random">
<code class="descclassname">swift.container.sync.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#swift.container.sync.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-swift.container.updater">
<span id="id6"></span><span id="container-updater"></span><h2>Container Updater<a class="headerlink" href="#module-swift.container.updater" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.container.updater.ContainerUpdater">
<em class="property">class </em><code class="descclassname">swift.container.updater.</code><code class="descname">ContainerUpdater</code><span class="sig-paren">(</span><em>conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.daemon.Daemon</span></code></p>
<p>Update container information in account listings.</p>
<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.container_report">
<code class="descname">container_report</code><span class="sig-paren">(</span><em>node</em>, <em>part</em>, <em>container</em>, <em>put_timestamp</em>, <em>delete_timestamp</em>, <em>count</em>, <em>bytes</em>, <em>storage_policy_index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.container_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Report container info to an account server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>node</strong> &#8211; node dictionary from the account ring</li>
<li><strong>part</strong> &#8211; partition the account is on</li>
<li><strong>container</strong> &#8211; container name</li>
<li><strong>put_timestamp</strong> &#8211; put timestamp</li>
<li><strong>delete_timestamp</strong> &#8211; delete timestamp</li>
<li><strong>count</strong> &#8211; object count in the container</li>
<li><strong>bytes</strong> &#8211; bytes used in the container</li>
<li><strong>storage_policy_index</strong> &#8211; the policy index for the container</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.container_sweep">
<code class="descname">container_sweep</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.container_sweep" title="Permalink to this definition">¶</a></dt>
<dd><p>Walk the path looking for container DBs and process them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; path to walk</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.get_account_ring">
<code class="descname">get_account_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.get_account_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the account ring.  Load it if it hasn&#8217;t been yet.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.get_paths">
<code class="descname">get_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.get_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get paths to all of the partitions on each drive to be processed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of paths</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.process_container">
<code class="descname">process_container</code><span class="sig-paren">(</span><em>dbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.process_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Process a container, and update the information in the account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dbfile</strong> &#8211; container DB to process</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.run_forever">
<code class="descname">run_forever</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the updater continuously.</p>
</dd></dl>

<dl class="method">
<dt id="swift.container.updater.ContainerUpdater.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.container.updater.ContainerUpdater.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the updater once.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.container.updater.random">
<code class="descclassname">swift.container.updater.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#swift.container.updater.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Container</a><ul>
<li><a class="reference internal" href="#module-swift.container.auditor">Container Auditor</a></li>
<li><a class="reference internal" href="#module-swift.container.backend">Container Backend</a></li>
<li><a class="reference internal" href="#module-swift.container.server">Container Server</a></li>
<li><a class="reference internal" href="#module-swift.container.replicator">Container Replicator</a></li>
<li><a class="reference internal" href="#module-swift.container.sync">Container Sync</a></li>
<li><a class="reference internal" href="#module-swift.container.updater">Container Updater</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="account.html"
                                  title="previous chapter">Account</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="db.html"
                                  title="next chapter">Account DB and Container DB</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/swift
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/container.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="db.html" title="Account DB and Container DB"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="account.html" title="Account"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">swift 2.12.1.dev102 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2017, OpenStack Foundation.
      Last updated on &#39;Tue Feb 14 07:57:22 2017, commit 7cb6882&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/swift");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>