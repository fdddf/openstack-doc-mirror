<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Account &mdash; swift 2.12.1.dev102 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.12.1.dev102',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="swift 2.12.1.dev102 documentation" href="index.html" />
    <link rel="next" title="Container" href="container.html" />
    <link rel="prev" title="Proxy" href="proxy.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="account">
<span id="id1"></span><h1>Account<a class="headerlink" href="#account" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-swift.account.auditor">
<span id="id2"></span><span id="account-auditor"></span><h2>Account Auditor<a class="headerlink" href="#module-swift.account.auditor" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.account.auditor.AccountAuditor">
<em class="property">class </em><code class="descclassname">swift.account.auditor.</code><code class="descname">AccountAuditor</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.auditor.AccountAuditor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.daemon.Daemon</span></code></p>
<p>Audit accounts.</p>
<dl class="method">
<dt id="swift.account.auditor.AccountAuditor.account_audit">
<code class="descname">account_audit</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.auditor.AccountAuditor.account_audit" title="Permalink to this definition">¶</a></dt>
<dd><p>Audits the given account path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; the path to an account db</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.auditor.AccountAuditor.run_forever">
<code class="descname">run_forever</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.auditor.AccountAuditor.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the account audit until stopped.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.auditor.AccountAuditor.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.auditor.AccountAuditor.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the account audit once.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.auditor.AccountAuditor.validate_per_policy_counts">
<code class="descname">validate_per_policy_counts</code><span class="sig-paren">(</span><em>broker</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.auditor.AccountAuditor.validate_per_policy_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.account.auditor.random">
<code class="descclassname">swift.account.auditor.</code><code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; x in the interval [0, 1).<a class="headerlink" href="#swift.account.auditor.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-swift.account.backend">
<span id="id3"></span><span id="account-backend"></span><h2>Account Backend<a class="headerlink" href="#module-swift.account.backend" title="Permalink to this headline">¶</a></h2>
<p>Pluggable Back-end for Account Server</p>
<dl class="class">
<dt id="swift.account.backend.AccountBroker">
<em class="property">class </em><code class="descclassname">swift.account.backend.</code><code class="descname">AccountBroker</code><span class="sig-paren">(</span><em>db_file</em>, <em>timeout=25</em>, <em>logger=None</em>, <em>account=None</em>, <em>container=None</em>, <em>pending_timeout=None</em>, <em>stale_reads_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="db.html#swift.common.db.DatabaseBroker" title="swift.common.db.DatabaseBroker"><code class="xref py py-class docutils literal"><span class="pre">swift.common.db.DatabaseBroker</span></code></a></p>
<p>Encapsulates working with an account database.</p>
<dl class="method">
<dt id="swift.account.backend.AccountBroker.create_account_stat_table">
<code class="descname">create_account_stat_table</code><span class="sig-paren">(</span><em>conn</em>, <em>put_timestamp</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.create_account_stat_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create account_stat table which is specific to the account DB.
Not a part of Pluggable Back-ends, internal to the baseline code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>conn</strong> &#8211; DB connection object</li>
<li><strong>put_timestamp</strong> &#8211; put timestamp</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.create_container_table">
<code class="descname">create_container_table</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.create_container_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create container table which is specific to the account DB.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conn</strong> &#8211; DB connection object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.create_policy_stat_table">
<code class="descname">create_policy_stat_table</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.create_policy_stat_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Create policy_stat table which is specific to the account DB.
Not a part of Pluggable Back-ends, internal to the baseline code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>conn</strong> &#8211; DB connection object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="swift.account.backend.AccountBroker.db_contains_type">
<code class="descname">db_contains_type</code><em class="property"> = 'container'</em><a class="headerlink" href="#swift.account.backend.AccountBroker.db_contains_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.account.backend.AccountBroker.db_reclaim_timestamp">
<code class="descname">db_reclaim_timestamp</code><em class="property"> = 'delete_timestamp'</em><a class="headerlink" href="#swift.account.backend.AccountBroker.db_reclaim_timestamp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="swift.account.backend.AccountBroker.db_type">
<code class="descname">db_type</code><em class="property"> = 'account'</em><a class="headerlink" href="#swift.account.backend.AccountBroker.db_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.empty">
<code class="descname">empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the account DB is empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if the database has no active containers.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.get_db_version">
<code class="descname">get_db_version</code><span class="sig-paren">(</span><em>conn</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.get_db_version" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.get_info">
<code class="descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get global data for the account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict with keys: account, created_at, put_timestamp,
delete_timestamp, status_changed_at, container_count,
object_count, bytes_used, hash, id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.get_policy_stats">
<code class="descname">get_policy_stats</code><span class="sig-paren">(</span><em>do_migrations=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.get_policy_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Get global policy stats for the account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>do_migrations</strong> &#8211; boolean, if True the policy stat dicts will
always include the &#8216;container_count&#8217; key;
otherwise it may be omitted on legacy databases
until they are migrated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict of policy stats where the key is the policy index and
the value is a dictionary like {&#8216;object_count&#8217;: M,
&#8216;bytes_used&#8217;: N, &#8216;container_count&#8217;: L}</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.is_status_deleted">
<code class="descname">is_status_deleted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.is_status_deleted" title="Permalink to this definition">¶</a></dt>
<dd><p>Only returns true if the status field is set to DELETED.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.list_containers_iter">
<code class="descname">list_containers_iter</code><span class="sig-paren">(</span><em>limit</em>, <em>marker</em>, <em>end_marker</em>, <em>prefix</em>, <em>delimiter</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.list_containers_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of containers sorted by name starting at marker onward, up
to limit entries. Entries will begin with the prefix and will not have
the delimiter after the prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>limit</strong> &#8211; maximum number of entries to get</li>
<li><strong>marker</strong> &#8211; marker query</li>
<li><strong>end_marker</strong> &#8211; end marker query</li>
<li><strong>prefix</strong> &#8211; prefix query</li>
<li><strong>delimiter</strong> &#8211; delimiter for query</li>
<li><strong>reverse</strong> &#8211; reverse the result order.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of tuples of (name, object_count, bytes_used,
put_timestamp, 0)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.make_tuple_for_pickle">
<code class="descname">make_tuple_for_pickle</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.make_tuple_for_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.merge_items">
<code class="descname">merge_items</code><span class="sig-paren">(</span><em>item_list</em>, <em>source=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.merge_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge items into the container table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>item_list</strong> &#8211; list of dictionaries of {&#8216;name&#8217;, &#8216;put_timestamp&#8217;,
&#8216;delete_timestamp&#8217;, &#8216;object_count&#8217;, &#8216;bytes_used&#8217;,
&#8216;deleted&#8217;, &#8216;storage_policy_index&#8217;}</li>
<li><strong>source</strong> &#8211; if defined, update incoming_sync with the source</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.backend.AccountBroker.put_container">
<code class="descname">put_container</code><span class="sig-paren">(</span><em>name</em>, <em>put_timestamp</em>, <em>delete_timestamp</em>, <em>object_count</em>, <em>bytes_used</em>, <em>storage_policy_index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.backend.AccountBroker.put_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a container with the given attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> &#8211; name of the container to create</li>
<li><strong>put_timestamp</strong> &#8211; put_timestamp of the container to create</li>
<li><strong>delete_timestamp</strong> &#8211; delete_timestamp of the container to create</li>
<li><strong>object_count</strong> &#8211; number of objects in the container</li>
<li><strong>bytes_used</strong> &#8211; number of bytes used by the container</li>
<li><strong>storage_policy_index</strong> &#8211; the storage policy for this container</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swift.account.reaper">
<span id="id4"></span><span id="account-reaper"></span><h2>Account Reaper<a class="headerlink" href="#module-swift.account.reaper" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.account.reaper.AccountReaper">
<em class="property">class </em><code class="descclassname">swift.account.reaper.</code><code class="descname">AccountReaper</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.daemon.Daemon</span></code></p>
<p>Removes data from status=DELETED accounts. These are accounts that have
been asked to be removed by the reseller via services
remove_storage_account XMLRPC call.</p>
<p>The account is not deleted immediately by the services call, but instead
the account is simply marked for deletion by setting the status column in
the account_stat table of the account database. This account reaper scans
for such accounts and removes the data in the background. The background
deletion process will occur on the primary account server for the account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>server_conf</strong> &#8211; The [account-server] dictionary of the account server
configuration file</li>
<li><strong>reaper_conf</strong> &#8211; The [account-reaper] dictionary of the account server
configuration file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>See the etc/account-server.conf-sample for information on the possible
configuration parameters.</p>
<dl class="method">
<dt id="swift.account.reaper.AccountReaper.get_account_ring">
<code class="descname">get_account_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.get_account_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>The account <code class="xref py py-class docutils literal"><span class="pre">swift.common.ring.Ring</span></code> for the cluster.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.get_container_ring">
<code class="descname">get_container_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.get_container_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>The container <code class="xref py py-class docutils literal"><span class="pre">swift.common.ring.Ring</span></code> for the cluster.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.get_object_ring">
<code class="descname">get_object_ring</code><span class="sig-paren">(</span><em>policy_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.get_object_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the ring identified by the policy index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>policy_idx</strong> &#8211; Storage policy index</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A ring matching the storage policy</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.reap_account">
<code class="descname">reap_account</code><span class="sig-paren">(</span><em>broker</em>, <em>partition</em>, <em>nodes</em>, <em>container_shard=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.reap_account" title="Permalink to this definition">¶</a></dt>
<dd><p>Called once per pass for each account this server is the primary for
and attempts to delete the data for the given account. The reaper will
only delete one account at any given time. It will call
<a class="reference internal" href="#swift.account.reaper.AccountReaper.reap_container" title="swift.account.reaper.AccountReaper.reap_container"><code class="xref py py-func docutils literal"><span class="pre">reap_container()</span></code></a> up to sqrt(self.concurrency) times concurrently
while reaping the account.</p>
<p>If there is any exception while deleting a single container, the
process will continue for any other containers and the failed
containers will be tried again the next time this function is called
with the same parameters.</p>
<p>If there is any exception while listing the containers for deletion,
the process will stop (but will obviously be tried again the next time
this function is called with the same parameters). This isn&#8217;t likely
since the listing comes from the local database.</p>
<p>After the process completes (successfully or not) statistics about what
was accomplished will be logged.</p>
<p>This function returns nothing and should raise no exception but only
update various self.stats_* values for what occurs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>broker</strong> &#8211; The AccountBroker for the account to delete.</li>
<li><strong>partition</strong> &#8211; The partition in the account ring the account is on.</li>
<li><strong>nodes</strong> &#8211; The primary node dicts for the account to delete.</li>
<li><strong>container_shard</strong> &#8211; int used to shard containers reaped. If None,
will reap all containers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#swift.account.backend.AccountBroker" title="swift.account.backend.AccountBroker"><code class="xref py py-class docutils literal"><span class="pre">swift.account.backend.AccountBroker</span></code></a> for the broker class.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal"><span class="pre">swift.common.ring.Ring.get_nodes()</span></code> for a description
of the node dicts.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.reap_container">
<code class="descname">reap_container</code><span class="sig-paren">(</span><em>account</em>, <em>account_partition</em>, <em>account_nodes</em>, <em>container</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.reap_container" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the data and the container itself for the given container. This
will call <a class="reference internal" href="#swift.account.reaper.AccountReaper.reap_object" title="swift.account.reaper.AccountReaper.reap_object"><code class="xref py py-func docutils literal"><span class="pre">reap_object()</span></code></a> up to sqrt(self.concurrency) times
concurrently for the objects in the container.</p>
<p>If there is any exception while deleting a single object, the process
will continue for any other objects in the container and the failed
objects will be tried again the next time this function is called with
the same parameters.</p>
<p>If there is any exception while listing the objects for deletion, the
process will stop (but will obviously be tried again the next time this
function is called with the same parameters). This is a possibility
since the listing comes from querying just the primary remote container
server.</p>
<p>Once all objects have been attempted to be deleted, the container
itself will be attempted to be deleted by sending a delete request to
all container nodes. The format of the delete request is such that each
container server will update a corresponding account server, removing
the container from the account&#8217;s listing.</p>
<p>This function returns nothing and should raise no exception but only
update various self.stats_* values for what occurs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>account</strong> &#8211; The name of the account for the container.</li>
<li><strong>account_partition</strong> &#8211; The partition for the account on the account
ring.</li>
<li><strong>account_nodes</strong> &#8211; The primary node dicts for the account.</li>
<li><strong>container</strong> &#8211; The name of the container to delete.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>See also: <code class="xref py py-func docutils literal"><span class="pre">swift.common.ring.Ring.get_nodes()</span></code> for a description
of the account node dicts.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.reap_device">
<code class="descname">reap_device</code><span class="sig-paren">(</span><em>device</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.reap_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Called once per pass for each device on the server. This will scan the
accounts directory for the device, looking for partitions this device
is the primary for, then looking for account databases that are marked
status=DELETED and still have containers and calling
<a class="reference internal" href="#swift.account.reaper.AccountReaper.reap_account" title="swift.account.reaper.AccountReaper.reap_account"><code class="xref py py-func docutils literal"><span class="pre">reap_account()</span></code></a>. Account databases marked status=DELETED that no
longer have containers will eventually be permanently removed by the
reclaim process within the account replicator (see
<code class="xref py py-mod docutils literal"><span class="pre">swift.db_replicator</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>device</strong> &#8211; The device to look for accounts to be deleted.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.reap_object">
<code class="descname">reap_object</code><span class="sig-paren">(</span><em>account</em>, <em>container</em>, <em>container_partition</em>, <em>container_nodes</em>, <em>obj</em>, <em>policy_index</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.reap_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the given object by issuing a delete request to each node for
the object. The format of the delete request is such that each object
server will update a corresponding container server, removing the
object from the container&#8217;s listing.</p>
<p>This function returns nothing and should raise no exception but only
update various self.stats_* values for what occurs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>account</strong> &#8211; The name of the account for the object.</li>
<li><strong>container</strong> &#8211; The name of the container for the object.</li>
<li><strong>container_partition</strong> &#8211; The partition for the container on the
container ring.</li>
<li><strong>container_nodes</strong> &#8211; The primary node dicts for the container.</li>
<li><strong>obj</strong> &#8211; The name of the object to delete.</li>
<li><strong>policy_index</strong> &#8211; The storage policy index of the object&#8217;s container</li>
</ul>
</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>See also: <code class="xref py py-func docutils literal"><span class="pre">swift.common.ring.Ring.get_nodes()</span></code> for a description
of the container node dicts.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.reset_stats">
<code class="descname">reset_stats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.reset_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.run_forever">
<code class="descname">run_forever</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.run_forever" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point when running the reaper in normal daemon mode.</p>
<p>This repeatedly calls <a class="reference internal" href="#swift.account.reaper.AccountReaper.run_once" title="swift.account.reaper.AccountReaper.run_once"><code class="xref py py-func docutils literal"><span class="pre">run_once()</span></code></a> no quicker than the
configuration interval.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.reaper.AccountReaper.run_once">
<code class="descname">run_once</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.reaper.AccountReaper.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Main entry point when running the reaper in &#8216;once&#8217; mode, where it will
do a single pass over all accounts on the server. This is called
repeatedly by <a class="reference internal" href="#swift.account.reaper.AccountReaper.run_forever" title="swift.account.reaper.AccountReaper.run_forever"><code class="xref py py-func docutils literal"><span class="pre">run_forever()</span></code></a>. This will call <a class="reference internal" href="#swift.account.reaper.AccountReaper.reap_device" title="swift.account.reaper.AccountReaper.reap_device"><code class="xref py py-func docutils literal"><span class="pre">reap_device()</span></code></a>
once for each device on the server.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-swift.account.server">
<span id="id5"></span><span id="account-server"></span><h2>Account Server<a class="headerlink" href="#module-swift.account.server" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="swift.account.server.AccountController">
<em class="property">class </em><code class="descclassname">swift.account.server.</code><code class="descname">AccountController</code><span class="sig-paren">(</span><em>conf</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">swift.common.base_storage_server.BaseStorageServer</span></code></p>
<p>WSGI controller for the account server.</p>
<dl class="method">
<dt id="swift.account.server.AccountController.DELETE">
<code class="descname">DELETE</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.DELETE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP DELETE request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.server.AccountController.GET">
<code class="descname">GET</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.GET" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP GET request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.server.AccountController.HEAD">
<code class="descname">HEAD</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.HEAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP HEAD request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.server.AccountController.POST">
<code class="descname">POST</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.POST" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP POST request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.server.AccountController.PUT">
<code class="descname">PUT</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.PUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP PUT request.</p>
</dd></dl>

<dl class="method">
<dt id="swift.account.server.AccountController.REPLICATE">
<code class="descname">REPLICATE</code><span class="sig-paren">(</span><em>ctrl</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.AccountController.REPLICATE" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle HTTP REPLICATE request.
Handler for RPC calls for account replication.</p>
</dd></dl>

<dl class="attribute">
<dt id="swift.account.server.AccountController.server_type">
<code class="descname">server_type</code><em class="property"> = 'account-server'</em><a class="headerlink" href="#swift.account.server.AccountController.server_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="swift.account.server.app_factory">
<code class="descclassname">swift.account.server.</code><code class="descname">app_factory</code><span class="sig-paren">(</span><em>global_conf</em>, <em>**local_conf</em><span class="sig-paren">)</span><a class="headerlink" href="#swift.account.server.app_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>paste.deploy app factory for creating WSGI account server apps</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Account</a><ul>
<li><a class="reference internal" href="#module-swift.account.auditor">Account Auditor</a></li>
<li><a class="reference internal" href="#module-swift.account.backend">Account Backend</a></li>
<li><a class="reference internal" href="#module-swift.account.reaper">Account Reaper</a></li>
<li><a class="reference internal" href="#module-swift.account.server">Account Server</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="proxy.html"
                                  title="previous chapter">Proxy</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="container.html"
                                  title="next chapter">Container</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/swift
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/account.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="container.html" title="Container"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="proxy.html" title="Proxy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">swift 2.12.1.dev102 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2017, OpenStack Foundation.
      Last updated on &#39;Tue Feb 14 07:57:22 2017, commit 7cb6882&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/swift");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>