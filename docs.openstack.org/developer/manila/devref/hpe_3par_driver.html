<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: HPE 3PAR Driver</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>HPE 3PAR Driver</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="hitachi_hnas_driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Hitachi NAS Platform File Services Driver for OpenStack"></i></a>
    
    
    <a href="tegile_driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Tegile Driver"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">HPE 3PAR Driver</a><ul>
<li><a class="reference internal" href="#supported-operations">Supported Operations</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#pre-configuration-on-the-hpe-3par">Pre-Configuration on the HPE 3PAR</a></li>
<li><a class="reference internal" href="#backend-configuration">Backend Configuration</a></li>
<li><a class="reference internal" href="#backend-configuration-for-ad-user">Backend Configuration for AD user</a></li>
<li><a class="reference internal" href="#example-of-using-ad-user-to-access-cifs-share">Example of using AD user to access CIFS share</a></li>
<li><a class="reference internal" href="#network-approach">Network Approach</a></li>
<li><a class="reference internal" href="#share-types">Share Types</a></li>
<li><a class="reference internal" href="#delete-nested-shares">Delete Nested Shares</a><ul>
<li><a class="reference internal" href="#the-manila-share-drivers-hpe-hpe-3par-driver-module">The <code class="docutils literal"><span class="pre">manila.share.drivers.hpe.hpe_3par_driver</span></code> Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="hpe-3par-driver">
<h1>HPE 3PAR Driver<a class="headerlink" href="#hpe-3par-driver" title="Permalink to this headline">¶</a></h1>
<p>The HPE 3PAR manila driver provides NFS and CIFS shared file systems to
OpenStack using HPE 3PAR&#8217;s File Persona capabilities.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In OpenStack releases prior to Mitaka this driver was called the
HP 3PAR driver. The Liberty configuration reference can be found
at: <a class="reference external" href="http://docs.openstack.org/liberty/config-reference/content/hp-3par-share-driver.html">http://docs.openstack.org/liberty/config-reference/content/hp-3par-share-driver.html</a></p>
</div>
<div class="section" id="supported-operations">
<h2>Supported Operations<a class="headerlink" href="#supported-operations" title="Permalink to this headline">¶</a></h2>
<p>The following operations are supported with HPE 3PAR File Persona:</p>
<ul class="simple">
<li>Create/delete NFS and CIFS shares<ul>
<li>Shares are not accessible until access rules allow access</li>
</ul>
</li>
<li>Allow/deny NFS share access<ul>
<li>IP access rules are required for NFS share access</li>
</ul>
</li>
<li>Allow/deny CIFS share access<ul>
<li>CIFS shares require user access rules.</li>
<li>User access requires a 3PAR local or AD user (LDAP is not yet supported)</li>
</ul>
</li>
<li>Create/delete snapshots</li>
<li>Create shares from snapshots</li>
</ul>
<p>Share networks are not supported. Shares are created directly on the 3PAR
without the use of a share server or service VM. Network connectivity is
setup outside of manila.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>On the system running the manila share service:</p>
<ul class="simple">
<li>python-3parclient 4.2.0 or newer from PyPI.</li>
</ul>
<p>On the HPE 3PAR array:</p>
<ul class="simple">
<li>HPE 3PAR Operating System software version 3.2.1 MU3 or higher</li>
<li>A license that enables the File Persona feature</li>
<li>The array class and hardware configuration must support File Persona</li>
</ul>
</div>
<div class="section" id="pre-configuration-on-the-hpe-3par">
<h2>Pre-Configuration on the HPE 3PAR<a class="headerlink" href="#pre-configuration-on-the-hpe-3par" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>HPE 3PAR File Persona must be initialized and started (<code class="code docutils literal"><span class="pre">startfs</span></code>)</li>
<li>A File Provisioning Group (FPG) must be created for use with manila</li>
<li>A Virtual File Server (VFS) must be created for the FPG</li>
<li>The VFS must be configured with an appropriate share export IP address</li>
<li>A local user in the Administrators group is needed for CIFS shares</li>
</ul>
</div>
<div class="section" id="backend-configuration">
<h2>Backend Configuration<a class="headerlink" href="#backend-configuration" title="Permalink to this headline">¶</a></h2>
<p>The following parameters need to be configured in the manila configuration
file for the HPE 3PAR driver:</p>
<ul class="simple">
<li><cite>share_backend_name</cite> = &lt;backend name to enable&gt;</li>
<li><cite>share_driver</cite> = manila.share.drivers.hpe.hpe_3par_driver.HPE3ParShareDriver</li>
<li><cite>driver_handles_share_servers</cite> = False</li>
<li><cite>hpe3par_fpg</cite> = &lt;FPG to use for share creation&gt;</li>
<li><cite>hpe3par_share_ip_address</cite> = &lt;IP address to use for share export location&gt;</li>
<li><cite>hpe3par_san_ip</cite> = &lt;IP address for SSH access to the SAN controller&gt;</li>
<li><cite>hpe3par_api_url</cite> = &lt;3PAR WS API Server URL&gt;</li>
<li><cite>hpe3par_username</cite> = &lt;3PAR username with the &#8216;edit&#8217; role&gt;</li>
<li><cite>hpe3par_password</cite> = &lt;3PAR password for the user specified in hpe3par_username&gt;</li>
<li><cite>hpe3par_san_login</cite> = &lt;Username for SSH access to the SAN controller&gt;</li>
<li><cite>hpe3par_san_password</cite> = &lt;Password for SSH access to the SAN controller&gt;</li>
<li><cite>hpe3par_debug</cite> = &lt;False or True for extra debug logging&gt;</li>
<li><cite>hpe3par_cifs_admin_access_username</cite> = &lt;CIFS admin user name&gt;</li>
<li><cite>hpe3par_cifs_admin_access_password</cite> = &lt;CIFS admin password&gt;</li>
<li><cite>hpe3par_cifs_admin_access_domain</cite> = &lt;CIFS admin domain&gt;</li>
<li><cite>hpe3par_share_mount_path</cite> = &lt;Full path to mount shares&gt;</li>
</ul>
<p>The <cite>hpe3par_share_ip_address</cite> must be a valid IP address for the configured
FPG&#8217;s VFS. This IP address is used in export locations for shares that are
created. Networking must be configured to allow connectivity from clients to
shares.</p>
<p><cite>hpe3par_cifs_admin_access_username</cite> and <cite>hpe3par_cifs_admin_access_password</cite>
must be provided to delete nested CIFS shares. If they are not, the share
contents will not be deleted. <cite>hpe3par_cifs_admin_access_domain</cite> and
<cite>hpe3par_share_mount_path</cite> can be provided for additional configuration.</p>
<p>Restart of <a class="reference internal" href="../glossary.html#term-manila-share"><span class="xref std std-term">manila-share</span></a> service is needed for the configuration changes to take
effect.</p>
</div>
<div class="section" id="backend-configuration-for-ad-user">
<h2>Backend Configuration for AD user<a class="headerlink" href="#backend-configuration-for-ad-user" title="Permalink to this headline">¶</a></h2>
<p>The following parameters need to be configured through HPE 3PAR CLI to access
file share using AD.</p>
<p>Set authentication parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ setauthparam ldap-server IP_ADDRESS_OF_AD_SERVER
$ setauthparam binding simple
$ setauthparam user-attr AD_DOMAIN_NAME\\
$ setauthparam accounts-dn CN=Users,DC=AD,DC=DOMAIN,DC=NAME
$ setauthparam account-obj user
$ setauthparam account-name-attr sAMAccountName
$ setauthparam memberof-attr memberOf
$ setauthparam super-map CN=AD_USER_GROUP,DC=AD,DC=DOMAIN,DC=NAME
</pre></div>
</div>
<p>Verify new authentication parameters set as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ showauthparam
</pre></div>
</div>
<p>Verify AD users set as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ checkpassword AD_USER
</pre></div>
</div>
<p>Command result should show <code class="docutils literal"><span class="pre">user</span> <span class="pre">AD_USER</span> <span class="pre">is</span> <span class="pre">authenticated</span> <span class="pre">and</span> <span class="pre">authorized</span></code>
message on successful configuration.</p>
<p>Add &#8216;ActiveDirectory&#8217; in authentication providers list:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ setfs auth ActiveDirectory Local
</pre></div>
</div>
<p>Verify authentication provider list shows &#8216;ActiveDirectory&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ showfs -auth
</pre></div>
</div>
<p>Set/Add AD user on FS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ setfs ad –passwd PASSWORD AD_USER AD_DOMAIN_NAME
</pre></div>
</div>
<p>Verify FS user details:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ showfs -ad
</pre></div>
</div>
</div>
<div class="section" id="example-of-using-ad-user-to-access-cifs-share">
<h2>Example of using AD user to access CIFS share<a class="headerlink" href="#example-of-using-ad-user-to-access-cifs-share" title="Permalink to this headline">¶</a></h2>
<p>Pre-requisite:</p>
<ul class="simple">
<li>Share type should be configured for 3PAR backend</li>
</ul>
<p>Create a CIFS file share with 2GB of size:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ manila create --name FILE_SHARE_NAME --share-type SHARE_TYPE CIFS 2
</pre></div>
</div>
<p>Check file share created as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ manila show FILE_SHARE_NAME
</pre></div>
</div>
<p>Configuration to provide share access to AD user:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ manila access-allow FILE_SHARE_NAME user AD_DOMAIN_NAME\\\\AD_USER
  --access-level rw
</pre></div>
</div>
<p>Check users permission set as expected:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ manila access-list FILE_SHARE_NAME
</pre></div>
</div>
<p>The AD_DOMAIN_NAME\AD_USER must be listed in access_to column and should
show active in its state column as result of this command.</p>
</div>
<div class="section" id="network-approach">
<h2>Network Approach<a class="headerlink" href="#network-approach" title="Permalink to this headline">¶</a></h2>
<p>Connectivity between the storage array (SSH/CLI and WSAPI) and the manila host
is required for share management.</p>
<p>Connectivity between the clients and the VFS is required for mounting
and using the shares. This includes:</p>
<ul class="simple">
<li>Routing from the client to the external network</li>
<li>Assigning the client an external IP address (e.g., a floating IP)</li>
<li>Configuring the manila host networking properly for IP forwarding</li>
<li>Configuring the VFS networking properly for client subnets</li>
</ul>
</div>
<div class="section" id="share-types">
<h2>Share Types<a class="headerlink" href="#share-types" title="Permalink to this headline">¶</a></h2>
<p>When creating a share, a share type can be specified to determine where and
how the share will be created. If a share type is not specified, the
<cite>default_share_type</cite> set in the manila configuration file is used.</p>
<p>Manila requires that the share type includes the
<cite>driver_handles_share_servers</cite> extra-spec. This ensures that the share
will be created on a backend that supports the requested
driver_handles_share_servers (share networks) capability.
For the HPE 3PAR driver, this must be set to False.</p>
<p>Another common manila extra-spec used to determine where a share is created
is <cite>share_backend_name</cite>. When this extra-spec is defined in the share type,
the share will be created on a backend with a matching share_backend_name.</p>
<p>The HPE 3PAR driver automatically reports capabilities based on the FPG used
for each backend. Share types with extra specs can be created by an
administrator to control which share types are allowed to use FPGs with or
without specific capabilities. The following extra-specs are used with
the capabilities filter and the HPE 3PAR driver:</p>
<ul class="simple">
<li><cite>hpe3par_flash_cache</cite> = &#8216;&lt;is&gt; True&#8217; or &#8216;&lt;is&gt; False&#8217;</li>
<li><cite>thin_provisioning</cite> = &#8216;&lt;is&gt; True&#8217; or &#8216;&lt;is&gt; False&#8217;</li>
<li><cite>dedupe</cite> = &#8216;&lt;is&gt; True&#8217; or &#8216;&lt;is&gt; False&#8217;</li>
</ul>
<p><cite>hpe3par_flash_cache</cite> will be reported as True for backends that have
3PAR&#8217;s Adaptive Flash Cache enabled.</p>
<p><cite>thin_provisioning</cite> will be reported as True for backends that use thin
provisioned volumes. FPGs that use fully provisioned volumes will report
False. Backends that use thin provisioning also support manila&#8217;s
over-subscription feature.</p>
<p><cite>dedupe</cite> will be reported as True for backends that use deduplication
technology.</p>
<p>Scoped extra-specs are used to influence vendor-specific implementation
details. Scoped extra-specs use a prefix followed by a colon.  For HPE 3PAR
these extra-specs have a prefix of <cite>hpe3par</cite>. For HP 3PAR these extra-specs
have a prefix of <cite>hp3par</cite>.</p>
<p>The following HPE 3PAR extra-specs are used when creating CIFS (SMB) shares:</p>
<ul class="simple">
<li><cite>hpe3par:smb_access_based_enum</cite> = true or false</li>
<li><cite>hpe3par:smb_continuous_avail</cite> = true or false</li>
<li><cite>hpe3par:smb_cache</cite> = off, manual, optimized or auto</li>
</ul>
<p><cite>smb_access_based_enum</cite> (Access Based Enumeration) specifies if users can see
only the files and directories to which they have been allowed access on the
shares. The default is <cite>false</cite>.</p>
<p><cite>smb_continuous_avail</cite> (Continuous Availability) specifies if SMB3 continuous
availability features should be enabled for this share. If not specified,
the default is <cite>true</cite>. This setting will be ignored with hp3parclient 3.2.1
or earlier.</p>
<p><cite>smb_cache</cite> specifies client-side caching for offline files. Valid values are:</p>
<ul class="simple">
<li><cite>off</cite>: The client must not cache any files from this share. The share is
configured to disallow caching.</li>
<li><cite>manual</cite>: The client must allow only manual caching for the files open from
this share.</li>
<li><cite>optimized</cite>: The client may cache every file that it opens from
this share. Also, the client may satisfy the file requests from its
local cache. The share is configured to allow automatic caching
of programs and documents.</li>
<li><cite>auto</cite>: The client may cache every file that it opens from this
share. The share is configured to allow automatic caching of
documents.</li>
<li>If this is not specified, the default is <cite>manual</cite>.</li>
</ul>
<p>The following HPE 3PAR extra-specs are used when creating NFS shares:</p>
<ul class="simple">
<li><cite>hpe3par:nfs_options</cite> = Comma separated list of NFS export options</li>
</ul>
<p>The NFS export options have the following limitations:</p>
<blockquote>
<div><ul class="simple">
<li><cite>ro</cite> and <cite>rw</cite> are not allowed (manila will determine the read-only option)</li>
<li><cite>no_subtree_check</cite> and <cite>fsid</cite> are not allowed per HPE 3PAR CLI support</li>
<li><cite>(in)secure</cite> and <cite>(no_)root_squash</cite> are not allowed because the HPE 3PAR
driver controls those settings</li>
</ul>
</div></blockquote>
<p>All other NFS options are forwarded to the HPE 3PAR as part of share creation.
The HPE 3PAR will do additional validation at share creation time. Refer to
HPE 3PAR CLI help for more details.</p>
</div>
<div class="section" id="delete-nested-shares">
<h2>Delete Nested Shares<a class="headerlink" href="#delete-nested-shares" title="Permalink to this headline">¶</a></h2>
<p>When a nested share is deleted (nested shares will be created when
<code class="docutils literal"><span class="pre">hpe_3par_fstore_per_share</span></code> is set to <code class="docutils literal"><span class="pre">False</span></code>), the file tree also
attempts to be deleted.</p>
<p>With NFS shares, there is no additional configuration that needs to be done.</p>
<p>For CIFS shares, <code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_username</span></code> and
<code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_password</span></code> must be provided. If they are omitted,
the original functionality is honored and the file tree remains untouched.
<code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_domain</span></code> and <code class="docutils literal"><span class="pre">hpe3par_share_mount_path</span></code> can also
be specified to create further customization.</p>
<div class="section" id="the-manila-share-drivers-hpe-hpe-3par-driver-module">
<h3>The <code class="xref py py-mod docutils literal"><span class="pre">manila.share.drivers.hpe.hpe_3par_driver</span></code> Module<a class="headerlink" href="#the-manila-share-drivers-hpe-hpe-3par-driver-module" title="Permalink to this headline">¶</a></h3>
<p>HPE 3PAR Driver for OpenStack Manila.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descname">FPG</code><span class="sig-paren">(</span><em>min_ip=0</em>, <em>max_ip=4</em>, <em>type_name='FPG'</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">oslo_config.types.String</span></code>, <code class="xref py py-class docutils literal"><span class="pre">oslo_config.types.IPAddress</span></code></p>
<p>FPG type.</p>
<p>Used to represent multiple pools per backend values.
Converts configuration value to an FPGs value.
FPGs value format:</p>
<blockquote>
<div>FPG name, IP address 1, IP address 2, ..., IP address 4</div></blockquote>
<p>where FPG name is a string value,
IP address is of type types.IPAddress</p>
<p>Optionally doing range checking.
If value is whitespace or empty string will raise error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>min_ip</strong> &#8211; Optional check that number of min IP address of VFS.</li>
<li><strong>max_ip</strong> &#8211; Optional check that number of max IP address of VFS.</li>
<li><strong>type_name</strong> &#8211; Type name to be used in the sample config file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt>
<code class="descname">MAX_SUPPORTED_IP_PER_VFS</code><em class="property"> = 4</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">HPE3ParShareDriver</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <a class="reference internal" href="share_replication.html#manila.share.driver.ShareDriver" title="manila.share.driver.ShareDriver"><code class="xref py py-class docutils literal"><span class="pre">manila.share.driver.ShareDriver</span></code></a></p>
<p>HPE 3PAR driver for Manila.</p>
<p>Supports NFS and CIFS protocols on arrays with File Persona.</p>
<dl class="docutils">
<dt>Version history:</dt>
<dd><p class="first">1.0.0 - Begin Liberty development (post-Kilo)
1.0.1 - Report thin/dedup/hp_flash_cache capabilities
1.0.2 - Add share server/share network support
2.0.0 - Rebranded HP to HPE
2.0.1 - Add access_level (e.g. read-only support)
2.0.2 - Add extend/shrink
2.0.3 - Remove file tree on delete when using nested shares #1538800
2.0.4 - Reduce the fsquota by share size</p>
<blockquote>
<div>when a share is deleted #1582931</div></blockquote>
<p>2.0.5 - Add update_access support
2.0.6 - Multi pool support per backend
2.0.7 - Fix get_vfs() to correctly validate conf IP addresses at</p>
<blockquote class="last">
<div>boot up #1621016</div></blockquote>
</dd>
</dl>
<dl class="attribute">
<dt>
<code class="descname">VERSION</code><em class="property"> = '2.0.7'</em></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">build_share_comment</code><span class="sig-paren">(</span><em>share</em><span class="sig-paren">)</span></dt>
<dd><p>Create an informational only comment to help admins and testers.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">check_for_setup_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">choose_share_server_compatible_with_share</code><span class="sig-paren">(</span><em>context</em>, <em>share_servers</em>, <em>share</em>, <em>snapshot=None</em>, <em>consistency_group=None</em><span class="sig-paren">)</span></dt>
<dd><p>Method that allows driver to choose share server for provided share.</p>
<p>If compatible share-server is not found, method should return None.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>share_servers</strong> &#8211; list with share-server models</li>
<li><strong>share</strong> &#8211; share model</li>
<li><strong>snapshot</strong> &#8211; snapshot model</li>
<li><strong>consistency_group</strong> &#8211; ConsistencyGroup model with shares</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">share-server or None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">create_share</code><span class="sig-paren">(</span><em>context</em>, <em>share</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Is called to create share.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">create_share_from_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>share</em>, <em>snapshot</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Is called to create share from snapshot.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">create_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>snapshot</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Creates a snapshot of a share.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_share</code><span class="sig-paren">(</span><em>context</em>, <em>share</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Deletes share and its fstore.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>snapshot</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Deletes a snapshot of a share.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">do_setup</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span></dt>
<dd><p>Any initialization the share driver does while starting.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">ensure_share</code><span class="sig-paren">(</span><em>context</em>, <em>share</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">extend_share</code><span class="sig-paren">(</span><em>share</em>, <em>new_size</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Extends size of existing share.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_network_allocations_number</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">sha1_hash</code><span class="sig-paren">(</span><em>clazz</em><span class="sig-paren">)</span></dt>
<dd><p>Get the SHA1 hash for the source of a class.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">shrink_share</code><span class="sig-paren">(</span><em>share</em>, <em>new_size</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Shrinks size of existing share.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">update_access</code><span class="sig-paren">(</span><em>context</em>, <em>share</em>, <em>access_rules</em>, <em>add_rules</em>, <em>delete_rules</em>, <em>share_server=None</em><span class="sig-paren">)</span></dt>
<dd><p>Update access to the share.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descname">to_list</code><span class="sig-paren">(</span><em>var</em><span class="sig-paren">)</span></dt>
<dd><p>Convert var to list type if not</p>
</dd></dl>

</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="hitachi_hnas_driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Hitachi NAS Platform File Services Driver for OpenStack"></i></a>
          
          
            <a href="tegile_driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Tegile Driver"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#programming-howtos-and-tutorials">Programming HowTos and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#background-concepts-for-manila">Background Concepts for manila</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#other-resources">Other Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#api-reference">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-reference">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#capabilities-and-extra-specs">Capabilities and Extra-Specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#share-backends-feature-support-mapping">Share backends feature support mapping</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#share-backends">Share backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Command-Line Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../adminref/index.html">Admin Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "devref/hpe_3par_driver" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/manila/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 610baa2fdb702fa4cc2c12eb5c61599bdcad21ce";
        var bugProject = "manila";
        var bugTitle = "HPE 3PAR Driver in manila";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 4.0.0.0rc2.dev25 on 'Tue Feb 14 14:25:27 2017, commit 610baa2'";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>