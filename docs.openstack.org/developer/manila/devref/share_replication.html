<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Share Replication</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Share Replication</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="ganesha.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Ganesha Library"></i></a>
    
    
    <a href="driver_filter_goodness_weigher.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Configure and use driver filter and weighing for scheduler"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Share Replication</a><ul>
<li><a class="reference internal" href="#storage-availability-zones-and-replication-domains">Storage availability zones and replication domains</a></li>
<li><a class="reference internal" href="#replication-types">Replication types</a></li>
<li><a class="reference internal" href="#health-of-a-share-replica">Health of a share replica</a></li>
<li><a class="reference internal" href="#promotion">Promotion</a></li>
<li><a class="reference internal" href="#snapshots">Snapshots</a></li>
<li><a class="reference internal" href="#access-rules">Access Rules</a></li>
<li><a class="reference internal" href="#understanding-replication-workflows">Understanding Replication Workflows</a><ul>
<li><a class="reference internal" href="#creating-a-share-that-supports-replication">Creating a share that supports replication</a></li>
<li><a class="reference internal" href="#creating-a-replica">Creating a replica</a></li>
<li><a class="reference internal" href="#deleting-a-replica">Deleting a replica</a></li>
<li><a class="reference internal" href="#promoting-a-replica">Promoting a replica</a></li>
<li><a class="reference internal" href="#resyncing-a-replica">Resyncing a replica</a></li>
<li><a class="reference internal" href="#creating-a-snapshot">Creating a snapshot</a></li>
<li><a class="reference internal" href="#deleting-a-snapshot">Deleting a snapshot</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-interfaces">Driver Interfaces</a><ul>
<li><a class="reference internal" href="#share-replica-interfaces">Share Replica interfaces:</a></li>
<li><a class="reference internal" href="#replicated-snapshot-interfaces">Replicated Snapshot interfaces:</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="share-replication">
<h1>Share Replication<a class="headerlink" href="#share-replication" title="Permalink to this headline">¶</a></h1>
<p>As of the Mitaka release of OpenStack, <a class="reference internal" href="../glossary.html#term-manila"><span class="xref std std-term">manila</span></a> supports replication of
shares between different pools for drivers that operate with
<code class="docutils literal"><span class="pre">driver_handles_share_servers=False</span></code> mode. These pools may be on different
backends or within the same backend. This feature can be used as a disaster
recovery solution or as a load sharing mirroring solution depending upon the
replication style chosen, the capability of the driver and the configuration
of backends.</p>
<p>This feature assumes and relies on the fact that share drivers will be
responsible for communicating with ALL storage controllers necessary to
achieve any replication tasks, even if that involves sending commands to
other storage controllers in other Availability Zones (or AZs).</p>
<p>End users would be able to create and manage their replicas, alongside their
shares and snapshots.</p>
<div class="section" id="storage-availability-zones-and-replication-domains">
<h2>Storage availability zones and replication domains<a class="headerlink" href="#storage-availability-zones-and-replication-domains" title="Permalink to this headline">¶</a></h2>
<p>Replication is supported within the same availability zone, but in an ideal
solution, an Availability Zone should be perceived as a single failure domain.
So this feature provides the most value in an inter-AZ replication use case.</p>
<p>The <code class="docutils literal"><span class="pre">replication_domain</span></code> option is a backend specific StrOpt option to be
used within <code class="docutils literal"><span class="pre">manila.conf</span></code>. The value can be any ASCII string. Two backends
that can replicate between each other would have the same
<code class="docutils literal"><span class="pre">replication_domain</span></code>. This comes from the premise that manila expects
Share Replication to be performed between backends that have similar
characteristics.</p>
<p>When scheduling new replicas, the scheduler takes into account the
<code class="docutils literal"><span class="pre">replication_domain</span></code> option to match similar backends. It also ensures that
only one replica can be scheduled per pool. When backends report multiple
pools, manila would allow for replication between two pools on the same
backend.</p>
<p>The <code class="docutils literal"><span class="pre">replication_domain</span></code> option is meant to be used in conjunction with the
<code class="docutils literal"><span class="pre">storage_availability_zone</span></code> option to utilize this solution for Data
Protection/Disaster Recovery.</p>
</div>
<div class="section" id="replication-types">
<h2>Replication types<a class="headerlink" href="#replication-types" title="Permalink to this headline">¶</a></h2>
<p>When creating a share that is meant to have replicas in the future, the user
will use a <code class="docutils literal"><span class="pre">share_type</span></code> with an extra_spec, <a class="reference internal" href="../glossary.html#term-replication-type"><span class="xref std std-term">replication_type</span></a> set to
a valid replication type that manila supports. Drivers must report the
replication type that they support as the <a class="reference internal" href="../glossary.html#term-replication-type"><span class="xref std std-term">replication_type</span></a>
capability during the <code class="docutils literal"><span class="pre">_update_share_stats()</span></code> call.</p>
<p>Three types of replication are currently supported:</p>
<dl class="docutils">
<dt><strong>writable</strong></dt>
<dd>Synchronously replicated shares where all replicas are writable.
Promotion is not supported and not needed.</dd>
<dt><strong>readable</strong></dt>
<dd>Mirror-style replication with a primary (writable) copy
and one or more secondary (read-only) copies which can become writable
after a promotion.</dd>
<dt><strong>dr (for Disaster Recovery)</strong></dt>
<dd>Generalized replication with secondary copies that are inaccessible until
they are promoted to become the <code class="docutils literal"><span class="pre">active</span></code> replica.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The term <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica refers to the <code class="docutils literal"><span class="pre">primary</span></code> share. In
<a class="reference internal" href="../glossary.html#term-writable"><span class="xref std std-term">writable</span></a> style of replication, all replicas are <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a>,
and there could be no distinction of a <code class="docutils literal"><span class="pre">primary</span></code> share. In
<a class="reference internal" href="../glossary.html#term-readable"><span class="xref std std-term">readable</span></a> and <a class="reference internal" href="../glossary.html#term-dr"><span class="xref std std-term">dr</span></a> styles of replication, a <code class="docutils literal"><span class="pre">secondary</span></code>
replica may be referred to as <code class="docutils literal"><span class="pre">passive</span></code>, <code class="docutils literal"><span class="pre">non-active</span></code> or simply
<code class="docutils literal"><span class="pre">replica</span></code>.</p>
</div>
</div>
<div class="section" id="health-of-a-share-replica">
<h2>Health of a share replica<a class="headerlink" href="#health-of-a-share-replica" title="Permalink to this headline">¶</a></h2>
<p>Apart from the <code class="docutils literal"><span class="pre">status</span></code> attribute, share replicas have the
<a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute to denote the state of the replica. The
<code class="docutils literal"><span class="pre">primary</span></code> replica will have it&#8217;s <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute set to
<a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a>. A <code class="docutils literal"><span class="pre">secondary</span></code> replica may have one of the following values as
its <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a>:</p>
<dl class="docutils">
<dt><strong>in_sync</strong></dt>
<dd>The replica is up to date with the active replica
(possibly within a backend specific <a class="reference internal" href="../glossary.html#term-recovery-point-objective"><span class="xref std std-term">recovery point objective</span></a>).</dd>
<dt><strong>out_of_sync</strong></dt>
<dd>The replica has gone out of date (all new replicas start out in this
<a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a>).</dd>
<dt><strong>error</strong></dt>
<dd>When the scheduler failed to schedule this replica or some potentially
irrecoverable damage occurred with regard to updating data for this
replica.</dd>
</dl>
<p>Manila requests periodic update of the <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> of all non-active
replicas. The update occurs with respect to an interval defined through the
<code class="docutils literal"><span class="pre">replica_state_update_interval</span></code> option in <code class="docutils literal"><span class="pre">manila.conf</span></code>.</p>
<p>Administrators have an option of initiating a <code class="docutils literal"><span class="pre">resync</span></code> of a secondary
replica (for <a class="reference internal" href="../glossary.html#term-readable"><span class="xref std std-term">readable</span></a> and <a class="reference internal" href="../glossary.html#term-dr"><span class="xref std std-term">dr</span></a> types of replication). This could
be performed before a planned failover operation in order to have the most
up-to-date data on the replica.</p>
</div>
<div class="section" id="promotion">
<h2>Promotion<a class="headerlink" href="#promotion" title="Permalink to this headline">¶</a></h2>
<p>For <a class="reference internal" href="../glossary.html#term-readable"><span class="xref std std-term">readable</span></a> and <a class="reference internal" href="../glossary.html#term-dr"><span class="xref std std-term">dr</span></a> styles, we refer to the task of
switching a <code class="docutils literal"><span class="pre">non-active</span></code> replica with the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica as
<cite>promotion</cite>. For the <a class="reference internal" href="../glossary.html#term-writable"><span class="xref std std-term">writable</span></a> style of replication, promotion does
not make sense since all replicas are <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> (or writable) at all
given points of time.</p>
<p>The <code class="docutils literal"><span class="pre">status</span></code> attribute of the non-active replica being promoted will be set
to <a class="reference internal" href="../glossary.html#term-replication-change"><span class="xref std std-term">replication_change</span></a> during its promotion. This has been classified
as a <code class="docutils literal"><span class="pre">busy</span></code> state and hence API interactions with the share are restricted
while one of its replicas is in this state.</p>
<p>Promotion of replicas with <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> set to <code class="docutils literal"><span class="pre">error</span></code> may not be
fully supported by the backend. However, manila allows the action as an
administrator feature and such an attempt may be honored by backends if
possible.</p>
<p>When multiple replicas exist, multiple replication relationships
between shares may need to be redefined at the backend during the promotion
operation. If the driver fails at this stage, the replicas may be left in an
inconsistent state. The share manager will set all replicas to have the
<code class="docutils literal"><span class="pre">status</span></code> attribute set to <code class="docutils literal"><span class="pre">error</span></code>. Recovery from this state would require
administrator intervention.</p>
</div>
<div class="section" id="snapshots">
<h2>Snapshots<a class="headerlink" href="#snapshots" title="Permalink to this headline">¶</a></h2>
<p>If the driver supports snapshots, the replication of a snapshot is expected
to be initiated simultaneously with the creation of the snapshot on the
<a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica. Manila tracks snapshots across replicas as separate
snapshot instances. The aggregate snapshot object itself will be in
<code class="docutils literal"><span class="pre">creating</span></code> state until it is <code class="docutils literal"><span class="pre">available</span></code> across all of the share&#8217;s replicas
that have their <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute set to <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> or
<code class="docutils literal"><span class="pre">in_sync</span></code>.</p>
<p>Therefore, for a driver that supports snapshots, the definition of being
<code class="docutils literal"><span class="pre">in_sync</span></code> with the primary is not only that data is ensured (within the
<a class="reference internal" href="../glossary.html#term-recovery-point-objective"><span class="xref std std-term">recovery point objective</span></a>), but also that any &#8216;available&#8217; snapshots
on the primary are ensured on the replica as well. If the snapshots cannot
be ensured, the <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> <em>must</em> be reported to manila as being
<code class="docutils literal"><span class="pre">out_of_sync</span></code> until the snapshots have been replicated.</p>
<p>When a snapshot instance has its <code class="docutils literal"><span class="pre">status</span></code> attribute set to <code class="docutils literal"><span class="pre">creating</span></code> or
<code class="docutils literal"><span class="pre">deleting</span></code>, manila will poll the respective drivers for a status update. As
described earlier, the parent snapshot itself will be <code class="docutils literal"><span class="pre">available</span></code> only when
its instances across the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> and <code class="docutils literal"><span class="pre">in_sync</span></code> replicas of the share
are <code class="docutils literal"><span class="pre">available</span></code>. The polling interval will be the same as
<code class="docutils literal"><span class="pre">replica_state_update_interval</span></code>.</p>
</div>
<div class="section" id="access-rules">
<h2>Access Rules<a class="headerlink" href="#access-rules" title="Permalink to this headline">¶</a></h2>
<p>Access rules are not meant to be different across the replicas of the share.
Manila expects drivers to handle these access rules effectively depending on
the style of replication supported. For example, the <a class="reference internal" href="../glossary.html#term-dr"><span class="xref std std-term">dr</span></a> style of
replication does mean that the non-active replicas are inaccessible, so if
read-write rules are expected, then the rules should be applied on the
<a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica only. Similarly, drivers that
support <a class="reference internal" href="../glossary.html#term-readable"><span class="xref std std-term">readable</span></a> replication type should apply any read-write
rules as read-only for the non-active replicas.</p>
<p>Drivers will receive all the access rules in <code class="docutils literal"><span class="pre">create_replica</span></code>,
<code class="docutils literal"><span class="pre">delete_replica</span></code> and <code class="docutils literal"><span class="pre">update_replica_state</span></code> calls and have ample
opportunity to reconcile these rules effectively across replicas.</p>
</div>
<div class="section" id="understanding-replication-workflows">
<h2>Understanding Replication Workflows<a class="headerlink" href="#understanding-replication-workflows" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-share-that-supports-replication">
<h3>Creating a share that supports replication<a class="headerlink" href="#creating-a-share-that-supports-replication" title="Permalink to this headline">¶</a></h3>
<p>Administrators can create a share type with extra-spec
<a class="reference internal" href="../glossary.html#term-replication-type"><span class="xref std std-term">replication_type</span></a>, matching the style of replication the desired backend
supports. Users can use the share type to create a new share that
allows/supports replication. A replicated share always starts out with one
replica, the <code class="docutils literal"><span class="pre">primary</span></code> share itself.</p>
<p>The <a class="reference internal" href="../glossary.html#term-manila-scheduler"><span class="xref std std-term">manila-scheduler</span></a> service will filter and weigh available pools to
find a suitable pool for the share being created. In particular,</p>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">CapabilityFilter</span></code> will match the <a class="reference internal" href="../glossary.html#term-replication-type"><span class="xref std std-term">replication_type</span></a> extra_spec
in the request share_type with the <code class="docutils literal"><span class="pre">replication_type</span></code> capability reported
by a pool.</li>
<li>The <code class="docutils literal"><span class="pre">ShareReplicationFilter</span></code> will further ensure that the pool has a
non-empty <code class="docutils literal"><span class="pre">replication_domain</span></code> capability being reported as well.</li>
<li>The <code class="docutils literal"><span class="pre">AvailabilityZoneFilter</span></code> will ensure that the availability_zone
requested matches with the pool&#8217;s availability zone.</li>
</ul>
</div>
<div class="section" id="creating-a-replica">
<h3>Creating a replica<a class="headerlink" href="#creating-a-replica" title="Permalink to this headline">¶</a></h3>
<p>The user has to specify the share name/id of the share that is supposed to be
replicated and optionally an availability zone for the replica to exist in.
The replica inherits the parent share&#8217;s share_type and associated
extra_specs. Scheduling of the replica is similar to that of the share.</p>
<ul>
<li><dl class="first docutils">
<dt>The <cite>ShareReplicationFilter</cite> will ensure that the pool is within</dt>
<dd><p class="first last">the same <code class="docutils literal"><span class="pre">replication_domain</span></code> as the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica and also
ensures that the pool does not already have a replica for that share.</p>
</dd>
</dl>
</li>
</ul>
<p>Drivers supporting <a class="reference internal" href="../glossary.html#term-writable"><span class="xref std std-term">writable</span></a> style <strong>must</strong> set the
<a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute to <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> when the replica has been
created and is <code class="docutils literal"><span class="pre">available</span></code>.</p>
</div>
<div class="section" id="deleting-a-replica">
<h3>Deleting a replica<a class="headerlink" href="#deleting-a-replica" title="Permalink to this headline">¶</a></h3>
<p>Users can remove replicas that have their <cite>status</cite> attribute set to
<code class="docutils literal"><span class="pre">error</span></code>, <code class="docutils literal"><span class="pre">in_sync</span></code> or <code class="docutils literal"><span class="pre">out_of_sync</span></code>. They could even delete an
<a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica as long as there is another <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica
(as could be the case with <cite>writable</cite> replication style). Before the
<code class="docutils literal"><span class="pre">delete_replica</span></code> call is made to the driver, an update_access call is made
to ensure access rules are safely removed for the replica.</p>
<p>Administrators may also <code class="docutils literal"><span class="pre">force-delete</span></code> replicas. Any driver exceptions will
only be logged and not re-raised; the replica will be purged from manila&#8217;s
database.</p>
</div>
<div class="section" id="promoting-a-replica">
<h3>Promoting a replica<a class="headerlink" href="#promoting-a-replica" title="Permalink to this headline">¶</a></h3>
<p>Users can promote replicas that have their <a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute set
to <code class="docutils literal"><span class="pre">in_sync</span></code>. Administrators can attempt to promote replicas that have their
<a class="reference internal" href="../glossary.html#term-replica-state"><span class="xref std std-term">replica_state</span></a> attribute set to <code class="docutils literal"><span class="pre">out_of_sync</span></code> or <code class="docutils literal"><span class="pre">error</span></code>. During a
promotion, if the driver raises an exception, all replicas will have their
<cite>status</cite> attribute set to <cite>error</cite> and recovery from this state will require
administrator intervention.</p>
</div>
<div class="section" id="resyncing-a-replica">
<h3>Resyncing a replica<a class="headerlink" href="#resyncing-a-replica" title="Permalink to this headline">¶</a></h3>
<p>Prior to a planned failover, an administrator could attempt to update the
data on the replica. The <code class="docutils literal"><span class="pre">update_replica_state</span></code> call will be made during
such an action, giving drivers an opportunity to push the latest updates from
the <cite>active</cite> replica to the secondaries.</p>
</div>
<div class="section" id="creating-a-snapshot">
<h3>Creating a snapshot<a class="headerlink" href="#creating-a-snapshot" title="Permalink to this headline">¶</a></h3>
<p>When a user takes a snapshot of a share that has replicas, manila creates as
many snapshot instances as there are share replicas. These snapshot
instances all begin with their <cite>status</cite> attribute set to <cite>creating</cite>. The driver
is expected to create the snapshot of the <code class="docutils literal"><span class="pre">active</span></code> replica and then begin to
replicate this snapshot as soon as the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica&#8217;s
snapshot instance is created and becomes <code class="docutils literal"><span class="pre">available</span></code>.</p>
</div>
<div class="section" id="deleting-a-snapshot">
<h3>Deleting a snapshot<a class="headerlink" href="#deleting-a-snapshot" title="Permalink to this headline">¶</a></h3>
<p>When a user deletes a snapshot, the snapshot instances corresponding to each
replica of the share have their <code class="docutils literal"><span class="pre">status</span></code> attribute set to <code class="docutils literal"><span class="pre">deleting</span></code>.
Drivers must update their secondaries as soon as the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica&#8217;s
snapshot instance is deleted.</p>
</div>
</div>
<div class="section" id="driver-interfaces">
<h2>Driver Interfaces<a class="headerlink" href="#driver-interfaces" title="Permalink to this headline">¶</a></h2>
<p>As part of the <code class="docutils literal"><span class="pre">_update_share_stats()</span></code> call, the base driver reports the
<code class="docutils literal"><span class="pre">replication_domain</span></code> capability. Drivers are expected to update the
<a class="reference internal" href="../glossary.html#term-replication-type"><span class="xref std std-term">replication_type</span></a> capability.</p>
<p>Drivers must implement the methods enumerated below in order to support
replication. <code class="docutils literal"><span class="pre">promote_replica</span></code>, <code class="docutils literal"><span class="pre">update_replica_state</span></code> and
<code class="docutils literal"><span class="pre">update_replicated_snapshot</span></code> need not be implemented by drivers that support
the <a class="reference internal" href="../glossary.html#term-writable"><span class="xref std std-term">writable</span></a> style of replication. The snapshot methods
<code class="docutils literal"><span class="pre">create_replicated_snapshot</span></code>, <code class="docutils literal"><span class="pre">delete_replicated_snapshot</span></code> and
<code class="docutils literal"><span class="pre">update_replicated_snapshot</span></code> need not be implemented by a driver that does
not support snapshots.</p>
<p>Each driver request is made on a specific host. Create/delete operations
on secondary replicas are always made on the destination host. Create/delete
operations on snapshots are always made on the <a class="reference internal" href="../glossary.html#term-active"><span class="xref std std-term">active</span></a> replica&#8217;s host.
<code class="docutils literal"><span class="pre">update_replica_state</span></code> and <code class="docutils literal"><span class="pre">update_replicated_snapshot</span></code> calls are made on
the host that the replica or snapshot resides on.</p>
<div class="section" id="share-replica-interfaces">
<h3>Share Replica interfaces:<a class="headerlink" href="#share-replica-interfaces" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="manila.share.driver.ShareDriver">
<em class="property">class </em><code class="descname">ShareDriver</code><span class="sig-paren">(</span><em>driver_handles_share_servers</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver" title="Permalink to this definition">¶</a></dt>
<dd><p>Class defines interface of NAS driver.</p>
<dl class="method">
<dt id="manila.share.driver.ShareDriver.create_replica">
<code class="descname">create_replica</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>new_replica</em>, <em>access_rules</em>, <em>replica_snapshots</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.create_replica" title="Permalink to this definition">¶</a></dt>
<dd><p>Replicate the active replica to a new replica on this backend.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the host that the new replica is being created
upon.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share.
This list also contains the replica to be created. The &#8216;active&#8217;
replica will have its &#8216;replica_state&#8217; attr set to &#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;07574742-67ea-4dfd-9844-9fbd8ada3d87&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_replica</strong> &#8211; The share replica dictionary.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>{
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;deleted&#39;: False,
    &#39;host&#39;: &#39;openstack2@cmodeSSVMNFS2&#39;,
    &#39;status&#39;: &#39;creating&#39;,
    &#39;scheduled_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;launched_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;terminated_at&#39;: None,
    &#39;replica_state&#39;: &#39;out_of_sync&#39;,
    &#39;availability_zone_id&#39;: &#39;f6e146d0-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;export_locations&#39;: [
        models.ShareInstanceExportLocations,
    ],
    &#39;access_rules_status&#39;: &#39;out_of_sync&#39;,
    &#39;share_network_id&#39;: &#39;4ccd5318-65f1-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_server_id&#39;: &#39;e6155221-ea00-49ef-abf9-9f89b7dd900a&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>access_rules</strong> &#8211; A list of access rules.
These are rules that other instances of the share already obey.
Drivers are expected to apply access rules to the new replica or
disregard access rules that don&#8217;t apply.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
 {
    &#39;id&#39;: &#39;f0875f6f-766b-4865-8b41-cccb4cdf1676&#39;,
    &#39;deleted&#39; = False,
    &#39;share_id&#39; = &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;access_type&#39; = &#39;ip&#39;,
    &#39;access_to&#39; = &#39;172.16.20.1&#39;,
    &#39;access_level&#39; = &#39;rw&#39;,
 }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
This includes snapshot instances of every snapshot of the share
whose &#8216;aggregate_status&#8217; property was reported to be &#8216;available&#8217;
when the share manager initiated this request. Each list member
will have two sub dictionaries: &#8216;active_replica_snapshot&#8217; and
&#8216;share_replica_snapshot&#8217;. The &#8216;active&#8217; replica snapshot corresponds
to the instance of the snapshot on any of the &#8216;active&#8217; replicas of
the share while share_replica_snapshot corresponds to the snapshot
instance for the specific replica that will need to exist on the
new share replica that is being created. The driver needs to ensure
that this snapshot instance is truly available before transitioning
the replica from &#8216;out_of_sync&#8217; to &#8216;in_sync&#8217;. Snapshots instances
for snapshots that have an &#8216;aggregate_status&#8217; of &#8216;creating&#8217; or
&#8216;deleting&#8217; will be polled for in the <code class="docutils literal"><span class="pre">update_replicated_snapshot</span></code>
method.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
 {
 &#39;active_replica_snapshot&#39;: {
    &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
    &#39;share_instance_id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;status&#39;: &#39;available&#39;,
    &#39;provider_location&#39;: &#39;/newton/share-snapshot-10e49c3e-aca9&#39;,
    ...
    },
 &#39;share_replica_snapshot&#39;: {
    &#39;id&#39;: &#39;&#39;,
    &#39;share_instance_id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;status&#39;: &#39;available&#39;,
    &#39;provider_location&#39;: None,
        ...
    },
 }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None
Share server of the replica being created.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None or a dictionary.
The dictionary can contain export_locations replica_state and
access_rules_status. export_locations is a list of paths and
replica_state is one of &#8216;active&#8217;, &#8216;in_sync&#8217;, &#8216;out_of_sync&#8217; or
&#8216;error&#8217;.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">A backend supporting &#8216;writable&#8217; type replication should return
&#8216;active&#8217; as the replica_state.</p>
</div>
<p>Export locations should be in the same format as returned during the
<code class="docutils literal"><span class="pre">create_share</span></code> call.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;export_locations&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;172.16.20.22/sample/export/path&#39;</span><span class="p">,</span>
             <span class="s1">&#39;is_admin_only&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
             <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;some_key&#39;</span><span class="p">:</span> <span class="s1">&#39;some_value&#39;</span><span class="p">},</span>
        <span class="p">},</span>
    <span class="p">],</span>
     <span class="s1">&#39;replica_state&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
     <span class="s1">&#39;access_rules_status&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="manila.share.driver.ShareDriver.delete_replica">
<code class="descname">delete_replica</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>replica_snapshots</em>, <em>replica</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.delete_replica" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a replica.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the host that hosts the replica being
deleted.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
This list also contains the replica to be deleted. The &#8216;active&#8217;
replica will have its &#8216;replica_state&#8217; attr set to &#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;07574742-67ea-4dfd-9844-9fbd8ada3d87&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica</strong> &#8211; Dictionary of the share replica being deleted.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>{
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;deleted&#39;: False,
    &#39;host&#39;: &#39;openstack2@cmodeSSVMNFS2&#39;,
    &#39;status&#39;: &#39;available&#39;,
    &#39;scheduled_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;launched_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;terminated_at&#39;: None,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
    &#39;availability_zone_id&#39;: &#39;f6e146d0-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;export_locations&#39;: [
        models.ShareInstanceExportLocations
    ],
    &#39;access_rules_status&#39;: &#39;out_of_sync&#39;,
    &#39;share_network_id&#39;: &#39;4ccd5318-65f1-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_server_id&#39;: &#39;53099868-65f1-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
The dict contains snapshot instances that are associated with the
share replica being deleted.
No model updates to snapshot instances are possible in this method.
The driver should return when the cleanup is completed on the
backend for both, the snapshots and the replica itself. Drivers
must handle situations where the snapshot may not yet have
finished &#8216;creating&#8217; on this replica.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;89dafd00-0999-4d23-8614-13eaa6b02a3b&#39;,
    &#39;snapshot_id&#39;: &#39;3ce1caf7-0945-45fd-a320-714973e949d3&#39;,
    &#39;status: &#39;available&#39;,
    &#39;share_instance_id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;
        ...
    },
    {
    &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;status: &#39;creating&#39;,
    &#39;share_instance_id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;
        ...
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None
Share server of the replica to be deleted.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">Exception.
Any exception raised will set the share replica&#8217;s &#8216;status&#8217; and
&#8216;replica_state&#8217; attributes to &#8216;error_deleting&#8217;. It will not affect
snapshots belonging to this replica.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="manila.share.driver.ShareDriver.promote_replica">
<code class="descname">promote_replica</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>replica</em>, <em>access_rules</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.promote_replica" title="Permalink to this definition">¶</a></dt>
<dd><p>Promote a replica to &#8216;active&#8217; replica state.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the host that hosts the replica being
promoted.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
This list also contains the replica to be promoted. The &#8216;active&#8217;
replica will have its &#8216;replica_state&#8217; attr set to &#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;07574742-67ea-4dfd-9844-9fbd8ada3d87&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica</strong> &#8211; Dictionary of the replica to be promoted.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>{
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;deleted&#39;: False,
    &#39;host&#39;: &#39;openstack2@cmodeSSVMNFS2&#39;,
    &#39;status&#39;: &#39;available&#39;,
    &#39;scheduled_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;launched_at&#39;: datetime.datetime(2015, 8, 10, 0, 5, 58),
    &#39;terminated_at&#39;: None,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
    &#39;availability_zone_id&#39;: &#39;f6e146d0-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;export_locations&#39;: [
        models.ShareInstanceExportLocations
    ],
    &#39;access_rules_status&#39;: &#39;in_sync&#39;,
    &#39;share_network_id&#39;: &#39;4ccd5318-65f1-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_server_id&#39;: &#39;07574742-67ea-4dfd-9844-9fbd8ada3d87&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>access_rules</strong> &#8211; A list of access rules
These access rules are obeyed by other instances of the share</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
 {
    &#39;id&#39;: &#39;f0875f6f-766b-4865-8b41-cccb4cdf1676&#39;,
    &#39;deleted&#39; = False,
    &#39;share_id&#39; = &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;access_type&#39; = &#39;ip&#39;,
    &#39;access_to&#39; = &#39;172.16.20.1&#39;,
    &#39;access_level&#39; = &#39;rw&#39;,
 }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None
Share server of the replica to be promoted.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">updated_replica_list or None.
The driver can return the updated list as in the request
parameter. Changes that will be updated to the Database are:
&#8216;export_locations&#8217;, &#8216;access_rules_status&#8217; and &#8216;replica_state&#8217;.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">Exception.
This can be any exception derived from BaseException. This is
re-raised by the manager after some necessary cleanup. If the
driver raises an exception during promotion, it is assumed that
all of the replicas of the share are in an inconsistent state.
Recovery is only possible through the periodic update call and/or
administrator intervention to correct the &#8216;status&#8217; of the affected
replicas if they become healthy again.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="manila.share.driver.ShareDriver.update_replica_state">
<code class="descname">update_replica_state</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>replica</em>, <em>access_rules</em>, <em>replica_snapshots</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.update_replica_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the replica_state of a replica.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the host which hosts the replica being
updated.</p>
</div>
<p>Drivers should fix replication relationships that were broken if
possible inside this method.</p>
<p>This method is called periodically by the share manager; and
whenever requested by the administrator through the &#8216;resync&#8217; API.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
This list also contains the replica to be updated. The &#8216;active&#8217;
replica will have its &#8216;replica_state&#8217; attr set to &#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;e82ff8b6-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;07574742-67ea-4dfd-9844-9fbd8ada3d87&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica</strong> &#8211; Dictionary of the replica being updated
Replica state will always be &#8216;in_sync&#8217;, &#8216;out_of_sync&#8217;, or &#8216;error&#8217;.
Replicas in &#8216;active&#8217; state will not be passed via this parameter.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_id&#39;</span><span class="p">:</span> <span class="s1">&#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;deleted&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;openstack2@cmodeSSVMNFS1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span>
    <span class="s1">&#39;scheduled_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
    <span class="s1">&#39;launched_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
    <span class="s1">&#39;terminated_at&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="s1">&#39;replica_state&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
    <span class="s1">&#39;availability_zone_id&#39;</span><span class="p">:</span> <span class="s1">&#39;e2c2db5c-cb2f-4697-9966-c06fb200cb80&#39;</span><span class="p">,</span>
    <span class="s1">&#39;export_locations&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">models</span><span class="o">.</span><span class="n">ShareInstanceExportLocations</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;access_rules_status&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_network_id&#39;</span><span class="p">:</span> <span class="s1">&#39;4ccd5318-65f1-11e5-9d70-feff819cdc9f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_server_id&#39;</span><span class="p">:</span> <span class="s1">&#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>access_rules</strong> &#8211; A list of access rules
These access rules are obeyed by other instances of the share. The
driver could attempt to sync on any un-applied access_rules.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
 {
    &#39;id&#39;: &#39;f0875f6f-766b-4865-8b41-cccb4cdf1676&#39;,
    &#39;deleted&#39; = False,
    &#39;share_id&#39; = &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;access_type&#39; = &#39;ip&#39;,
    &#39;access_to&#39; = &#39;172.16.20.1&#39;,
    &#39;access_level&#39; = &#39;rw&#39;,
 }
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
This includes snapshot instances of every snapshot of the share
whose &#8216;aggregate_status&#8217; property was reported to be &#8216;available&#8217;
when the share manager initiated this request. Each list member
will have two sub dictionaries: &#8216;active_replica_snapshot&#8217; and
&#8216;share_replica_snapshot&#8217;. The &#8216;active&#8217; replica snapshot corresponds
to the instance of the snapshot on any of the &#8216;active&#8217; replicas of
the share while share_replica_snapshot corresponds to the snapshot
instance for the specific replica being updated. The driver needs
to ensure that this snapshot instance is truly available before
transitioning from &#8216;out_of_sync&#8217; to &#8216;in_sync&#8217;. Snapshots instances
for snapshots that have an &#8216;aggregate_status&#8217; of &#8216;creating&#8217; or
&#8216;deleting&#8217; will be polled for in the update_replicated_snapshot
method.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> [
  {
&#39;active_replica_snapshot&#39;: {
     &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
     &#39;share_instance_id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
     &#39;status&#39;: &#39;available&#39;,
     &#39;provider_location&#39;: &#39;/newton/share-snapshot-10e49c3e-aca9&#39;,
     ...
    },
 &#39;share_replica_snapshot&#39;: {
     &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
     &#39;share_instance_id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
     &#39;status&#39;: &#39;creating&#39;,
     &#39;provider_location&#39;: None,
        ...
    },
  }
 ]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">replica_state: a str value denoting the replica_state.
Valid values are &#8216;in_sync&#8217; and &#8216;out_of_sync&#8217; or None (to leave the
current replica_state unchanged).</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="replicated-snapshot-interfaces">
<h3>Replicated Snapshot interfaces:<a class="headerlink" href="#replicated-snapshot-interfaces" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt>
<em class="property">class </em><code class="descname">ShareDriver</code><span class="sig-paren">(</span><em>driver_handles_share_servers</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Class defines interface of NAS driver.</p>
<dl class="method">
<dt id="manila.share.driver.ShareDriver.create_replicated_snapshot">
<code class="descname">create_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>replica_snapshots</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.create_replicated_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a snapshot on active instance and update across the replicas.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the &#8216;active&#8217; replica&#8217;s host. Drivers are
expected to transfer the snapshot created to the respective
replicas.</p>
</div>
<p>The driver is expected to return model updates to the share manager.
If it was able to confirm the creation of any number of the snapshot
instances passed in this interface, it can set their status to
&#8216;available&#8217; as a cue for the share manager to set the progress attr
to &#8216;100%&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
The &#8216;active&#8217; replica will have its &#8216;replica_state&#8217; attr set to
&#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
These snapshot instances track the snapshot across the replicas.
All the instances will have their status attribute set to
&#8216;creating&#8217;.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> [
    {
    &#39;id&#39;: &#39;d3931a93-3984-421e-a9e7-d9f71895450a&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;status: &#39;creating&#39;,
    &#39;progress&#39;: &#39;0%&#39;,
        ...
    },
    {
    &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;status: &#39;creating&#39;,
    &#39;progress&#39;: &#39;0%&#39;,
        ...
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of dictionaries of snapshot instances.
The dictionaries can contain values that need to be updated on the
database for the snapshot instances being created.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">Exception.
Any exception in this method will set all instances to &#8216;error&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="manila.share.driver.ShareDriver.delete_replicated_snapshot">
<code class="descname">delete_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>replica_snapshots</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.delete_replicated_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a snapshot by deleting its instances across the replicas.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This call is made on the &#8216;active&#8217; replica&#8217;s host, since
drivers may not be able to delete the snapshot from an individual
replica.</p>
</div>
<p>The driver is expected to return model updates to the share manager.
If it was able to confirm the removal of any number of the snapshot
instances passed in this interface, it can set their status to
&#8216;deleted&#8217; as a cue for the share manager to clean up that instance
from the database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
The &#8216;active&#8217; replica will have its &#8216;replica_state&#8217; attr set to
&#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;in_sync&#39;,
        ...
    &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    {
    &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
    &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
    &#39;replica_state&#39;: &#39;active&#39;,
        ...
    &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
    &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
These snapshot instances track the snapshot across the replicas.
All the instances will have their status attribute set to
&#8216;deleting&#8217;.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> [
    {
    &#39;id&#39;: &#39;d3931a93-3984-421e-a9e7-d9f71895450a&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;status&#39;: &#39;deleting&#39;,
    &#39;progress&#39;: &#39;100%&#39;,
        ...
    },
    {
    &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;status: &#39;deleting&#39;,
    &#39;progress&#39;: &#39;100%&#39;,
        ...
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of dictionaries of snapshot instances.
The dictionaries can contain values that need to be updated on the
database for the snapshot instances being deleted. To confirm the
deletion of the snapshot instance, set the &#8216;status&#8217; attribute of
the instance to &#8216;deleted&#8217; (constants.STATUS_DELETED)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">Exception.
Any exception in this method will set the status attribute of all
snapshot instances to &#8216;error_deleting&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="manila.share.driver.ShareDriver.update_replicated_snapshot">
<code class="descname">update_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>replica_list</em>, <em>share_replica</em>, <em>replica_snapshots</em>, <em>replica_snapshot</em>, <em>share_server=None</em><span class="sig-paren">)</span><a class="headerlink" href="#manila.share.driver.ShareDriver.update_replicated_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the status of a snapshot instance that lives on a replica.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For DR and Readable styles of replication, this call is made on
the replica&#8217;s host and not the &#8216;active&#8217; replica&#8217;s host.</p>
</div>
<p>This method is called periodically by the share manager. It will
query for snapshot instances that track the parent snapshot across
non-&#8216;active&#8217; replicas. Drivers can expect the status of the instance to
be &#8216;creating&#8217; or &#8216;deleting&#8217;. If the driver sees that a snapshot
instance has been removed from the replica&#8217;s backend and the
instance status was set to &#8216;deleting&#8217;, it is expected to raise a
SnapshotResourceNotFound exception. All other exceptions will set the
snapshot instance status to &#8216;error&#8217;. If the instance was not in
&#8216;deleting&#8217; state, raising a SnapshotResourceNotFound will set the
instance status to &#8216;error&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> &#8211; Current context</li>
<li><strong>replica_list</strong> &#8211; List of all replicas for a particular share
The &#8216;active&#8217; replica will have its &#8216;replica_state&#8217; attr set to
&#8216;active&#8217;.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
     {
      &#39;id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
      &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
      &#39;replica_state&#39;: &#39;in_sync&#39;,
      ...
      &#39;share_server_id&#39;: &#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;,
      &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
     },
     {
      &#39;id&#39;: &#39;10e49c3e-aca9-483b-8c2d-1c337b38d6af&#39;,
      &#39;share_id&#39;: &#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;,
      &#39;replica_state&#39;: &#39;active&#39;,
      ...
      &#39;share_server_id&#39;: &#39;f63629b3-e126-4448-bec2-03f788f76094&#39;,
      &#39;share_server&#39;: &lt;models.ShareServer&gt; or None,
     },
      ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_replica</strong> &#8211; Share replica dictionary.
This replica is associated with the snapshot instance whose
status is being updated. Replicas in &#8216;active&#8217; replica_state will
not be passed via this parameter.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_id&#39;</span><span class="p">:</span> <span class="s1">&#39;f0e4bb5e-65f0-11e5-9d70-feff819cdc9f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;deleted&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="s1">&#39;host&#39;</span><span class="p">:</span> <span class="s1">&#39;openstack2@cmodeSSVMNFS1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;available&#39;</span><span class="p">,</span>
    <span class="s1">&#39;scheduled_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
    <span class="s1">&#39;launched_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">58</span><span class="p">),</span>
    <span class="s1">&#39;terminated_at&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
    <span class="s1">&#39;replica_state&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
    <span class="s1">&#39;availability_zone_id&#39;</span><span class="p">:</span> <span class="s1">&#39;e2c2db5c-cb2f-4697-9966-c06fb200cb80&#39;</span><span class="p">,</span>
    <span class="s1">&#39;export_locations&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">models</span><span class="o">.</span><span class="n">ShareInstanceExportLocations</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;access_rules_status&#39;</span><span class="p">:</span> <span class="s1">&#39;in_sync&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_network_id&#39;</span><span class="p">:</span> <span class="s1">&#39;4ccd5318-65f1-11e5-9d70-feff819cdc9f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;share_server_id&#39;</span><span class="p">:</span> <span class="s1">&#39;4ce78e7b-0ef6-4730-ac2a-fd2defefbd05&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshots</strong> &#8211; List of dictionaries of snapshot instances.
These snapshot instances track the snapshot across the replicas.
This will include the snapshot instance being updated as well.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> [
    {
    &#39;id&#39;: &#39;d3931a93-3984-421e-a9e7-d9f71895450a&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
        ...
    },
    {
    &#39;id&#39;: &#39;8bda791c-7bb6-4e7b-9b64-fefff85ff13e&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
        ...
    },
    ...
]
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replica_snapshot</strong> &#8211; Dictionary of the snapshot instance.
This is the instance to be updated. It will be in &#8216;creating&#8217; or
&#8216;deleting&#8217; state when sent via this parameter.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>{
    &#39;name&#39;: &#39;share-snapshot-18825630-574f-4912-93bb-af4611ef35a2&#39;,
    &#39;share_id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;share_name&#39;: &#39;share-d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;status&#39;: &#39;creating&#39;,
    &#39;id&#39;: &#39;18825630-574f-4912-93bb-af4611ef35a2&#39;,
    &#39;deleted&#39;: False,
    &#39;created_at&#39;: datetime.datetime(2016, 8, 3, 0, 5, 58),
    &#39;share&#39;: &lt;models.ShareInstance&gt;,
    &#39;updated_at&#39;: datetime.datetime(2016, 8, 3, 0, 5, 58),
    &#39;share_instance_id&#39;: &#39;d487b88d-e428-4230-a465-a800c2cce5f8&#39;,
    &#39;snapshot_id&#39;: &#39;13ee5cb5-fc53-4539-9431-d983b56c5c40&#39;,
    &#39;progress&#39;: &#39;0%&#39;,
    &#39;deleted_at&#39;: None,
    &#39;provider_location&#39;: None,
}
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share_server</strong> &#8211; &lt;models.ShareServer&gt; or None</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">replica_snapshot_model_update: a dictionary.
The dictionary must contain values that need to be updated on the
database for the snapshot instance that represents the snapshot on
the replica.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">exception.SnapshotResourceNotFound
Raise this exception for snapshots that are not found on the
backend and their status was &#8216;deleting&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="ganesha.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Ganesha Library"></i></a>
          
          
            <a href="driver_filter_goodness_weigher.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Configure and use driver filter and weighing for scheduler"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#programming-howtos-and-tutorials">Programming HowTos and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#background-concepts-for-manila">Background Concepts for manila</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#other-resources">Other Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#api-reference">API Reference</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#module-reference">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#capabilities-and-extra-specs">Capabilities and Extra-Specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#share-backends-feature-support-mapping">Share backends feature support mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#share-backends">Share backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Command-Line Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../adminref/index.html">Admin Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "devref/share_replication" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/manila/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 610baa2fdb702fa4cc2c12eb5c61599bdcad21ce";
        var bugProject = "manila";
        var bugTitle = "Share Replication in manila";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 4.0.0.0rc2.dev25 on 'Tue Feb 14 14:25:27 2017, commit 610baa2'";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>