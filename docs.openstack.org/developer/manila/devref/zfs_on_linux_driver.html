<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: ZFS (on Linux) Driver</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>ZFS (on Linux) Driver</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="container_driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Container Driver"></i></a>
    
    
    <a href="netapp_cluster_mode_driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: NetApp Clustered Data ONTAP"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">ZFS (on Linux) Driver</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#supported-operations">Supported Operations</a></li>
<li><a class="reference internal" href="#possibilities">Possibilities</a></li>
<li><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li><a class="reference internal" href="#known-problems">Known problems</a></li>
<li><a class="reference internal" href="#backend-configuration">Backend Configuration</a><ul>
<li><a class="reference internal" href="#the-manila-share-drivers-zfsonlinux-driver-module">The <code class="docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.driver</span></code> Module</a></li>
<li><a class="reference internal" href="#the-manila-share-drivers-zfsonlinux-utils-module">The <code class="docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.utils</span></code> Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="zfs-on-linux-driver">
<h1>ZFS (on Linux) Driver<a class="headerlink" href="#zfs-on-linux-driver" title="Permalink to this headline">¶</a></h1>
<p>Manila ZFSonLinux share driver uses ZFS filesystem for exporting NFS shares.
Written and tested using Linux version of ZFS.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">&#8216;NFS&#8217; daemon that can be handled via &#8220;exportfs&#8221; app.</p>
</li>
<li><p class="first">&#8216;ZFS&#8217; filesystem packages, either Kernel or FUSE versions.</p>
</li>
<li><p class="first">ZFS zpools that are going to be used by Manila should exist and be
configured as desired. Manila will not change zpool configuration.</p>
</li>
<li><p class="first">For remote ZFS hosts according to manila-share service host SSH should be
installed.</p>
</li>
<li><dl class="first docutils">
<dt>For ZFS hosts that support replication:</dt>
<dd><ul class="first last simple">
<li>SSH access for each other should be passwordless.</li>
<li>Service IP addresses should be available by ZFS hosts for each other.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="supported-operations">
<h2>Supported Operations<a class="headerlink" href="#supported-operations" title="Permalink to this headline">¶</a></h2>
<p>The following operations are supported:</p>
<ul>
<li><p class="first">Create NFS Share</p>
</li>
<li><p class="first">Delete NFS Share</p>
</li>
<li><p class="first">Manage NFS Share</p>
</li>
<li><p class="first">Unmanage NFS Share</p>
</li>
<li><dl class="first docutils">
<dt>Allow NFS Share access</dt>
<dd><ul class="first last simple">
<li>Only IP access type is supported for NFS</li>
<li>Both access levels are supported - &#8216;RW&#8217; and &#8216;RO&#8217;</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Deny NFS Share access</p>
</li>
<li><p class="first">Create snapshot</p>
</li>
<li><p class="first">Delete snapshot</p>
</li>
<li><p class="first">Manage snapshot</p>
</li>
<li><p class="first">Unmanage snapshot</p>
</li>
<li><p class="first">Create share from snapshot</p>
</li>
<li><p class="first">Extend share</p>
</li>
<li><p class="first">Shrink share</p>
</li>
<li><dl class="first docutils">
<dt>Replication (experimental):</dt>
<dd><ul class="first last simple">
<li>Create/update/delete/promote replica operations are supported</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">Share migration (experimental)</p>
</li>
</ul>
</div>
<div class="section" id="possibilities">
<h2>Possibilities<a class="headerlink" href="#possibilities" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Any amount of ZFS zpools can be used by share driver.</li>
<li>Allowed to configure default options for ZFS datasets that are used
for share creation.</li>
<li>Any amount of nested datasets is allowed to be used.</li>
<li>All share replicas are read-only, only active one is RW.</li>
<li>All share replicas are synchronized periodically, not continuously.
So, status &#8216;in_sync&#8217; means latest sync was successful.
Time range between syncs equals to value of
config global opt &#8216;replica_state_update_interval&#8217;.</li>
<li>Driver is able to use qualified extra spec &#8216;zfsonlinux:compression&#8217;.
It can contain any value that is supported by used ZFS app.
But if it is disabled via config option with value &#8216;compression=off&#8217;,
then it will not be used.</li>
</ul>
</div>
<div class="section" id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<p>The ZFSonLinux share driver has the following restrictions:</p>
<ul class="simple">
<li>Only IP access type is supported for NFS.</li>
<li>Only FLAT network is supported.</li>
<li>&#8216;Promote share replica&#8217; operation will switch roles of
current &#8216;secondary&#8217; replica and &#8216;active&#8217;. It does not make more than
one active replica available.</li>
<li>&#8216;SaMBa&#8217; based sharing is not yet implemented.</li>
<li>&#8216;Thick provisioning&#8217; is not yet implemented.</li>
</ul>
</div>
<div class="section" id="known-problems">
<h2>Known problems<a class="headerlink" href="#known-problems" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>&#8216;Promote share replica&#8217; operation will make ZFS filesystem that became
secondary as RO only on NFS level. On ZFS level system will
stay mounted as was - RW.</li>
</ul>
</div>
<div class="section" id="backend-configuration">
<h2>Backend Configuration<a class="headerlink" href="#backend-configuration" title="Permalink to this headline">¶</a></h2>
<p>The following parameters need to be configured in the manila configuration file
for the ZFSonLinux driver:</p>
<ul>
<li><p class="first">share_driver = manila.share.drivers.zfsonlinux.driver.ZFSonLinuxShareDriver</p>
</li>
<li><p class="first">driver_handles_share_servers = False</p>
</li>
<li><dl class="first docutils">
<dt>replication_domain = custom_str_value_as_domain_name</dt>
<dd><ul class="first last simple">
<li>if empty, then replication will be disabled</li>
<li>if set then will be able to be used as replication peer for other
backend with same value.</li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">zfs_share_export_ip = &lt;user_facing IP address of ZFS host&gt;</p>
</li>
<li><p class="first">zfs_service_ip = &lt;IP address of service network interface of ZFS host&gt;</p>
</li>
<li><dl class="first docutils">
<dt>zfs_zpool_list = zpoolname1,zpoolname2/nested_dataset_for_zpool2</dt>
<dd><ul class="first last simple">
<li>can be one or more zpools</li>
<li>can contain nested datasets</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_dataset_creation_options = &lt;list of ZFS dataset options&gt;</dt>
<dd><ul class="first last simple">
<li>readonly,quota,sharenfs and sharesmb options will be ignored</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_dataset_name_prefix = &lt;prefix&gt;</dt>
<dd><ul class="first last simple">
<li>Prefix to be used in each dataset name.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_dataset_snapshot_name_prefix = &lt;prefix&gt;</dt>
<dd><ul class="first last simple">
<li>Prefix to be used in each dataset snapshot name.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_use_ssh = &lt;boolean_value&gt;</dt>
<dd><ul class="first last simple">
<li>set &#8216;False&#8217; if ZFS located on the same host as &#8216;manila-share&#8217; service</li>
<li>set &#8216;True&#8217; if &#8216;manila-share&#8217; service should use SSH for ZFS configuration</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_ssh_username = &lt;ssh_username&gt;</dt>
<dd><ul class="first last simple">
<li>required for replication operations</li>
<li>required for SSH&#8217;ing to ZFS host if &#8216;zfs_use_ssh&#8217; is set to &#8216;True&#8217;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_ssh_user_password = &lt;ssh_user_password&gt;</dt>
<dd><ul class="first last simple">
<li>password for &#8216;zfs_ssh_username&#8217; of ZFS host.</li>
<li>used only if &#8216;zfs_use_ssh&#8217; is set to &#8216;True&#8217;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_ssh_private_key_path = &lt;path_to_private_ssh_key&gt;</dt>
<dd><ul class="first last simple">
<li>used only if &#8216;zfs_use_ssh&#8217; is set to &#8216;True&#8217;</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_share_helpers = NFS=manila.share.drivers.zfsonlinux.utils.NFSviaZFSHelper</dt>
<dd><ul class="first last simple">
<li>Approach for setting up helpers is similar to various other share driver</li>
<li>At least one helper should be used.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_replica_snapshot_prefix = &lt;prefix&gt;</dt>
<dd><ul class="first last simple">
<li>Prefix to be used in dataset snapshot names that are created
by &#8216;update replica&#8217; operation.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zfs_migration_snapshot_prefix = &lt;prefix&gt;</dt>
<dd><ul class="first last simple">
<li>Prefix to be used in dataset snapshot names that are created
for &#8216;migration&#8217; operation.</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Restart of <a class="reference internal" href="../glossary.html#term-manila-share"><span class="xref std std-term">manila-share</span></a> service is needed for the configuration
changes to take effect.</p>
<div class="section" id="the-manila-share-drivers-zfsonlinux-driver-module">
<h3>The <code class="xref py py-mod docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.driver</span></code> Module<a class="headerlink" href="#the-manila-share-drivers-zfsonlinux-driver-module" title="Permalink to this headline">¶</a></h3>
<p>Module with ZFSonLinux share driver that utilizes ZFS filesystem resources
and exports them as shares.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descname">ZFSonLinuxShareDriver</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.utils.ExecuteMixin</span></code>, <a class="reference internal" href="share_replication.html#manila.share.driver.ShareDriver" title="manila.share.driver.ShareDriver"><code class="xref py py-class docutils literal"><span class="pre">manila.share.driver.ShareDriver</span></code></a></p>
<dl class="method">
<dt>
<code class="descname">create_replica</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">create_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">create_share</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">create_share_from_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">create_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_replica</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_share</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">delete_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">do_setup</code><span class="sig-paren">(</span><em>context</em><span class="sig-paren">)</span></dt>
<dd><p>Perform basic setup and checks.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">ensure_share</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">extend_share</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">get_network_allocations_number</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>ZFS does not handle networking. Return 0.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_pool</code><span class="sig-paren">(</span><em>share</em><span class="sig-paren">)</span></dt>
<dd><p>Return pool name where the share resides on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>share</strong> &#8211; The share hosted by the driver.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">manage_existing</code><span class="sig-paren">(</span><em>share</em>, <em>driver_options</em><span class="sig-paren">)</span></dt>
<dd><p>Manage existing ZFS dataset as manila share.</p>
<p>ZFSonLinux driver accepts only one driver_option &#8216;size&#8217;.
If an administrator provides this option, then such quota will be set
to dataset and used as share size. Otherwise, driver will set quota
equal to nearest bigger rounded integer of usage size.
Driver does not expect mountpoint to be changed (should be equal
to default that is &#8220;/%(dataset_name)s&#8221;).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>share</strong> &#8211; share data</li>
<li><strong>driver_options</strong> &#8211; Empty dict or dict with &#8216;size&#8217; option.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dict with share size and its export locations.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">manage_existing_snapshot</code><span class="sig-paren">(</span><em>snapshot_instance</em>, <em>driver_options</em><span class="sig-paren">)</span></dt>
<dd><p>Manage existing share snapshot with manila.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>snapshot_instance</strong> &#8211; SnapshotInstance data</li>
<li><strong>driver_options</strong> &#8211; expects only one optional key &#8216;size&#8217;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>dict with share snapshot instance fields for update, example:
{&#8216;size&#8217;: 1,</p>
<blockquote>
<div><p>&#8216;provider_location&#8217;: <a class="reference external" href="mailto:'path/to/some/dataset&#37;&#52;&#48;some_snapshot_tag">'path/to/some/dataset<span>&#64;</span>some_snapshot_tag</a>&#8216;}</p>
</div></blockquote>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">migration_cancel</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">migration_check_compatibility</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">migration_complete</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">migration_continue</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">migration_start</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">promote_replica</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">shrink_share</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">unmanage</code><span class="sig-paren">(</span><em>share</em><span class="sig-paren">)</span></dt>
<dd><p>Removes the specified share from Manila management.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">unmanage_snapshot</code><span class="sig-paren">(</span><em>snapshot_instance</em><span class="sig-paren">)</span></dt>
<dd><p>Unmanage dataset snapshot.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">update_access</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">update_replica_state</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">update_replicated_snapshot</code><span class="sig-paren">(</span><em>context</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descname">ensure_share_server_not_provided</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descname">get_backend_configuration</code><span class="sig-paren">(</span><em>backend_name</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</div>
<div class="section" id="the-manila-share-drivers-zfsonlinux-utils-module">
<h3>The <code class="xref py py-mod docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.utils</span></code> Module<a class="headerlink" href="#the-manila-share-drivers-zfsonlinux-utils-module" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Module for storing ZFSonLinux driver utility stuff such as:</dt>
<dd><ul class="first last simple">
<li>Common ZFS code</li>
<li>Share helpers</li>
</ul>
</dd>
</dl>
<dl class="class">
<dt>
<em class="property">class </em><code class="descname">ExecuteMixin</code></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">manila.share.driver.ExecuteMixin</span></code></p>
<dl class="method">
<dt>
<code class="descname">execute</code><span class="sig-paren">(</span><em>*cmd</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Common interface for running shell commands.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">execute_with_retry</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Retry wrapper over common shell interface.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_zfs_option</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>option_name</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Returns value of requested zfs dataset option.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_zpool_option</code><span class="sig-paren">(</span><em>zpool_name</em>, <em>option_name</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Returns value of requested zpool option.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">init_execute_mixin</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Init method for mixin called in the end of driver&#8217;s __init__().</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">parse_zfs_answer</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span></dt>
<dd><p>Returns list of dicts with data returned by ZFS shell commands.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">zfs</code><span class="sig-paren">(</span><em>*cmd</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>ZFS shell commands executor.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">zfs_with_retry</code><span class="sig-paren">(</span><em>*cmd</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>ZFS shell commands executor.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">NASHelperBase</code><span class="sig-paren">(</span><em>configuration</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class for share helpers of &#8216;ZFS on Linux&#8217; driver.</p>
<dl class="method">
<dt>
<code class="descname">create_exports</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>executor</em><span class="sig-paren">)</span></dt>
<dd><p>Creates share exports.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_exports</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>service</em>, <em>executor</em><span class="sig-paren">)</span></dt>
<dd><p>Gets/reads share exports.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">remove_exports</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>executor</em><span class="sig-paren">)</span></dt>
<dd><p>Removes share exports.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">update_access</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>access_rules</em>, <em>add_rules</em>, <em>delete_rules</em>, <em>executor</em><span class="sig-paren">)</span></dt>
<dd><p>Update access rules for specified ZFS dataset.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">verify_setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Performs checks for required stuff.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descname">NFSviaZFSHelper</code><span class="sig-paren">(</span><em>configuration</em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.utils.ExecuteMixin</span></code>, <code class="xref py py-class docutils literal"><span class="pre">manila.share.drivers.zfsonlinux.utils.NASHelperBase</span></code></p>
<p>Helper class for handling ZFS datasets as NFS shares.</p>
<p>Kernel and Fuse versions of ZFS have different syntax for setting up access
rules, and this Helper designed to satisfy both making autodetection.</p>
<dl class="method">
<dt>
<code class="descname">create_exports</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>executor=None</em><span class="sig-paren">)</span></dt>
<dd><p>Creates NFS share exports for given ZFS dataset.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">get_exports</code><span class="sig-paren">(</span><em>dataset_name</em>, <em>executor=None</em><span class="sig-paren">)</span></dt>
<dd><p>Gets/reads NFS share export for given ZFS dataset.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">is_kernel_version</code></dt>
<dd><p>Says whether Kernel version of ZFS is used or not.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">remove_exports</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">update_access</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">verify_setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Performs checks for required stuff.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descname">get_remote_shell_executor</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>conn_timeout</em>, <em>login=None</em>, <em>password=None</em>, <em>privatekey=None</em>, <em>max_size=10</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="function">
<dt>
<code class="descname">zfs_dataset_synchronized</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="container_driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Container Driver"></i></a>
          
          
            <a href="netapp_cluster_mode_driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: NetApp Clustered Data ONTAP"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 'Tue Feb 14 14:25:27 2017, commit 610baa2'</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#programming-howtos-and-tutorials">Programming HowTos and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#background-concepts-for-manila">Background Concepts for manila</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#other-resources">Other Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#api-reference">API Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#module-reference">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#capabilities-and-extra-specs">Capabilities and Extra-Specs</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#share-backends-feature-support-mapping">Share backends feature support mapping</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#share-backends">Share backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Command-Line Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../adminref/index.html">Admin Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "devref/zfs_on_linux_driver" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/manila/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 610baa2fdb702fa4cc2c12eb5c61599bdcad21ce";
        var bugProject = "manila";
        var bugTitle = "ZFS (on Linux) Driver in manila";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 4.0.0.0rc2.dev25 on 'Tue Feb 14 14:25:27 2017, commit 610baa2'";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>