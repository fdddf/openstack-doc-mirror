<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Troubleshooting &mdash; congress 5.0.0.0rc2.dev7 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.0.0.0rc2.dev7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="congress 5.0.0.0rc2.dev7 documentation" href="index.html" />
    <link rel="next" title="Deployment" href="deployment.html" />
    <link rel="prev" title="Congress Tutorial - Tenant Sharing Policy" href="tutorial-tenant-sharing.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="troubleshooting">
<span id="id1"></span><h1>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<p>So you&#8217;ve installed Congress with devstack as per the README,
and now something is not behaving the way you think it should.
Let&#8217;s say you&#8217;re using the policy that follows (from the tutorial),
but the <em>error</em> table does not contain the rows you expect.  In
this document, we describe how to figure out what the problem is
and hopefully how to fix it.  At the end we also detail a collection
of problems and tips for how to fix them.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>  error(name2) :-
    neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p),
    nova:servers(device_id, name2, c2, d2, tenant_id2, f2, g2, h2),
    neutron:networks(a3, b3, c3, d3, e3, f3, tenant_id3, h3, i3, j3, network_id, l3),
    not same_group(tenant_id, tenant_id2)

  error(name2) :-
    neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p),
    nova:servers(device_id, name2, c2, d2, tenant_id2, f2, g2, h2),
    neutron:networks(a3, b3, c3, d3, e3, f3, tenant_id3, h3, i3, j3, network_id, l3),
    not same_group(tenant_id2, tenant_id3)

  same_group(x, y) :-
      group(x, g),
      group(y, g)

group(&quot;7320f8345acb489e8296ddb3b1ad1262&quot;, &quot;IT&quot;) :- true()
group(&quot;81084a94769c4ce0accb6968c397a085&quot;, &quot;Marketing&quot;) :- true()
</pre></div>
</div>
<div class="section" id="policy-engine-troubleshooting">
<h2>Policy-engine troubleshooting<a class="headerlink" href="#policy-engine-troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Make sure the policy engine knows about the rules you think it knows about.
It is possible that the policy engine rejected a rule because of a syntax
error.  Let&#8217;s assume you&#8217;re using the <em>classification</em> policy.</p>
<p><strong>Check</strong>: Ensure the policy engine has the right rules:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/rules
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/rules
{
  &quot;results&quot;: [
    {
      &quot;comment&quot;: &quot;None&quot;,
      &quot;id&quot;: &quot;2be98841-953d-44f0-91f6-32c5f4dd4f83&quot;,
      &quot;rule&quot;: &quot;group(\&quot;d0a7ff9e5d5b4130a586a7af1c855c3e\&quot;, \&quot;IT\&quot;) :- true()&quot;
    },
    {
      &quot;comment&quot;: &quot;None&quot;,
      &quot;id&quot;: &quot;c01067ef-10e4-498f-8aaa-0c1cce1272a3&quot;,
      &quot;rule&quot;: &quot;group(\&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;Marketing\&quot;) :- true()&quot;
    },
    {
      &quot;comment&quot;: &quot;None&quot;,
      &quot;id&quot;: &quot;3c6e48ee-2783-4b5e-94ff-aab00ccffd42&quot;,
      &quot;rule&quot;: &quot;error(name2) :- neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p), nova:servers(device_id, name2, c2, d2, tenant_id2, f2, g2, h2), neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, network_id, i3), not same_group(tenant_id, tenant_id2)&quot;
    },
    {
      &quot;comment&quot;: &quot;None&quot;,
      &quot;id&quot;: &quot;36264def-d917-4f39-a6b0-4aaf12d4b349&quot;,
      &quot;rule&quot;: &quot;error(name2) :- neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p), nova:servers(device_id, name2, c2, d2, tenant_id2, f2, g2, h2), neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, network_id, i3), not same_group(tenant_id2, tenant_id3)&quot;
    },
    {
      &quot;comment&quot;: &quot;None&quot;,
      &quot;id&quot;: &quot;31922bb0-711c-43da-9f11-cef69828a2c4&quot;,
      &quot;rule&quot;: &quot;same_group(x, y) :- group(x, g), group(y, g)&quot;
    }
  ]
}
</pre></div>
</div>
<p>It is also possible that you might have a typo in one of the table names that appear
in the rules.  To eliminate that possibility, ask the list of tables
that occur in the rules and compare those to the ones the datasources export.
You might also look for near-duplicates, such as <em>same_group</em> and <em>samegroup</em>,
in case tables are spelled differently in different rules.</p>
<p><strong>Check</strong>: Ensure there are no typos in any of the table names by asking
for the list of tables occurring in the rules:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables
{
  &quot;results&quot;: [
    {
      &quot;id&quot;: &quot;nova:servers&quot;
    },
    {
      &quot;id&quot;: &quot;neutron:ports&quot;
    },
    {
      &quot;id&quot;: &quot;group&quot;
    },
    {
      &quot;id&quot;: &quot;neutron:networks&quot;
    },
    {
      &quot;id&quot;: &quot;error&quot;
    },
    {
      &quot;id&quot;: &quot;same_group&quot;
    },
    {
      &quot;id&quot;: &quot;true&quot;
    }
  ]
}
</pre></div>
</div>
<p>Next we want to check that tables have the rows we would expect.  A good place
to start is with the tables exported by external datasources like Nova and
Neutron.  If these tables are empty, that points to a problem with the
datasources (see below for troubleshooting datasources).
If they are not empty, it points to a problem with the rules:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables/&lt;table-id&gt;/rows
</pre></div>
</div>
<p>For example, below are the rows in the <em>neutron:ports</em> table.  There are 2
rows (each of which represents a port), and each row has 16 columns:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> $ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables/neutron:ports/rows
{
  &quot;results&quot;: [
    {
      &quot;data&quot;: [
        &quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a&quot;,
        &quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd&quot;,
        &quot;1955273c-242d-46a6-8063-7dc9c20cbba9&quot;,
        &quot;None&quot;,
        &quot;ACTIVE&quot;,
        &quot;&quot;,
        &quot;True&quot;,
        &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;,
        &quot;e793326db18847e1908e791daa69a5a3&quot;,
        &quot;None&quot;,
        &quot;network:router_interface&quot;,
        &quot;fa:16:3e:28:ab:0b&quot;,
        &quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c&quot;,
        &quot;882911e9-e3cf-4682-bb18-4bf8c559e22d&quot;,
        &quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;,
        &quot;None&quot;
      ]
    },
    {
      &quot;data&quot;: [
        &quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9&quot;,
        &quot;f999de49-753e-40c9-9eed-d01ad76bc6c3&quot;,
        &quot;ad058c04-05be-4f56-a76f-7f3b42f36f79&quot;,
        &quot;None&quot;,
        &quot;ACTIVE&quot;,
        &quot;&quot;,
        &quot;True&quot;,
        &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;,
        &quot;e793326db18847e1908e791daa69a5a3&quot;,
        &quot;None&quot;,
        &quot;compute:None&quot;,
        &quot;fa:16:3e:3c:0d:13&quot;,
        &quot;af179309-65f7-4662-a087-e583d6a8bc21&quot;,
        &quot;149f4271-41ca-4b1a-875b-77909debbeac&quot;,
        &quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;,
        &quot;None&quot;
      ]
    }
  ]
}
</pre></div>
</div>
<p>After checking the tables exported by datasources like Nova and Neutron,
it is useful to check the contents of the other tables that build upon
those tables.</p>
<p>In our running example, we should check the rows of the <em>group</em> table.  Here
we see what we expect: that there are two users, each of which belongs to
a different group:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables/group/rows
{
  &quot;results&quot;: [
    {
      &quot;data&quot;: [
        &quot;d0a7ff9e5d5b4130a586a7af1c855c3e&quot;,
        &quot;IT&quot;
      ]
    },
    {
      &quot;data&quot;: [
        &quot;e793326db18847e1908e791daa69a5a3&quot;,
        &quot;Marketing&quot;
      ]
    }
  ]
}
</pre></div>
</div>
<p>Once you have found a table that contains the wrong rows, it may be obvious
looking at the rules for that table what the problem is.  But if there
are many rules or if some of the rules are long, it can be difficult to
pinpoint the problem.  When this happens, you can ask for a trace that
describes how the rows of that table were computed:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables/&lt;table-id&gt;/rows?trace=true
</pre></div>
</div>
<p>The trace is similar to a function-call trace. It uses the following
annotations:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>* Call Q: a query for all the rows that match Q
* Exit Q: successfully discovered row Q
* Fail Q: failure to find a row matching Q (in the current context)
* Redo Q: attempt to find another row matching Q
</pre></div>
</div>
<p>In our example, we know the contents of the <em>error</em> table is empty, but
all of the tables used to construct <em>error</em> look reasonable.  So we ask
for a trace showing why the <em>error</em> table is empty.  The trace is returned
as a string and be quite large.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/policies/&lt;classification-id&gt;/tables/error/rows?trace=true
{
  &quot;results&quot;: [],
  &quot;trace&quot;: &quot;Clas  : Call: error(x0)\nClas  : | Call: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)\nClas  : | Exit: neutron:ports(\&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a\&quot;, \&quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd\&quot;, \&quot;1955273c-242d-46a6-8063-7dc9c20cbba9\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;37eee894-a65f-414d-bd8c-a9363293000a\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;network:router_interface\&quot;, \&quot;fa:16:3e:28:ab:0b\&quot;, \&quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c\&quot;, \&quot;882911e9-e3cf-4682-bb18-4bf8c559e22d\&quot;, \&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, \&quot;None\&quot;)\nClas  : | Call: nova:servers(\&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Fail: nova:servers(\&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Redo: neutron:ports(\&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a\&quot;, \&quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd\&quot;, \&quot;1955273c-242d-46a6-8063-7dc9c20cbba9\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;37eee894-a65f-414d-bd8c-a9363293000a\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;network:router_interface\&quot;, \&quot;fa:16:3e:28:ab:0b\&quot;, \&quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c\&quot;, \&quot;882911e9-e3cf-4682-bb18-4bf8c559e22d\&quot;, \&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, \&quot;None\&quot;)\nClas  : | Exit: neutron:ports(\&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9\&quot;, \&quot;f999de49-753e-40c9-9eed-d01ad76bc6c3\&quot;, \&quot;ad058c04-05be-4f56-a76f-7f3b42f36f79\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;compute:None\&quot;, \&quot;fa:16:3e:3c:0d:13\&quot;, \&quot;af179309-65f7-4662-a087-e583d6a8bc21\&quot;, \&quot;149f4271-41ca-4b1a-875b-77909debbeac\&quot;, \&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;None\&quot;)\nClas  : | Call: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Exit: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;vm-demo\&quot;, \&quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d\&quot;, \&quot;ACTIVE\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;cf23fabed97742a9af463002e68068bd\&quot;, \&quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976\&quot;, \&quot;1\&quot;)\nClas  : | Call: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, i3)\nClas  : | Fail: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, i3)\nClas  : | Redo: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;vm-demo\&quot;, \&quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d\&quot;, \&quot;ACTIVE\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;cf23fabed97742a9af463002e68068bd\&quot;, \&quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976\&quot;, \&quot;1\&quot;)\nClas  : | Fail: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Redo: neutron:ports(\&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9\&quot;, \&quot;f999de49-753e-40c9-9eed-d01ad76bc6c3\&quot;, \&quot;ad058c04-05be-4f56-a76f-7f3b42f36f79\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;compute:None\&quot;, \&quot;fa:16:3e:3c:0d:13\&quot;, \&quot;af179309-65f7-4662-a087-e583d6a8bc21\&quot;, \&quot;149f4271-41ca-4b1a-875b-77909debbeac\&quot;, \&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;None\&quot;)\nClas  : | Fail: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)\nClas  : | Call: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)\nClas  : | Exit: neutron:ports(\&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a\&quot;, \&quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd\&quot;, \&quot;1955273c-242d-46a6-8063-7dc9c20cbba9\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;37eee894-a65f-414d-bd8c-a9363293000a\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;network:router_interface\&quot;, \&quot;fa:16:3e:28:ab:0b\&quot;, \&quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c\&quot;, \&quot;882911e9-e3cf-4682-bb18-4bf8c559e22d\&quot;, \&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, \&quot;None\&quot;)\nClas  : | Call: nova:servers(\&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Fail: nova:servers(\&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Redo: neutron:ports(\&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a\&quot;, \&quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd\&quot;, \&quot;1955273c-242d-46a6-8063-7dc9c20cbba9\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;37eee894-a65f-414d-bd8c-a9363293000a\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;network:router_interface\&quot;, \&quot;fa:16:3e:28:ab:0b\&quot;, \&quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c\&quot;, \&quot;882911e9-e3cf-4682-bb18-4bf8c559e22d\&quot;, \&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec\&quot;, \&quot;None\&quot;)\nClas  : | Exit: neutron:ports(\&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9\&quot;, \&quot;f999de49-753e-40c9-9eed-d01ad76bc6c3\&quot;, \&quot;ad058c04-05be-4f56-a76f-7f3b42f36f79\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;compute:None\&quot;, \&quot;fa:16:3e:3c:0d:13\&quot;, \&quot;af179309-65f7-4662-a087-e583d6a8bc21\&quot;, \&quot;149f4271-41ca-4b1a-875b-77909debbeac\&quot;, \&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;None\&quot;)\nClas  : | Call: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Exit: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;vm-demo\&quot;, \&quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d\&quot;, \&quot;ACTIVE\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;cf23fabed97742a9af463002e68068bd\&quot;, \&quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976\&quot;, \&quot;1\&quot;)\nClas  : | Call: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, i3)\nClas  : | Fail: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, i3)\nClas  : | Redo: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;vm-demo\&quot;, \&quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d\&quot;, \&quot;ACTIVE\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;cf23fabed97742a9af463002e68068bd\&quot;, \&quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976\&quot;, \&quot;1\&quot;)\nClas  : | Fail: nova:servers(\&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)\nClas  : | Redo: neutron:ports(\&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9\&quot;, \&quot;f999de49-753e-40c9-9eed-d01ad76bc6c3\&quot;, \&quot;ad058c04-05be-4f56-a76f-7f3b42f36f79\&quot;, \&quot;None\&quot;, \&quot;ACTIVE\&quot;, \&quot;\&quot;, \&quot;True\&quot;, \&quot;07ecce19-d7a4-4c79-924e-1692713e53a7\&quot;, \&quot;e793326db18847e1908e791daa69a5a3\&quot;, \&quot;None\&quot;, \&quot;compute:None\&quot;, \&quot;fa:16:3e:3c:0d:13\&quot;, \&quot;af179309-65f7-4662-a087-e583d6a8bc21\&quot;, \&quot;149f4271-41ca-4b1a-875b-77909debbeac\&quot;, \&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8\&quot;, \&quot;None\&quot;)\nClas  : | Fail: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)\nClas  : Fail: error(x0)\n&quot;
}
</pre></div>
</div>
<p>We can print the trace using &#8216;printf &lt;trace&gt;&#8217; (without the quotes):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ printf &quot;Clas  : Call: error(x0)...
Clas  : Call: error(x0)
Clas  : | Call: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)
Clas  : | Exit: neutron:ports(&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a&quot;, &quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd&quot;, &quot;1955273c-242d-46a6-8063-7dc9c20cbba9&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;network:router_interface&quot;, &quot;fa:16:3e:28:ab:0b&quot;, &quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c&quot;, &quot;882911e9-e3cf-4682-bb18-4bf8c559e22d&quot;, &quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, &quot;None&quot;)
Clas  : | Call: nova:servers(&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Fail: nova:servers(&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Redo: neutron:ports(&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a&quot;, &quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd&quot;, &quot;1955273c-242d-46a6-8063-7dc9c20cbba9&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;network:router_interface&quot;, &quot;fa:16:3e:28:ab:0b&quot;, &quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c&quot;, &quot;882911e9-e3cf-4682-bb18-4bf8c559e22d&quot;, &quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, &quot;None&quot;)
Clas  : | Exit: neutron:ports(&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9&quot;, &quot;f999de49-753e-40c9-9eed-d01ad76bc6c3&quot;, &quot;ad058c04-05be-4f56-a76f-7f3b42f36f79&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;compute:None&quot;, &quot;fa:16:3e:3c:0d:13&quot;, &quot;af179309-65f7-4662-a087-e583d6a8bc21&quot;, &quot;149f4271-41ca-4b1a-875b-77909debbeac&quot;, &quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;None&quot;)
Clas  : | Call: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Exit: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;vm-demo&quot;, &quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d&quot;, &quot;ACTIVE&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;cf23fabed97742a9af463002e68068bd&quot;, &quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976&quot;, &quot;1&quot;)
Clas  : | Call: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, i3)
Clas  : | Fail: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, i3)
Clas  : | Redo: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;vm-demo&quot;, &quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d&quot;, &quot;ACTIVE&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;cf23fabed97742a9af463002e68068bd&quot;, &quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976&quot;, &quot;1&quot;)
Clas  : | Fail: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Redo: neutron:ports(&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9&quot;, &quot;f999de49-753e-40c9-9eed-d01ad76bc6c3&quot;, &quot;ad058c04-05be-4f56-a76f-7f3b42f36f79&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;compute:None&quot;, &quot;fa:16:3e:3c:0d:13&quot;, &quot;af179309-65f7-4662-a087-e583d6a8bc21&quot;, &quot;149f4271-41ca-4b1a-875b-77909debbeac&quot;, &quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;None&quot;)
Clas  : | Fail: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)

Clas  : | Call: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)
Clas  : | Exit: neutron:ports(&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a&quot;, &quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd&quot;, &quot;1955273c-242d-46a6-8063-7dc9c20cbba9&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;network:router_interface&quot;, &quot;fa:16:3e:28:ab:0b&quot;, &quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c&quot;, &quot;882911e9-e3cf-4682-bb18-4bf8c559e22d&quot;, &quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, &quot;None&quot;)
Clas  : | Call: nova:servers(&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Fail: nova:servers(&quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Redo: neutron:ports(&quot;795a4e6f-7cc8-4052-ae43-80d4c3ad233a&quot;, &quot;5f1f9b53-46b2-480f-b653-606f4aaf61fd&quot;, &quot;1955273c-242d-46a6-8063-7dc9c20cbba9&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;network:router_interface&quot;, &quot;fa:16:3e:28:ab:0b&quot;, &quot;4b7e5f9c-9ba8-4c94-a7d0-e5811207d26c&quot;, &quot;882911e9-e3cf-4682-bb18-4bf8c559e22d&quot;, &quot;c62efe5d-d070-4dff-8d9d-3df8ac08b0ec&quot;, &quot;None&quot;)
Clas  : | Exit: neutron:ports(&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9&quot;, &quot;f999de49-753e-40c9-9eed-d01ad76bc6c3&quot;, &quot;ad058c04-05be-4f56-a76f-7f3b42f36f79&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;compute:None&quot;, &quot;fa:16:3e:3c:0d:13&quot;, &quot;af179309-65f7-4662-a087-e583d6a8bc21&quot;, &quot;149f4271-41ca-4b1a-875b-77909debbeac&quot;, &quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;None&quot;)
Clas  : | Call: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Exit: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;vm-demo&quot;, &quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d&quot;, &quot;ACTIVE&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;cf23fabed97742a9af463002e68068bd&quot;, &quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976&quot;, &quot;1&quot;)
Clas  : | Call: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, i3)
Clas  : | Fail: neutron:networks(a3, b3, c3, d3, e3, tenant_id3, f3, g3, h3, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, i3)
Clas  : | Redo: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;vm-demo&quot;, &quot;c5dd62237226c4f2eaddea823ca8b4f5c1a3c2d3a27e5e51e407954d&quot;, &quot;ACTIVE&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;cf23fabed97742a9af463002e68068bd&quot;, &quot;6183d5a6-e26c-4f48-af4d-5d0b6770a976&quot;, &quot;1&quot;)
Clas  : | Fail: nova:servers(&quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, x0, c2, d2, tenant_id2, f2, g2, h2)
Clas  : | Redo: neutron:ports(&quot;ebeb4ee6-14be-4ba2-a723-fd62f220b6b9&quot;, &quot;f999de49-753e-40c9-9eed-d01ad76bc6c3&quot;, &quot;ad058c04-05be-4f56-a76f-7f3b42f36f79&quot;, &quot;None&quot;, &quot;ACTIVE&quot;, &quot;&quot;, &quot;True&quot;, &quot;07ecce19-d7a4-4c79-924e-1692713e53a7&quot;, &quot;e793326db18847e1908e791daa69a5a3&quot;, &quot;None&quot;, &quot;compute:None&quot;, &quot;fa:16:3e:3c:0d:13&quot;, &quot;af179309-65f7-4662-a087-e583d6a8bc21&quot;, &quot;149f4271-41ca-4b1a-875b-77909debbeac&quot;, &quot;bc333f0f-b665-4e2b-97db-a4dd985cb5c8&quot;, &quot;None&quot;)
Clas  : | Fail: neutron:ports(a, b, c, d, e, f, g, network_id, tenant_id, j, k, l, m, n, device_id, p)
Clas  : Fail: error(x0)
</pre></div>
</div>
<p>Recall that there are 2 rules defining <em>error</em>.  The part of the trace
occurring before the line break is from one of the rules; the part of the trace
after the line break is from the other.  (The line break does not appear in
the trace&#8211;we inserted it for the sake of pedagogy.)</p>
<p>Both rules join the tables neutron:ports, nova:servers, and neutron:networks.  The
trace shows the join being computed one row at a time.  In this case,
we see that there is some port (from neutron:ports) connected to a VM
(from nova:servers) for which there is no record of the port&#8217;s network
(from neutron:networks).  In this case, there is a row missing from
neutron:networks: the one with ID 07ecce19-d7a4-4c79-924e-1692713e53a7.</p>
<p>At this point, it seems clear that the problem is with the Neutron datasource,
not the rules.</p>
</div>
<div class="section" id="datasource-troubleshooting">
<h2>Datasource troubleshooting<a class="headerlink" href="#datasource-troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>At this point, you believe the problem is with one of the datasources.  The first
thing to consider is whether Congress can properly connect to the associated cloud service.
The best way to do that is to examine the tables that the problematic datasource
is exporting.  If the tables being exported by a service is empty, the datasource
driver is not properly connecting to the datasource.</p>
<p><strong>Check</strong>: Ensure each (relevant) datasource is exporting the tables
the documentation says should be exported:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/data-sources/&lt;ds-id&gt;/tables
</pre></div>
</div>
<p>To fix connection problems, do both of the following.</p>
<blockquote>
<div><ul class="simple">
<li>Ensure the datasource component is enabled in devstack (if you&#8217;re using devstack)</li>
<li>Fix the configuration of the datasource by asking to see its current configuration,
and if it is wrong, delete that datasource and create a new one with the proper
configuration.  Don&#8217;t forget that datasources sometimes return different
information for different username/password combinations.</li>
</ul>
</div></blockquote>
<p>Below are examples of how to list datasource configuration, delete an existing datasource,
and create a new datasource:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># show list and configuration options for each
$ curl -X GET localhost:1789/v1/data-sources

# delete old datasource
$ curl -X DELETE http://127.0.0.1:1789/v1/data-sources/&lt;ds-id&gt;

# create new datasource
$ curl -X POST localhost:1789/v1/data-sources -d
 &#39;{&quot;config&quot;: {&quot;username&quot;: &quot;admin&quot;,
              &quot;tenant_name&quot;: &quot;admin&quot;,
              &quot;password&quot;: &quot;password&quot;,
              &quot;auth_url&quot;: &quot;http://127.0.0.1:5000/v2&quot;},
   &quot;driver&quot;: &quot;neutronv2&quot;,
   &quot;name&quot;: &quot;neutronv2&quot;}&#39;
</pre></div>
</div>
<p>For example, below we see that the <em>neutron</em> datasource is exporting all
the right tables:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/data-sources/&lt;neutron-id&gt;/tables
{
  &quot;results&quot;: [
    {
      &quot;id&quot;: &quot;ports.binding_capabilities&quot;
    },
    {
      &quot;id&quot;: &quot;routers&quot;
    },
    {
      &quot;id&quot;: &quot;ports.extra_dhcp_opts&quot;
    },
    {
      &quot;id&quot;: &quot;ports.fixed_ips&quot;
    },
    {
      &quot;id&quot;: &quot;ports&quot;
    },
    {
      &quot;id&quot;: &quot;ports.fixed_ips_groups&quot;
    },
    {
      &quot;id&quot;: &quot;ports.security_groups&quot;
    },
    {
      &quot;id&quot;: &quot;networks.subnets&quot;
    },
    {
      &quot;id&quot;: &quot;networks&quot;
    },
    {
      &quot;id&quot;: &quot;security_groups&quot;
    },
    {
      &quot;id&quot;: &quot;ports.address_pairs&quot;
    }
  ]
}
</pre></div>
</div>
<p>Once the datasource is properly configured and is returning the proper
list of tables, the next potential problem is that the rows of
one of the tables are incorrect.</p>
<p><strong>Check</strong>: Ensure the rows of each of the tables exported by the
datasource are correct:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/data-sources/&lt;ds-id&gt;/tables/&lt;table-name&gt;/rows
</pre></div>
</div>
<p>To check that the rows are correct, you&#8217;ll need to look at the datasource&#8217;s schema
to see what each column means and compare that to the
current contents of the actual datasource.</p>
<p>For example, we can look at the rows of the <em>networks</em> table in the <em>neutron</em>
service.  In this example, there are two rows.  Each row is the value of
the <em>data</em> key:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/data-sources/&lt;neutron-id&gt;/tables/networks/rows
{
  &quot;results&quot;: [
    {
      &quot;data&quot;: [
        &quot;ACTIVE&quot;,
        &quot;public&quot;,
        &quot;faf2c578-2893-11e4-b1e3-fa163ebf1676&quot;,
        &quot;None&quot;,
        &quot;True&quot;,
        &quot;d0a7ff9e5d5b4130a586a7af1c855c3e&quot;,
        &quot;None&quot;,
        &quot;True&quot;,
        &quot;False&quot;,
        &quot;0d31bf61-c749-4791-8cf2-345f624bad8d&quot;,
        &quot;None&quot;
      ]
    },
    {
      &quot;data&quot;: [
        &quot;ACTIVE&quot;,
        &quot;private&quot;,
        &quot;faf31ec4-2893-11e4-b1e3-fa163ebf1676&quot;,
        &quot;None&quot;,
        &quot;True&quot;,
        &quot;e793326db18847e1908e791daa69a5a3&quot;,
        &quot;None&quot;,
        &quot;False&quot;,
        &quot;False&quot;,
        &quot;37eee894-a65f-414d-bd8c-a9363293000a&quot;,
        &quot;None&quot;
      ]
    }
  ]
}
</pre></div>
</div>
<p>Compare these rows to the schema for this datasource:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ curl -X GET localhost:1789/v1/data-sources/&lt;neutron-id&gt;/schema

{&#39;tables&#39;: [
  ...
  {&#39;columns&#39;: [
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;status&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;name&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;subnet_group_id&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;provider_physical_network&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;admin_state_up&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;tenant_id&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;provider_network_type&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;router_external&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;shared&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;id&#39;},
    {&#39;description&#39;: &#39;None&#39;, &#39;name&#39;: &#39;provider_segmentation_id&#39;}],
   &#39;table_id&#39;: &#39;networks&#39;},
  ...]}
</pre></div>
</div>
<p>The schema says the 1st column is the network&#8217;s status, which in both the
rows above, has the value &#8220;ACTIVE&#8221;.
The schema says the 10th column is the network&#8217;s ID, which in the
two rows above are 0d31bf61-c749-4791-8cf2-345f624bad8d and
37eee894-a65f-414d-bd8c-a9363293000a.  Notice that the missing network
from our earlier analysis of the policy trace is missing from here as well:
07ecce19-d7a4-4c79-924e-1692713e53a7.</p>
<p>This points to a problem in the configuration of the datasource, in particular
using a username/password combination that does not return all the networks.</p>
</div>
<div class="section" id="message-bus-troubleshooting">
<h2>Message bus troubleshooting<a class="headerlink" href="#message-bus-troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>One thing that sometimes happens is that the datasource has the right rows,
but the policy engine does not.  For example, the <em>networks</em> table of the
<em>neutron</em> service is not identical to the <em>neutron:networks</em> table.
Typically, this means that the policy engine simply hasn&#8217;t received and
processed the update from the datasource on the message bus.  Waiting
several seconds should fix the problem.</p>
<p><strong>Check</strong>: Compare the policy engine&#8217;s version of a table to the datasource&#8217;s
version.  Remember that the policy engine&#8217;s name for table T in datasource
D is D:T, e.g. the <em>networks</em> table for service <em>neutron</em> is named <em>neutron:networks</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>curl -X GET localhost:1789/v1/policies/classification/tables/&lt;ds-name&gt;:&lt;table-name&gt;/rows
curl -X GET localhost:1789/v1/data-sources/&lt;ds-id&gt;/tables/&lt;table-name&gt;/rows
</pre></div>
</div>
<p><strong>Warning</strong>: In the current datasource drivers for Neutron and Nova, a
single API call can generate several different tables.  Each table is sent independently
on the message bus, which can lead to inconsistencies between tables (e.g.
table <em>neutron:ports</em> might be out of sync with <em>neutron:ports.security_groups</em>).
This kind of data skew is an artifact of our implementation and will be
addressed in a future release.  The best solution currently is to wait
until all the messages from the latest polling reach the policy engine.</p>
<p>A similar problem can arise when two datasources are out of sync with each other.
This happens because the two datasources are polled independently.  If something
changes one of the datasources in between when those datasources are polled,
the local cache Congress has will be out of sync.  In a future release, we
will provide machinery for mitigating the impact of these kinds of synchronization
problems.</p>
</div>
<div class="section" id="production-troubleshooting">
<h2>Production troubleshooting<a class="headerlink" href="#production-troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Another class of problems arises most often in production deployments.
Here we give a couple of problems encountered in production deployments
along with tips for solving them.</p>
<ol class="arabic simple">
<li>Log file too big</li>
</ol>
<p><strong>Symptom</strong>: slower than normal performance, log size not changing</p>
<dl class="docutils">
<dt><strong>Solution</strong>: set up logrotate (a Linux service).  In the directory</dt>
<dd><p class="first"><cite>/etc/logrotate.d</cite>, include a file <cite>congress</cite> and add an entry
such as the one shown below.  (Here we&#8217;re assuming the congress log
is in /var/log/congress):</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>/var/log/congress
{
  rotate 7
  daily
  missingok
  notifempty
  delaycompress
  compress
  endscript
}
</pre></div>
</div>
</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Troubleshooting</a><ul>
<li><a class="reference internal" href="#policy-engine-troubleshooting">Policy-engine troubleshooting</a></li>
<li><a class="reference internal" href="#datasource-troubleshooting">Datasource troubleshooting</a></li>
<li><a class="reference internal" href="#message-bus-troubleshooting">Message bus troubleshooting</a></li>
<li><a class="reference internal" href="#production-troubleshooting">Production troubleshooting</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="tutorial-tenant-sharing.html"
                                  title="previous chapter">Congress Tutorial - Tenant Sharing Policy</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="deployment.html"
                                  title="next chapter">Deployment</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/congress
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/troubleshooting.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="deployment.html" title="Deployment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial-tenant-sharing.html" title="Congress Tutorial - Tenant Sharing Policy"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">congress 5.0.0.0rc2.dev7 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/congress");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>