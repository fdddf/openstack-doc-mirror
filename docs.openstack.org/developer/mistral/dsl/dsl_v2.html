<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mistral DSL v2 specification &mdash; Mistral</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/toggle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.0.0.0rc2.dev22',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toggle.js"></script>
    <link rel="top" title="Mistral" href="../index.html" />
    <link rel="up" title="DSL Specification" href="index.html" />
    <link rel="next" title="Mistral Client Commands Guide" href="../guides/cli_guide.html" />
    <link rel="prev" title="DSL Specification" href="index.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mistral-dsl-v2-specification">
<h1>Mistral DSL v2 specification<a class="headerlink" href="#mistral-dsl-v2-specification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document fully describes Domain Specific Language (DSL) version 2
of Mistral Workflow Service. Since version 1 issued in May 2014 Mistral
team completely reworked the language pursuing the goal in mind to make
it easier to understand while more consistent and flexible.</p>
<p>Unlike Mistral DSLv1 DSL v2 assumes that all
entities that Mistral works with like workflows and actions are
completely independent in terms of how they&#8217;re referenced and accessed
through API (and also Python Client API and CLI). Workbook, the entity
that can combine workflows and actions still exists in the
language but only for namespacing and convenience purposes. See
<a class="reference external" href="#workbooks">Workbooks section</a> for more details.</p>
<p><strong>NOTE</strong>: DSL and API of version 1 has not been supported since April 2015 and
DSL and API of version 2 is now the only way to interact with Mistral
service.</p>
<p>Mistral DSL consists of the following main object(entity) types that
will be described in details below:</p>
<ul class="simple">
<li><a class="reference external" href="#workflows">Workflows</a></li>
<li><a class="reference external" href="#actions">Actions</a></li>
</ul>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Mistral DSL supports <a class="reference external" href="https://pypi.python.org/pypi/yaql/1.0.0">YAQL</a> and
<a class="reference external" href="http://jinja.pocoo.org/docs/dev/">Jinja2</a> expression languages to
reference workflow context variables and thereby implements passing data
between workflow tasks. It&#8217;s also referred to as Data Flow mechanism.
YAQL is a simple but powerful query language that allows to extract
needed information from JSON structured data. It is allowed to use YAQL
in the following sections of DSL:</p>
<ul class="simple">
<li>Workflow <a class="reference external" href="#common-workflow-attributes">&#8216;output&#8217; attribute</a></li>
<li>Workflow <a class="reference external" href="#common-workflow-attributes">&#8216;task-defaults&#8217; attribute</a></li>
<li><a class="reference external" href="#direct-workflow">Direct workflow</a> transitions</li>
<li>Task <a class="reference external" href="#common-task-attributes">&#8216;publish&#8217; attribute</a></li>
<li>Task <a class="reference external" href="#common-task-attributes">&#8216;input&#8217; attribute</a></li>
<li>Task <a class="reference external" href="#common-task-attributes">&#8216;with-items&#8217; attribute</a></li>
<li>Task <a class="reference external" href="#common-task-attributes">&#8216;target&#8217; attribute</a></li>
<li>Any attribute of <a class="reference external" href="#policies">task policies</a></li>
<li>Action <a class="reference external" href="#attributes">&#8216;base-input&#8217; attribute</a></li>
<li>Action <a class="reference external" href="#attributes">&#8216;output&#8217; attribute</a></li>
</ul>
<p>Mistral DSL is fully based on YAML and knowledge of YAML is a plus for
better understanding of the material in this specification. It also
takes advantage of supported query languages to define expressions in workflow
and action definitions.</p>
<ul class="simple">
<li>Yet Another Markup Language (YAML): <a class="reference external" href="http://yaml.org">http://yaml.org</a></li>
<li>Yet Another Query Language (YAQL): <a class="reference external" href="https://pypi.python.org/pypi/yaql/1.0.0">https://pypi.python.org/pypi/yaql/1.0.0</a></li>
<li>Jinja 2: <a class="reference external" href="http://jinja.pocoo.org/docs/dev/">http://jinja.pocoo.org/docs/dev/</a></li>
</ul>
</div>
<div class="section" id="workflows">
<h2>Workflows<a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h2>
<p>Workflow is the main building block of Mistral DSL, the reason why the
project exists. Workflow represents a process that can be described in a
various number of ways and that can do some job interesting to the end
user. Each workflow consists of tasks (at least one) describing what
exact steps should be made during workflow execution.</p>
<div class="section" id="yaml-example">
<h3>YAML example<a class="headerlink" href="#yaml-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">create_vm</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  description: Simple workflow example</span>
<span class="l l-Scalar l-Scalar-Plain">  type: direct</span>

  <span class="l l-Scalar l-Scalar-Plain">input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - vm_name</span>
<span class="l l-Scalar l-Scalar-Plain">    - image_ref</span>
<span class="l l-Scalar l-Scalar-Plain">    - flavor_ref</span>
<span class="l l-Scalar l-Scalar-Plain">  output</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    vm_id: &lt;% $.vm_id %&gt;</span>

  <span class="l l-Scalar l-Scalar-Plain">tasks</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    create_server</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      action: nova.servers_create name=&lt;% $.vm_name %&gt; image=&lt;% $.image_ref %&gt; flavor=&lt;% $.flavor_ref %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">      publish</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        vm_id: &lt;% task(create_server).result.id %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">      on-success</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        - wait_for_instance</span>

<span class="l l-Scalar l-Scalar-Plain">    wait_for_instance</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      action: nova.servers_find id=&lt;% $.vm_id %&gt; status=&#39;ACTIVE&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">      retry</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        delay: 5</span>
<span class="l l-Scalar l-Scalar-Plain">        count: 15</span>
</pre></div>
</div>
<p>This example workflow simply sends a command to OpenStack Compute
service Nova to start creating a virtual machine and wait till it&#8217;s
created using special &#8220;retry&#8221; policy.</p>
</div>
<div class="section" id="workflow-types">
<h3>Workflow types<a class="headerlink" href="#workflow-types" title="Permalink to this headline">¶</a></h3>
<p>Mistral DSL v2 introduces different workflow types and the structure of
each workflow type varies according to its semantics. Basically,
workflow type encapsulates workflow processing logic, a set of meta
rules defining how all workflows of this type should work. Currently,
Mistral provides two workflow types:</p>
<ul class="simple">
<li><a class="reference external" href="#direct-workflow">Direct workflow</a></li>
<li><a class="reference external" href="#reverse-workflow">Reverse workflow</a></li>
</ul>
<p>See corresponding sections for details.</p>
</div>
<div class="section" id="common-workflow-attributes">
<h3>Common workflow attributes<a class="headerlink" href="#common-workflow-attributes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>type</strong> - Workflow type. Either &#8216;direct&#8217; or &#8216;reverse&#8217;. <em>Optional</em>. &#8216;direct&#8217;
by default.</li>
<li><strong>description</strong> - Arbitrary text containing workflow description. <em>Optional</em>.</li>
<li><strong>input</strong> - List defining required input parameter names and
optionally their default values in a form &#8220;my_param: 123&#8221;. <em>Optional</em>.</li>
<li><strong>output</strong> - Any data structure arbitrarily containing
expressions that defines workflow output. May be nested. <em>Optional</em>.</li>
<li><strong>output-on-error</strong> - Any data structure arbitrarily containing YAQL
expressions that defines output of a workflow to be returned if it goes into
error state. May be nested. <em>Optional</em>.</li>
<li><strong>task-defaults</strong> - Default settings for some of task attributes
defined at workflow level. <em>Optional</em>. Corresponding attribute
defined for a specific task always takes precedence. Specific task
attributes that could be defined in <strong>task-defaults</strong> are the
following:<ul>
<li><strong>on-error</strong> - List of tasks which will run after the task has
completed with an error. For <a class="reference external" href="#direct-workflow">direct
workflow</a> only. <em>Optional</em>.</li>
<li><strong>on-success</strong> - List of tasks which will run after the task has
completed successfully. For <a class="reference external" href="#direct-workflow">direct workflow</a>
only. <em>Optional</em>.</li>
<li><strong>on-complete</strong> - List of tasks which will run after the task has
completed regardless of whether it is successful or not. For
<a class="reference external" href="#direct-workflow">direct workflow</a> only. <em>Optional</em>.</li>
<li><strong>requires</strong> - List of tasks that a task depends on. For <a class="reference external" href="#Reverse_Workflow">reverse
workflow</a> only. <em>Optional</em>.</li>
<li><strong>pause-before</strong> - Configures pause-before policy. <em>Optional</em>.</li>
<li><strong>wait-before</strong> - Configures wait-before policy. <em>Optional</em>.</li>
<li><strong>wait-after</strong> - Configures wait-after policy. <em>Optional</em>.</li>
<li><strong>timeout</strong> - Configures timeout policy. <em>Optional</em>.</li>
<li><strong>retry</strong> - Configures retry policy. <em>Optional</em>.</li>
<li><strong>concurrency</strong> - Configures concurrency policy. <em>Optional</em>.</li>
</ul>
</li>
<li><strong>tasks</strong> - Dictionary containing workflow tasks. See below for more
details. <em>Required</em>.</li>
</ul>
</div>
<div class="section" id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<p>Task is what a workflow consists of. It defines a specific computational
step in the workflow. Each task can optionally take input data and
produce output. In Mistral DSL v2 task can be associated with an action
or a workflow. In the example below there are two tasks of different
types:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">action_based_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: std.http url=&#39;openstack.org&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">workflow_based_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  workflow: backup_vm_workflow vm_id=&lt;% $.vm_id %&gt;</span>
</pre></div>
</div>
<p>Actions will be explained below in an individual paragraph but looking
ahead it&#8217;s worth saying that Mistral provides a lot of actions out of
the box (including actions for most of the core OpenStack services) and
it&#8217;s also easy to plug new actions into Mistral.</p>
<div class="section" id="common-task-attributes">
<h4>Common task attributes<a class="headerlink" href="#common-task-attributes" title="Permalink to this headline">¶</a></h4>
<p>All Mistral tasks regardless of workflow type have the following common
attributes:</p>
<ul>
<li><p class="first"><strong>description</strong> - Arbitrary text containing task description.
<em>Optional</em>.</p>
</li>
<li><p class="first"><strong>action</strong> - Name of the action associated with the task.
<em>Mutually exclusive with</em> <strong>workflow</strong>. If neither action nor workflow are
provided then the action &#8216;std.noop&#8217; will be used.</p>
</li>
<li><p class="first"><strong>workflow</strong> - Name of the workflow associated with the task.
<em>Mutually exclusive with</em> <strong>action</strong>.</p>
</li>
<li><p class="first"><strong>input</strong> - Actual input parameter values of the task. <em>Optional</em>.
Value of each parameter is a JSON-compliant type such as number,
string etc, dictionary or list. It can also be an expression to
retrieve value from task context or any of the mentioned types
containing inline expressions (for example, string &#8220;&lt;%
$.movie_name %&gt; is a cool movie!&#8221;)</p>
</li>
<li><p class="first"><strong>publish</strong> - Dictionary of variables to publish to the workflow
context. Any JSON-compatible data structure optionally containing
expression to select precisely what needs to be published.
Published variables will be accessible for downstream tasks via using
expressions. <em>Optional</em>.</p>
</li>
<li><dl class="first docutils">
<dt><strong>publish-on-error</strong> - Same as <strong>publish</strong> but evaluated in case of</dt>
<dd><p class="first last">task execution failures. <em>Optional</em></p>
</dd>
</dl>
</li>
<li><p class="first"><strong>with-items</strong> - If configured, it allows to run action or workflow
associated with a task multiple times on a provided list of items.
See <a class="reference external" href="#processing-collections">Processing collections using
&#8216;with-items&#8217;</a> for details. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>keep-result</strong> - Boolean value allowing to not store action results
after task completion (e.g. if they are large and not needed
afterwards). <em>Optional</em>. By default is &#8216;true&#8217;.</p>
</li>
<li><p class="first"><strong>target</strong> - String parameter. It defines an executor to which task
action should be sent to. Target here physically means a name of
executors group but task will be run only on one of them. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>pause-before</strong> - Configures pause-before policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>wait-before</strong> - Configures wait-before policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>wait-after</strong> - Configures wait-after policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>timeout</strong> - Configures timeout policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>retry</strong> - Configures retry policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>concurrency</strong> - Configures concurrency policy. <em>Optional</em>.</p>
</li>
<li><p class="first"><strong>safe-rerun</strong> - Boolean value allowing to rerun task if executor dies
during action execution. If set to &#8216;true&#8217; task may be run twice.
<em>Optional</em>. By default set to &#8216;false&#8217;.</p>
</li>
</ul>
</div>
<div class="section" id="policies">
<h4>Policies<a class="headerlink" href="#policies" title="Permalink to this headline">¶</a></h4>
<p>Any Mistral task regardless of its workflow type can optionally have
configured policies.</p>
<p>YAML example</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: my_action</span>
<span class="l l-Scalar l-Scalar-Plain">  pause-before: true</span>
<span class="l l-Scalar l-Scalar-Plain">  wait-before: 2</span>
<span class="l l-Scalar l-Scalar-Plain">  wait-after: 4</span>
<span class="l l-Scalar l-Scalar-Plain">  timeout: 30</span>
<span class="l l-Scalar l-Scalar-Plain">  retry</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    count: 10</span>
<span class="l l-Scalar l-Scalar-Plain">    delay: 20</span>
<span class="l l-Scalar l-Scalar-Plain">    break-on: &lt;% $.my_var = true %&gt;</span>
    <span class="l l-Scalar l-Scalar-Plain">continue-on</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;% $.my_var = false %&gt;</span>
</pre></div>
</div>
<p><strong>pause-before</strong></p>
<p>Defines whether Mistral Engine should put the workflow on hold or not
before starting a task.</p>
<p><strong>wait-before</strong></p>
<p>Defines a delay in seconds that Mistral Engine should wait before
starting a task.</p>
<p><strong>wait-after</strong></p>
<p>Defines a delay in seconds that Mistral Engine should wait after a task
has completed before starting next tasks defined in <em>on-success</em>,
<em>on-error</em> or <em>on-complete</em>.</p>
<p><strong>timeout</strong></p>
<p>Defines a period of time in seconds after which a task will be failed
automatically by engine if hasn&#8217;t completed.</p>
<p><strong>concurrency</strong></p>
<p>Defines a max number of actions running simultaneously in a task. <em>Applicable</em>
only for tasks that have <em>with-items</em>.</p>
<p><strong>retry</strong></p>
<p>Defines a pattern how task should be repeated in case of an error.</p>
<ul class="simple">
<li><strong>count</strong> - Defines a maximum number of times that a task can be
repeated.</li>
<li><strong>delay</strong> - Defines a delay in seconds between subsequent task
iterations.</li>
<li><strong>break-on</strong> - Defines an expression that will break iteration
loop if it evaluates to &#8216;true&#8217;. If it fires then the task is
considered error.</li>
<li><strong>continue-on</strong> - Defines an expression that will continue iteration
loop if it evaluates to &#8216;true&#8217;. If it fires then the task is
considered successful. If it evaluates to &#8216;false&#8217; then policy will break the
iteration.</li>
</ul>
<p>Retry policy can also be configured on a single line as:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">task1</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: my_action</span>
<span class="l l-Scalar l-Scalar-Plain">  retry: count=10 delay=5 break-on=&lt;% $.foo = &#39;bar&#39; %&gt;</span>
</pre></div>
</div>
<p>All parameter values for any policy can be defined as expressions.</p>
</div>
<div class="section" id="simplified-input-syntax">
<h4>Simplified input syntax<a class="headerlink" href="#simplified-input-syntax" title="Permalink to this headline">¶</a></h4>
<p>When describing a workflow task it&#8217;s possible to specify its input
parameters in two ways:</p>
<p>Full syntax:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: std.http</span>
<span class="l l-Scalar l-Scalar-Plain">  input</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">url: http://mywebsite.org</span>
<span class="l l-Scalar l-Scalar-Plain">    method: GET</span>
</pre></div>
</div>
<p>Simplified syntax:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: std.http url=&quot;http://mywebsite.org&quot; method=&quot;GET&quot;</span>
</pre></div>
</div>
<p>The same rules apply to tasks associated with workflows.</p>
<p>Full syntax:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  workflow: some_nested_workflow</span>
<span class="l l-Scalar l-Scalar-Plain">  input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    param1: val1</span>
<span class="l l-Scalar l-Scalar-Plain">    param2: val2</span>
</pre></div>
</div>
<p>Simplified syntax:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  workflow: some_nested_workflow param1=&#39;val1&#39; param2=&#39;val2&#39;</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: It&#8217;s also possible to merge these two approaches and specify a
part of parameters using simplified key-value pairs syntax and using
keyword <em>input</em>. In this case all the parameters will be effectively
merged. If the same parameter is specified in both ways then the one
under <em>input</em> keyword takes precedence.</p>
</div>
</div>
<div class="section" id="direct-workflow">
<h3>Direct workflow<a class="headerlink" href="#direct-workflow" title="Permalink to this headline">¶</a></h3>
<p>Direct workflow consists of tasks combined in a graph where every next
task starts after another one depending on produced result. So direct
workflow has a notion of transition. Direct workflow is considered to be
completed if there aren&#8217;t any transitions left that could be used to
jump to next tasks.</p>
<img alt="../_images/Mistral_direct_workflow.png" src="../_images/Mistral_direct_workflow.png" />
<p>Figure 1. Mistral Direct Workflow.</p>
<div class="section" id="id1">
<h4>YAML example<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">create_vm_and_send_email</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> type: direct</span>

 <span class="l l-Scalar l-Scalar-Plain"> input</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - vm_name</span>
 <span class="l l-Scalar l-Scalar-Plain">   - image_id</span>
 <span class="l l-Scalar l-Scalar-Plain">   - flavor_id</span>

 <span class="l l-Scalar l-Scalar-Plain"> output</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   result: &lt;% $.vm_id %&gt;</span>

 <span class="l l-Scalar l-Scalar-Plain"> tasks</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   create_vm</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.servers_create name=&lt;% $.vm_name %&gt; image=&lt;% $.image_id %&gt; flavor=&lt;% $.flavor_id %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     publish</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       vm_id: &lt;% task(create_vm).result.id %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     on-error</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       - send_error_email</span>
 <span class="l l-Scalar l-Scalar-Plain">     on-success</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       - send_success_email</span>

 <span class="l l-Scalar l-Scalar-Plain">   send_error_email</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: send_email to_addrs=[&#39;admin@mysite.org&#39;] body=&#39;Failed to create a VM&#39;</span>
 <span class="l l-Scalar l-Scalar-Plain">     on-complete</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       - fail</span>

 <span class="l l-Scalar l-Scalar-Plain">   send_success_email</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: send_email to_addrs=[&#39;admin@mysite.org&#39;] body=&#39;Vm is successfully created and its id &lt;% $.vm_id %&gt;&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="direct-workflow-task-attributes">
<h4>Direct workflow task attributes<a class="headerlink" href="#direct-workflow-task-attributes" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>on-success</strong> - List of tasks which will run after the task has
completed successfully. <em>Optional</em>.</li>
<li><strong>on-error</strong> - List of tasks which will run after the task has
completed with an error. <em>Optional</em>.</li>
<li><strong>on-complete</strong> - List of tasks which will run after the task has
completed regardless of whether it is successful or not. <em>Optional</em>.</li>
</ul>
</div>
<div class="section" id="transitions-with-yaql-expressions">
<h4>Transitions with YAQL expressions<a class="headerlink" href="#transitions-with-yaql-expressions" title="Permalink to this headline">¶</a></h4>
<p>Task transitions can be determined by success/error/completeness of the
previous tasks and also by additional guard expressions that can
access any data produced by upstream tasks. So in the example above task
&#8216;create_vm&#8217; could also have a YAQL expression on transition to task
&#8216;send_success_email&#8217; as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">create_vm</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain"> ...</span>
<span class="l l-Scalar l-Scalar-Plain"> on-success</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">   - send_success_email: &lt;% $.vm_id != null %&gt;</span>
</pre></div>
</div>
<p>And this would tell Mistral to run &#8216;send_success_email&#8217; task only if
&#8216;vm_id&#8217; variable published by task &#8216;create_vm&#8217; is not empty.
Expressions can also be applied to &#8216;on-error&#8217; and &#8216;on-complete&#8217;.</p>
</div>
<div class="section" id="fork">
<h4>Fork<a class="headerlink" href="#fork" title="Permalink to this headline">¶</a></h4>
<p>There are situations when we need to be able to run more than one task after
some task has completed.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">create_vm</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  ...</span>
<span class="l l-Scalar l-Scalar-Plain">  on-success</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - register_vm_in_load_balancer</span>
<span class="l l-Scalar l-Scalar-Plain">    - register_vm_in_dns</span>
</pre></div>
</div>
<p>In this case Mistral will run both &#8220;register_xxx&#8221; tasks simultaneously
and this will lead to multiple independent workflow routes being
processed in parallel.</p>
</div>
<div class="section" id="join">
<h4>Join<a class="headerlink" href="#join" title="Permalink to this headline">¶</a></h4>
<p>Join flow control allows to synchronize multiple parallel workflow
branches and aggregate their data.</p>
<p>Full Join (join: all)</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">register_vm_in_load_balancer</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  ...</span>
<span class="l l-Scalar l-Scalar-Plain">  on-success</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">register_vm_in_dns</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> ...</span>
 <span class="l l-Scalar l-Scalar-Plain"> on-success</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">try_to_do_something_without_registration</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> ...</span>
 <span class="l l-Scalar l-Scalar-Plain"> on-error</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">   - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">wait_for_all_registrations</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  join: all</span>
<span class="l l-Scalar l-Scalar-Plain">  action: send_email</span>
</pre></div>
</div>
<p>When a task has property &#8220;join&#8221; assigned with value &#8220;all&#8221; the task will
run only if all upstream tasks (ones that lead to this task) are
completed and corresponding conditions have triggered. Task A is
considered an upstream task of Task B if Task A has Task B mentioned in
any of its &#8220;on-success&#8221;, &#8220;on-error&#8221; and &#8220;on-complete&#8221; clauses regardless
of guard expressions.</p>
<p>Partial Join (join: 2)</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">register_vm_in_load_balancer</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> ...</span>
 <span class="l l-Scalar l-Scalar-Plain"> on-success</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">register_vm_in_dns</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> ...</span>
 <span class="l l-Scalar l-Scalar-Plain"> on-success</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">register_vm_in_zabbix</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  ...</span>
<span class="l l-Scalar l-Scalar-Plain">  on-success</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - wait_for_all_registrations</span>

<span class="l l-Scalar l-Scalar-Plain">wait_for_two_registrations</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  join: 2</span>
<span class="l l-Scalar l-Scalar-Plain">  action: send_email</span>
</pre></div>
</div>
<p>When a task has property &#8220;join&#8221; assigned with a numeric value then the
task will run once at least this number of upstream tasks are completed
and corresponding conditions have triggered. In the example above task
&#8220;wait_for_two_registrations&#8221; will run if two any of
&#8220;register_vm_xxx&#8221; tasks complete.</p>
<p>Discriminator (join: one)</p>
<p>Discriminator is a special case of Partial Join when &#8220;join&#8221; property has
value 1. It means Mistral will wait for any completed task.
In this case instead of 1 it is possible to specify special
string value &#8220;one&#8221; which is introduced for symmetry with &#8220;all&#8221;. However,
it&#8217;s up to the user whether to use &#8220;1&#8221; or &#8220;one&#8221;.</p>
</div>
</div>
<div class="section" id="reverse-workflow">
<h3>Reverse workflow<a class="headerlink" href="#reverse-workflow" title="Permalink to this headline">¶</a></h3>
<p>In reverse workflow all relationships in workflow task graph are
dependencies. In order to run this type of workflow we need to specify a
task that needs to be completed, it can be conventionally called &#8216;target
task&#8217;. When Mistral Engine starts a workflow it recursively identifies
all the dependencies that need to be completed first.</p>
<img alt="../_images/Mistral_reverse_workflow.png" src="../_images/Mistral_reverse_workflow.png" />
<p>Figure 2 explains how reverse workflow works. In the example, task
<strong>T1</strong> is chosen a target task. So when the workflow starts Mistral will
run only tasks <strong>T7</strong>, <strong>T8</strong>, <strong>T5</strong>, <strong>T6</strong>, <strong>T2</strong> and <strong>T1</strong> in the
specified order (starting from tasks that have no dependencies). Tasks
<strong>T3</strong> and <strong>T4</strong> won&#8217;t be a part of this workflow because there&#8217;s no
route in the directed graph from <strong>T1</strong> to <strong>T3</strong> or <strong>T4</strong>.</p>
<div class="section" id="id2">
<h4>YAML example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">create_vm_and_send_email</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> type: reverse</span>

 <span class="l l-Scalar l-Scalar-Plain"> input</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - vm_name</span>
 <span class="l l-Scalar l-Scalar-Plain">   - image_id</span>
 <span class="l l-Scalar l-Scalar-Plain">   - flavor_id</span>

 <span class="l l-Scalar l-Scalar-Plain"> output</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   result: &lt;% $.vm_id %&gt;</span>

 <span class="l l-Scalar l-Scalar-Plain"> tasks</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   create_vm</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.servers_create name=&lt;% $.vm_name %&gt; image=&lt;% $.image_id %&gt; flavor=&lt;% $.flavor_id %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     publish</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       vm_id: &lt;% task(create_vm).result.id %&gt;</span>

 <span class="l l-Scalar l-Scalar-Plain">   search_for_ip</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.floating_ips_findall instance_id=null</span>
 <span class="l l-Scalar l-Scalar-Plain">     publish</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       vm_ip: &lt;% task(search_for_ip).result[0].ip %&gt;</span>

 <span class="l l-Scalar l-Scalar-Plain">   associate_ip</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.servers_add_floating_ip server=&lt;% $.vm_id %&gt; address=&lt;% $.vm_ip %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     requires: [search_for_ip]</span>

 <span class="l l-Scalar l-Scalar-Plain">   send_email</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: send_email to=&#39;admin@mysite.org&#39; body=&#39;Vm is created and id &lt;% $.vm_id %&gt; and ip address &lt;% $.vm_ip %&gt;&#39;</span>
 <span class="l l-Scalar l-Scalar-Plain">     requires: [create_vm, associate_ip]</span>
</pre></div>
</div>
</div>
<div class="section" id="reverse-workflow-task-attributes">
<h4>Reverse workflow task attributes<a class="headerlink" href="#reverse-workflow-task-attributes" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>requires</strong> - List of tasks which should be executed before this
task. <em>Optional</em>.</li>
</ul>
</div>
</div>
<div class="section" id="processing-collections">
<h3>Processing collections<a class="headerlink" href="#processing-collections" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id3">
<h4>YAML example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">create_vms</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> description: Creating multiple virtual servers using &quot;with-items&quot;.</span>

 <span class="l l-Scalar l-Scalar-Plain"> input</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   - vm_names</span>
 <span class="l l-Scalar l-Scalar-Plain">   - image_ref</span>
 <span class="l l-Scalar l-Scalar-Plain">   - flavor_ref</span>

 <span class="l l-Scalar l-Scalar-Plain"> output</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   vm_ids: &lt;% $.vm_ids %&gt;</span>

 <span class="l l-Scalar l-Scalar-Plain"> tasks</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   create_servers</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     with-items: vm_name in &lt;% $.vm_names %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.servers_create name=&lt;% $.vm_name %&gt; image=&lt;% $.image_ref %&gt; flavor=&lt;% $.flavor_ref %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     publish</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       vm_ids: &lt;% task(create_servers).result.id %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     on-success</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       - wait_for_servers</span>

 <span class="l l-Scalar l-Scalar-Plain">   wait_for_servers</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     with-items: vm_id in &lt;% $.vm_ids %&gt;</span>
 <span class="l l-Scalar l-Scalar-Plain">     action: nova.servers_find id=&lt;% $.vm_id %&gt; status=&#39;ACTIVE&#39;</span>
 <span class="l l-Scalar l-Scalar-Plain">     retry</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       delay: 5</span>
 <span class="l l-Scalar l-Scalar-Plain">       count: &lt;% $.vm_names.len() * 10 %&gt;</span>
</pre></div>
</div>
<p>Workflow &#8220;create_vms&#8221; in this example creates as many virtual servers
as we provide in &#8220;vm_names&#8221; input parameter. E.g., if we specify
vm_names=[&#8220;vm1&#8221;, &#8220;vm2&#8221;] then it&#8217;ll create servers with these names
based on same image and flavor. It is possible because of using
&#8220;with-items&#8221; keyword that makes an action or a workflow associated with
a task run multiple times. Value of &#8220;with-items&#8221; task property contains
an expression in the form: in &lt;% YAQL_expression %&gt;.</p>
<p>The most common form is:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">with-items</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  - var1 in &lt;% YAQL_expression_1 %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">  - var2 in &lt;% YAQL_expression_2 %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">  ...</span>
<span class="l l-Scalar l-Scalar-Plain">  - varN in &lt;% YAQL_expression_N %&gt;</span>
</pre></div>
</div>
<p>where collections expressed as YAQL_expression_1, YAQL_expression_2,
YAQL_expression_N must have equal sizes. When a task gets started
Mistral will iterate over all collections in parallel, i.e. number of
iterations will be equal to length of any collections.</p>
<p>Note that in case of using &#8220;with-items&#8221; task result accessible in
workflow context as &lt;% task(task_name).result %&gt; will be a list containing results
of corresponding action/workflow calls. If at least one action/workflow
call has failed then the whole task will get into ERROR state. It&#8217;s also
possible to apply retry policy for tasks with &#8220;with-items&#8221; property. In
this case retry policy will be relaunching all action/workflow calls
according to &#8220;with-items&#8221; configuration. Other policies can also be used
the same way as with regular non &#8220;with-items&#8221; tasks.</p>
</div>
</div>
</div>
<div class="section" id="actions">
<span id="actions-dsl"></span><h2>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h2>
<p>Action defines what exactly needs to be done when task starts. Action is
similar to a regular function in general purpose programming language
like Python. It has a name and parameters. Mistral distinguishes &#8216;system
actions&#8217; and &#8216;Ad-hoc actions&#8217;.</p>
<div class="section" id="system-actions">
<h3>System actions<a class="headerlink" href="#system-actions" title="Permalink to this headline">¶</a></h3>
<p>System actions are provided by Mistral out of the box and can be used by
anyone. It is also possible to add system actions for specific Mistral
installation via a special plugin mechanism. Currently, built-in system
actions are:</p>
<div class="section" id="std-fail">
<h4>std.fail<a class="headerlink" href="#std-fail" title="Permalink to this headline">¶</a></h4>
<p>Fail the current workflow. This action can be used to manually set the workflow
state to error.</p>
<p>Example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">manual_fail</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">action</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">std.fail</span>
</pre></div>
</div>
</div>
<div class="section" id="std-http">
<h4>std.http<a class="headerlink" href="#std-http" title="Permalink to this headline">¶</a></h4>
<p>Sends an HTTP request.</p>
<p>Input parameters:</p>
<ul class="simple">
<li><strong>url</strong> - URL for the HTTP request. <em>Required</em>.</li>
<li><strong>method</strong> - method for the HTTP request. <em>Optional</em>. Default is
&#8216;GET&#8217;.</li>
<li><strong>params</strong> - Dictionary or bytes to be sent in the query string for
the HTTP request. <em>Optional</em>.</li>
<li><strong>body</strong> - Dictionary, bytes, or file-like object to send in the body
of the HTTP request. <em>Optional</em>.</li>
<li><strong>headers</strong> - Dictionary of HTTP Headers to send with the HTTP
request. <em>Optional</em>.</li>
<li><strong>cookies</strong> - Dictionary of HTTP Cookies to send with the HTTP
request. <em>Optional</em>.</li>
<li><strong>auth</strong> - Auth to enable Basic/Digest/Custom HTTP Auth. <em>Optional</em>.</li>
<li><strong>timeout</strong> - Float describing the timeout of the request in seconds.
<em>Optional</em>.</li>
<li><strong>allow_redirects</strong> - Boolean. Set to True if POST/PUT/DELETE
redirect following is allowed. <em>Optional</em>.</li>
<li><strong>proxies</strong> - Dictionary mapping protocol to the URL of the proxy.
<em>Optional</em>.</li>
</ul>
<p>Example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: std.http url=&#39;google.com&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="std-mistral-http">
<h4>std.mistral_http<a class="headerlink" href="#std-mistral-http" title="Permalink to this headline">¶</a></h4>
<p>This action works just like &#8216;std.http&#8217; with the only exception: when
sending a request it inserts the following HTTP headers:</p>
<ul class="simple">
<li><strong>Mistral-Workflow-Name</strong> - Name of the workflow that the current
action execution is associated with.</li>
<li><strong>Mistral-Execution-Id</strong> - Identifier of the workflow execution this
action is associated with.</li>
<li><strong>Mistral-Task-Id</strong> - Identifier of the task execution this action
execution is associated with.</li>
<li><strong>Mistral-Action-Execution-Id</strong> - Identifier of the current action
execution.</li>
</ul>
<p>Using this action makes it possible to do any work in asynchronous
manner triggered via HTTP protocol. That means that Mistral can send a
request using &#8216;std.mistral_http&#8217; and then any time later whatever
system that received this request can notify Mistral back (using its
public API) with the result of this action. Header
<strong>Mistral-Action-Execution-Id</strong> is required for this operation because
it is used a key to find corresponding action execution in Mistral
to attach the result to.</p>
</div>
<div class="section" id="std-email">
<h4>std.email<a class="headerlink" href="#std-email" title="Permalink to this headline">¶</a></h4>
<p>Sends an email message via SMTP protocol.</p>
<ul class="simple">
<li><strong>to_addrs</strong> - Comma separated list of recipients. <em>Required</em>.</li>
<li><strong>subject</strong> - Subject of the message. <em>Optional</em>.</li>
<li><strong>body</strong> - Text containing message body. <em>Optional</em>.</li>
<li><strong>from_addr</strong> - Sender email address. <em>Required</em>.</li>
<li><strong>smtp_server</strong> - SMTP server host name. <em>Required</em>.</li>
<li><strong>smtp_password</strong> - SMTP server password. <em>Required</em>.</li>
</ul>
<p>Example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">send_email_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  action: std.email</span>
<span class="l l-Scalar l-Scalar-Plain">  input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      to_addrs: [admin@mywebsite.org]</span>
<span class="l l-Scalar l-Scalar-Plain">      subject: Hello from Mistral :)</span>
<span class="l l-Scalar l-Scalar-Plain">      body: |</span>
<span class="l l-Scalar l-Scalar-Plain">        Cheers! (:_:)</span>
<span class="l l-Scalar l-Scalar-Plain">        -- Thanks, Mistral Team.</span>
<span class="l l-Scalar l-Scalar-Plain">      from_addr: mistral@openstack.org</span>
<span class="l l-Scalar l-Scalar-Plain">      smtp_server: smtp.google.com</span>
<span class="l l-Scalar l-Scalar-Plain">      smtp_password: SECRET</span>
</pre></div>
</div>
<p>The syntax of &#8216;std.emal&#8217; action is pretty verbose. However, it can be
significantly simplified using Ad-hoc actions. More about them
<a class="reference external" href="#ad-hoc-actions">below</a>.</p>
</div>
<div class="section" id="std-ssh">
<h4>std.ssh<a class="headerlink" href="#std-ssh" title="Permalink to this headline">¶</a></h4>
<p>Runs Secure Shell command.</p>
<p>Input parameters:</p>
<ul class="simple">
<li><strong>cmd</strong> - String containing a shell command that needs to be
executed. <em>Required</em>.</li>
<li><strong>host</strong> - Host name that the command needs to be executed on.
<em>Required</em>.</li>
<li><strong>username</strong> - User name to authenticate on the host. <em>Required</em>.</li>
<li><strong>password</strong> - User password to to authenticate on the host. <em>Optional</em>.</li>
<li><strong>private_key_filename</strong> - Private key file name which will be used for authentication on remote host.</li>
</ul>
<p>All private keys should be on executor host in <strong>&lt;home-user-directory&gt;/.ssh/</strong>.
<strong>&lt;home-user-directory&gt;</strong> should refer to user directory under which service is running. <em>Optional</em>.</p>
<p><strong>NOTE</strong>: Authentication using key pairs is supported, key should be
on Mistral Executor server machine.</p>
</div>
<div class="section" id="std-echo">
<h4>std.echo<a class="headerlink" href="#std-echo" title="Permalink to this headline">¶</a></h4>
<p>Simple action mostly needed for testing purposes that returns a
predefined result.</p>
<p>Input parameters:</p>
<ul class="simple">
<li><strong>output</strong> - Value of any type that needs to be returned as a result
of the action. <em>Required</em>.</li>
</ul>
</div>
<div class="section" id="std-javascript">
<h4>std.javascript<a class="headerlink" href="#std-javascript" title="Permalink to this headline">¶</a></h4>
<p>Evaluates given JavaScript code.</p>
<p>Input parameters:</p>
<ul class="simple">
<li><strong>script</strong> - The text of JavaScript snippet that needs to be
executed. <em>Required</em>.</li>
</ul>
<p><strong>To use std.javascript, it is needed to install a number of
dependencies and JS engine.</strong> Currently Mistral uses only V8 Engine and
its wrapper - PyV8. For installing it, do the next steps:</p>
<ol class="arabic">
<li><p class="first">Install required libraries - boost, g++, libtool, autoconf, subversion, libv8-legacy-dev: On Ubuntu:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ sudo apt-get install libboost-all-dev g++ libtool autoconf libv8-legacy-dev subversion make
</pre></div>
</div>
</li>
<li><p class="first">Checkout last version of PyV8:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ svn checkout http://pyv8.googlecode.com/svn/trunk/ pyv8
$ cd pyv8
</pre></div>
</div>
</li>
<li><p class="first">Build PyV8 - it will checkout last V8 trunk, build it, and then build PyV8:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ sudo python setup.py build
</pre></div>
</div>
</li>
<li><p class="first">Install PyV8:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ sudo python setup.py install
</pre></div>
</div>
</li>
</ol>
<p>Example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">generate_uuid</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  description: Generates a Universal Unique ID</span>

<span class="l l-Scalar l-Scalar-Plain">  type: direct</span>

<span class="l l-Scalar l-Scalar-Plain">  input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - radix: 16</span>

<span class="l l-Scalar l-Scalar-Plain">  output</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    uuid: &lt;% $.generated_uuid %&gt;</span>

<span class="l l-Scalar l-Scalar-Plain">  tasks</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    generate_uuid_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      action: std.javascript</span>
<span class="l l-Scalar l-Scalar-Plain">      input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        context: &lt;% $ %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">        script: |</span>
<span class="l l-Scalar l-Scalar-Plain">          return &#39;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#39;.replace(/[xy]/g, function(c) {</span>
<span class="l l-Scalar l-Scalar-Plain">                  var r = Math.random() * 16 | 0, v = c == &#39;x&#39; ? r</span> <span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">(r&amp;0x3|0x8);</span>
<span class="l l-Scalar l-Scalar-Plain">                  return v.toString($.radix);</span>
<span class="l l-Scalar l-Scalar-Plain">          });</span>
<span class="l l-Scalar l-Scalar-Plain">      publish</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        generated_uuid: &lt;% task(generate_uuid_task).result %&gt;</span>
</pre></div>
</div>
<p>Another example for getting the current date and time:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">get_date_workflow</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">  description: Get the current date</span>

<span class="l l-Scalar l-Scalar-Plain">  type: direct</span>

<span class="l l-Scalar l-Scalar-Plain">  output</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    current_date: &lt;% $.current_date %&gt;</span>

<span class="l l-Scalar l-Scalar-Plain">  tasks</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    get_date_task</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      action: std.javascript</span>
<span class="l l-Scalar l-Scalar-Plain">      input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        context: &lt;% $ %&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">        script: |</span>
<span class="l l-Scalar l-Scalar-Plain">          var date = new Date();</span>
<span class="l l-Scalar l-Scalar-Plain">          return date; # returns &quot;2015-07-12T10:32:12.460000&quot; or use date.toLocaleDateString() for &quot;Sunday, July 12, 2015&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">      publish</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        current_date: &lt;% task(get_date_task).result %&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ad-hoc-actions">
<h3>Ad-hoc actions<a class="headerlink" href="#ad-hoc-actions" title="Permalink to this headline">¶</a></h3>
<p>Ad-hoc action is a special type of action that can be created by user.
Ad-hoc action is always created as a wrapper around any other existing
system action and its main goal is to simplify using same actions many
times with similar pattern.</p>
<p><strong>NOTE</strong>: Nested ad-hoc actions currently are not supported (i.e. ad-hoc
action around another ad-hoc action).</p>
<div class="section" id="id4">
<h4>YAML example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">error_email</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    - execution_id</span>
  <span class="l l-Scalar l-Scalar-Plain">base: std.email</span>
  <span class="l l-Scalar l-Scalar-Plain">base-input</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    to_addrs: [&#39;admin@mywebsite.org&#39;]</span>
<span class="l l-Scalar l-Scalar-Plain">    subject: &#39;Something went wrong with your Mistral workflow :(&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">    body: |</span>
<span class="l l-Scalar l-Scalar-Plain">        Please take a look at Mistral Dashboard to find out what&#39;s wrong</span>
<span class="l l-Scalar l-Scalar-Plain">        with your workflow execution &lt;% $.execution_id %&gt;.</span>
<span class="l l-Scalar l-Scalar-Plain">        Everything&#39;s going to be alright!</span>
<span class="l l-Scalar l-Scalar-Plain">        -- Sincerely, Mistral Team.</span>
<span class="l l-Scalar l-Scalar-Plain">    from_addr: &#39;mistral@openstack.org&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">    smtp_server: &#39;smtp.google.com&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">    smtp_password: &#39;SECRET&#39;</span>
</pre></div>
</div>
<p>Once this action is uploaded to Mistral any workflow will be able to use
it as follows:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">my_workflow</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> tasks</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    ...</span>
<span class="l l-Scalar l-Scalar-Plain">    send_error_email</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      action: error_email execution_id=&lt;% execution().id %&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="attributes">
<h4>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><strong>base</strong> - Name of base action that this action is built on top of.
<em>Required</em>.</li>
<li><strong>base-input</strong> - Actual input parameters provided to base action.
Look at the example above. <em>Optional</em>.</li>
<li><strong>input</strong> - List of declared action parameters which should be
specified as corresponding task input. This attribute is optional and
used only for documenting purposes. Mistral now does not enforce
actual input parameters to exactly correspond to this list. Based
parameters will be calculated based on provided actual parameters
with using expressions so what&#8217;s used in expressions implicitly
define real input parameters. Dictionary of actual input parameters
(expression context) is referenced as &#8216;$.&#8217; in YAQL and as &#8216;_.&#8217; in Jinja.
Redundant parameters will be simply ignored.</li>
<li><strong>output</strong> - Any data structure defining how to calculate output of
this action based on output of base action. It can optionally have
expressions to access properties of base action output through expression
context.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="workbooks">
<h2>Workbooks<a class="headerlink" href="#workbooks" title="Permalink to this headline">¶</a></h2>
<p>As mentioned before, workbooks still exist in Mistral DSL version 2 but
purely for convenience. Using workbooks users can combine multiple
entities of any type (workflows, actions and triggers) into one document
and upload to Mistral service. When uploading a workbook Mistral will
parse it and save its workflows, actions and triggers as independent
objects which will be accessible via their own API endpoints
(/workflows, /actions and /triggers/). Once it&#8217;s done the workbook comes
out of the game. User can just start workflows and use references to
workflows/actions/triggers as if they were uploaded without workbook in
the first place. However, if we want to modify these individual objects
we can modify the same workbook definition and re-upload it to Mistral
(or, of course, we can do it independently).</p>
<div class="section" id="namespacing">
<h3>Namespacing<a class="headerlink" href="#namespacing" title="Permalink to this headline">¶</a></h3>
<p>One thing that&#8217;s worth noting is that when using a workbook Mistral uses
its name as a prefix for generating final names of workflows, actions
and triggers included into the workbook. To illustrate this principle
let&#8217;s take a look at the figure below.</p>
<img alt="../_images/Mistral_workbook_namespacing.png" src="../_images/Mistral_workbook_namespacing.png" />
<p>So after a workbook has been uploaded its workflows and actions become independent objects but with slightly different names.</p>
<div class="section" id="id5">
<h4>YAML example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="l l-Scalar l-Scalar-Plain">version: &#39;2.0&#39;</span>

<span class="l l-Scalar l-Scalar-Plain">name: my_workbook</span>

<span class="l l-Scalar l-Scalar-Plain">description: My set of workflows and ad-hoc actions</span>

<span class="l l-Scalar l-Scalar-Plain">workflows</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> local_workflow1</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   type: direct</span>

 <span class="l l-Scalar l-Scalar-Plain">   tasks</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     task1</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       action: local_action str1=&#39;Hi&#39; str2=&#39; Mistral!&#39;</span>
 <span class="l l-Scalar l-Scalar-Plain">       on-complete</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">         - task2</span>

   <span class="l l-Scalar l-Scalar-Plain">   task2</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">       action: global_action</span>
 <span class="l l-Scalar l-Scalar-Plain">       ...</span>

<span class="l l-Scalar l-Scalar-Plain">  local_workflow2</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">    type: reverse</span>

<span class="l l-Scalar l-Scalar-Plain">    tasks</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">      task1</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        workflow: local_workflow1</span>

<span class="l l-Scalar l-Scalar-Plain">      task2</span><span class="p p-Indicator">:</span>
<span class="l l-Scalar l-Scalar-Plain">        workflow: global_workflow param1=&#39;val1&#39; param2=&#39;val2&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">        requires: [task1]</span>
<span class="l l-Scalar l-Scalar-Plain">        ...</span>
<span class="l l-Scalar l-Scalar-Plain">actions</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain"> local_action</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">   input</span><span class="p p-Indicator">:</span>
 <span class="l l-Scalar l-Scalar-Plain">     - str1</span>
 <span class="l l-Scalar l-Scalar-Plain">     - str2</span>
 <span class="l l-Scalar l-Scalar-Plain">   base: std.echo output=&quot;&lt;% $.str1 %&gt;&lt;% $.str2 %&gt;&quot;</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Even though names of objects inside workbooks change upon
uploading Mistral allows referencing between those objects using local
names declared in the original workbook.</p>
</div>
</div>
<div class="section" id="id6">
<h3>Attributes<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>name</strong> - Workbook name. <em>Required</em>.</li>
<li><strong>description</strong> - Workbook description. <em>Optional</em>.</li>
<li><strong>tags</strong> - String with arbitrary comma-separated values.
<strong>Optional</strong>.</li>
<li><strong>workflows</strong> - Dictionary containing workflow definitions.
<em>Optional</em>.</li>
<li><strong>actions</strong> - Dictionary containing ad-hoc action definitions.
<em>Optional</em>.</li>
</ul>
</div>
</div>
<div class="section" id="predefined-values-functions-in-execution-data-context">
<h2>Predefined values/Functions in execution data context<a class="headerlink" href="#predefined-values-functions-in-execution-data-context" title="Permalink to this headline">¶</a></h2>
<p>Using expressions it is possible to use some predefined values in Mistral DSL.</p>
<ul class="simple">
<li><strong>OpenStack context</strong></li>
<li><strong>Task result</strong></li>
<li><strong>Execution info</strong></li>
<li><strong>Environment</strong></li>
</ul>
<div class="section" id="openstack-context">
<h3>OpenStack context<a class="headerlink" href="#openstack-context" title="Permalink to this headline">¶</a></h3>
<p>OpenStack context is available by <strong>$.openstack</strong>. It contains
<strong>auth_token,</strong> <strong>project_id</strong>, <strong>user_id</strong>, <strong>service_catalog</strong>,
<strong>user_name</strong>, <strong>project_name</strong>, <strong>roles</strong>, <strong>is_admin</strong> properties.</p>
</div>
<div class="section" id="task-result">
<h3>Task result<a class="headerlink" href="#task-result" title="Permalink to this headline">¶</a></h3>
<p>Task result is available by <strong>task(&lt;task_name&gt;).result</strong>. It contains task result
and directly depends on action output structure. Note that the <em>task(&lt;task_name&gt;)</em>
function itself returns more than only task result. It returns the following
fields of task executions:</p>
<ul class="simple">
<li><strong>id</strong> - task execution UUID.</li>
<li><strong>name</strong> - task execution name.</li>
<li><strong>spec</strong> - task execution spec dict (loaded from DSL).</li>
<li><strong>state</strong> - task execution state.</li>
<li><strong>state_info</strong> - task execution state info.</li>
<li><strong>result</strong> - task execution result.</li>
<li><strong>published</strong> - task execution published variables.</li>
</ul>
</div>
<div class="section" id="execution-info">
<h3>Execution info<a class="headerlink" href="#execution-info" title="Permalink to this headline">¶</a></h3>
<p>Execution info is available by <strong>execution()</strong>. It contains
information about execution itself such as <strong>id</strong>, <strong>wf_spec</strong>,
<strong>input</strong> and <strong>start_params</strong>.</p>
</div>
<div class="section" id="environment">
<h3>Environment<a class="headerlink" href="#environment" title="Permalink to this headline">¶</a></h3>
<p>Environment info is available by <strong>env()</strong>. It is passed when user submit workflow execution.
It contains variables specified by user.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Mistral DSL v2 specification</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#workflows">Workflows</a><ul>
<li><a class="reference internal" href="#yaml-example">YAML example</a></li>
<li><a class="reference internal" href="#workflow-types">Workflow types</a></li>
<li><a class="reference internal" href="#common-workflow-attributes">Common workflow attributes</a></li>
<li><a class="reference internal" href="#tasks">Tasks</a><ul>
<li><a class="reference internal" href="#common-task-attributes">Common task attributes</a></li>
<li><a class="reference internal" href="#policies">Policies</a></li>
<li><a class="reference internal" href="#simplified-input-syntax">Simplified input syntax</a></li>
</ul>
</li>
<li><a class="reference internal" href="#direct-workflow">Direct workflow</a><ul>
<li><a class="reference internal" href="#id1">YAML example</a></li>
<li><a class="reference internal" href="#direct-workflow-task-attributes">Direct workflow task attributes</a></li>
<li><a class="reference internal" href="#transitions-with-yaql-expressions">Transitions with YAQL expressions</a></li>
<li><a class="reference internal" href="#fork">Fork</a></li>
<li><a class="reference internal" href="#join">Join</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-workflow">Reverse workflow</a><ul>
<li><a class="reference internal" href="#id2">YAML example</a></li>
<li><a class="reference internal" href="#reverse-workflow-task-attributes">Reverse workflow task attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#processing-collections">Processing collections</a><ul>
<li><a class="reference internal" href="#id3">YAML example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#actions">Actions</a><ul>
<li><a class="reference internal" href="#system-actions">System actions</a><ul>
<li><a class="reference internal" href="#std-fail">std.fail</a></li>
<li><a class="reference internal" href="#std-http">std.http</a></li>
<li><a class="reference internal" href="#std-mistral-http">std.mistral_http</a></li>
<li><a class="reference internal" href="#std-email">std.email</a></li>
<li><a class="reference internal" href="#std-ssh">std.ssh</a></li>
<li><a class="reference internal" href="#std-echo">std.echo</a></li>
<li><a class="reference internal" href="#std-javascript">std.javascript</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ad-hoc-actions">Ad-hoc actions</a><ul>
<li><a class="reference internal" href="#id4">YAML example</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#workbooks">Workbooks</a><ul>
<li><a class="reference internal" href="#namespacing">Namespacing</a><ul>
<li><a class="reference internal" href="#id5">YAML example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6">Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#predefined-values-functions-in-execution-data-context">Predefined values/Functions in execution data context</a><ul>
<li><a class="reference internal" href="#openstack-context">OpenStack context</a></li>
<li><a class="reference internal" href="#task-result">Task result</a></li>
<li><a class="reference internal" href="#execution-info">Execution info</a></li>
<li><a class="reference internal" href="#environment">Environment</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">DSL Specification</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../guides/cli_guide.html"
                                  title="next chapter">Mistral Client Commands Guide</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/mistral
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/dsl/dsl_v2.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../guides/cli_guide.html" title="Mistral Client Commands Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="DSL Specification"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Mistral</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">DSL Specification</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Mistral Contributors.
      Last updated on &#39;Tue Feb 14 13:51:17 2017, commit 83d638a&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/mistral");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>