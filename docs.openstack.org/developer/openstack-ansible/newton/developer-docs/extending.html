<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Extending OpenStack-Ansible</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.min.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/videos/summits">Summit Videos</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
    <h2>Extending OpenStack-Ansible</h2>
  </div>
  <div class="docs-actions">
    
    <a href="playbooks.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Playbooks"></i></a>
    
    
    <a href="ops.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Operations"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:56</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Extending OpenStack-Ansible</a><ul>
<li><a class="reference internal" href="#including-openstack-ansible-in-your-project">Including OpenStack-Ansible in your project</a></li>
<li><a class="reference internal" href="#ansible-cfg-files">ansible.cfg files</a></li>
<li><a class="reference internal" href="#env-d">env.d</a></li>
<li><a class="reference internal" href="#conf-d">conf.d</a></li>
<li><a class="reference internal" href="#user-yml-files">user_*.yml files</a><ul>
<li><a class="reference internal" href="#ordering-and-precedence">Ordering and Precedence</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-galaxy-roles">Adding Galaxy roles</a></li>
<li><a class="reference internal" href="#setting-overrides-in-configuration-files">Setting overrides in configuration files</a><ul>
<li><a class="reference internal" href="#build-the-environment-with-additional-python-packages">Build the environment with additional python packages</a></li>
<li><a class="reference internal" href="#module-documentation">Module documentation</a><ul>
<li><a class="reference internal" href="#example-task-using-the-config-template-module">Example task using the &#8220;config_template&#8221; module</a></li>
<li><a class="reference internal" href="#example-overrides-dictionary-hash">Example overrides dictionary(hash)</a></li>
<li><a class="reference internal" href="#original-template-file-test-ini-j2">Original template  file &#8220;test.ini.j2&#8221;</a></li>
<li><a class="reference internal" href="#rendered-on-disk-file-tmp-test-ini">Rendered on disk file &#8220;/tmp/test.ini&#8221;</a></li>
<li><a class="reference internal" href="#discovering-available-overrides">Discovering Available Overrides</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="extending-openstack-ansible">
<h1>Extending OpenStack-Ansible<a class="headerlink" href="#extending-openstack-ansible" title="Permalink to this headline">¶</a></h1>
<p>The OpenStack-Ansible project provides a basic OpenStack environment, but
many deployers will wish to extend the environment based on their needs. This
could include installing extra services, changing package versions, or
overriding existing variables.</p>
<p>Using these extension points, deployers can provide a more &#8216;opinionated&#8217;
installation of OpenStack that may include their own software.</p>
<div class="section" id="including-openstack-ansible-in-your-project">
<h2>Including OpenStack-Ansible in your project<a class="headerlink" href="#including-openstack-ansible-in-your-project" title="Permalink to this headline">¶</a></h2>
<p>Including the openstack-ansible repository within another project can be
done in several ways.</p>
<blockquote>
<div><ol class="arabic simple">
<li>A git submodule pointed to a released tag.</li>
<li>A script to automatically perform a git checkout of
openstack-ansible</li>
</ol>
</div></blockquote>
<p>When including OpenStack-Ansible in a project, consider using a parallel
directory structure as shown in the <a class="reference internal" href="#ansible-cfg-files">ansible.cfg files</a> section.</p>
<p>Also note that copying files into directories such as <a class="reference internal" href="#env-d">env.d</a> or
<a class="reference internal" href="#conf-d">conf.d</a> should be handled via some sort of script within the extension
project.</p>
</div>
<div class="section" id="ansible-cfg-files">
<h2>ansible.cfg files<a class="headerlink" href="#ansible-cfg-files" title="Permalink to this headline">¶</a></h2>
<p>You can create your own playbook, variable, and role structure while still
including the OpenStack-Ansible roles and libraries by putting an
<tt class="docutils literal"><span class="pre">ansible.cfg</span></tt> file in your <tt class="docutils literal"><span class="pre">playbooks</span></tt> directory.</p>
<p>The relevant options for Ansible 1.9 (included in OpenStack-Ansible)
are as follows:</p>
<blockquote>
<div><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">library</span></tt></dt>
<dd>This variable should point to
<tt class="docutils literal"><span class="pre">openstack-ansible/playbooks/library</span></tt>. Doing so allows roles and
playbooks to access OpenStack-Ansible&#8217;s included Ansible modules.</dd>
<dt><tt class="docutils literal"><span class="pre">roles_path</span></tt></dt>
<dd>This variable should point to
<tt class="docutils literal"><span class="pre">openstack-ansible/playbooks/roles</span></tt>. This allows Ansible to
properly look up any OpenStack-Ansible roles that extension roles
may reference.</dd>
<dt><tt class="docutils literal"><span class="pre">inventory</span></tt></dt>
<dd>This variable should point to
<tt class="docutils literal"><span class="pre">openstack-ansible/playbooks/inventory</span></tt>. With this setting,
extensions have access to the same dynamic inventory that
OpenStack-Ansible uses.</dd>
</dl>
</div></blockquote>
<p>Note that the paths to the <tt class="docutils literal"><span class="pre">openstack-ansible</span></tt> top level directory can be
relative in this file.</p>
<p>Consider this directory structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>my_project
|
|- custom_stuff
|  |
|  |- playbooks
|- openstack-ansible
|  |
|  |- playbooks
</pre></div>
</div>
<p>The variables in <tt class="docutils literal"><span class="pre">my_project/custom_stuff/playbooks/ansible.cfg</span></tt> would use
<tt class="docutils literal"><span class="pre">../openstack-ansible/playbooks/&lt;directory&gt;</span></tt>.</p>
</div>
<div class="section" id="env-d">
<h2>env.d<a class="headerlink" href="#env-d" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">/etc/openstack_deploy/env.d</span></tt> directory sources all YAML files into the
deployed environment, allowing a deployer to define additional group mappings.</p>
<p>This directory is used to extend the environment skeleton, or modify the
defaults defined in the <tt class="docutils literal"><span class="pre">playbooks/inventory/env.d</span></tt> directory.</p>
<p>See also <a class="reference external" href="http://docs.openstack.org/project-deploy-guide/openstack-ansible/newton/app-custom-layouts.html#understanding-container-groups">Understanding Container Groups</a> in Appendix C.</p>
</div>
<div class="section" id="conf-d">
<h2>conf.d<a class="headerlink" href="#conf-d" title="Permalink to this headline">¶</a></h2>
<p>Common OpenStack services and their configuration are defined by
OpenStack-Ansible in the
<tt class="docutils literal"><span class="pre">/etc/openstack_deploy/openstack_user_config.yml</span></tt> settings file.</p>
<p>Additional services should be defined with a YAML file in
<tt class="docutils literal"><span class="pre">/etc/openstack_deploy/conf.d</span></tt>, in order to manage file size.</p>
<p>See also <a class="reference external" href="http://docs.openstack.org/project-deploy-guide/openstack-ansible/newton/app-custom-layouts.html#understanding-host-groups">Understanding Host Groups</a> in Appendix C.</p>
</div>
<div class="section" id="user-yml-files">
<h2>user_*.yml files<a class="headerlink" href="#user-yml-files" title="Permalink to this headline">¶</a></h2>
<p>Files in <tt class="docutils literal"><span class="pre">/etc/openstack_deploy</span></tt> beginning with <tt class="docutils literal"><span class="pre">user_</span></tt> will be
automatically sourced in any <tt class="docutils literal"><span class="pre">openstack-ansible</span></tt> command. Alternatively,
the files can be sourced with the <tt class="docutils literal"><span class="pre">-e</span></tt> parameter of the <tt class="docutils literal"><span class="pre">ansible-playbook</span></tt>
command.</p>
<p><tt class="docutils literal"><span class="pre">user_variables.yml</span></tt> and <tt class="docutils literal"><span class="pre">user_secrets.yml</span></tt> are used directly by
OpenStack-Ansible. Adding custom variables used by your own roles and
playbooks to these files is not recommended. Doing so will complicate your
upgrade path by making comparison of your existing files with later versions
of these files more arduous. Rather, recommended practice is to place your own
variables in files named following the <tt class="docutils literal"><span class="pre">user_*.yml</span></tt> pattern so they will be
sourced alongside those used exclusively by OpenStack-Ansible.</p>
<div class="section" id="ordering-and-precedence">
<h3>Ordering and Precedence<a class="headerlink" href="#ordering-and-precedence" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">user_*.yml</span></tt> variables are just YAML variable files. They will be sourced
in alphanumeric order by <tt class="docutils literal"><span class="pre">openstack-ansible</span></tt>.</p>
</div>
</div>
<div class="section" id="adding-galaxy-roles">
<span id="id1"></span><h2>Adding Galaxy roles<a class="headerlink" href="#adding-galaxy-roles" title="Permalink to this headline">¶</a></h2>
<p>Any roles defined in <tt class="docutils literal"><span class="pre">openstack-ansible/ansible-role-requirements.yml</span></tt>
will be installed by the
<tt class="docutils literal"><span class="pre">openstack-ansible/scripts/bootstrap-ansible.sh</span></tt> script.</p>
</div>
<div class="section" id="setting-overrides-in-configuration-files">
<h2>Setting overrides in configuration files<a class="headerlink" href="#setting-overrides-in-configuration-files" title="Permalink to this headline">¶</a></h2>
<p>All of the services that use YAML, JSON, or INI for configuration can receive
overrides through the use of a Ansible action plugin named <tt class="docutils literal"><span class="pre">config_template</span></tt>.
The configuration template engine allows a deployer to use a simple dictionary
to modify or add items into configuration files at run time that may not have a
preset template option. All OpenStack-Ansible roles allow for this
functionality where applicable. Files available to receive overrides can be
seen in the <tt class="docutils literal"><span class="pre">defaults/main.yml</span></tt> file as standard empty dictionaries (hashes).</p>
<p>Practical guidance for using this feature is available in the <a class="reference external" href="http://docs.openstack.org/project-deploy-guide/openstack-ansible/newton/app-advanced-config-override.html">Install Guide</a>.</p>
<p>This module has been <a class="reference external" href="https://github.com/ansible/ansible/pull/12555">submitted for consideration</a> into Ansible Core.</p>
<div class="section" id="build-the-environment-with-additional-python-packages">
<h3>Build the environment with additional python packages<a class="headerlink" href="#build-the-environment-with-additional-python-packages" title="Permalink to this headline">¶</a></h3>
<p>The system will allow you to install and build any package that is a python
installable. The repository infrastructure will look for and create any
git based or PyPi installable package. When the package is built the repo-build
role will create the sources as Python wheels to extend the base system and
requirements.</p>
<p>While the packages pre-built in the repository-infrastructure are
comprehensive, it may be needed to change the source locations and versions of
packages to suit different deployment needs. Adding additional repositories as
overrides is as simple as listing entries within the variable file of your
choice. Any <tt class="docutils literal"><span class="pre">user_.*.yml</span></tt> file within the &#8220;/etc/openstack_deployment&#8221;
directory will work to facilitate the addition of a new packages.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">swift_git_repo</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://private-git.example.org/example-org/swift</span>
<span class="l l-Scalar l-Scalar-Plain">swift_git_install_branch</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">master</span>
</pre></div>
</div>
<p>Additional lists of python packages can also be overridden using a
<tt class="docutils literal"><span class="pre">user_.*.yml</span></tt> variable file.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">swift_requires_pip_packages</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">virtualenv</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">virtualenv-tools</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python-keystoneclient</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">NEW-SPECIAL-PACKAGE</span>
</pre></div>
</div>
<p>Once the variables are set call the play <tt class="docutils literal"><span class="pre">repo-build.yml</span></tt> to build all of the
wheels within the repository infrastructure. When ready run the target plays to
deploy your overridden source code.</p>
</div>
<div class="section" id="module-documentation">
<h3>Module documentation<a class="headerlink" href="#module-documentation" title="Permalink to this headline">¶</a></h3>
<p>These are the options available as found within the virtual module
documentation section.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">module</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">config_template</span>
<span class="l l-Scalar l-Scalar-Plain">version_added</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1.9.2</span>
<span class="l l-Scalar l-Scalar-Plain">short_description</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">&gt;</span>
  <span class="no">Renders template files providing a create/update override interface</span>
<span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The module contains the template functionality with the ability to</span>
    <span class="l l-Scalar l-Scalar-Plain">override items in config, in transit, through the use of a simple</span>
    <span class="l l-Scalar l-Scalar-Plain">dictionary without having to write out various temp files on target</span>
    <span class="l l-Scalar l-Scalar-Plain">machines. The module renders all of the potential jinja a user could</span>
    <span class="l l-Scalar l-Scalar-Plain">provide in both the template file and in the override dictionary which</span>
    <span class="l l-Scalar l-Scalar-Plain">is ideal for deployers who may have lots of different configs using a</span>
    <span class="l l-Scalar l-Scalar-Plain">similar code base.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">The module is an extension of the **copy** module and all of attributes</span>
    <span class="l l-Scalar l-Scalar-Plain">that can be set there are available to be set here.</span>
<span class="l l-Scalar l-Scalar-Plain">options</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">src</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Path of a Jinja2 formatted template on the local server. This can</span>
        <span class="l l-Scalar l-Scalar-Plain">be a relative or absolute path.</span>
    <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
  <span class="l l-Scalar l-Scalar-Plain">dest</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Location to render the template to on the remote machine.</span>
    <span class="l l-Scalar l-Scalar-Plain">required</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
    <span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
  <span class="l l-Scalar l-Scalar-Plain">config_overrides</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A dictionary used to update or override items within a configuration</span>
        <span class="l l-Scalar l-Scalar-Plain">template. The dictionary data structure may be nested. If the target</span>
        <span class="l l-Scalar l-Scalar-Plain">config file is an ini file the nested keys in the ``config_overrides``</span>
        <span class="l l-Scalar l-Scalar-Plain">will be used as section headers.</span>
  <span class="l l-Scalar l-Scalar-Plain">config_type</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">A string value describing the target config type.</span>
    <span class="l l-Scalar l-Scalar-Plain">choices</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">ini</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">json</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">yaml</span>
</pre></div>
</div>
<div class="section" id="example-task-using-the-config-template-module">
<h4>Example task using the &#8220;config_template&#8221; module<a class="headerlink" href="#example-task-using-the-config-template-module" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Run config template ini</span>
  <span class="l l-Scalar l-Scalar-Plain">config_template</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">src</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">test.ini.j2</span>
    <span class="l l-Scalar l-Scalar-Plain">dest</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/tmp/test.ini</span>
    <span class="l l-Scalar l-Scalar-Plain">config_overrides</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{{</span> <span class="nv">test_overrides</span> <span class="p p-Indicator">}}</span>
    <span class="l l-Scalar l-Scalar-Plain">config_type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ini</span>
</pre></div>
</div>
</div>
<div class="section" id="example-overrides-dictionary-hash">
<h4>Example overrides dictionary(hash)<a class="headerlink" href="#example-overrides-dictionary-hash" title="Permalink to this headline">¶</a></h4>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">test_overrides</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">DEFAULT</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">new_item</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">12345</span>
</pre></div>
</div>
</div>
<div class="section" id="original-template-file-test-ini-j2">
<h4>Original template  file &#8220;test.ini.j2&#8221;<a class="headerlink" href="#original-template-file-test-ini-j2" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">value1</span> <span class="o">=</span> <span class="s">abc</span>
<span class="na">value2</span> <span class="o">=</span> <span class="s">123</span>
</pre></div>
</div>
</div>
<div class="section" id="rendered-on-disk-file-tmp-test-ini">
<h4>Rendered on disk file &#8220;/tmp/test.ini&#8221;<a class="headerlink" href="#rendered-on-disk-file-tmp-test-ini" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">value1</span> <span class="o">=</span> <span class="s">abc</span>
<span class="na">value2</span> <span class="o">=</span> <span class="s">123</span>
<span class="na">new_item</span> <span class="o">=</span> <span class="s">12345</span>
</pre></div>
</div>
<p>In this task the <tt class="docutils literal"><span class="pre">test.ini.j2</span></tt> file is a template which will be rendered and
written to disk at <tt class="docutils literal"><span class="pre">/tmp/test.ini</span></tt>. The <strong>config_overrides</strong> entry is a
dictionary(hash) which allows a deployer to set arbitrary data as overrides to
be written into the configuration file at run time. The <strong>config_type</strong> entry
specifies the type of configuration file the module will be interacting with;
available options are &#8220;yaml&#8221;, &#8220;json&#8221;, and &#8220;ini&#8221;.</p>
</div>
<div class="section" id="discovering-available-overrides">
<h4>Discovering Available Overrides<a class="headerlink" href="#discovering-available-overrides" title="Permalink to this headline">¶</a></h4>
<p>All of these options can be specified in any way that suits your deployment.
In terms of ease of use and flexibility it&#8217;s recommended that you define your
overrides in a user variable file such as
<tt class="docutils literal"><span class="pre">/etc/openstack_deploy/user_variables.yml</span></tt>.</p>
<p>The list of overrides available may be found by executing:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>find . -name <span class="s2">&quot;main.yml&quot;</span> -exec grep <span class="s1">&#39;_.*_overrides:&#39;</span> <span class="o">{}</span> <span class="se">\;</span> <span class="se">\</span>
    <span class="p">|</span> grep -v <span class="s2">&quot;^#&quot;</span> <span class="se">\</span>
    <span class="p">|</span> sort -u
</pre></div>
</div>
</div>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="playbooks.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Playbooks"></i></a>
          
          
            <a href="ops.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Operations"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:56</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../upgrade-guide/index.html">Upgrade Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="quickstart-aio.html">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation-hosts-limited-connectivity.html">Installation on hosts with limited connectivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts.html">Included Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks.html">Playbooks</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Extending OpenStack-Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="ops.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html">Contributor Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="bug-triage.html">OpenStack-Ansible Bug Triage</a></li>
<li class="toctree-l2"><a class="reference internal" href="core-reviewers.html">Core Reviewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="role-services.html">Roles and Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="inventory.html">OpenStack-Ansible Inventory</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.11.3.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.min.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "developer-docs/extending" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-ansible/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: da2a8c349892471b0c8ae109fd44b04fd7a28f43";
        var bugProject = "openstack-ansible";
        var bugTitle = "Documentation bug";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 14.0.8.dev20 on 2017-02-14 13:56";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>