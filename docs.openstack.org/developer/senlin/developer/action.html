<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Actions</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Actions</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="policy.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Policies"></i></a>
    
    
    <a href="receiver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Receiver"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Actions</a><ul>
<li><a class="reference internal" href="#action-properties">Action Properties</a><ul>
<li><a class="reference internal" href="#the-action-data-property">The Action Data Property</a></li>
</ul>
</li>
<li><a class="reference internal" href="#action-statuses">Action Statuses</a></li>
<li><a class="reference internal" href="#the-execute-method-and-return-values">The <code class="docutils literal"><span class="pre">execute()</span></code> Method and Return Values</a></li>
<li><a class="reference internal" href="#creating-an-action">Creating An Action</a></li>
<li><a class="reference internal" href="#listing-actions">Listing Actions</a></li>
<li><a class="reference internal" href="#getting-an-action">Getting An Action</a></li>
<li><a class="reference internal" href="#signaling-an-action">Signaling An Action</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="actions">
<h1>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h1>
<p>An action is an abstraction of some logic that can be executed by a worker
thread. Most of the operations supported by Senlin are executed asynchronously,
which means they are queued into database and then picked up by certain worker
thread for execution.</p>
<p>Currently, Senlin only supports builtin actions listed below. In future, we
may evolve to support user-defined actions (UDAs). A user-defined action may
carry a Shell script to be executed on a target Nova server, or a Heat
SoftwareConfig to be deployed on a stack, for example. The following builtin
actions are supported at the time of this design:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">CLUSTER_CREATE</span></code>: An action for creating a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_DELETE</span></code>: An action for deleting a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_UPDATE</span></code>: An action for updating a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_ADD_NODES</span></code>: An action for adding existing nodes to a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_DEL_NODES</span></code>: An action for removing nodes from a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_REPLACE_NODES</span></code>: An action for replacing nodes in a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_RESIZE</span></code>: An action for adjusting the size of a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_SCALE_IN</span></code>: An action to shrink the size of a cluster by removing
nodes from the cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_SCALE_OUT</span></code>: An action to extend the size of a cluster by creating
new nodes using the <code class="docutils literal"><span class="pre">profile_id</span></code> of the cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_ATTACH_POLICY</span></code>: An action to attach a policy to a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_DETACH_POLICY</span></code>: An action to detach a policy from a cluster;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_UPDATE_POLICY</span></code>: An action to update the properties of a binding
between a cluster and a policy;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_CHECK</span></code>: An action for checking a cluster and execute <code class="docutils literal"><span class="pre">NODE_CHECK</span></code>
for all its nodes;</li>
<li><code class="docutils literal"><span class="pre">CLUSTER_RECOVER</span></code>: An action for recovering a cluster and execute
<code class="docutils literal"><span class="pre">NODE_RECOVER</span></code> for all the nodes in &#8216;ERROR&#8217; status;</li>
<li><code class="docutils literal"><span class="pre">NODE_CREATE</span></code>: An action for creating a new node;</li>
<li><code class="docutils literal"><span class="pre">NODE_DELETE</span></code>: An action for deleting an existing node;</li>
<li><code class="docutils literal"><span class="pre">NODE_UPDATE</span></code>: An action for updating the properties of an existing node;</li>
<li><code class="docutils literal"><span class="pre">NODE_JOIN</span></code>: An action for joining a node to an existing cluster;</li>
<li><code class="docutils literal"><span class="pre">NODE_LEAVE</span></code>: An action for a node to leave its current owning cluster;</li>
<li><code class="docutils literal"><span class="pre">NODE_CHECK</span></code>: An action for checking a node to see if its physical node is
&#8216;ACTIVE&#8217; and update its status with &#8216;ERROR&#8217; if not;</li>
<li><code class="docutils literal"><span class="pre">NODE_RECOVER</span></code>: An action for recovering a node;</li>
</ul>
<div class="section" id="action-properties">
<h2>Action Properties<a class="headerlink" href="#action-properties" title="Permalink to this headline">¶</a></h2>
<p>An action has the following properties when created:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">id</span></code>: a globally unique ID for the action object;</li>
<li><code class="docutils literal"><span class="pre">name</span></code>: a string representation of the action name which might be
generated automatically for actions derived from other operations;</li>
<li><code class="docutils literal"><span class="pre">context</span></code>: a dictionary that contains the calling context that will be
used by the engine when executing the action. Contents in this dictionary
may contain sensitive information such as user credentials.</li>
<li><code class="docutils literal"><span class="pre">action</span></code>: a text property that contains the action body to be executed.
Currently, this property only contains the name of a builtin action. In
future, we will provide a structured definition of action for UDAs.</li>
<li><code class="docutils literal"><span class="pre">target</span></code>: the UUID of an object (e.g. a cluster, a node or a policy) to
be operated;</li>
<li><code class="docutils literal"><span class="pre">cause</span></code>: a string indicating the reason why this action was created. The
purpose of this property is for the engine to check whether a new lock should
be acquired before operating an object. Valid values for this property
include:<ul>
<li><code class="docutils literal"><span class="pre">RPC</span> <span class="pre">Request</span></code>: this indicates that the action was created upon receiving
a RPC request from Senlin API, which means a lock is likely needed;</li>
<li><code class="docutils literal"><span class="pre">Derived</span> <span class="pre">Action</span></code>: this indicates that the action was created internally
as part of the execution path of another action, which means a lock might
have been acquired;</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">owner</span></code>: the UUID of a worker thread that currently &#8220;owns&#8221; this action and
is responsible for executing it.</li>
<li><code class="docutils literal"><span class="pre">interval</span></code>: the interval (in seconds) for repetitive actions, a value of 0
means that the action won&#8217;t be repeated;</li>
<li><code class="docutils literal"><span class="pre">start_time</span></code>: timestamp when the action was last started. This field is
provided for action execution timeout detection;</li>
<li><code class="docutils literal"><span class="pre">stop_time</span></code>: timestamp when the action was stopped. This field is provided
for measuring the execution time of an action;</li>
<li><code class="docutils literal"><span class="pre">timeout</span></code>: timeout (in seconds) for the action execution. A value of 0
means that the action does not have a customized timeout constraint, though
it may still have to honor the system wide <code class="docutils literal"><span class="pre">default_action_timeout</span></code>
setting.</li>
<li><code class="docutils literal"><span class="pre">status</span></code>: a string representation of the current status of the action. See
subsection below for detailed status definitions.</li>
<li><code class="docutils literal"><span class="pre">status_reason</span></code>: a string describing the reason that has led the action to
its current status.</li>
<li><code class="docutils literal"><span class="pre">control</span></code>: a string for holding the pending signals such as <code class="docutils literal"><span class="pre">CANCEL</span></code>,
<code class="docutils literal"><span class="pre">SUSPEND</span></code> or <code class="docutils literal"><span class="pre">RESUME</span></code>.</li>
<li><code class="docutils literal"><span class="pre">inputs</span></code>: a dictionary that provides inputs to the action when executed;</li>
<li><code class="docutils literal"><span class="pre">outputs</span></code>: a dictionary that captures the outputs (including error
messages) from the action execution;</li>
<li><code class="docutils literal"><span class="pre">depends_on</span></code>: a UUID list for the actions that must be successfully
completed before the current action becomes <code class="docutils literal"><span class="pre">READY</span></code>. An action cannot
become <code class="docutils literal"><span class="pre">READY</span></code> when this property is not an empty string.</li>
<li><code class="docutils literal"><span class="pre">depended_by</span></code>: a UUID list for the actions that depends on the successful
completion of current action. When the current action is completed with a
success, the actions listed in this property will get notified.</li>
<li><code class="docutils literal"><span class="pre">created_at</span></code>: the timestamp when the action was created;</li>
<li><code class="docutils literal"><span class="pre">updated_at</span></code>: the timestamp when the action was last updated;</li>
</ul>
<p><em>TODO</em>: Add support for scheduled action execution.</p>
<p><em>NOTE</em>: The default value of the <code class="docutils literal"><span class="pre">default_action_timeout</span></code> is 3600 seconds.</p>
<div class="section" id="the-action-data-property">
<h3>The Action Data Property<a class="headerlink" href="#the-action-data-property" title="Permalink to this headline">¶</a></h3>
<p>An action object has a property named <code class="docutils literal"><span class="pre">data</span></code> which is used for saving policy
decisions. This property is a Python dict for different policies to save and
exchange policy decision data.</p>
<p>Suppose we have a scaling policy, a deletion policy and a load-balancing
policy attached to the same cluster. By design, when an <code class="docutils literal"><span class="pre">CLUSTER_SCALE_IN</span></code>
action is picked up for execution, the following sequence will happen:</p>
<ol class="arabic simple">
<li>When the action is about to be executed, the worker thread checks all
policies that have registered a &#8220;pre_op&#8221; on this action type.</li>
<li>Based on the built-in priority setting, the &#8220;pre_op&#8221; of the scaling policy
is invoked, and the policy determines the number of nodes to be deleted.
This decision is saved to the action&#8217;s <code class="docutils literal"><span class="pre">data</span></code> property in the following
format:</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span>&quot;deletion&quot;: {
  &quot;count&quot;: 2
}
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Based on the built-in priority setting, the deletion policy is evaluated
next. When the &#8220;pre_op&#8221; method of the deletion policy is invoked, it first
checks the <code class="docutils literal"><span class="pre">data</span></code> property of the action where it finds out the number of
nodes to delete. Then it will calculate the list of candidates to be
deleted using its selection criteria (e.g. <code class="docutils literal"><span class="pre">OLDEST_FIRST</span></code>). Finally, it
saves the list of candidate nodes to be deleted to the <code class="docutils literal"><span class="pre">data</span></code> property of
the action, in the following format:</li>
</ol>
<div class="highlight-python"><div class="highlight"><pre><span></span>&quot;deletion&quot;: {
  &quot;count&quot;: 2,
  &quot;candidates&quot;: [&quot;1234-4567-9900&quot;, &quot;3232-5656-1111&quot;]
}
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>According to the built-in priority setting, the load-balancing policy is
evaluated last.  When invoked, its &#8220;pre_op&#8221; method checks the <code class="docutils literal"><span class="pre">data</span></code>
property of the action and finds out the candidate nodes to be removed from
the cluster. With this information, the method removes the nodes from the
load-balancer maintained by the policy.</li>
<li>The action&#8217;s <code class="docutils literal"><span class="pre">execute()</span></code> method is now invoked and it removes the nodes
as given in its <code class="docutils literal"><span class="pre">data</span></code> property, updates the cluster&#8217;s last update
timestamp, then returns.</li>
</ol>
<p>From the example above, we can see that the <code class="docutils literal"><span class="pre">data</span></code> property of an action
plays a critical role in policy checking and enforcement. To avoid losing of
the in-memory <code class="docutils literal"><span class="pre">data</span></code> content during service restart, Senlin persists the
content to database whenever it is changed.</p>
<p>Note that there are policies that will write to the <code class="docutils literal"><span class="pre">data</span></code> property of a
node for a similar reason. For example, a placement policy may decide where a
new node should be created. This information is saved into the <code class="docutils literal"><span class="pre">data</span></code>
property of a node. When a profile is about to create a node, it is supposed
to check this property and enforce it. For a Nova server profile, this means
that the profile code will inject <code class="docutils literal"><span class="pre">scheduler_hints</span></code> to the server instance
before it is created.</p>
</div>
</div>
<div class="section" id="action-statuses">
<h2>Action Statuses<a class="headerlink" href="#action-statuses" title="Permalink to this headline">¶</a></h2>
<p>An action can be in one of the following statuses during its lifetime:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">INIT</span></code>: Action object is being initialized, not ready for execution;</li>
<li><code class="docutils literal"><span class="pre">READY</span></code>: Action object can be picked up by any worker thread for
execution;</li>
<li><code class="docutils literal"><span class="pre">WAITING</span></code>: Action object has dependencies on other actions, it may
become <code class="docutils literal"><span class="pre">READY</span></code> only when the dependents are all completed with successes;</li>
<li><code class="docutils literal"><span class="pre">RUNNING</span></code>: Action object is being executed by a worker thread;</li>
<li><code class="docutils literal"><span class="pre">SUSPENDED</span></code>: Action object is suspended during execution, so the only way
to put it back to <code class="docutils literal"><span class="pre">RUNNING</span></code> status is to send it a <code class="docutils literal"><span class="pre">RESUME</span></code> signal;</li>
<li><code class="docutils literal"><span class="pre">SUCCEEDED</span></code>: Action object has completed execution with a success;</li>
<li><code class="docutils literal"><span class="pre">FAILED</span></code>: Action object execution has been aborted due to failures;</li>
<li><code class="docutils literal"><span class="pre">CANCELLED</span></code>: Action object execution has been aborted due to a <code class="docutils literal"><span class="pre">CANCEL</span></code>
signal.</li>
</ul>
<p>Collectively, the <code class="docutils literal"><span class="pre">SUCCEEDED</span></code>, <code class="docutils literal"><span class="pre">FAILED</span></code> and <code class="docutils literal"><span class="pre">CANCELLED</span></code> statuses are all
valid action completion status.</p>
</div>
<div class="section" id="the-execute-method-and-return-values">
<h2>The <code class="docutils literal"><span class="pre">execute()</span></code> Method and Return Values<a class="headerlink" href="#the-execute-method-and-return-values" title="Permalink to this headline">¶</a></h2>
<p>Each subclass of the base <code class="docutils literal"><span class="pre">Action</span></code> must provide an implementation of the
<code class="docutils literal"><span class="pre">execute()</span></code> method which provides the actual logic to be invoked by the
generic action execution framework.</p>
<p>Senlin defines a protocol for the execution of actions. The <code class="docutils literal"><span class="pre">execute()</span></code>
method should always return a tuple <code class="docutils literal"><span class="pre">&lt;RES&gt;,</span> <span class="pre">&lt;REASON&gt;</span></code> where the <code class="docutils literal"><span class="pre">&lt;RES&gt;</span></code>
indicates whether the action procedure execution was successful and the
<code class="docutils literal"><span class="pre">&lt;REASON&gt;</span></code> provides an explanation of the result, e.g. the error message
when the execution has failed. In this protocol, the action procedure can
return one of the following values:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">OK</span></code>: the action execution was a complete success;</li>
<li><code class="docutils literal"><span class="pre">ERROR</span></code>: the action execution has failed with error messages;</li>
<li><code class="docutils literal"><span class="pre">RETRY</span></code>: the action execution has encountered some resource competition
situation, so the recommendation is to re-start the action if possible;</li>
<li><code class="docutils literal"><span class="pre">CANCEL</span></code>: the action has received a <code class="docutils literal"><span class="pre">CANCEL</span></code> signal and thus has aborted
its execution;</li>
<li><code class="docutils literal"><span class="pre">TIMEOUT</span></code>: the action has detected a timeout error when performing some
time consuming jobs.</li>
</ul>
<p>When the return value is <code class="docutils literal"><span class="pre">OK</span></code>, the action status will be set to
<code class="docutils literal"><span class="pre">SUCCEEDED</span></code>; when the return value is <code class="docutils literal"><span class="pre">ERROR</span></code> or <code class="docutils literal"><span class="pre">TIMEOUT</span></code>, the action
status will be set to <code class="docutils literal"><span class="pre">FAILED</span></code>; when the return value is <code class="docutils literal"><span class="pre">CANCEL</span></code>, the
action status will be set to <code class="docutils literal"><span class="pre">CANCELLED</span></code>; finally, when the return value is
<code class="docutils literal"><span class="pre">RETRY</span></code>, the action status is reset to <code class="docutils literal"><span class="pre">READY</span></code>, and the current worker
thread will release its lock on the action so that other threads can pick it
up when resources permit.</p>
</div>
<div class="section" id="creating-an-action">
<h2>Creating An Action<a class="headerlink" href="#creating-an-action" title="Permalink to this headline">¶</a></h2>
<p>Currently, Senlin actions are mostly generated from within the Senlin engine,
either due to a RPC request, or due to another action&#8217;s execution.</p>
<p>In future, Senlin plans to support user-defined actions (UDAs). Senlin API will
provide API for creating an UDA and invoking an action which can be an UDA.</p>
</div>
<div class="section" id="listing-actions">
<h2>Listing Actions<a class="headerlink" href="#listing-actions" title="Permalink to this headline">¶</a></h2>
<p>Senlin provides an <code class="docutils literal"><span class="pre">action_list</span></code> API for users to query the action objects
in the Senlin database. Such a query request can be accompanied with the
following query parameters in the query string:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filters</span></code>: a map that will be used for filtering out records that fail to
match the criteria. The recognizable keys in the map include:<ul>
<li><code class="docutils literal"><span class="pre">name</span></code>: the name of the actions where the value can be a string or a
list of strings;</li>
<li><code class="docutils literal"><span class="pre">target</span></code>: the UUID of the object targeted by the action where the value
can be a string or a list of strings;</li>
<li><code class="docutils literal"><span class="pre">action</span></code>: the builtin action for matching where the value can be a
string or a list of strings;</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">limit</span></code>: a number that restricts the maximum number of action records to be
returned from the query. It is useful for displaying the records in pages
where the page size can be specified as the limit.</li>
<li><code class="docutils literal"><span class="pre">marker</span></code>: A string that represents the last seen UUID of actions in
previous queries. This query will only return results appearing after the
specified UUID. This is useful for displaying records in pages.</li>
<li><code class="docutils literal"><span class="pre">sort</span></code>: A string to enforce sorting of the results. It accepts a list of
known property names of an action as sorting keys separated by commas. Each
sorting key can optionally have either <code class="docutils literal"><span class="pre">:asc</span></code> or <code class="docutils literal"><span class="pre">:desc</span></code> appended to the
key for controlling the sorting direction.</li>
</ul>
</div>
<div class="section" id="getting-an-action">
<h2>Getting An Action<a class="headerlink" href="#getting-an-action" title="Permalink to this headline">¶</a></h2>
<p>Senlin API provides the <code class="docutils literal"><span class="pre">action_show</span></code> API call for software or a user to
retrieve a specific action for examining its details. When such a query
arrives at the Senlin engine, the engine will search the database for the
<code class="docutils literal"><span class="pre">action_id</span></code> specified.</p>
<p>User can provide the UUID, the name or the short ID of an action as the
<code class="docutils literal"><span class="pre">action_id</span></code> for query. The Senlin engine will try each of them in sequence.
When more than one action matches the criteria, an error message is returned
to user, or else the details of the action object is returned.</p>
</div>
<div class="section" id="signaling-an-action">
<h2>Signaling An Action<a class="headerlink" href="#signaling-an-action" title="Permalink to this headline">¶</a></h2>
<p>When an action is in <code class="docutils literal"><span class="pre">RUNNING</span></code> status, a user can send signals to it. A
signal is actually a word that will be written into the <code class="docutils literal"><span class="pre">control</span></code> field of
the <code class="docutils literal"><span class="pre">action</span></code> table in the database.</p>
<p>When an action is capable of handling signals, it is supposed to check its
<code class="docutils literal"><span class="pre">control</span></code> field in the DB table regularly and abort execution in a graceful
way. An action has the freedom to check or ignore these signals. In other
words, Senlin cannot guarantee that a signal will have effect on any action.</p>
<p>The currently supported signal words are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">CANCEL</span></code>: this word indicates that the target action should cancel its
execution and return when possible;</li>
<li><code class="docutils literal"><span class="pre">SUSPEND</span></code>: this word indicates that the target action should suspend its
execution when possible. The action doesn&#8217;t have to return. As an
alternative, it can sleep waiting on a <code class="docutils literal"><span class="pre">RESUME</span></code> signal to continue its
work;</li>
<li><code class="docutils literal"><span class="pre">RESUME</span></code>: this word indicates that the target action, if suspended, should
resume its execution.</li>
</ul>
<p>The support to <code class="docutils literal"><span class="pre">SUSPEND</span></code> and <code class="docutils literal"><span class="pre">RESUME</span></code> signals are still under development.</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="policy.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Policies"></i></a>
          
          
            <a href="receiver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Receiver"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Options</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/basics.html">Senlin Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/policies.html">Working with Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/receivers.html">Working with Receivers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/profile_types.html">Profile Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/profiles.html">Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/clusters.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/membership.html">Cluster Membership</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types.html">Policy Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policies.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/bindings.html">Cluster-Policy Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/receivers.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/affinity.html">Affinity Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/deletion.html">Deletion Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/load_balancing.html">Load-Balancing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/scaling.html">Scaling Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/region_placement.html">Region Placement Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/zone_placement.html">Zone Placement Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/affinity.html">Managing Node Affinity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_overview.html">Support to AutoScaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_ceilometer.html">Autoscaling using Ceilometer/Aodh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_heat.html">Autoscaling with Heat</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_microversion.html">API Microversioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Senlin Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="node.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy.html">Policies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Actions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#action-properties">Action Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#action-statuses">Action Statuses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-execute-method-and-return-values">The <code class="docutils literal"><span class="pre">execute()</span></code> Method and Return Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-action">Creating An Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="#listing-actions">Listing Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-an-action">Getting An Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="#signaling-an-action">Signaling An Action</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="receiver.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Senlin testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin_guide.html">Plugin Writer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="osprofiler.html">OSProfiler</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies/affinity_v1.html">Affinity Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/deletion_v1.html">Deletion Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/health_v1.html">Health Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/load_balance_v1.html">Load Balancing Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/region_v1.html">Region Placement Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/scaling_v1.html">Scaling Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/zone_v1.html">Zone Placement Policy V1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reviews.html">Reviews</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Man Pages</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "developer/action" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/senlin/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 'Tue Feb 14 14:27:25 2017, commit e2451a7";
        var bugProject = "senlin";
        var bugTitle = "Actions in senlin";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 3.0.0.0rc2.dev62 on None";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>