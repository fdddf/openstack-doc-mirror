<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Policy Types</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Policy Types</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="plugin_guide.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Plugin Writer&#8217;s Guide"></i></a>
    
    
    <a href="policies/affinity_v1.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Affinity Policy V1.0"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Policy Types</a><ul>
<li><a class="reference internal" href="#the-base-class-policy">The Base Class <code class="docutils literal"><span class="pre">Policy</span></code></a><ul>
<li><a class="reference internal" href="#the-versions-property">The <code class="docutils literal"><span class="pre">VERSIONS</span></code> Property</a></li>
</ul>
</li>
<li><a class="reference internal" href="#providing-new-policy-types">Providing New Policy Types</a><ul>
<li><a class="reference internal" href="#develop-a-new-policy-type">Develop A New Policy Type</a></li>
<li><a class="reference internal" href="#defining-spec-schema">Defining Spec Schema</a></li>
<li><a class="reference internal" href="#applicable-profile-types">Applicable Profile Types</a></li>
<li><a class="reference internal" href="#policy-targets">Policy Targets</a></li>
<li><a class="reference internal" href="#passing-data-between-policies">Passing Data Between Policies</a></li>
<li><a class="reference internal" href="#registering-the-new-policy-type">Registering The New Policy Type</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="policy-types">
<h1>Policy Types<a class="headerlink" href="#policy-types" title="Permalink to this headline">¶</a></h1>
<p>A <a class="reference internal" href="policy.html"><em>policy</em></a> policy is a set of rules that are checked
and enforced. The checking can be done before or after an action&#8217;s execution
or both. Policies are of different policy types, each of which is designed to
make sure that a cluster&#8217;s behavior follows certain patterns or complies with
certain restrictions.</p>
<p>When released, Senlin comes with some built-in policy types to meet the
requirements found in some typical use cases. However, the distributors or the
users can always augment their collection of policy types by implementing
their own ones.</p>
<p>Policy type implementations are managed as Senlin plugins. The plan is to have
Senlin engine support dynamical loading of plugins from user specified modules
and classes. Currently, this can be achieved by adding new <code class="docutils literal"><span class="pre">senlin.policies</span></code>
entries in the <code class="docutils literal"><span class="pre">entry_points</span></code> section in the <code class="docutils literal"><span class="pre">setup.cfg</span></code> file, followed by
a reinstall of the Senlin service, i.e. <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span></code> command.</p>
<div class="section" id="the-base-class-policy">
<h2>The Base Class <code class="docutils literal"><span class="pre">Policy</span></code><a class="headerlink" href="#the-base-class-policy" title="Permalink to this headline">¶</a></h2>
<p>The base class <code class="docutils literal"><span class="pre">Policy</span></code> provides some common logics regarding the following
operations:</p>
<ul class="simple">
<li>The initialization of the <code class="docutils literal"><span class="pre">spec_data</span></code> property, based on the
<code class="docutils literal"><span class="pre">spec_schema</span></code> definition and the <code class="docutils literal"><span class="pre">spec</span></code> input.</li>
<li>The serialization and deserialization of a policy object into/from database.</li>
<li>The serialization and deserialization of a policy object into/from a dict.</li>
<li>The default validation operation for the <code class="docutils literal"><span class="pre">spec_data</span></code> property.</li>
<li>Default implementations for the following methods which are to be overridden
by a policy type implementation:<ul>
<li><code class="docutils literal"><span class="pre">attach(cluster_id,</span> <span class="pre">action)</span></code>: a method that will be invoked when a policy
object of this type is attached to a cluster.</li>
<li><code class="docutils literal"><span class="pre">detach(cluster_id,</span> <span class="pre">action)</span></code>: a method that will be invoked when a policy
object of this type is detached from a cluster.</li>
<li><code class="docutils literal"><span class="pre">pre_op(cluster_id,</span> <span class="pre">action)</span></code>: a method that will be invoked before an
action is executed;</li>
<li><code class="docutils literal"><span class="pre">post_op(cluster_id,</span> <span class="pre">action)</span></code>: a method that will be invoked after an
action is executed.</li>
</ul>
</li>
</ul>
<div class="section" id="the-versions-property">
<h3>The <code class="docutils literal"><span class="pre">VERSIONS</span></code> Property<a class="headerlink" href="#the-versions-property" title="Permalink to this headline">¶</a></h3>
<p>Each policy type class has a <code class="docutils literal"><span class="pre">VERSIONS</span></code> class property that documents the
changes to the policy type. This information is returned when users request
to list all policy types supported.</p>
<p>The <code class="docutils literal"><span class="pre">VERSIONS</span></code> property is a dict with version numbers as keys. For each
specific version, the value is list of support status changes made to the
policy type. Each change record contains a <code class="docutils literal"><span class="pre">status</span></code> key whose value is one
of <code class="docutils literal"><span class="pre">EXPERIMENTAL</span></code>, <code class="docutils literal"><span class="pre">SUPPORTED</span></code>, <code class="docutils literal"><span class="pre">DEPRECATED</span></code> or <code class="docutils literal"><span class="pre">UNSUPPORTED</span></code>, and a
<code class="docutils literal"><span class="pre">since</span></code> key whose value is of format <code class="docutils literal"><span class="pre">yyyy.mm</span></code> where <code class="docutils literal"><span class="pre">yyyy</span></code> and <code class="docutils literal"><span class="pre">mm</span></code>
are the year and month of the release that bears the change to the support
status. For example, the following record indicates that the specific policy
type was introduced in April, 2016 (i.e. version 1.0 release of Senlin) as
an experimental feature; later, in October, 2016 (i.e. version 2.0 release of
Senlin) it has graduated into a mature feature supported by the developer
team.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">VERSIONS</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;1.0&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;EXPERIMENTAL&quot;</span><span class="p">,</span>
          <span class="s2">&quot;since&quot;</span><span class="p">:</span> <span class="s2">&quot;2016.04&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;SUPPORTED&quot;</span><span class="p">,</span>
          <span class="s2">&quot;since&quot;</span><span class="p">:</span> <span class="s2">&quot;2016.10&quot;</span>
      <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="providing-new-policy-types">
<h2>Providing New Policy Types<a class="headerlink" href="#providing-new-policy-types" title="Permalink to this headline">¶</a></h2>
<p>Adding new policy type implementations is an easy task with only a few steps
to follow.</p>
<div class="section" id="develop-a-new-policy-type">
<h3>Develop A New Policy Type<a class="headerlink" href="#develop-a-new-policy-type" title="Permalink to this headline">¶</a></h3>
<p>The first step for adding a new policy type is to create a new file containing
a subclass of <code class="docutils literal"><span class="pre">Policy</span></code>. Then you will define the spec schema for the new
policy type in a Python dictionary named <code class="docutils literal"><span class="pre">spec_schema</span></code>.</p>
</div>
<div class="section" id="defining-spec-schema">
<h3>Defining Spec Schema<a class="headerlink" href="#defining-spec-schema" title="Permalink to this headline">¶</a></h3>
<p>Each key in this dictionary represents a property name; the value of it is an
object of one of the schema types listed below:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">String</span></code>: A string property.</li>
<li><code class="docutils literal"><span class="pre">Boolean</span></code>: A boolean property.</li>
<li><code class="docutils literal"><span class="pre">Integer</span></code>: An integer property.</li>
<li><code class="docutils literal"><span class="pre">List</span></code>: A property containing a list of values.</li>
<li><code class="docutils literal"><span class="pre">Map</span></code>: A property containing a map of key-value pairs.</li>
</ul>
<p>For example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>spec_schema = {
  &#39;destroy_after_delete&#39;: schema.Boolean(
    &#39;Boolean indicating whether object will be destroyed after deletion.&#39;,
    default=True,
  ),
  ...
}
</pre></div>
</div>
<p>If a property value will be a list, you can further define the type of items
the list can accept. For example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>spec_schema = {
  &#39;criteria&#39;: schema.List(
    &#39;Criteria for object selection that will be evaluated in order.&#39;,
    schema=schema.String(&#39;Name of a criterion&#39;),
  ),
  ...
}
</pre></div>
</div>
<p>If a property value will be a map of key-value pairs, you can define the
schema of the map, which is another Python dictionary containing definitions
of properties. For example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>spec_schema = {
  &#39;strategy&#39;: schema.Map(
    &#39;Strategy for dealing with servers with different states.&#39;,
    schema={
      &#39;inactive&#39;: &#39;boot&#39;,
      &#39;deleted&#39;: &#39;create&#39;,
      &#39;suspended&#39;: &#39;resume&#39;,
    },
  ),
  ...
}
</pre></div>
</div>
<p>When creating a schema type object, you can specify the following keyword
arguments to gain a better control of the property:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">default</span></code>: a default value of the expected data type;</li>
<li><code class="docutils literal"><span class="pre">required</span></code>: a boolean value indicating whether a missing of the property
is acceptable when validating the policy spec;</li>
<li><code class="docutils literal"><span class="pre">constraints</span></code>: a list of <code class="docutils literal"><span class="pre">Constraint</span></code> objects each of which defines a
constraint to be checked. Senlin currently only support <code class="docutils literal"><span class="pre">AllowedValues</span></code>
constraint.</li>
</ul>
</div>
<div class="section" id="applicable-profile-types">
<h3>Applicable Profile Types<a class="headerlink" href="#applicable-profile-types" title="Permalink to this headline">¶</a></h3>
<p>Not all policy types can be used on all profile types. For example, a policy
about load-balancing is only meaningful for objects that can handle workloads,
or more specifically, objects that expose service access point on an IP port.</p>
<p>You can define what are the profile types your new policy type can handle by
specifying the <code class="docutils literal"><span class="pre">PROFILE_TYPE</span></code> property of your policy type class. The value
of <code class="docutils literal"><span class="pre">PROFILE_TYPE</span></code> is a list of profile type names. If a policy type is
designed to handle all profile types, you can specify a single entry <code class="docutils literal"><span class="pre">ANY</span></code>
as the value. See <a class="reference internal" href="profile_type.html"><em>profile types</em></a> for profile type related
operations.</p>
</div>
<div class="section" id="policy-targets">
<h3>Policy Targets<a class="headerlink" href="#policy-targets" title="Permalink to this headline">¶</a></h3>
<p>A policy type is usually defined to handle certain operations. The rules
embedded in the implementation may need to be checked before the execution of
an <a class="reference internal" href="action.html"><em>action</em></a> or they may need to be enforced after the execution
of the action. When an action is about to be executed or an action has
finished execution, the Senlin engine will check if any policy objects
attached to a cluster is interested in the action. If the answer is yes, the
engine will invoke the <code class="docutils literal"><span class="pre">pre_op</span></code> function or the <code class="docutils literal"><span class="pre">post_op</span></code> function
respectively, thus giving the policy object a chance to adjust the action&#8217;s
behavior.</p>
<p>You can define a <code class="docutils literal"><span class="pre">TARGET</span></code> property for the policy type implementation to
indicate the actions your policy type want to subscribe to. The <code class="docutils literal"><span class="pre">TARGET</span></code>
property is a list of tuple (<code class="docutils literal"><span class="pre">WHEN</span></code>, <code class="docutils literal"><span class="pre">ACTION</span></code>). For example, the following
property definition indicates that the policy type is interested in the action
<code class="docutils literal"><span class="pre">CLUSTER_SCALE_IN</span></code> and <code class="docutils literal"><span class="pre">CLUSTER_DEL_NODES</span></code>. The policy type wants itself
be consulted <em>before</em> these actions are performed.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyPolicyType</span><span class="p">(</span><span class="n">Policy</span><span class="p">):</span>
  <span class="o">...</span>
  <span class="n">TARGET</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">BEFORE</span><span class="p">,</span> <span class="n">consts</span><span class="o">.</span><span class="n">CLUSTER_SCALE_IN</span><span class="p">),</span>
    <span class="p">(</span><span class="n">BEFORE</span><span class="p">,</span> <span class="n">consts</span><span class="o">.</span><span class="n">CLUSTER_DEL_NODES</span><span class="p">),</span>
  <span class="p">]</span>
  <span class="o">...</span>
</pre></div>
</div>
<p>When the corresponding actions are about to be executed, the <code class="docutils literal"><span class="pre">pre_op</span></code>
function of this policy object will be invoked.</p>
</div>
<div class="section" id="passing-data-between-policies">
<h3>Passing Data Between Policies<a class="headerlink" href="#passing-data-between-policies" title="Permalink to this headline">¶</a></h3>
<p>Each policy type may decide to send some data as additional inputs or
constraints for the action to consume. This is done by modifying the <code class="docutils literal"><span class="pre">data</span></code>
property of an <code class="docutils literal"><span class="pre">Action</span></code> object (see <a class="reference internal" href="action.html"><em>action</em></a>).</p>
<p>A policy type may want to check if there are other policy objects leaving some
policy decisions in the <code class="docutils literal"><span class="pre">data</span></code> property of an action object.</p>
<p>Senlin allows for more than one policy to be attached to the same cluster.
Each policy, when enabled, is supposed to check a specific subset of cluster
actions. In other words, different policies may get checked before/after the
engine executes a specific cluster action. This design is effectively forming
a chain of policies for checking. The decisions (outcomes) from one policy
sometimes impact other policies that are checked later.</p>
<p>To help other developers to understand how a specific policy type is designed
to work in concert with others, we require all policy type implementations
shipped with Senlin accompanied by a documentation about:</p>
<ul class="simple">
<li>the <code class="docutils literal"><span class="pre">action</span> <span class="pre">data</span></code> items the policy type will consume, including how these
data will impact the policy decisions.</li>
<li>the <code class="docutils literal"><span class="pre">action.data</span></code> items the policy type will produce, thus consumable by
any policies downstream.</li>
</ul>
<p>For built-in policy types, the protocol is documented below:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies/affinity_v1.html">Affinity Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/deletion_v1.html">Deletion Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/load_balance_v1.html">Load Balancing Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/region_v1.html">Region Placement Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/scaling_v1.html">Scaling Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/zone_v1.html">Zone Placement Policy V1.0</a></li>
</ul>
</div>
</div>
<div class="section" id="registering-the-new-policy-type">
<h3>Registering The New Policy Type<a class="headerlink" href="#registering-the-new-policy-type" title="Permalink to this headline">¶</a></h3>
<p>For Senlin service to be aware of and thus to make use of the new policy type
you have just developed, you will register it to the Senlin service.
Currently, this is done through a manual process shown below. In future,
Senlin will provide dynamical loading support to policy type plugins.</p>
<p>To register a new plugin type, you will add a line to the <code class="docutils literal"><span class="pre">setup.cfg</span></code> file
that can be found at the root directory of Senlin code base. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[entry_points]
senlin.policies =
    ScalingPolicy = senlin.policies.scaling_policy:ScalingPolicy
    MyCoolPolicy = &lt;path to the policy module&gt;:&lt;policy class name&gt;
</pre></div>
</div>
<p>Finally, save that file and do a reinstall of the Senlin service, followed
by a restart of the <code class="docutils literal"><span class="pre">senlin-engine</span></code> process.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ sudo pip install -e .
</pre></div>
</div>
<p>Now, when you do a <strong class="command">openstack cluster policy type list</strong>, you will see
your policy type listed along with other existing policy types.</p>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="plugin_guide.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Plugin Writer&#8217;s Guide"></i></a>
          
          
            <a href="policies/affinity_v1.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Affinity Policy V1.0"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Options</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/basics.html">Senlin Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/policies.html">Working with Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/receivers.html">Working with Receivers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/profile_types.html">Profile Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/profiles.html">Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/clusters.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/membership.html">Cluster Membership</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types.html">Policy Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policies.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/bindings.html">Cluster-Policy Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/receivers.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/affinity.html">Affinity Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/deletion.html">Deletion Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/load_balancing.html">Load-Balancing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/scaling.html">Scaling Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/region_placement.html">Region Placement Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/zone_placement.html">Zone Placement Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/affinity.html">Managing Node Affinity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_overview.html">Support to AutoScaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_ceilometer.html">Autoscaling using Ceilometer/Aodh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_heat.html">Autoscaling with Heat</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_microversion.html">API Microversioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Senlin Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="node.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="action.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="receiver.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Senlin testing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="plugin_guide.html">Plugin Writer&#8217;s Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Policy Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="profile_type.html">Profile Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_dispatcher.html">Event Dispatchers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="osprofiler.html">OSProfiler</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies/affinity_v1.html">Affinity Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/deletion_v1.html">Deletion Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/health_v1.html">Health Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/load_balance_v1.html">Load Balancing Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/region_v1.html">Region Placement Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/scaling_v1.html">Scaling Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/zone_v1.html">Zone Placement Policy V1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reviews.html">Reviews</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Man Pages</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "developer/policy_type" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/senlin/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 'Tue Feb 14 14:27:25 2017, commit e2451a7";
        var bugProject = "senlin";
        var bugTitle = "Policy Types in senlin";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 3.0.0.0rc2.dev62 on None";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>