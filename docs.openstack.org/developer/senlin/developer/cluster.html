<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Clusters</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../_static/css/combined.css" rel="stylesheet">
<link href="../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Clusters</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="profile.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Profiles"></i></a>
    
    
    <a href="node.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Nodes"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Clusters</a><ul>
<li><a class="reference internal" href="#cluster-statuses">Cluster Statuses</a></li>
<li><a class="reference internal" href="#creating-a-cluster">Creating A Cluster</a></li>
<li><a class="reference internal" href="#listing-clusters">Listing Clusters</a></li>
<li><a class="reference internal" href="#getting-a-cluster">Getting a Cluster</a></li>
<li><a class="reference internal" href="#updating-a-cluster">Updating A Cluster</a><ul>
<li><a class="reference internal" href="#update-cluster-s-profile">Update Cluster&#8217;s Profile</a></li>
<li><a class="reference internal" href="#update-cluster-size-properties">Update Cluster Size Properties</a></li>
<li><a class="reference internal" href="#update-other-cluster-properties">Update Other Cluster Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cluster-actions">Cluster Actions</a><ul>
<li><a class="reference internal" href="#adding-nodes-to-a-cluster">Adding Nodes to a Cluster</a></li>
<li><a class="reference internal" href="#deleting-nodes-from-a-cluster">Deleting Nodes from a Cluster</a></li>
<li><a class="reference internal" href="#replacing-nodes-in-a-cluster">Replacing Nodes in a Cluster</a></li>
<li><a class="reference internal" href="#resizing-a-cluster">Resizing a Cluster</a></li>
<li><a class="reference internal" href="#scaling-in-out-a-cluster">Scaling in/out a Cluster</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cluster-policy-bindings">Cluster Policy Bindings</a><ul>
<li><a class="reference internal" href="#attaching-a-policy-to-a-cluster">Attaching a Policy to a Cluster</a></li>
<li><a class="reference internal" href="#detaching-a-policy-from-a-cluster">Detaching a Policy from a Cluster</a></li>
<li><a class="reference internal" href="#updating-a-policy-on-a-cluster">Updating a Policy on a Cluster</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="clusters">
<h1>Clusters<a class="headerlink" href="#clusters" title="Permalink to this headline">¶</a></h1>
<p>Clusters are first-class citizens in Senlin service design. A cluster is
defined as a collection of homogeneous objects. The &#8220;homogeneous&#8221; here means
that the objects managed (aka. Nodes) have to be instantiated from the same
&#8220;profile type&#8221;.</p>
<p>A cluster can contain zero or more nodes. Senlin provides REST APIs for users
to create, retrieve, update, delete clusters. Using these APIs, a user can
manage the node membership of a cluster.</p>
<p>A cluster is owned by a user (the owner), and it is accessible from within the
Keystone project (tenant) which is the default project of the user.</p>
<p>A cluster has the following timestamps when instantiated:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">init_at</span></code>: the timestamp when a cluster object is initialized in the
Senlin database, but the actual cluster creation has not yet started;</li>
<li><code class="docutils literal"><span class="pre">created_at</span></code>: the timestamp when the cluster object is created, i.e.
the <code class="docutils literal"><span class="pre">CLUSTER_CREATE</span></code> action has completed;</li>
<li><code class="docutils literal"><span class="pre">updated_at</span></code>: the timestamp when the cluster was last updated.</li>
</ul>
</div></blockquote>
<div class="section" id="cluster-statuses">
<h2>Cluster Statuses<a class="headerlink" href="#cluster-statuses" title="Permalink to this headline">¶</a></h2>
<p>A cluster can have one of the following statuses during its lifecycle:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">INIT</span></code>: the cluster object has been initialized, but not created yet;</li>
<li><code class="docutils literal"><span class="pre">ACTIVE</span></code>: the cluster is created and providing service;</li>
<li><code class="docutils literal"><span class="pre">CREATING</span></code>: the cluster creation action is still on going;</li>
<li><code class="docutils literal"><span class="pre">ERROR</span></code>: the cluster is still providing services, but there are things
going wrong that needs human intervention;</li>
<li><code class="docutils literal"><span class="pre">CRITICAL</span></code>: the cluster is not operational, it may or may not be
providing services as expected. Senlin cannot recover it from its current
status. The best way to deal with this cluster is to delete it and then
re-create it if needed.</li>
<li><code class="docutils literal"><span class="pre">DELETING</span></code>: the cluster deletion is ongoing;</li>
<li><code class="docutils literal"><span class="pre">WARNING</span></code>: the cluster is operational, but there are some warnings
detected during past operations. In this case, human involvement is
suggested but not required.</li>
<li><code class="docutils literal"><span class="pre">UPDATING</span></code>: the cluster is being updated.</li>
</ul>
</div></blockquote>
<p>Along with the <code class="docutils literal"><span class="pre">status</span></code> property, Senlin provides a <code class="docutils literal"><span class="pre">status_reason</span></code>
property for users to check what is the cause of the cluster&#8217;s current status.</p>
<p>To avoid frequent databases accesses, a cluster object has a runtime data
property named <code class="docutils literal"><span class="pre">rt</span></code> which is a Python dictionary. The property caches the
profile referenced by the cluster, the list of nodes in the cluster and the
policies attached to the cluster. The runtime data is not directly visible to
users. It is merely a convenience for cluster operations.</p>
</div>
<div class="section" id="creating-a-cluster">
<h2>Creating A Cluster<a class="headerlink" href="#creating-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>When creating a cluster, the Senlin API will verify whether the request
carries a body with valid, sufficient information for the engine to complete
the creation job. The following fields are required in a map named <code class="docutils literal"><span class="pre">cluster</span></code>
in the request JSON body:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: the name of the cluster to be created;</li>
<li><code class="docutils literal"><span class="pre">profile</span></code>: the name or ID or short-ID of a profile to be used;</li>
<li><code class="docutils literal"><span class="pre">desired_capacity</span></code>: the desired number of nodes in the cluster, which is
treated also as the initial number of nodes to be created.</li>
</ul>
</div></blockquote>
<p>The following optional fields can be provided in the <code class="docutils literal"><span class="pre">cluster</span></code> map in the
JSON request body:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">min_size</span></code>: the minimum number of nodes inside the cluster, default
value is 0;</li>
<li><code class="docutils literal"><span class="pre">max_size</span></code>: the maximum number of nodes inside the cluster, default
value is -1, which means there is no upper limit on the number of nodes;</li>
<li><code class="docutils literal"><span class="pre">timeout</span></code>: the maximum number of seconds to wait for the cluster to
become ready, i.e. <code class="docutils literal"><span class="pre">ACTIVE</span></code>.</li>
<li><code class="docutils literal"><span class="pre">metadata</span></code>: a list of key-value pairs to be associated with the cluster.</li>
<li><code class="docutils literal"><span class="pre">dependents</span></code>: A dict contains dependency information between nova server/
heat stack cluster and container cluster. The container node&#8217;s id will be
stored in &#8216;dependents&#8217; property of its host cluster.</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">max_size</span></code> and the <code class="docutils literal"><span class="pre">min_size</span></code> fields, when specified, will be checked
against each other by the Senlin API. The API also checks if the specified
<code class="docutils literal"><span class="pre">desired_capacity</span></code> falls out of the range [<code class="docutils literal"><span class="pre">min_size</span></code>, <code class="docutils literal"><span class="pre">max_size</span></code>]. If
any verification failed, a <code class="docutils literal"><span class="pre">HTTPBadRequest</span></code> exception is thrown and the
cluster creation request is rejected.</p>
<p>A cluster creation request is then forwarded to the Senlin RPC engine for
processing, where the engine creates an Action for the request and queues it
for any worker threads to execute. Once the action is queued, the RPC engine
returns the current cluster properties in a map to the API. Along with these
properties, the engine also returns the UUID of the Action that will do the
real job of cluster creation. A user can check the status of the action to
determine whether the cluster has been successfully completed or failed.</p>
</div>
<div class="section" id="listing-clusters">
<h2>Listing Clusters<a class="headerlink" href="#listing-clusters" title="Permalink to this headline">¶</a></h2>
<p>Clusters in the current project can be queried using some query parameters.
None of these parameters is required. By default, the Senlin API will return
all clusters that are not deleted.</p>
<p>When listing clusters, the following query parameters can be specified,
individually or combined:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filters</span></code>: a map containing key-value pairs for matching. Records that
fail to match the criteria will be filtered out. The valid keys in this map
include:<ul>
<li><code class="docutils literal"><span class="pre">name</span></code>: name of clusters to list, can be a string or a list of strings;</li>
<li><code class="docutils literal"><span class="pre">status</span></code>: status of clusters, can be a string or a list of strings;</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">limit</span></code>: a number that restricts the maximum number of records to be
returned from the query. It is useful for displaying the records in pages
where the page size can be specified as the limit.</li>
<li><code class="docutils literal"><span class="pre">marker</span></code>: A string that represents the last seen UUID of clusters in
previous queries. This query will only return results appearing after the
specified UUID. This is useful for displaying records in pages.</li>
<li><code class="docutils literal"><span class="pre">sort</span></code>: A string to enforce sorting of the results. It accepts a list of
known property names of a cluster as sorting keys separated by commas. Each
sorting key can optionally have either <code class="docutils literal"><span class="pre">:asc</span></code> or <code class="docutils literal"><span class="pre">:desc</span></code> appended to the
key for controlling the sorting direction.</li>
<li><code class="docutils literal"><span class="pre">global_project</span></code>: A boolean indicating whether cluster listing should be
done in a tenant-safe way. When this value is specified as False (the
default), only clusters from the current project that match the other
criteria will be returned. When this value is specified as True, clusters
that matching all other criteria would be returned, no matter in which
project a cluster was created. Only a user with admin privilege is permitted
to do a global listing.</li>
</ul>
</div>
<div class="section" id="getting-a-cluster">
<h2>Getting a Cluster<a class="headerlink" href="#getting-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>When a user wants to check the details about a specific cluster, he or she can
specify one of the following keys for query:</p>
<ul class="simple">
<li>cluster UUID: Clusters are queried strictly based on the UUID given. This is
the most precise query supported.</li>
<li>cluster name: Senlin allows multiple clusters to have the same name. It is
user&#8217;s responsibility to avoid name conflicts if needed. The output may be
the details of a cluster if the cluster name is unique, or else Senlin will
return a message telling users that multiple clusters found matching the
specified name.</li>
<li>short ID: Considering that UUID is a long string not so convenient to input,
Senlin supports a short version of UUIDs for query. Senlin engine will use
the provided string as a prefix to attempt a matching in the database. When
the &#8220;ID&#8221; is long enough to be unique, the details of the matching cluster is
returned, or else Senlin will return an error message indicating that more
than one cluster matching the short ID have been found.</li>
</ul>
<p>Senlin engine service will try the above three ways in order to find a match
in database.</p>
<p>In the returned result, Senlin injects a list of node IDs for nodes in the
cluster. It also injects the name of the profile used by the cluster. These
are all for user&#8217;s convenience.</p>
</div>
<div class="section" id="updating-a-cluster">
<h2>Updating A Cluster<a class="headerlink" href="#updating-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>A cluster can be updated upon user&#8217;s requests. In theory, all properties of a
cluster could be updated/changed. However, some update operations are light
-weight ones, others are heavy weight ones. This is because the semantics of
properties differ a lot from each other. Currently, cluster profile related
changes and cluster size related changes are heavy weight because they may
induce a chain of operations on the cluster. Updating other properties are
light weight operations.</p>
<p>In the JSON body of a <code class="docutils literal"><span class="pre">cluster_update</span></code> request, users can specify new values
for the following properties:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: new cluster name;</li>
<li><code class="docutils literal"><span class="pre">profile_id</span></code>: ID or name or short ID of a profile object to use;</li>
<li><code class="docutils literal"><span class="pre">metadata</span></code>: a list of key-value pairs to be associated with the cluster,
this dict will be merged with the existing key-value pairs based on keys.</li>
<li><code class="docutils literal"><span class="pre">desired_capacity</span></code>: new <em>desired</em> size for the cluster;</li>
<li><code class="docutils literal"><span class="pre">min_size</span></code>: new lower bound for the cluster size;</li>
<li><code class="docutils literal"><span class="pre">max_size</span></code>: new upper bound for the cluster size.</li>
<li><code class="docutils literal"><span class="pre">timeout</span></code>: new timeout value for the specified cluster.</li>
</ul>
<div class="section" id="update-cluster-s-profile">
<h3>Update Cluster&#8217;s Profile<a class="headerlink" href="#update-cluster-s-profile" title="Permalink to this headline">¶</a></h3>
<p>When <code class="docutils literal"><span class="pre">profile_id</span></code> is specified, the request will be interpreted as a
wholistic update to all nodes across the cluster. The targeted use case is to
do a cluster wide system upgrade. For example, replacing glance images used by
the cluster nodes when new kernel patches have been applied or software
defects have been fixed.</p>
<p>When receiving such an update request, the Senlin engine will check if the new
profile referenced does exist and whether the new profile has the same profile
type as that of the existing profile. Exceptions will be thrown if any
verification has failed and thus the request is rejected.</p>
<p>After the engine has validated the request, an Action of <code class="docutils literal"><span class="pre">CLUSTER_UPDATE</span></code> is
created and queued internally for execution. Later on, when a worker thread
picks up the action for execution, it will first lock the whole cluster and
mark the cluster status as <code class="docutils literal"><span class="pre">UPDATING</span></code>. It will then fork <code class="docutils literal"><span class="pre">NODE_UPDATE</span></code>
actions per node inside the cluster, which are in turn queued for execution.
Other worker threads will pick up the node level update action for execution
and mark the action as completed/failed. When all these node level updates are
completed, the <code class="docutils literal"><span class="pre">CLUSTER_UPDATE</span></code> operation continues and marks the cluster as
<code class="docutils literal"><span class="pre">ACTIVE</span></code> again.</p>
<p>The cluster update operation may take a long time to complete, depending on
the response time from the underlying profile operations. Note also, when
there is a update policy is attached to the cluster and enabled, the update
operation may be split into several batches so that 1) there is a minimum
number of nodes remained in service at any time; 2) the pressure on the
underlying service is controlled.</p>
</div>
<div class="section" id="update-cluster-size-properties">
<h3>Update Cluster Size Properties<a class="headerlink" href="#update-cluster-size-properties" title="Permalink to this headline">¶</a></h3>
<p>When either one of the <code class="docutils literal"><span class="pre">desired_capacity</span></code>, <code class="docutils literal"><span class="pre">min_size</span></code> and <code class="docutils literal"><span class="pre">max_size</span></code>
property is specified in the <code class="docutils literal"><span class="pre">CLUSTER_UPDATE</span></code> request, it may lead to a
resize operation on the cluster.</p>
<p>The Senlin API will do a preliminary validation upon the new property values.
For example, if both <code class="docutils literal"><span class="pre">min_size</span></code> and <code class="docutils literal"><span class="pre">max_size</span></code> are specified, they have to
be integers and the value for <code class="docutils literal"><span class="pre">max_size</span></code> is greater than the value for
<code class="docutils literal"><span class="pre">min_size</span></code>, unless the value of <code class="docutils literal"><span class="pre">max_size</span></code> is -1 which means the upper
bound of cluster size is unlimited.</p>
<p>When the request is then received by the Senlin engine, the engine first
retrieves the cluster properties from the database and do further
cross-verifications between the new property values and the current values.
For example, it is treated as an invalid request if a user has specified value
for <code class="docutils literal"><span class="pre">min_size</span></code> but no value for <code class="docutils literal"><span class="pre">max_size</span></code>, however the new <code class="docutils literal"><span class="pre">min_size</span></code>
is greater than the existing <code class="docutils literal"><span class="pre">max_size</span></code> of the cluster. In this case, the
user has to provide a valid <code class="docutils literal"><span class="pre">max_size</span></code> to override the existing value, or
he/she has to lower the <code class="docutils literal"><span class="pre">min_size</span></code> value so that the request becomes
acceptable.</p>
<p>Once the cross-verification has passed, Senlin engine will calculate the new
<code class="docutils literal"><span class="pre">desired_capacity</span></code> and adjust the size of the cluster if deemed necessary.
For example, when the cluster size is below the new <code class="docutils literal"><span class="pre">min_size</span></code>, some nodes
will be removed from the cluster; when the cluster size is above the new
<code class="docutils literal"><span class="pre">max_size</span></code>, new nodes will be created and added to the cluster. If the
<code class="docutils literal"><span class="pre">desired_capacity</span></code> is set and the property value falls between the new range
of cluster size, Senlin tries resize the cluster to the <code class="docutils literal"><span class="pre">desired_capacity</span></code>.</p>
<p>When the size of the cluster is adjusted, Senlin engine will check if there
are relevant policies attached to the cluster so that the engine will add
and/or remove nodes in a predictable way.</p>
</div>
<div class="section" id="update-other-cluster-properties">
<h3>Update Other Cluster Properties<a class="headerlink" href="#update-other-cluster-properties" title="Permalink to this headline">¶</a></h3>
<p>The update to other cluster properties is relatively straightforward. Senlin
engine simply verifies the data types when necessary and override the existing
property values in the database.</p>
<p>Note that in the cases where multiple properties are specified in a single
<code class="docutils literal"><span class="pre">CLUSTER_UPDATE</span></code> request, some will take a longer time to complete  than
others. Any mixes of update properties are acceptable to the Senlin API and
the engine.</p>
</div>
</div>
<div class="section" id="cluster-actions">
<h2>Cluster Actions<a class="headerlink" href="#cluster-actions" title="Permalink to this headline">¶</a></h2>
<p>A cluster object supports the following asynchronous actions:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">add_nodes</span></code>: add a list of nodes into the target cluster;</li>
<li><code class="docutils literal"><span class="pre">del_nodes</span></code>: remove the specified list of nodes from the cluster;</li>
<li><code class="docutils literal"><span class="pre">replace_nodes</span></code>: replace the specified list of nodes in the cluster;</li>
<li><code class="docutils literal"><span class="pre">resize</span></code>: adjust the size of the cluster;</li>
<li><code class="docutils literal"><span class="pre">scale_in</span></code>: explicitly shrink the size of the cluster;</li>
<li><code class="docutils literal"><span class="pre">scale_out</span></code>: explicitly enlarge the size of the cluster.</li>
<li><code class="docutils literal"><span class="pre">policy_attach</span></code>: attach a policy object to the cluster;</li>
<li><code class="docutils literal"><span class="pre">policy_detach</span></code>: detach a policy object from the cluster;</li>
<li><code class="docutils literal"><span class="pre">policy_update</span></code>: modify the settings of a policy that is attached to the
cluster.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">scale_in</span></code> and the <code class="docutils literal"><span class="pre">scale_out</span></code> actions are subject to change in future.
We recommend using the unified <code class="docutils literal"><span class="pre">CLUSTER_RESIZE</span></code> action for cluster size
adjustments.</p>
<p>Software or a user can trigger a <code class="docutils literal"><span class="pre">cluster_action</span></code> API to issue an action
for Senlin to perform. In the JSON body of these requests, Senlin will verify
if the top-level key contains <em>one</em> of the above actions. When no valid action
name is found or more than one action is specified, the API will return error
messages to the caller and reject the request.</p>
<div class="section" id="adding-nodes-to-a-cluster">
<h3>Adding Nodes to a Cluster<a class="headerlink" href="#adding-nodes-to-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Senlin API provides the <code class="docutils literal"><span class="pre">add_nodes</span></code> action for user to add some existing
nodes into the specified cluster. The parameter for this action is interpreted
as a list in which each item is the UUID, name or short ID of a node.</p>
<p>When receiving an <code class="docutils literal"><span class="pre">add_nodes</span></code> action request, the Senlin API only validates
if the parameter is a list and if the list is empty. After this validation,
the request is forwarded to the Senlin engine for processing.</p>
<p>The Senlin engine will examine nodes in the list one by one and see if any of
the following conditions is true. Senlin engine rejects the request if so.</p>
<ul class="simple">
<li>Any node from the list is not in <code class="docutils literal"><span class="pre">ACTIVE</span></code> state?</li>
<li>Any node from the list is still member of another cluster?</li>
<li>Any node from the list is not found in the database?</li>
<li>Number of nodes to add is zero?</li>
</ul>
<p>When this phase of validation succeeds, the request is translated into a
<code class="docutils literal"><span class="pre">CLUSTER_ADD_NODES</span></code> builtin action and queued for execution. The engine
returns to the user an action UUID for checking.</p>
<p>When the action is picked up by a worker thread for execution, Senlin checks
if the profile type of the nodes to be added matches that of the cluster.
Finally, a number of <code class="docutils literal"><span class="pre">NODE_JOIN</span></code> action is forked and executed from the
<code class="docutils literal"><span class="pre">CLUSTER_ADD_NODES</span></code> action. When <code class="docutils literal"><span class="pre">NODE_JOIN</span></code> actions complete, the
<code class="docutils literal"><span class="pre">CLUSTER_ADD_NODES</span></code> action returns with success.</p>
<p>In the cases where there are load-balancing policies attached to the cluster,
the <code class="docutils literal"><span class="pre">CLUSTER_ADD_NODES</span></code> action will save the list of UUIDs of the new nodes
into the action&#8217;s <code class="docutils literal"><span class="pre">data</span></code> field so that those policies could update the
associated resources.</p>
</div>
<div class="section" id="deleting-nodes-from-a-cluster">
<h3>Deleting Nodes from a Cluster<a class="headerlink" href="#deleting-nodes-from-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Senlin API provides the <code class="docutils literal"><span class="pre">del_nodes</span></code> action for user to delete some existing
nodes from the specified cluster. The parameter for this action is interpreted
as a list in which each item is the UUID, name or short ID of a node.</p>
<p>When receiving a <code class="docutils literal"><span class="pre">del_nodes</span></code> action request, the Senlin API only validates
if the parameter is a list and if the list is empty. After this validation,
the request is forwarded to the Senlin engine for processing.</p>
<p>The Senlin engine will examine nodes in the list one by one and see if any of
the following conditions is true. Senlin engine rejects the request if so.</p>
<ul class="simple">
<li>Any node from the list cannot be found from the database?</li>
<li>Any node from the list is not member of the specified cluster?</li>
<li>Number of nodes to delete is zero?</li>
</ul>
<p>When this phase of validation succeeds, the request is translated into a
<code class="docutils literal"><span class="pre">CLUSTER_DEL_NODES</span></code> builtin action and queued for execution. The engine
returns to the user an action UUID for checking.</p>
<p>When the action is picked up by a worker thread for execution, Senlin forks a
number of <code class="docutils literal"><span class="pre">NODE_DELETE</span></code> actions and execute them asynchronously. When all
forked actions complete, the <code class="docutils literal"><span class="pre">CLUSTER_DEL_NODES</span></code> returns with a success.</p>
<p>In the cases where there are load-balancing policies attached to the cluster,
the <code class="docutils literal"><span class="pre">CLUSTER_DEL_NODES</span></code> action will save the list of UUIDs of the deleted
nodes into the action&#8217;s <code class="docutils literal"><span class="pre">data</span></code> field so that those policies could update the
associated resources.</p>
<p>Note also that by default Senlin won&#8217;t destroy the nodes that are deleted
from the cluster. It simply removes the nodes from the cluster so that they
become orphan nodes.
Senlin also provides a paramater <code class="docutils literal"><span class="pre">destroy_after_deletion</span></code> for this action
so that a user can request the deleted node(s) to be destroyed right away,
instead of becoming orphan nodes.</p>
</div>
<div class="section" id="replacing-nodes-in-a-cluster">
<h3>Replacing Nodes in a Cluster<a class="headerlink" href="#replacing-nodes-in-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Senlin API provides the <code class="docutils literal"><span class="pre">replace_nodes</span></code> action for user to replace some existing
nodes in the specified cluster. The parameter for this action is interpreted
as a dict in which each item is the node-pair{OLD_NODE:NEW_NODE}. The key OLD_NODE
is the UUID, name or short ID of a node to be replaced, and the value NEW_NODE is
the UUID, name or short ID of a node as replacement.</p>
<p>When receiving a <code class="docutils literal"><span class="pre">replace_nodes</span></code> action request, the Senlin API only validates
if the parameter is a dict and if the dict is empty. After this validation,
the request is forwarded to the Senlin engine for processing.</p>
<p>The Senlin engine will examine nodes in the dict one by one and see if all of
the following conditions is true. Senlin engine accepts the request if so.</p>
<ul class="simple">
<li>All nodes from the list can be found from the database.</li>
<li>All replaced nodes from the list are the members of the specified cluster.</li>
<li>All replacement nodes from the list are not the members of any cluster.</li>
<li>The profile types of all replacement nodes match that of the specified
cluster.</li>
<li>The statuses of all replacement nodes are ACTIVE.</li>
</ul>
<p>When this phase of validation succeeds, the request is translated into a
<code class="docutils literal"><span class="pre">CLUSTER_REPLACE_NODES</span></code> builtin action and queued for execution. The engine
returns to the user an action UUID for checking.</p>
<p>When the action is picked up by a worker thread for execution, Senlin forks a
number of <code class="docutils literal"><span class="pre">NODE_LEAVE</span></code> and related <code class="docutils literal"><span class="pre">NODE_JOIN</span></code> actions, and execute them
asynchronously. When all forked actions complete, the <code class="docutils literal"><span class="pre">CLUSTER_REPLACE_NODES</span></code>
returns with a success.</p>
</div>
<div class="section" id="resizing-a-cluster">
<h3>Resizing a Cluster<a class="headerlink" href="#resizing-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>In addition to the <code class="docutils literal"><span class="pre">cluster_update</span></code> request, Senlin provides a dedicated API
for adjusting the size of a cluster, i.e. <code class="docutils literal"><span class="pre">cluster_resize</span></code>. This operation
is designed for the auto-scaling and manual-scaling use cases.</p>
<p>Below is a list of API parameters recognizable by the Senlin API when parsing
the JSON body of a <code class="docutils literal"><span class="pre">cluster_resize</span></code> request:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">adjustment_type</span></code>: type of adjustment to be performed where the value
should be one of the followings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">EXACT_CAPACITY</span></code>: the adjustment is about the targeted size of the
cluster;</li>
<li><code class="docutils literal"><span class="pre">CHANGE_IN_CAPACITY</span></code>: the adjustment is about the number of nodes to be
added or removed from the cluster and this is the default setting;</li>
<li><code class="docutils literal"><span class="pre">CHANGE_IN_PERCENTAGE</span></code>: the adjustment is about a relative percentage of
the targeted cluster.</li>
</ul>
<p>This field is mandatory.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">number</span></code>: adjustment number whose value will be interpreted base on the
value of <code class="docutils literal"><span class="pre">adjustment_type</span></code>. This field is mandatory.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">min_size</span></code>: the new lower bound for the cluster size;</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">max_size</span></code>: the new upper bound for the cluster size;</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">min_step</span></code>: the minimum number of nodes to be added or removed when the
<code class="docutils literal"><span class="pre">adjustment_type</span></code> is set to <code class="docutils literal"><span class="pre">CHANGE_IN_PERCENTAGE</span></code> and the absolute
value computed is less than 1;</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">strict</span></code>: a boolean value indicating whether the service should do a
best-effort resizing operation even if the request cannot be fully met.</p>
</li>
</ul>
<p>For example, the following request is about increasing the size of the cluster
by 20% and Senlin can try a best-effort if the calculated size is greater than
the upper limit of the cluster size:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;adj_type&quot;</span><span class="p">:</span> <span class="s2">&quot;CHANGE_IN_PERCENTAGE&quot;</span><span class="p">,</span>
  <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span>
  <span class="s2">&quot;strict&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When Senlin API receives a <code class="docutils literal"><span class="pre">cluster_resize</span></code> request, it first validates the
data type of the values and the sanity of the value collection. For example,
you cannot specify a <code class="docutils literal"><span class="pre">min_size</span></code> greater than the current upper bound (i.e.
the <code class="docutils literal"><span class="pre">max_size</span></code> property of the cluster) if you are not providing a new
<code class="docutils literal"><span class="pre">max_size</span></code> that is greater than the <code class="docutils literal"><span class="pre">min_size</span></code>.</p>
<p>After the request is forwarded to the Senlin engine, the engine will further
validates the parameter values against the targeted cluster. When all
validations pass, the request is converted into a <code class="docutils literal"><span class="pre">CLUSTER_RESIZE</span></code> action
and queued for execution. The API returns the cluster properties and the UUID
of the action at this moment.</p>
<p>When executing the action, Senlin will analyze the request parameters and
determine the operations to be performed to meet user&#8217;s requirement. The
corresponding cluster properties are updated before the resize operation
is started.</p>
</div>
<div class="section" id="scaling-in-out-a-cluster">
<h3>Scaling in/out a Cluster<a class="headerlink" href="#scaling-in-out-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>As a convenience method, Senlin provides the <code class="docutils literal"><span class="pre">scale_out</span></code> and the <code class="docutils literal"><span class="pre">scale_in</span></code>
action API for clusters. With these two APIs, a user can request a cluster to
be resized by the specified number of nodes.</p>
<p>The <code class="docutils literal"><span class="pre">scale_out</span></code> and the <code class="docutils literal"><span class="pre">scale_in</span></code> APIs both take a parameter named
<code class="docutils literal"><span class="pre">count</span></code> which is a positive integer. The integer parameter is optional, and
it specifies the number of nodes to be added or removed if provided. When it
is omitted from the request JSON body, Senlin engine will check if the cluster
has any relevant policies attached that will decide the number of nodes to be
added or removed respectively. The Senlin engine will use the outputs from
these policies as the number of nodes to create (or delete) if such policies
exist. When the request does contain a <code class="docutils literal"><span class="pre">count</span></code> parameter and there are
policies governing the scaling arguments, the <code class="docutils literal"><span class="pre">count</span></code> parameter value may
be overridden/ignored.</p>
<p>When a <code class="docutils literal"><span class="pre">scale_out</span></code> or a <code class="docutils literal"><span class="pre">scale_in</span></code> request is received by the Senlin
engine, a <code class="docutils literal"><span class="pre">CLUSTER_SCALE_OUT</span></code> or a <code class="docutils literal"><span class="pre">CLUSTER_SCALE_IN</span></code> action is then
created and queued for execution after some validation of the parameter value.</p>
<p>A worker thread picks up the action and execute it. The worker will check if
there are outputs from policy checkings. For <code class="docutils literal"><span class="pre">CLUSTER_SCALE_OUT</span></code> actions,
the worker checks if the policies checked has left a <code class="docutils literal"><span class="pre">count</span></code> key in the
dictionary named <code class="docutils literal"><span class="pre">creation</span></code> from the action&#8217;s runtime <code class="docutils literal"><span class="pre">data</span></code> attribute.
The worker will use such a <code class="docutils literal"><span class="pre">count</span></code> value for node creation. For a
<code class="docutils literal"><span class="pre">CLUSTER_SCALE_OUT</span></code> action, the worker checks if the policies checked has
left a <code class="docutils literal"><span class="pre">count</span></code> key in the dictionary named <code class="docutils literal"><span class="pre">deletion</span></code> from the action&#8217;s
runtime <code class="docutils literal"><span class="pre">data</span></code> attribute. The worker will use such a <code class="docutils literal"><span class="pre">count</span></code> value for
node deletion.</p>
<p>Note that both <code class="docutils literal"><span class="pre">scale_out</span></code> and <code class="docutils literal"><span class="pre">scale_in</span></code> actions will adjust the
<code class="docutils literal"><span class="pre">desired_capacity</span></code> property of the target cluster.</p>
</div>
</div>
<div class="section" id="cluster-policy-bindings">
<h2>Cluster Policy Bindings<a class="headerlink" href="#cluster-policy-bindings" title="Permalink to this headline">¶</a></h2>
<p>Senlin API provides the following action APIs for managing the binding
relationship between a cluster and a policy:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">policy_attach</span></code>: attach a policy to a cluster;</li>
<li><code class="docutils literal"><span class="pre">policy_detach</span></code>: detach a policy from a cluster;</li>
<li><code class="docutils literal"><span class="pre">policy_update</span></code>: update the properties of the binding between a cluster
and a policy.</li>
</ul>
<div class="section" id="attaching-a-policy-to-a-cluster">
<h3>Attaching a Policy to a Cluster<a class="headerlink" href="#attaching-a-policy-to-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Once a policy is attached (bound) to a cluster, it will be enforced when
related actions are performed on that cluster, unless the policy is
(temporarily) disabled on the cluster.</p>
<p>When attaching a policy to a cluster, the following properties can be
specified:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enabled</span></code>: a boolean indicating whether the policy should be enabled on
the cluster once attached. Default is True. When specified, it will override
the default setting for the policy.</li>
</ul>
<p>Upon receiving the <code class="docutils literal"><span class="pre">policy_attach</span></code> request, the Senlin engine will perform
some validations then translate the request into a <code class="docutils literal"><span class="pre">CLUSTER_ATTACH_POLICY</span></code>
action and queue the action for execution. The action&#8217;s UUID is then returned
to Senlin API and finally the requestor.</p>
<p>When the engine executes the action, it will try find if the policy is already
attached to the cluster. This checking was not done previously because the
engine must ensure that the cluster has been locked before this checking, or
else there might be race conditions.</p>
<p>The engine calls the policy&#8217;s <code class="docutils literal"><span class="pre">attach</span></code> method when attaching the policy and
record the binding into database if the <code class="docutils literal"><span class="pre">attach</span></code> method returns a positive
response.</p>
<p>Currently, Senlin does not allow two policies of the same type to be attached
to the same cluster. This constraint may be relaxed in future, but for now, it
is checked and enforced before a policy gets attached to a cluster.</p>
<p>Policies attached to a cluster are cached at the target cluster as part of its
runtime <code class="docutils literal"><span class="pre">rt</span></code> data structure. This is an optimization regarding DB queries.</p>
</div>
<div class="section" id="detaching-a-policy-from-a-cluster">
<h3>Detaching a Policy from a Cluster<a class="headerlink" href="#detaching-a-policy-from-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>Once a policy is attached to a cluster, it can be detached from the cluster at
user&#8217;s request. The only parameter required for the <code class="docutils literal"><span class="pre">policy_detach</span></code> action
API is <code class="docutils literal"><span class="pre">policy_id</span></code>, which can be the UUID, the name or the short ID of the
policy.</p>
<p>Upon receiving a <code class="docutils literal"><span class="pre">policy_detach</span></code> request, the Senlin engine will perform
some validations then translate the request into a <code class="docutils literal"><span class="pre">CLUSTER_DETACH_POLICY</span></code>
action and queue the action for execution. The action&#8217;s UUID is then returned
to Senlin API and finally the requestor.</p>
<p>When the Senlin engine executes the <code class="docutils literal"><span class="pre">CLUSTER_DETACH_POLICY</span></code> action, it will
try find if the policy is already attached to the cluster. This checking was
not done previously because the engine must ensure that the cluster has been
locked before this checking, or else there might be race conditions.</p>
<p>The engine calls the policy&#8217;s <code class="docutils literal"><span class="pre">detach</span></code> method when detaching the policy from
the cluster and then removes the binding record from database if the
<code class="docutils literal"><span class="pre">detach</span></code> method returns a True value.</p>
<p>Policies attached to a cluster are cached at the target cluster as part of its
runtime <code class="docutils literal"><span class="pre">rt</span></code> data structure. This is an optimization regarding DB queries.
The <code class="docutils literal"><span class="pre">CLUSTER_DETACH_POLICY</span></code> action will invalidate the cache when detaching
a policy from a cluster.</p>
</div>
<div class="section" id="updating-a-policy-on-a-cluster">
<h3>Updating a Policy on a Cluster<a class="headerlink" href="#updating-a-policy-on-a-cluster" title="Permalink to this headline">¶</a></h3>
<p>When a policy is attached to a cluster, there are some properties pertaining
to the binding. These properties can be updated as long as the policy is still
attached to the cluster. The properties that can be updated include:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">enabled</span></code>: a boolean value indicating whether the policy should be enabled
or disabled. There are cases where some policies have to be temporarily
disabled when other manual operations going on.</li>
</ul>
<p>Upon receiving the <code class="docutils literal"><span class="pre">policy_update</span></code> request, Senlin API performs some basic
validations on the parameters passed.</p>
<p>Senlin engine translates the <code class="docutils literal"><span class="pre">policy_update</span></code> request into an action
<code class="docutils literal"><span class="pre">CLUSTER_UPDATE_POLICY</span></code> and queue it for execution. The UUID of the action
is then returned to Senlin API and eventually the requestor.</p>
<p>During execution of the <code class="docutils literal"><span class="pre">CLUSTER_UPDATE_POLICY</span></code> action, Senlin engine
simply updates the binding record in the database and returns.</p>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="profile.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Profiles"></i></a>
          
          
            <a href="node.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Nodes"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: None</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Options</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/basics.html">Senlin Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/policies.html">Working with Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/receivers.html">Working with Receivers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/profile_types.html">Profile Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/profiles.html">Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/clusters.html">Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/membership.html">Cluster Membership</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types.html">Policy Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policies.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/bindings.html">Cluster-Policy Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/receivers.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/affinity.html">Affinity Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/deletion.html">Deletion Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/load_balancing.html">Load-Balancing Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/scaling.html">Scaling Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/region_placement.html">Region Placement Policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/policy_types/zone_placement.html">Zone Placement Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/affinity.html">Managing Node Affinity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_overview.html">Support to AutoScaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_ceilometer.html">Autoscaling using Ceilometer/Aodh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scenarios/autoscaling_heat.html">Autoscaling with Heat</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_microversion.html">API Microversioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="authorization.html">Senlin Authorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">Profiles</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Clusters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cluster-statuses">Cluster Statuses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-cluster">Creating A Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#listing-clusters">Listing Clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-a-cluster">Getting a Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-a-cluster">Updating A Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cluster-actions">Cluster Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cluster-policy-bindings">Cluster Policy Bindings</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="node.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy.html">Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="action.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="receiver.html">Receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Senlin testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin_guide.html">Plugin Writer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="osprofiler.html">OSProfiler</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="policies/affinity_v1.html">Affinity Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/deletion_v1.html">Deletion Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/health_v1.html">Health Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/load_balance_v1.html">Load Balancing Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/region_v1.html">Region Placement Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/scaling_v1.html">Scaling Policy V1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies/zone_v1.html">Zone Placement Policy V1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reviews.html">Reviews</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../man/index.html">Man Pages</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "developer/cluster" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/senlin/tree/doc/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 'Tue Feb 14 14:27:25 2017, commit e2451a7";
        var bugProject = "senlin";
        var bugTitle = "Clusters in senlin";
    var fieldTags = "docs";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 3.0.0.0rc2.dev62 on None";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>