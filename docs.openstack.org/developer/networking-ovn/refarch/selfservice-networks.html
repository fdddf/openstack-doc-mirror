<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Self-service networks &mdash; networking-ovn 2.0.0.0rc2.dev13 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0.0rc2.dev13',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="networking-ovn 2.0.0.0rc2.dev13 documentation" href="../index.html" />
    <link rel="up" title="Reference architecture" href="refarch.html" />
    <link rel="next" title="Routers" href="routers.html" />
    <link rel="prev" title="Provider networks" href="provider-networks.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="self-service-networks">
<span id="refarch-selfservice-networks"></span><h1>Self-service networks<a class="headerlink" href="#self-service-networks" title="Permalink to this headline">¶</a></h1>
<p>A self-service (project) network includes only virtual components, thus
enabling projects to manage them without additional configuration of the
underlying physical network. The OVN mechanism driver supports Geneve
and VLAN network types with a preference toward Geneve. Projects can
choose to isolate self-service networks, connect two or more together
via routers, or connect them to provider networks via routers with
appropriate capabilities. Similar to provider networks, self-service
networks can use arbitrary names.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Similar to provider networks, self-service VLAN networks map to a
unique bridge on each compute node that supports launching instances
on those networks. Self-service VLAN networks also require several
commands at the host and OVS levels. The following example assumes
use of Geneve self-service networks.</p>
</div>
<div class="section" id="create-a-self-service-network">
<h2>Create a self-service network<a class="headerlink" href="#create-a-self-service-network" title="Permalink to this headline">¶</a></h2>
<p>Creating a self-service network involves several commands at the
Networking service level that yield a series of operations at the OVN
level to create the virtual network components. The following example
creates a Geneve self-service network and binds a subnet to it. The
subnet uses DHCP to distribute IP addresses to instances.</p>
<ol class="arabic">
<li><p class="first">On the controller node, source the credentials for a regular
(non-privileged) project. The following example uses the <code class="docutils literal"><span class="pre">demo</span></code>
project.</p>
</li>
<li><p class="first">On the controller node, create a self-service network in the Networking
service.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network create selfservice
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| Field                   | Value                                |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| admin_state_up          | UP                                   |</span>
<span class="go">| availability_zone_hints |                                      |</span>
<span class="go">| availability_zones      |                                      |</span>
<span class="go">| created_at              | 2016-06-09T15:42:41                  |</span>
<span class="go">| description             |                                      |</span>
<span class="go">| id                      | f49791f7-e653-4b43-99b1-0f5557c313e4 |</span>
<span class="go">| ipv4_address_scope      | None                                 |</span>
<span class="go">| ipv6_address_scope      | None                                 |</span>
<span class="go">| mtu                     | 1442                                 |</span>
<span class="go">| name                    | selfservice                          |</span>
<span class="go">| port_security_enabled   | True                                 |</span>
<span class="go">| project_id              | 1ef26f483b9d44e8ac0c97388d6cb609     |</span>
<span class="go">| router_external         | Internal                             |</span>
<span class="go">| shared                  | False                                |</span>
<span class="go">| status                  | ACTIVE                               |</span>
<span class="go">| subnets                 |                                      |</span>
<span class="go">| tags                    | []                                   |</span>
<span class="go">| updated_at              | 2016-06-09T15:42:41                  |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
</ol>
<div class="section" id="ovn-operations">
<h3>OVN operations<a class="headerlink" href="#ovn-operations" title="Permalink to this headline">¶</a></h3>
<p>The OVN mechanism driver and OVN perform the following operations
during creation of a self-service network.</p>
<ol class="arabic">
<li><p class="first">The mechanism driver translates the network into a logical switch in
the OVN northbound database.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">uuid               : 0ab40684-7cf8-4d6c-ae8b-9d9143762d37</span>
<span class="go">acls                : []</span>
<span class="go">external_ids        : {&quot;neutron:network_name&quot;=&quot;selfservice&quot;}</span>
<span class="go">name                : &quot;neutron-d5aadceb-d8d6-41c8-9252-c5e0fe6c26a5&quot;</span>
<span class="go">ports               : []</span>
</pre></div>
</div>
</li>
<li><p class="first">The OVN northbound service translates this object into new datapath
bindings and logical flows in the OVN southbound database.</p>
<ul>
<li><p class="first">Datapath bindings</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">_uuid               : 0b214af6-8910-489c-926a-fd0ed16a8251</span>
<span class="go">external_ids        : {logical-switch=&quot;15e2c80b-1461-4003-9869-80416cd97de5&quot;}</span>
<span class="go">tunnel_key          : 5</span>
</pre></div>
</div>
</li>
<li><p class="first">Logical flows</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Datapath: 0b214af6-8910-489c-926a-fd0ed16a8251  Pipeline: ingress</span>
<span class="go">  table= 0(  ls_in_port_sec_l2), priority=  100, match=(eth.src[40]),</span>
<span class="go">    action=(drop;)</span>
<span class="go">  table= 0(  ls_in_port_sec_l2), priority=  100, match=(vlan.present),</span>
<span class="go">    action=(drop;)</span>
<span class="go">  table= 1(  ls_in_port_sec_ip), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 2(  ls_in_port_sec_nd), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 3(      ls_in_pre_acl), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 4(       ls_in_pre_lb), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 5( ls_in_pre_stateful), priority=  100, match=(reg0[0] == 1),</span>
<span class="go">    action=(ct_next;)</span>
<span class="go">  table= 5( ls_in_pre_stateful), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 6(          ls_in_acl), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 7(           ls_in_lb), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 8(     ls_in_stateful), priority=  100, match=(reg0[2] == 1),</span>
<span class="go">    action=(ct_lb;)</span>
<span class="go">  table= 8(     ls_in_stateful), priority=  100, match=(reg0[1] == 1),</span>
<span class="go">    action=(ct_commit; next;)</span>
<span class="go">  table= 8(     ls_in_stateful), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 9(      ls_in_arp_rsp), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table=10(      ls_in_l2_lkup), priority=  100, match=(eth.mcast),</span>
<span class="go">    action=(outport = &quot;_MC_flood&quot;; output;)</span>
<span class="go">Datapath: 0b214af6-8910-489c-926a-fd0ed16a8251  Pipeline: egress</span>
<span class="go">  table= 0(      ls_out_pre_lb), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 1(     ls_out_pre_acl), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 2(ls_out_pre_stateful), priority=  100, match=(reg0[0] == 1),</span>
<span class="go">    action=(ct_next;)</span>
<span class="go">  table= 2(ls_out_pre_stateful), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 3(          ls_out_lb), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 4(         ls_out_acl), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 5(    ls_out_stateful), priority=  100, match=(reg0[1] == 1),</span>
<span class="go">    action=(ct_commit; next;)</span>
<span class="go">  table= 5(    ls_out_stateful), priority=  100, match=(reg0[2] == 1),</span>
<span class="go">    action=(ct_lb;)</span>
<span class="go">  table= 5(    ls_out_stateful), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 6( ls_out_port_sec_ip), priority=    0, match=(1),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 7( ls_out_port_sec_l2), priority=  100, match=(eth.mcast),</span>
<span class="go">    action=(output;)</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These actions do not create flows on any nodes.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="create-a-subnet-on-the-self-service-network">
<h2>Create a subnet on the self-service network<a class="headerlink" href="#create-a-subnet-on-the-self-service-network" title="Permalink to this headline">¶</a></h2>
<p>A self-service network requires at least one subnet. In most cases,
the environment provides suitable values for IP address allocation for
instances, default gateway IP address, and metadata such as name
resolution.</p>
<ol class="arabic">
<li><p class="first">On the controller node, create a subnet bound to the self-service network
<code class="docutils literal"><span class="pre">selfservice</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack subnet create --network selfservice --subnet-range <span class="m">192</span>.168.1.0/24 selfservice-v4
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| allocation_pools  | 192.168.1.2-192.168.1.254            |</span>
<span class="go">| cidr              | 192.168.1.0/24                       |</span>
<span class="go">| created_at        | 2016-06-16 00:19:08+00:00            |</span>
<span class="go">| description       |                                      |</span>
<span class="go">| dns_nameservers   |                                      |</span>
<span class="go">| enable_dhcp       | True                                 |</span>
<span class="go">| gateway_ip        | 192.168.1.1                          |</span>
<span class="go">| headers           |                                      |</span>
<span class="go">| host_routes       |                                      |</span>
<span class="go">| id                | 8f027f25-0112-45b9-a1b9-2f8097c57219 |</span>
<span class="go">| ip_version        | 4                                    |</span>
<span class="go">| ipv6_address_mode | None                                 |</span>
<span class="go">| ipv6_ra_mode      | None                                 |</span>
<span class="go">| name              | selfservice-v4                       |</span>
<span class="go">| network_id        | 8ed4e43b-63ef-41ed-808b-b59f1120aec0 |</span>
<span class="go">| project_id        | b1ebf33664df402693f729090cfab861     |</span>
<span class="go">| subnetpool_id     | None                                 |</span>
<span class="go">| updated_at        | 2016-06-16 00:19:08+00:00            |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
</ol>
<p>If using DHCP to manage instance IP addresses, adding a subnet causes a series
of operations in the Networking service and OVN.</p>
<ul class="simple">
<li>The Networking service schedules the network on appropriate number of DHCP
agents. The example environment contains three DHCP agents.</li>
<li>Each DHCP agent spawns a network namespace with a <code class="docutils literal"><span class="pre">dnsmasq</span></code> process using
an IP address from the subnet allocation.</li>
<li>The OVN mechanism driver creates a logical switch port object in the OVN
northbound database for each <code class="docutils literal"><span class="pre">dnsmasq</span></code> process.</li>
</ul>
<div class="section" id="id1">
<h3>OVN operations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The OVN mechanism driver and OVN perform the following operations
during creation of a subnet on a self-service network.</p>
<ol class="arabic">
<li><p class="first">If the subnet uses DHCP for IP address management, create logical ports
ports for each DHCP agent serving the subnet and bind them to the logical
switch. In this example, the subnet contains two DHCP agents.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">_uuid               : 1ed7c28b-dc69-42b8-bed6-46477bb8b539</span>
<span class="go">addresses           : [&quot;fa:16:3e:94:db:5e 192.168.1.2&quot;]</span>
<span class="go">enabled             : true</span>
<span class="go">external_ids        : {&quot;neutron:port_name&quot;=&quot;&quot;}</span>
<span class="go">name                : &quot;0cfbbdca-ff58-4cf8-a7d3-77daaebe3056&quot;</span>
<span class="go">options             : {}</span>
<span class="go">parent_name         : []</span>
<span class="go">port_security       : []</span>
<span class="go">tag                 : []</span>
<span class="go">type                : &quot;&quot;</span>
<span class="go">up                  : true</span>

<span class="go">_uuid               : ae10a5e0-db25-4108-b06a-d2d5c127d9c4</span>
<span class="go">addresses           : [&quot;fa:16:3e:90:bd:f1 192.168.1.3&quot;]</span>
<span class="go">enabled             : true</span>
<span class="go">external_ids        : {&quot;neutron:port_name&quot;=&quot;&quot;}</span>
<span class="go">name                : &quot;74930ace-d939-4bca-b577-fccba24c3fca&quot;</span>
<span class="go">options             : {}</span>
<span class="go">parent_name         : []</span>
<span class="go">port_security       : []</span>
<span class="go">tag                 : []</span>
<span class="go">type                : &quot;&quot;</span>
<span class="go">up                  : true</span>

<span class="go">_uuid               : 0ab40684-7cf8-4d6c-ae8b-9d9143762d37</span>
<span class="go">acls                : []</span>
<span class="go">external_ids        : {&quot;neutron:network_name&quot;=&quot;selfservice&quot;}</span>
<span class="go">name                : &quot;neutron-d5aadceb-d8d6-41c8-9252-c5e0fe6c26a5&quot;</span>
<span class="go">ports               : [1ed7c28b-dc69-42b8-bed6-46477bb8b539,</span>
<span class="go">                      ae10a5e0-db25-4108-b06a-d2d5c127d9c4]</span>
</pre></div>
</div>
</li>
<li><p class="first">The OVN northbound service creates port bindings for these logical
ports and adds them to the appropriate multicast group.</p>
<ul>
<li><p class="first">Port bindings</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">_uuid               : 3e463ca0-951c-46fd-b6cf-05392fa3aa1f</span>
<span class="go">chassis             : 6a9d0619-8818-41e6-abef-2f3d9a597c03</span>
<span class="go">datapath            : 0b214af6-8910-489c-926a-fd0ed16a8251</span>
<span class="go">logical_port        : &quot;a203b410-97c1-4e4a-b0c3-558a10841c16&quot;</span>
<span class="go">mac                 : [&quot;fa:16:3e:a1:dc:58 192.168.1.3&quot;]</span>
<span class="go">options             : {}</span>
<span class="go">parent_port         : []</span>
<span class="go">tag                 : []</span>
<span class="go">tunnel_key          : 2</span>
<span class="go">type                : &quot;&quot;</span>

<span class="go">_uuid               : fa7b294d-2a62-45ae-8de3-a41c002de6de</span>
<span class="go">chassis             : d63e8ae8-caf3-4a6b-9840-5c3a57febcac</span>
<span class="go">datapath            : 0b214af6-8910-489c-926a-fd0ed16a8251</span>
<span class="go">logical_port        : &quot;39b23721-46f4-4747-af54-7e12f22b3397&quot;</span>
<span class="go">mac                 : [&quot;fa:16:3e:1a:b4:23 192.168.1.2&quot;]</span>
<span class="go">options             : {}</span>
<span class="go">parent_port         : []</span>
<span class="go">tag                 : []</span>
<span class="go">tunnel_key          : 1</span>
<span class="go">type                : &quot;&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Multicast groups</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">_uuid               : c08d0102-c414-4a47-98d9-dd3fa9f9901c</span>
<span class="go">datapath            : 0b214af6-8910-489c-926a-fd0ed16a8251</span>
<span class="go">name                : _MC_flood</span>
<span class="go">ports               : [3e463ca0-951c-46fd-b6cf-05392fa3aa1f,</span>
<span class="go">                       fa7b294d-2a62-45ae-8de3-a41c002de6de]</span>
<span class="go">tunnel_key          : 65535</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">The OVN northbound service translates the logical ports into logical flows
in the OVN southbound database.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Datapath: 0b214af6-8910-489c-926a-fd0ed16a8251  Pipeline: ingress</span>
<span class="go">  table= 0(  ls_in_port_sec_l2), priority=   50,</span>
<span class="go">    match=(inport == &quot;39b23721-46f4-4747-af54-7e12f22b3397&quot;),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 0(  ls_in_port_sec_l2), priority=   50,</span>
<span class="go">    match=(inport == &quot;a203b410-97c1-4e4a-b0c3-558a10841c16&quot;),</span>
<span class="go">    action=(next;)</span>
<span class="go">  table= 9(      ls_in_arp_rsp), priority=   50,</span>
<span class="go">    match=(arp.tpa == 192.168.1.2 &amp;&amp; arp.op == 1),</span>
<span class="go">    action=(eth.dst = eth.src; eth.src = fa:16:3e:1a:b4:23;</span>
<span class="go">            arp.op = 2; /* ARP reply */ arp.tha = arp.sha;</span>
<span class="go">            arp.sha = fa:16:3e:1a:b4:23; arp.tpa = arp.spa;</span>
<span class="go">            arp.spa = 192.168.1.2; outport = inport;</span>
<span class="go">            inport = &quot;&quot;; /* Allow sending out inport. */ output;)</span>
<span class="go">  table= 9(      ls_in_arp_rsp), priority=   50,</span>
<span class="go">    match=(arp.tpa == 192.168.1.3 &amp;&amp; arp.op == 1),</span>
<span class="go">    action=(eth.dst = eth.src; eth.src = fa:16:3e:a1:dc:58;</span>
<span class="go">            arp.op = 2; /* ARP reply */ arp.tha = arp.sha;</span>
<span class="go">            arp.sha = fa:16:3e:a1:dc:58; arp.tpa = arp.spa;</span>
<span class="go">            arp.spa = 192.168.1.3; outport = inport;</span>
<span class="go">            inport = &quot;&quot;; /* Allow sending out inport. */ output;)</span>
<span class="go">  table=10(      ls_in_l2_lkup), priority=   50,</span>
<span class="go">    match=(eth.dst == fa:16:3e:a1:dc:58),</span>
<span class="go">    action=(outport = &quot;a203b410-97c1-4e4a-b0c3-558a10841c16&quot;; output;)</span>
<span class="go">  table=10(      ls_in_l2_lkup), priority=   50,</span>
<span class="go">    match=(eth.dst == fa:16:3e:1a:b4:23),</span>
<span class="go">    action=(outport = &quot;39b23721-46f4-4747-af54-7e12f22b3397&quot;; output;)</span>
<span class="go">Datapath: 0b214af6-8910-489c-926a-fd0ed16a8251  Pipeline: egress</span>
<span class="go">  table= 7( ls_out_port_sec_l2), priority=   50,</span>
<span class="go">    match=(outport == &quot;39b23721-46f4-4747-af54-7e12f22b3397&quot;),</span>
<span class="go">    action=(output;)</span>
<span class="go">  table= 7( ls_out_port_sec_l2), priority=   50,</span>
<span class="go">    match=(outport == &quot;a203b410-97c1-4e4a-b0c3-558a10841c16&quot;),</span>
<span class="go">    action=(output;)</span>
</pre></div>
</div>
</li>
<li><p class="first">For each compute node without a DHCP agent on the subnet:</p>
<ul>
<li><p class="first">The OVN controller service translates these objects into flows on the
integration bridge <code class="docutils literal"><span class="pre">br-int</span></code>.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ovs-ofctl dump-flows br-int
<span class="go">cookie=0x0, duration=9.054s, table=32, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=9, priority=100,reg7=0xffff,metadata=0x5</span>
<span class="go">    actions=load:0x5-&gt;NXM_NX_TUN_ID[0..23],</span>
<span class="go">        set_field:0xffff/0xffffffff-&gt;tun_metadata0,</span>
<span class="go">        move:NXM_NX_REG6[0..14]-&gt;NXM_NX_TUN_METADATA0[16..30],</span>
<span class="go">        output:4,output:3</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">For each compute node with a DHCP agent on the subnet:</p>
<ul>
<li><p class="first">Creation of a DHCP network namespace adds a virtual switch ports that
connects the DHCP agent with the <code class="docutils literal"><span class="pre">dnsmasq</span></code> process to the integration
bridge.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ovs-ofctl show br-int
<span class="go">OFPT_FEATURES_REPLY (xid=0x2): dpid:000022024a1dc045</span>
<span class="go">n_tables:254, n_buffers:256</span>
<span class="go">capabilities: FLOW_STATS TABLE_STATS PORT_STATS QUEUE_STATS ARP_MATCH_IP</span>
<span class="go">actions: output enqueue set_vlan_vid set_vlan_pcp strip_vlan mod_dl_src mod_dl_dst mod_nw_src mod_nw_dst mod_nw_tos mod_tp_src mod_tp_dst</span>
<span class="go"> 9(tap39b23721-46): addr:00:00:00:00:b0:5d</span>
<span class="go">     config:     PORT_DOWN</span>
<span class="go">     state:      LINK_DOWN</span>
<span class="go">     speed: 0 Mbps now, 0 Mbps max</span>
</pre></div>
</div>
</li>
<li><p class="first">The OVN controller service translates these objects into flows on the
integration bridge.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cookie=0x0, duration=21.074s, table=0, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=100,in_port=9</span>
<span class="go">    actions=load:0x2-&gt;NXM_NX_REG5[],load:0x5-&gt;OXM_OF_METADATA[],</span>
<span class="go">        load:0x1-&gt;NXM_NX_REG6[],resubmit(,16)</span>
<span class="go">cookie=0x0, duration=21.076s, table=16, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=21, priority=100,metadata=0x5,</span>
<span class="go">        dl_src=01:00:00:00:00:00/01:00:00:00:00:00</span>
<span class="go">    actions=drop</span>
<span class="go">cookie=0x0, duration=21.075s, table=16, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=21, priority=100,metadata=0x5,vlan_tci=0x1000/0x1000</span>
<span class="go">    actions=drop</span>
<span class="go">cookie=0x0, duration=21.076s, table=16, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=21, priority=50,reg6=0x2,metadata=0x5</span>
<span class="go">    actions=resubmit(,17)</span>
<span class="go">cookie=0x0, duration=21.075s, table=16, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=50,reg6=0x1,metadata=0x5</span>
<span class="go">    actions=resubmit(,17)</span>
<span class="go">cookie=0x0, duration=21.075s, table=17, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,18)</span>
<span class="go">cookie=0x0, duration=21.076s, table=18, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,19)</span>
<span class="go">cookie=0x0, duration=21.076s, table=19, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,20)</span>
<span class="go">cookie=0x0, duration=21.075s, table=20, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,21)</span>
<span class="go">cookie=0x0, duration=5.398s, table=21, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x1/0x1,metadata=0x5</span>
<span class="go">    actions=ct(table=22,zone=NXM_NX_REG5[0..15])</span>
<span class="go">cookie=0x0, duration=5.398s, table=21, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x1/0x1,metadata=0x5</span>
<span class="go">    actions=ct(table=22,zone=NXM_NX_REG5[0..15])</span>
<span class="go">cookie=0x0, duration=5.398s, table=22, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=2, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,23)</span>
<span class="go">cookie=0x0, duration=5.398s, table=23, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=2, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,24)</span>
<span class="go">cookie=0x0, duration=5.398s, table=24, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x4/0x4,metadata=0x5</span>
<span class="go">    actions=ct(table=25,zone=NXM_NX_REG5[0..15],nat)</span>
<span class="go">cookie=0x0, duration=5.398s, table=24, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x4/0x4,metadata=0x5</span>
<span class="go">    actions=ct(table=25,zone=NXM_NX_REG5[0..15],nat)</span>
<span class="go">cookie=0x0, duration=5.398s, table=24, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x2/0x2,metadata=0x5</span>
<span class="go">    actions=ct(commit,zone=NXM_NX_REG5[0..15]),resubmit(,25)</span>
<span class="go">cookie=0x0, duration=5.398s, table=24, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x2/0x2,metadata=0x5</span>
<span class="go">    actions=ct(commit,zone=NXM_NX_REG5[0..15]),resubmit(,25)</span>
<span class="go">cookie=0x0, duration=5.399s, table=24, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=2, priority=0,metadata=0x5 actions=resubmit(,25)</span>
<span class="go">cookie=0x0, duration=5.398s, table=25, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,arp,metadata=0x5,</span>
<span class="go">        arp_tpa=192.168.1.2,arp_op=1</span>
<span class="go">    actions=move:NXM_OF_ETH_SRC[]-&gt;NXM_OF_ETH_DST[],</span>
<span class="go">        mod_dl_src:fa:16:3e:82:8b:0e,load:0x2-&gt;NXM_OF_ARP_OP[],</span>
<span class="go">        move:NXM_NX_ARP_SHA[]-&gt;NXM_NX_ARP_THA[],</span>
<span class="go">        load:0xfa163e828b0e-&gt;NXM_NX_ARP_SHA[],</span>
<span class="go">        move:NXM_OF_ARP_SPA[]-&gt;NXM_OF_ARP_TPA[],</span>
<span class="go">        load:0xc0a80102-&gt;NXM_OF_ARP_SPA[],</span>
<span class="go">        move:NXM_NX_REG6[]-&gt;NXM_NX_REG7[],load:0-&gt;NXM_NX_REG6[],</span>
<span class="go">        load:0-&gt;NXM_OF_IN_PORT[],resubmit(,32)</span>
<span class="go">cookie=0x0, duration=5.378s, table=25, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,arp,metadata=0x5,arp_tpa=192.168.1.3,</span>
<span class="go">        arp_op=1</span>
<span class="go">    actions=move:NXM_OF_ETH_SRC[]-&gt;NXM_OF_ETH_DST[],</span>
<span class="go">        mod_dl_src:fa:16:3e:d5:00:02,load:0x2-&gt;NXM_OF_ARP_OP[],</span>
<span class="go">        move:NXM_NX_ARP_SHA[]-&gt;NXM_NX_ARP_THA[],</span>
<span class="go">        load:0xfa163ed50002-&gt;NXM_NX_ARP_SHA[],</span>
<span class="go">        move:NXM_OF_ARP_SPA[]-&gt;NXM_OF_ARP_TPA[],</span>
<span class="go">        load:0xc0a80103-&gt;NXM_OF_ARP_SPA[],</span>
<span class="go">        move:NXM_NX_REG6[]-&gt;NXM_NX_REG7[],load:0-&gt;NXM_NX_REG6[],</span>
<span class="go">        load:0-&gt;NXM_OF_IN_PORT[],resubmit(,32)</span>
<span class="go">cookie=0x0, duration=5.399s, table=25, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=2, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,26)</span>
<span class="go">cookie=0x0, duration=5.399s, table=26, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=2, priority=100,metadata=0x5,</span>
<span class="go">        dl_dst=01:00:00:00:00:00/01:00:00:00:00:00</span>
<span class="go">    actions=load:0xffff-&gt;NXM_NX_REG7[],resubmit(,32)</span>
<span class="go">cookie=0x0, duration=5.398s, table=26, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,metadata=0x5,dl_dst=fa:16:3e:d5:00:02</span>
<span class="go">    actions=load:0x2-&gt;NXM_NX_REG7[],resubmit(,32)</span>
<span class="go">cookie=0x0, duration=5.398s, table=26, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,metadata=0x5,dl_dst=fa:16:3e:82:8b:0e</span>
<span class="go">    actions=load:0x1-&gt;NXM_NX_REG7[],resubmit(,32)</span>
<span class="go">cookie=0x0, duration=21.038s, table=32, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=21, priority=100,reg7=0x2,metadata=0x5</span>
<span class="go">    actions=load:0x5-&gt;NXM_NX_TUN_ID[0..23],</span>
<span class="go">        set_field:0x2/0xffffffff-&gt;tun_metadata0,</span>
<span class="go">        move:NXM_NX_REG6[0..14]-&gt;NXM_NX_TUN_METADATA0[16..30],output:4</span>
<span class="go">cookie=0x0, duration=21.038s, table=32, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=100,reg7=0xffff,metadata=0x5</span>
<span class="go">    actions=load:0x5-&gt;NXM_NX_TUN_ID[0..23],</span>
<span class="go">        set_field:0xffff/0xffffffff-&gt;tun_metadata0,</span>
<span class="go">        move:NXM_NX_REG6[0..14]-&gt;NXM_NX_TUN_METADATA0[16..30],</span>
<span class="go">        output:4,resubmit(,33)</span>
<span class="go">cookie=0x0, duration=5.397s, table=33, n_packets=12, n_bytes=1016,</span>
<span class="go">    idle_age=2, priority=100,reg7=0xffff,metadata=0x5</span>
<span class="go">    actions=load:0x1-&gt;NXM_NX_REG7[],resubmit(,34),</span>
<span class="go">       load:0xffff-&gt;NXM_NX_REG7[]</span>
<span class="go">cookie=0x0, duration=5.397s, table=33, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,reg7=0x1,metadata=0x5</span>
<span class="go">    actions=resubmit(,34)</span>
<span class="go">cookie=0x0, duration=21.074s, table=34, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=100,reg6=0x1,reg7=0x1,metadata=0x5</span>
<span class="go">    actions=drop</span>
<span class="go">cookie=0x0, duration=21.076s, table=48, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5 actions=resubmit(,49)</span>
<span class="go">cookie=0x0, duration=21.075s, table=49, n_packets=8, n_bytes=648,</span>
<span class="go">    idle_age=11, priority=0,metadata=0x5 actions=resubmit(,50)</span>
<span class="go">cookie=0x0, duration=5.398s, table=50, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x1/0x1,metadata=0x5</span>
<span class="go">    actions=ct(table=51,zone=NXM_NX_REG5[0..15])</span>
<span class="go">cookie=0x0, duration=5.398s, table=50, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x1/0x1,metadata=0x5</span>
<span class="go">    actions=ct(table=51,zone=NXM_NX_REG5[0..15])</span>
<span class="go">cookie=0x0, duration=5.398s, table=50, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,51)</span>
<span class="go">cookie=0x0, duration=5.398s, table=51, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,52)</span>
<span class="go">cookie=0x0, duration=5.398s, table=52, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,53)</span>
<span class="go">cookie=0x0, duration=5.399s, table=53, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x4/0x4,metadata=0x5</span>
<span class="go">    actions=ct(table=54,zone=NXM_NX_REG5[0..15],nat)</span>
<span class="go">cookie=0x0, duration=5.398s, table=53, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x4/0x4,metadata=0x5</span>
<span class="go">    actions=ct(table=54,zone=NXM_NX_REG5[0..15],nat)</span>
<span class="go">cookie=0x0, duration=5.398s, table=53, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ip,reg0=0x2/0x2,metadata=0x5</span>
<span class="go">    actions=ct(commit,zone=NXM_NX_REG5[0..15]),resubmit(,54)</span>
<span class="go">cookie=0x0, duration=5.398s, table=53, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=100,ipv6,reg0=0x2/0x2,metadata=0x5</span>
<span class="go">    actions=ct(commit,zone=NXM_NX_REG5[0..15]),resubmit(,54)</span>
<span class="go">cookie=0x0, duration=5.398s, table=53, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,54)</span>
<span class="go">cookie=0x0, duration=5.398s, table=54, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=0,metadata=0x5</span>
<span class="go">    actions=resubmit(,55)</span>
<span class="go">cookie=0x0, duration=5.398s, table=55, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=100,metadata=0x5,</span>
<span class="go">        dl_dst=01:00:00:00:00:00/01:00:00:00:00:00</span>
<span class="go">    actions=resubmit(,64)</span>
<span class="go">cookie=0x0, duration=5.398s, table=55, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,reg7=0x1,metadata=0x5</span>
<span class="go">    actions=resubmit(,64)</span>
<span class="go">cookie=0x0, duration=5.398s, table=55, n_packets=0, n_bytes=0,</span>
<span class="go">    idle_age=5, priority=50,reg7=0x2,metadata=0x5</span>
<span class="go">    actions=resubmit(,64)</span>
<span class="go">cookie=0x0, duration=5.397s, table=64, n_packets=6, n_bytes=508,</span>
<span class="go">    idle_age=3, priority=100,reg7=0x1,metadata=0x5</span>
<span class="go">    actions=output:9</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Self-service networks</a><ul>
<li><a class="reference internal" href="#create-a-self-service-network">Create a self-service network</a><ul>
<li><a class="reference internal" href="#ovn-operations">OVN operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#create-a-subnet-on-the-self-service-network">Create a subnet on the self-service network</a><ul>
<li><a class="reference internal" href="#id1">OVN operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="provider-networks.html"
                                  title="previous chapter">Provider networks</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="routers.html"
                                  title="next chapter">Routers</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/networking-ovn
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/refarch/selfservice-networks.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="routers.html" title="Routers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="provider-networks.html" title="Provider networks"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">networking-ovn 2.0.0.0rc2.dev13 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="refarch.html" accesskey="U">Reference architecture</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/networking-ovn");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>