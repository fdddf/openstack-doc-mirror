<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>glance.image_cache.drivers package &mdash; glance 14.0.0.0rc2.dev4 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '14.0.0.0rc2.dev4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="glance 14.0.0.0rc2.dev4 documentation" href="../index.html" />
    <link rel="up" title="glance.image_cache package" href="glance.image_cache.html" />
    <link rel="next" title="glance.quota package" href="glance.quota.html" />
    <link rel="prev" title="glance.image_cache package" href="glance.image_cache.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="glance-image-cache-drivers-package">
<h1>glance.image_cache.drivers package<a class="headerlink" href="#glance-image-cache-drivers-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-glance.image_cache.drivers.base">
<span id="glance-image-cache-drivers-base-module"></span><h2>glance.image_cache.drivers.base module<a class="headerlink" href="#module-glance.image_cache.drivers.base" title="Permalink to this headline">¶</a></h2>
<p>Base attribute driver class</p>
<dl class="class">
<dt id="glance.image_cache.drivers.base.Driver">
<em class="property">class </em><code class="descclassname">glance.image_cache.drivers.base.</code><code class="descname">Driver</code><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><em>stall_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Dependent on the driver, clean up and destroy any invalid or incomplete
cached images</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.configure">
<code class="descname">configure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the driver to use the stored configuration options
Any store that needs special configuration should implement
this method. If the store was not able to successfully configure
itself, it should raise <cite>exception.BadDriverConfiguration</cite></p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.delete_all_cached_images">
<code class="descname">delete_all_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.delete_all_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.delete_all_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all cached image files and any attributes about the images
and returns the number of cached image files that were deleted.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.delete_all_queued_images">
<code class="descname">delete_all_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.delete_all_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.delete_all_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all queued image files and any attributes about the images
and returns the number of queued image files that were deleted.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.delete_cached_image">
<code class="descname">delete_cached_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.delete_cached_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.delete_cached_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific cached image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.delete_queued_image">
<code class="descname">delete_queued_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.delete_queued_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.delete_queued_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific queued image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_cache_size">
<code class="descname">get_cache_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_cache_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_cache_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total size in bytes of the image cache.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_cached_images">
<code class="descname">get_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of records about cached images.</p>
<p>The list of records shall be ordered by image ID and shall look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[
    {
    &#39;image_id&#39;: &lt;IMAGE_ID&gt;,
    &#39;hits&#39;: INTEGER,
    &#39;last_modified&#39;: ISO_TIMESTAMP,
    &#39;last_accessed&#39;: ISO_TIMESTAMP,
    &#39;size&#39;: INTEGER
    }, ...
]
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_image_filepath">
<code class="descname">get_image_filepath</code><span class="sig-paren">(</span><em>image_id</em>, <em>cache_status='active'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_image_filepath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_image_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>This crafts an absolute path to a specific entry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image_id</strong> &#8211; Image ID</li>
<li><strong>cache_status</strong> &#8211; Status of the image in the cache</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_image_size">
<code class="descname">get_image_size</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_image_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of the image file for an image with supplied
identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_least_recently_accessed">
<code class="descname">get_least_recently_accessed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_least_recently_accessed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_least_recently_accessed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the image_id and size of the least recently
accessed cached file, or None if no cached files.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.get_queued_images">
<code class="descname">get_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.get_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.get_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of image IDs that are in the queue. The
list should be sorted by the time the image ID was inserted
into the queue.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.is_cacheable">
<code class="descname">is_cacheable</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.is_cacheable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.is_cacheable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID can have its
image file cached, False otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.is_cached">
<code class="descname">is_cached</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.is_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.is_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID has its image
file cached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.is_queued">
<code class="descname">is_queued</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.is_queued"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.is_queued" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image identifier is in our cache queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.open_for_read">
<code class="descname">open_for_read</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.open_for_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.open_for_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Open and yield file for reading the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.open_for_write">
<code class="descname">open_for_write</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.open_for_write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.open_for_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a file for writing the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.queue_image">
<code class="descname">queue_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.queue_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.queue_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Puts an image identifier in a queue for caching. Return True
on successful add to the queue, False otherwise...</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.base.Driver.set_paths">
<code class="descname">set_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/base.html#Driver.set_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.base.Driver.set_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates all necessary directories under the base cache directory</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-glance.image_cache.drivers.sqlite">
<span id="glance-image-cache-drivers-sqlite-module"></span><h2>glance.image_cache.drivers.sqlite module<a class="headerlink" href="#module-glance.image_cache.drivers.sqlite" title="Permalink to this headline">¶</a></h2>
<p>Cache driver that uses SQLite to store information about cached images</p>
<dl class="class">
<dt id="glance.image_cache.drivers.sqlite.Driver">
<em class="property">class </em><code class="descclassname">glance.image_cache.drivers.sqlite.</code><code class="descname">Driver</code><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#glance.image_cache.drivers.base.Driver" title="glance.image_cache.drivers.base.Driver"><code class="xref py py-class docutils literal"><span class="pre">glance.image_cache.drivers.base.Driver</span></code></a></p>
<p>Cache driver that uses xattr file tags and requires a filesystem
that has atimes set.</p>
<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><em>stall_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete any image files in the invalid directory and any
files in the incomplete directory that are older than a
configurable amount of time.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.configure">
<code class="descname">configure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the driver to use the stored configuration options
Any store that needs special configuration should implement
this method. If the store was not able to successfully configure
itself, it should raise <cite>exception.BadDriverConfiguration</cite></p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_all_cached_images">
<code class="descname">delete_all_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_all_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_all_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all cached image files and any attributes about the images</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_all_queued_images">
<code class="descname">delete_all_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_all_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_all_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all queued image files and any attributes about the images</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_cached_image">
<code class="descname">delete_cached_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_cached_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_cached_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific cached image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_invalid_files">
<code class="descname">delete_invalid_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_invalid_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_invalid_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes any invalid cache entries</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_queued_image">
<code class="descname">delete_queued_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_queued_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_queued_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific queued image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.delete_stalled_files">
<code class="descname">delete_stalled_files</code><span class="sig-paren">(</span><em>older_than</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.delete_stalled_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.delete_stalled_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes any incomplete cache entries older than a
supplied modified time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>older_than</strong> &#8211; Files written to on or before this timestamp
will be deleted.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_cache_files">
<code class="descname">get_cache_files</code><span class="sig-paren">(</span><em>basepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_cache_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_cache_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cache files in the supplied directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>basepath</strong> &#8211; Directory to look in for cache files</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_cache_size">
<code class="descname">get_cache_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_cache_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_cache_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total size in bytes of the image cache.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_cached_images">
<code class="descname">get_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of records about cached images.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_db">
<code class="descname">get_db</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a context manager that produces a database connection that
self-closes and calls rollback if an error occurs while using the
database connection</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_hit_count">
<code class="descname">get_hit_count</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_hit_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_hit_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of hits that an image has.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Opaque image identifier</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_least_recently_accessed">
<code class="descname">get_least_recently_accessed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_least_recently_accessed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_least_recently_accessed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the image_id and size of the least recently
accessed cached file, or None if no cached files.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.get_queued_images">
<code class="descname">get_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.get_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.get_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of image IDs that are in the queue. The
list should be sorted by the time the image ID was inserted
into the queue.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.initialize_db">
<code class="descname">initialize_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.initialize_db"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.initialize_db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.is_being_cached">
<code class="descname">is_being_cached</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.is_being_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.is_being_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with supplied id is currently
in the process of having its image file cached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.is_cacheable">
<code class="descname">is_cacheable</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.is_cacheable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.is_cacheable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID can have its
image file cached, False otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.is_cached">
<code class="descname">is_cached</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.is_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.is_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID has its image
file cached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.is_queued">
<code class="descname">is_queued</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.is_queued"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.is_queued" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image identifier is in our cache queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.open_for_read">
<code class="descname">open_for_read</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.open_for_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.open_for_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Open and yield file for reading the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.open_for_write">
<code class="descname">open_for_write</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.open_for_write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.open_for_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a file for writing the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.Driver.queue_image">
<code class="descname">queue_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#Driver.queue_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.Driver.queue_image" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds a image to be cache to the queue.</p>
<p>If the image already exists in the queue or has already been
cached, we return False, True otherwise</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="glance.image_cache.drivers.sqlite.SqliteConnection">
<em class="property">class </em><code class="descclassname">glance.image_cache.drivers.sqlite.</code><code class="descname">SqliteConnection</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#SqliteConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.SqliteConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">sqlite3.Connection</span></code></p>
<p>SQLite DB Connection handler that plays well with eventlet,
slightly modified from Swift&#8217;s similar code.</p>
<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.SqliteConnection.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#SqliteConnection.commit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.SqliteConnection.commit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.sqlite.SqliteConnection.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#SqliteConnection.execute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.SqliteConnection.execute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.sqlite.delete_cached_file">
<code class="descclassname">glance.image_cache.drivers.sqlite.</code><code class="descname">delete_cached_file</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#delete_cached_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.delete_cached_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.sqlite.dict_factory">
<code class="descclassname">glance.image_cache.drivers.sqlite.</code><code class="descname">dict_factory</code><span class="sig-paren">(</span><em>cur</em>, <em>row</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/sqlite.html#dict_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.sqlite.dict_factory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-glance.image_cache.drivers.xattr">
<span id="glance-image-cache-drivers-xattr-module"></span><h2>glance.image_cache.drivers.xattr module<a class="headerlink" href="#module-glance.image_cache.drivers.xattr" title="Permalink to this headline">¶</a></h2>
<p>Cache driver that uses xattr file tags and requires a filesystem
that has atimes set.</p>
<div class="section" id="assumptions">
<h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Cache data directory exists on a filesytem that updates atime on
reads (&#8216;noatime&#8217; should NOT be set)</p>
</li>
<li><p class="first">Cache data directory exists on a filesystem that supports xattrs.
This is optional, but highly recommended since it allows us to
present ops with useful information pertaining to the cache, like
human readable filenames and statistics.</p>
</li>
<li><dl class="first docutils">
<dt><cite>glance-prune</cite> is scheduled to run as a periodic job via cron. This</dt>
<dd><p class="first last">is needed to run the LRU prune strategy to keep the cache size
within the limits set by the config file.</p>
</dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="cache-directory-notes">
<h3>Cache Directory Notes<a class="headerlink" href="#cache-directory-notes" title="Permalink to this headline">¶</a></h3>
<p>The image cache data directory contains the main cache path, where the
active cache entries and subdirectories for handling partial downloads
and errored-out cache images.</p>
<p>The layout looks like:</p>
<dl class="docutils">
<dt>$image_cache_dir/</dt>
<dd>entry1
entry2
...
incomplete/
invalid/
queue/</dd>
</dl>
<dl class="class">
<dt id="glance.image_cache.drivers.xattr.Driver">
<em class="property">class </em><code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">Driver</code><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#glance.image_cache.drivers.base.Driver" title="glance.image_cache.drivers.base.Driver"><code class="xref py py-class docutils literal"><span class="pre">glance.image_cache.drivers.base.Driver</span></code></a></p>
<p>Cache driver that uses xattr file tags and requires a filesystem
that has atimes set.</p>
<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><em>stall_time=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete any image files in the invalid directory and any
files in the incomplete directory that are older than a
configurable amount of time.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.configure">
<code class="descname">configure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the driver to use the stored configuration options
Any store that needs special configuration should implement
this method. If the store was not able to successfully configure
itself, it should raise <cite>exception.BadDriverConfiguration</cite></p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.delete_all_cached_images">
<code class="descname">delete_all_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.delete_all_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.delete_all_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all cached image files and any attributes about the images</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.delete_all_queued_images">
<code class="descname">delete_all_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.delete_all_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.delete_all_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all queued image files and any attributes about the images</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.delete_cached_image">
<code class="descname">delete_cached_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.delete_cached_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.delete_cached_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific cached image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.delete_queued_image">
<code class="descname">delete_queued_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.delete_queued_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.delete_queued_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific queued image file and any attributes about the image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.get_cache_size">
<code class="descname">get_cache_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.get_cache_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.get_cache_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the total size in bytes of the image cache.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.get_cached_images">
<code class="descname">get_cached_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.get_cached_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.get_cached_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of records about cached images.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.get_hit_count">
<code class="descname">get_hit_count</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.get_hit_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.get_hit_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of hits that an image has.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Opaque image identifier</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.get_least_recently_accessed">
<code class="descname">get_least_recently_accessed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.get_least_recently_accessed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.get_least_recently_accessed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the image_id and size of the least recently
accessed cached file, or None if no cached files.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.get_queued_images">
<code class="descname">get_queued_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.get_queued_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.get_queued_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of image IDs that are in the queue. The
list should be sorted by the time the image ID was inserted
into the queue.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.is_being_cached">
<code class="descname">is_being_cached</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.is_being_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.is_being_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with supplied id is currently
in the process of having its image file cached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.is_cacheable">
<code class="descname">is_cacheable</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.is_cacheable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.is_cacheable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID can have its
image file cached, False otherwise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.is_cached">
<code class="descname">is_cached</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.is_cached"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.is_cached" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image with the supplied ID has its image
file cached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.is_queued">
<code class="descname">is_queued</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.is_queued"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.is_queued" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the image identifier is in our cache queue.</p>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.open_for_read">
<code class="descname">open_for_read</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.open_for_read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.open_for_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Open and yield file for reading the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.open_for_write">
<code class="descname">open_for_write</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.open_for_write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.open_for_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a file for writing the image file for an image
with supplied identifier.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.queue_image">
<code class="descname">queue_image</code><span class="sig-paren">(</span><em>image_id</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.queue_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.queue_image" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds a image to be cache to the queue.</p>
<p>If the image already exists in the queue or has already been
cached, we return False, True otherwise</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_id</strong> &#8211; Image ID</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.reap_invalid">
<code class="descname">reap_invalid</code><span class="sig-paren">(</span><em>grace=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.reap_invalid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.reap_invalid" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any invalid cache entries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grace</strong> &#8211; Number of seconds to keep an invalid entry around for
debugging purposes. If None, then delete immediately.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="glance.image_cache.drivers.xattr.Driver.reap_stalled">
<code class="descname">reap_stalled</code><span class="sig-paren">(</span><em>grace=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#Driver.reap_stalled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.Driver.reap_stalled" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any stalled cache entries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>grace</strong> &#8211; Number of seconds to keep an invalid entry around for
debugging purposes. If None, then delete immediately.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.xattr.delete_cached_file">
<code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">delete_cached_file</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#delete_cached_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.delete_cached_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.xattr.get_all_regular_files">
<code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">get_all_regular_files</code><span class="sig-paren">(</span><em>basepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#get_all_regular_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.get_all_regular_files" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.xattr.get_xattr">
<code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">get_xattr</code><span class="sig-paren">(</span><em>path</em>, <em>key</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#get_xattr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.get_xattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value for a particular xattr</p>
<p>If the key doesn&#8217;t not exist, or xattrs aren&#8217;t supported by the file
system then a KeyError will be raised, that is, unless you specify a
default using kwargs.</p>
</dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.xattr.inc_xattr">
<code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">inc_xattr</code><span class="sig-paren">(</span><em>path</em>, <em>key</em>, <em>n=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#inc_xattr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.inc_xattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment the value of an xattr (assuming it is an integer).</p>
<p>BEWARE, this code <em>does</em> have a RACE CONDITION, since the
read/update/write sequence is not atomic.</p>
<p>Since the use-case for this function is collecting stats&#8211;not critical&#8211;
the benefits of simple, lock-free code out-weighs the possibility of an
occasional hit not being counted.</p>
</dd></dl>

<dl class="function">
<dt id="glance.image_cache.drivers.xattr.set_xattr">
<code class="descclassname">glance.image_cache.drivers.xattr.</code><code class="descname">set_xattr</code><span class="sig-paren">(</span><em>path</em>, <em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/glance/image_cache/drivers/xattr.html#set_xattr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#glance.image_cache.drivers.xattr.set_xattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of a specified xattr.</p>
<p>If xattrs aren&#8217;t supported by the file-system, we skip setting the value.</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-glance.image_cache.drivers">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-glance.image_cache.drivers" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">glance.image_cache.drivers package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-glance.image_cache.drivers.base">glance.image_cache.drivers.base module</a></li>
<li><a class="reference internal" href="#module-glance.image_cache.drivers.sqlite">glance.image_cache.drivers.sqlite module</a></li>
<li><a class="reference internal" href="#module-glance.image_cache.drivers.xattr">glance.image_cache.drivers.xattr module</a><ul>
<li><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li><a class="reference internal" href="#cache-directory-notes">Cache Directory Notes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-glance.image_cache.drivers">Module contents</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="glance.image_cache.html"
                                  title="previous chapter">glance.image_cache package</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="glance.quota.html"
                                  title="next chapter">glance.quota package</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/glance
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/api/glance.image_cache.drivers.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="glance.quota.html" title="glance.quota package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="glance.image_cache.html" title="glance.image_cache package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">glance 14.0.0.0rc2.dev4 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >Modules</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="glance.html" >glance package</a> &raquo;</li>
          <li class="nav-item nav-item-3"><a href="glance.image_cache.html" accesskey="U">glance.image_cache package</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-present, OpenStack Foundation..
      Last updated on &#39;Fri Feb 10 09:39:49 2017, commit 65dd7ae&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/glance");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>