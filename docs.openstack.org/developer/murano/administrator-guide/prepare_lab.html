<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Prepare a lab for murano &mdash; Murano</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.1.dev17',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Murano" href="../index.html" />
    <link rel="up" title="Deploying Murano" href="admin_index.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="Configure SSL" href="deploy_murano/configure_ssl.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="prepare-a-lab-for-murano">
<h1>Prepare a lab for murano<a class="headerlink" href="#prepare-a-lab-for-murano" title="Permalink to this headline">¶</a></h1>
<p>This section provides basic information about lab&#8217;s system requirements.
It also contains a description of a test which you may use to check if
your hardware fits the requirements. To do this, run the test and
compare the results with baseline data provided.</p>
<div class="section" id="system-prerequisites">
<span id="id1"></span><h2>System prerequisites<a class="headerlink" href="#system-prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="section" id="supported-operating-systems">
<h3>Supported operating systems<a class="headerlink" href="#supported-operating-systems" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Ubuntu Server 12.04 LTS</li>
<li>RHEL/CentOS 6.4</li>
</ul>
<p><strong>System packages are required for Murano</strong></p>
<p><em>Ubuntu</em></p>
<ul class="simple">
<li>gcc</li>
<li>python-pip</li>
<li>python-dev</li>
<li>libxml2-dev</li>
<li>libxslt-dev</li>
<li>libffi-dev</li>
<li>libpq-dev</li>
<li>python-openssl</li>
<li>mysql-client</li>
</ul>
<p>Install all the requirements on Ubuntu by running:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo apt-get install gcc python-pip python-dev \
libxml2-dev libxslt-dev libffi-dev \
libpq-dev python-openssl mysql-client
</pre></div>
</div>
<p><em>CentOS</em></p>
<ul class="simple">
<li>gcc</li>
<li>python-pip</li>
<li>python-devel</li>
<li>libxml2-devel</li>
<li>libxslt-devel</li>
<li>libffi-devel</li>
<li>postgresql-devel</li>
<li>pyOpenSSL</li>
<li>mysql</li>
</ul>
<p>Install all the requirements on CentOS by running:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo yum install gcc python-pip python-devel libxml2-devel \
libxslt-devel libffi-devel postgresql-devel pyOpenSSL \
mysql
</pre></div>
</div>
</div>
<div class="section" id="lab-requirements">
<span id="id2"></span><h3>Lab requirements<a class="headerlink" href="#lab-requirements" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="48%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Criteria</th>
<th class="head">Minimal</th>
<th class="head">Recommended</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CPU</td>
<td>4 core &#64; 2.4 GHz</td>
<td>24 core &#64; 2.67 GHz</td>
</tr>
<tr class="row-odd"><td>RAM</td>
<td>8 GB</td>
<td>24 GB or more</td>
</tr>
<tr class="row-even"><td>HDD</td>
<td>2 x 500 GB (7200 rpm)</td>
<td>4 x 500 GB (7200 rpm)</td>
</tr>
<tr class="row-odd"><td>RAID</td>
<td>Software RAID-1 (use mdadm as
it will improve read
performance almost two times)</td>
<td>Hardware RAID-10</td>
</tr>
</tbody>
</table>
<p><cite>Table: Hardware requirements</cite></p>
<p>There are a few possible storage configurations except the shown above.
All of them were tested and were working well.</p>
<ul>
<li><p class="first">1x SSD 500+ GB</p>
</li>
<li><dl class="first docutils">
<dt>1x HDD (7200 rpm) 500+ GB and 1x SSD 250+ GB (install the system onto</dt>
<dd><p class="first last">the HDD and mount the SSD drive to folder where VM images are)</p>
</dd>
</dl>
</li>
<li><p class="first">1x HDD (15000 rpm) 500+ GB</p>
</li>
</ul>
</div>
</div>
<div class="section" id="test-your-lab-host-performance">
<h2>Test your lab host performance<a class="headerlink" href="#test-your-lab-host-performance" title="Permalink to this headline">¶</a></h2>
<p>We have measured time required to boot 1 to 5 instances of Windows
system simultaneously. You can use this data as the baseline to check if
your system is fast enough.</p>
<p>You should use sysprepped images for this test, to simulate VM first
boot.</p>
<p>Steps to reproduce test:</p>
<ol class="arabic">
<li><p class="first">Prepare Windows 2012 Standard (with GUI) image in QCOW2 format. Let&#8217;s
assume that its name is ws-2012-std.qcow2</p>
</li>
<li><p class="first">Ensure that there is NO KVM PROCESSES on the host. To do this, run
command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ps aux | grep kvm
</pre></div>
</div>
</li>
<li><p class="first">Make 5 copies of Windows image file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>for i in $(seq 5); do \
cp ws-2012-std.qcow2 ws-2012-std-$i.qcow2; done
</pre></div>
</div>
</li>
<li><p class="first">Create script start-vm.sh in the folder with .qcow2 files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>#!/bin/bash
[ -z $1 ] || echo &quot;VM count not provided!&quot;; exit 1
for i in $(seq $1); do
echo &quot;Starting VM $i ...&quot;
kvm -m 1024 -drive file=ws-2012-std-$i.qcow2,if=virtio -net user -net nic,model=virtio -nographic -usbdevice tablet -vnc :$i &amp; done
</pre></div>
</div>
</li>
<li><p class="first">Start ONE instance with command below (as root) and measure time
between VM’s launch and the moment when Server Manager window
appears. To view VM’s desktop, connect with VNC viewer to your host
to VNC screen :1 (port 5901):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo ./start-vm.sh 1
</pre></div>
</div>
</li>
<li><p class="first">Turn VM off. You may simply kill all KVM processes by</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo killall kvm
</pre></div>
</div>
</li>
<li><p class="first">Start FIVE instances with command below (as root) and measure time
interval between ALL VM’s launch and the moment when LAST Server Manager
window appears. To view VM’s desktops, connect with VNC viewer to your
host to VNC screens :1 thru :5 (ports 5901-5905):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo ./start-vm.sh 5
</pre></div>
</div>
</li>
<li><p class="first">Turn VMs off. You may simply kill all KVM processes by</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo killall kvm
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="baseline-data">
<h2>Baseline data<a class="headerlink" href="#baseline-data" title="Permalink to this headline">¶</a></h2>
<p>The table below provides baseline data which we&#8217;ve got in our
environment.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="41%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">&nbsp;</th>
<th class="head">Boot 1 instance</th>
<th class="head">Boot 5  instances</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Avg. Time</td>
<td>3m:40s</td>
<td>8m</td>
</tr>
<tr class="row-odd"><td>Max. Time</td>
<td>5m</td>
<td>20m</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal"><span class="pre">Avg.</span> <span class="pre">Time</span></code> refers to the lab with recommended hardware configuration,
while <code class="docutils literal"><span class="pre">Max.</span> <span class="pre">Time</span></code> refers to minimal hardware configuration.</p>
</div>
<div class="section" id="host-optimizations">
<h2>Host optimizations<a class="headerlink" href="#host-optimizations" title="Permalink to this headline">¶</a></h2>
<p>Default KVM installation could be improved to provide better
performance.</p>
<p>The following optimizations may improve host performance up to 30%:</p>
<ul class="simple">
<li>change default scheduler from <code class="docutils literal"><span class="pre">CFQ</span></code> to <code class="docutils literal"><span class="pre">Deadline</span></code></li>
<li>use <code class="docutils literal"><span class="pre">ksm</span></code></li>
<li>use <code class="docutils literal"><span class="pre">vhost-net</span></code></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Prepare a lab for murano</a><ul>
<li><a class="reference internal" href="#system-prerequisites">System prerequisites</a><ul>
<li><a class="reference internal" href="#supported-operating-systems">Supported operating systems</a></li>
<li><a class="reference internal" href="#lab-requirements">Lab requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-your-lab-host-performance">Test your lab host performance</a></li>
<li><a class="reference internal" href="#baseline-data">Baseline data</a></li>
<li><a class="reference internal" href="#host-optimizations">Host optimizations</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="deploy_murano/configure_ssl.html"
                                  title="previous chapter">Configure SSL</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="configuration.html"
                                  title="next chapter">Configuration</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/murano
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/administrator-guide/prepare_lab.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="deploy_murano/configure_ssl.html" title="Configure SSL"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Murano</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="admin_index.html" accesskey="U">Deploying Murano</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright .
      Last updated on &#39;Fri Feb 10 03:18:12 2017, commit fbee404&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/Murano");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>