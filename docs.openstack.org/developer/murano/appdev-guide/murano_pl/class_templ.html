<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Common class structure &mdash; Murano</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.1.1.dev17',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Murano" href="../../index.html" />
    <link rel="up" title="MuranoPL Reference" href="../murano_pl.html" />
    <link rel="next" title="MuranoPL Core Library" href="core_lib.html" />
    <link rel="prev" title="YAQL" href="yaql.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="common-class-structure">
<span id="class-templ"></span><h1>Common class structure<a class="headerlink" href="#common-class-structure" title="Permalink to this headline">¶</a></h1>
<p>Here is a common template for class declarations. Note, that it is in the YAML
format.</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">class name</span>
<span class="l l-Scalar l-Scalar-Plain">Namespaces</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">namespaces specification</span>
<span class="l l-Scalar l-Scalar-Plain">Extends</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="nv">list of parent classes</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">Properties</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">properties declaration</span>
<span class="l l-Scalar l-Scalar-Plain">Methods</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">methodName</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">Arguments</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">list</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">of</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">arguments</span>
        <span class="l l-Scalar l-Scalar-Plain">Body</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">list</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">of</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">instructions</span>
</pre></div>
</td></tr></table></div>
<p>Thus MuranoPL class is a YAML dictionary with predefined key names, all keys except
for <code class="docutils literal"><span class="pre">Name</span></code> are optional and can be omitted (but must be valid if specified).</p>
<div class="section" id="class-name">
<h2>Class name<a class="headerlink" href="#class-name" title="Permalink to this headline">¶</a></h2>
<p>Class names are alphanumeric names of the classes. Traditionally, all class names
begin with an upper-case letter symbol and are written in PascalCasing.</p>
<p>In MuranoPL all class names are unique. At the same time, MuranoPL
supports namespaces. So, in different namespaces you can have classes
with the same name. You can specify a namespace explicitly, like
<cite>ns:MyName</cite>. If you omit the namespace specification, <code class="docutils literal"><span class="pre">MyName</span></code> is
expanded using the default namespace <code class="docutils literal"><span class="pre">=:</span></code>. Therefore, <code class="docutils literal"><span class="pre">MyName</span></code>
equals <code class="docutils literal"><span class="pre">=:MyName</span></code> if <code class="docutils literal"><span class="pre">=</span></code> is a valid namespace.</p>
</div>
<div class="section" id="namespaces">
<h2>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline">¶</a></h2>
<p>Namespaces declaration specifies prefixes that can be used in the class body
to make long class names shorter.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Namespaces</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">=</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano.services.windows</span>
    <span class="l l-Scalar l-Scalar-Plain">srv</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano.services</span>
    <span class="l l-Scalar l-Scalar-Plain">std</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano</span>
</pre></div>
</div>
<p>In the example above, the <code class="docutils literal"><span class="pre">srv:</span> <span class="pre">Something</span></code> class name is automatically
translated to <code class="docutils literal"><span class="pre">io.murano.services.Something</span></code>.</p>
<p><code class="docutils literal"><span class="pre">=</span></code> means the current namespace, so that <code class="docutils literal"><span class="pre">MyClass</span></code> means
<code class="docutils literal"><span class="pre">io.murano.services.windows.MyClass</span></code>.</p>
<p>If the class name contains the period (.) in its name, then it is assumed
to be already fully namespace qualified and is not expanded.
Thus <code class="docutils literal"><span class="pre">ns.Myclass</span></code> remains as is.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To make class names globally unique, we recommend specifying a developer&#8217;s
domain name as a part of the namespace.</p>
</div>
</div>
<div class="section" id="extends">
<h2>Extends<a class="headerlink" href="#extends" title="Permalink to this headline">¶</a></h2>
<p>MuranoPL supports multiple inheritance. If present, the <code class="docutils literal"><span class="pre">Extends</span></code> section
shows base classes that are extended. If the list consists of a single entry,
then you can write it as a scalar string instead of an array. If you
do not specify any parents or omit the key, then the class extends
<code class="docutils literal"><span class="pre">io.murano.Object</span></code>. Thus, <code class="docutils literal"><span class="pre">io.murano.Object</span></code> is the root class
for all class hierarchies.</p>
</div>
<div class="section" id="properties">
<span id="class-props"></span><h2>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<p>Properties are class attributes that together with methods create public
class interface. Usually, but not always, properties are the values, and
reference other objects that have to be entered in an environment
designer prior to a workflow invocation.</p>
<p>Properties have the following declaration format:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">propertyName</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">property contract</span>
    <span class="l l-Scalar l-Scalar-Plain">Usage</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">property usage</span>
    <span class="l l-Scalar l-Scalar-Plain">Default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">property default</span>
</pre></div>
</div>
<div class="section" id="contract">
<h3>Contract<a class="headerlink" href="#contract" title="Permalink to this headline">¶</a></h3>
<p>Contract is a YAQL expression that says what type of the value is expected for
the property as well as additional constraints imposed on a property. Using
contracts you can define what value can be assigned to a property or argument.
In case of invalid input data it may be automatically transformed to confirm
to the contract. For example, if bool value is expected and user passes any
not null value it will be converted to <code class="docutils literal"><span class="pre">True</span></code>. If converting is impossible
exception <code class="docutils literal"><span class="pre">ContractViolationException</span></code> will be raised.</p>
<p>The following contracts are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operation</th>
<th class="head">Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.int()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">an integer value (may be null). String values consisting of digits are converted to integers</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.int().notNull()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">a mandatory integer</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.string()</div>
<div class="line">$.string().notNull()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">a string. If the value is not a string, it is converted to a string</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.bool()</div>
<div class="line">$.bool().notNull()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">bools are true and false. <code class="docutils literal"><span class="pre">0</span></code> is converted to false, other integers to true</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.class(ns:ClassName)</div>
<div class="line">$.class(ns:ClassName).notNull()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">value must be a reference to an instance of specified class name</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.template(ns:ClassName)</div>
<div class="line">$.template(ns:ClassName).notNull()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">value must be a dictionary with object-model representation of specified class name</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.class(ns:ClassName, ns:DefaultClassName)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">create instance of the <code class="docutils literal"><span class="pre">ns:DefaultClassName</span></code> class if no instance provided</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.class(ns:Name).check($.p = 12)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the value must be of the <code class="docutils literal"><span class="pre">ns:Name</span></code> type and have the <code class="docutils literal"><span class="pre">p</span></code> property equal to 12</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.class(ns:Name).owned()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">a current object must be direct or indirect owner of the value</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.class(ns:Name).notOwned()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the value must be owned by any object except current one</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">[$.int()]</div>
<div class="line">[$.int().notNull()]</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">an array of integers. Similar to other types.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">[$.int().check($ &gt; 0)]</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">an array of the positive integers (thus not null)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">[$.int(), $.string()]</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">an array that has at least two elements, first is int and others are strings</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">[$.int(), 2]</div>
<div class="line">[$.int(), 2, 5]</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">an array of ints with at least 2 items</div>
<div class="line">an array of ints with at least 2 items, and maximum of 5 items</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">{ A: $.int(), B: [$.string()] }</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the dictionary with the <code class="docutils literal"><span class="pre">A</span></code> key of the int type and <code class="docutils literal"><span class="pre">B</span></code> - an array of strings</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$</div>
<div class="line">[]</div>
<div class="line">{}</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">any scalar or data structure as is</div>
<div class="line">any array</div>
<div class="line">any dictionary</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">{ $.string().notNull(): $.int().notNull() }</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">dictionary string -&gt; int</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">A: StringMap</div>
<div class="line">$.string().notNull(): $</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the dictionary with the <code class="docutils literal"><span class="pre">A</span></code> key that must be equal to <code class="docutils literal"><span class="pre">StringMap</span></code>, and other keys be</div>
<div class="line">any scalar or data structure</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.check($ in $this.myStaticMethod())</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the value must be equal to one of a member of a list returned by static method of the class</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.check($this.myStaticMethod($))</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">the static method of the class must return true for the value</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In the example below property <code class="docutils literal"><span class="pre">port</span></code> must be int value greater than 0 and
less than 65536; <code class="docutils literal"><span class="pre">scope</span></code> must be a string value and one of &#8216;public&#8217;, &#8216;cloud&#8217;,
&#8216;host&#8217; or &#8216;internal&#8217;, and <code class="docutils literal"><span class="pre">protocol</span></code> must be a string value and either
&#8216;TCP&#8217; or &#8216;UDP&#8217;. When user passes some values to these properties it will be checked
that values confirm to the contracts.</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Namespaces</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">=</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano.apps.docker</span>
  <span class="l l-Scalar l-Scalar-Plain">std</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano</span>

<span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">ApplicationPort</span>

<span class="l l-Scalar l-Scalar-Plain">Properties</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.int().notNull().check($ &gt; 0 and $ &lt; 65536)</span>

  <span class="l l-Scalar l-Scalar-Plain">scope</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.string().notNull().check($ in list(public, cloud, host, internal))</span>
    <span class="l l-Scalar l-Scalar-Plain">Default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">private</span>

  <span class="l l-Scalar l-Scalar-Plain">protocol</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.string().notNull().check($ in list(TCP, UDP))</span>
    <span class="l l-Scalar l-Scalar-Plain">Default</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TCP</span>

<span class="l l-Scalar l-Scalar-Plain">Methods</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">getRepresentation</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Body</span><span class="p p-Indicator">:</span>
      <span class="l l-Scalar l-Scalar-Plain">Return</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.port</span>
        <span class="l l-Scalar l-Scalar-Plain">scope</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.scope</span>
        <span class="l l-Scalar l-Scalar-Plain">protocol</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.protocol</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">template</span></code> contract does the same validation as the <code class="docutils literal"><span class="pre">class</span></code> contract,
but does not require the actual object to be passed as a property or argument.
Instead it allows to create an object from the given template later. Also you
can exclude some of the properties from validation and provide them later in
the body of the method.</p>
<p>Consider the following example:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Namespaces</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">=</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano.applications</span>
  <span class="l l-Scalar l-Scalar-Plain">res</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano.resources</span>
  <span class="l l-Scalar l-Scalar-Plain">std</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">io.murano</span>

<span class="l l-Scalar l-Scalar-Plain">Name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TemplateServerProvider</span>

<span class="l l-Scalar l-Scalar-Plain">Properties</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">template</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.template(res:Instance, excludeProperties =&gt; [name]).notNull()</span>
  <span class="l l-Scalar l-Scalar-Plain">serverNamePattern</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.string().notNull()</span>
  <span class="l l-Scalar l-Scalar-Plain">threshold</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.int().check($ &gt; 0)</span>

<span class="l l-Scalar l-Scalar-Plain">Methods</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">createReplica</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Arguments</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">index</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.int().notNull()</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">owner</span><span class="p p-Indicator">:</span>
          <span class="l l-Scalar l-Scalar-Plain">Contract</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$.class(std:Object)</span>
    <span class="l l-Scalar l-Scalar-Plain">Body</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">If</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$index &lt; $this.threshold</span>
        <span class="l l-Scalar l-Scalar-Plain">Then</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$template</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$this.template</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$template.name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$this.serverNamePattern.format($index)</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">$template[&#39;?&#39;].name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">format(&#39;Server {0}&#39;, $index)</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">new($template, $owner)</span>
        <span class="l l-Scalar l-Scalar-Plain">Else</span><span class="p p-Indicator">:</span>
          <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Return</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
<p>In the example above the class has the <code class="docutils literal"><span class="pre">template</span></code> property that is validated
by the <code class="docutils literal"><span class="pre">template</span></code> contract. It holds the template of the object of the
<code class="docutils literal"><span class="pre">Instance</span></code> class or its inheritor. In the <code class="docutils literal"><span class="pre">createReplica</span></code> method
<code class="docutils literal"><span class="pre">template</span></code> is used to dynamically create instances in runtime considering
some conditions and customizing the <code class="docutils literal"><span class="pre">name</span></code> property of an instance, as it
was excluded from validation.</p>
<p>You still can pass an actual object to the property or argument with the
<code class="docutils literal"><span class="pre">template</span></code> contract, but it will be automatically converted to its object
model representation.</p>
</div>
<div class="section" id="property-usage">
<span id="id1"></span><h3>Property usage<a class="headerlink" href="#property-usage" title="Permalink to this headline">¶</a></h3>
<p>Usage states the purpose of the property. This implies who and how can
access it. The following usages are available:</p>
<table border="1" class="borderless docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Value</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Explanation</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">In</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Input property. Values of such properties are obtained from a user
and cannot be modified in MuranoPL workflows. This is the default
value for the Usage key.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Out</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A value is obtained from executing MuranoPL workflow and cannot be
modified by a user.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">InOut</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A value can be modified both by user and by workflow.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Const</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The same as <code class="docutils literal"><span class="pre">In</span></code> but once workflow is executed a property cannot be
changed neither by a user nor by a workflow.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Runtime</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A property is visible only from within workflows. It is neither read
from input nor serialized to a workflow output.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Static</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Property is defined on a class rather than on an instance.
See <a class="reference internal" href="statics.html#static-methods-and-properties"><span>Static methods and properties</span></a> for details.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Config</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A property allows to have per-class configuration. A value is obtained
from the config file rather than from the object model. These config
files are stored in a special folder that is configured in the
<code class="docutils literal"><span class="pre">[engine]</span></code> section of the Murano config file under the
<code class="docutils literal"><span class="pre">class_configs</span></code> key.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The usage attribute is optional and can be omitted (which implies <code class="docutils literal"><span class="pre">In</span></code>).</p>
<p>If the workflow tries to write to a property that is not declared with
one of the types above, it is considered to be private and accessible
only to that class (and not serialized to output and thus would be
lost upon the next deployment). An attempt to read the property that was
not initialized results in an exception.</p>
</div>
<div class="section" id="default">
<h3>Default<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h3>
<p>Default is a value that is used if the property value is not mentioned in
the input object model, but not when it is set to null.
Default, if specified, must conform to a declared property contract.
If Default is not specified, then null is the default.</p>
<p>For properties that are references to other classes, Default can modify
a default value of the referenced objects. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>p:
 Contract: $.class(MyClass)
 Default: {a: 12}
</pre></div>
</div>
<p>This overrides default for the <code class="docutils literal"><span class="pre">a</span></code> property of <code class="docutils literal"><span class="pre">MyClass</span></code> for instance
of <code class="docutils literal"><span class="pre">MyClass</span></code> that is created for this property.</p>
</div>
</div>
<div class="section" id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h2>
<p>Workflows are the methods that describe how the entities that are
represented by MuranoPL classes are deployed.</p>
<p>In a typical scenario, the root object in an input data model is of
the <code class="docutils literal"><span class="pre">io.murano.Environment</span></code> type, and has the <code class="docutils literal"><span class="pre">deploy</span></code> method.
This method invocation causes a series of infrastructure activities
(typically, a Heat stack modification) and the deployment scripts
execution initiated by VM agents commands. The role of the workflow
is to map data from the input object model, or a result of previously
executed actions, to the parameters of these activities and to
initiate these activities in a correct order.</p>
</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<p>Methods have input parameters, and can return a value to a caller.
Methods are defined in the Workflow section of the class using the
following template:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>methodName:
    Scope: Public
    Arguments:
       - list
       - of
       - arguments
    Body:
       - list
       - of
       - instructions
</pre></div>
</div>
<p>Public is an optional parameter that specifies methods to be executed
by direct triggering after deployment.</p>
<div class="section" id="method-arguments">
<span id="id2"></span><h3>Method arguments<a class="headerlink" href="#method-arguments" title="Permalink to this headline">¶</a></h3>
<p>Arguments are optional too, and are declared using the same syntax
as class properties. Same as properties, arguments also have contracts and
optional defaults.</p>
<p>Unlike class properties Arguments may have a different set of Usages:</p>
<table border="1" class="borderless docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Value</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Explanation</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Standard</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Regular method argument. Holds a single value based on its contract.
This is the default value for the Usage key.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">VarArgs</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A variable length argument. Method body sees it as a list of values,
each matching a contract of the argument.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">KwArgs</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">A keywrod-based argument, Method body sees it as a dict of values,
with keys being valid keyword strings and values matching a contract
of the argument.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Arguments example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>scaleRc:
  Arguments:
    - rcName:
        Contract: $.string().notNull()
    - newSize:
        Contract: $.int().notNull()
    - rest:
        Contract: $.int()
        Usage: VarArgs
    - others:
        Contract: $.int()
        Usage: KwArgs
</pre></div>
</div>
</div>
<div class="section" id="method-body">
<h3>Method body<a class="headerlink" href="#method-body" title="Permalink to this headline">¶</a></h3>
<p>The Method body is an array of instructions that get executed sequentially.
There are 3 types of instructions that can be found in a workflow body:</p>
<ul class="simple">
<li>Expressions,</li>
<li>Assignments,</li>
<li>Block constructs.</li>
</ul>
</div>
<div class="section" id="method-usage">
<h3>Method usage<a class="headerlink" href="#method-usage" title="Permalink to this headline">¶</a></h3>
<p>Usage states the purpose of the method. This implies who and how can
access it. The following usages are available:</p>
<table border="1" class="borderless docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Value</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Explanation</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Runtime</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Normal instance method.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Static</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Static method that does not require class instance.
See <a class="reference internal" href="statics.html#static-methods-and-properties"><span>Static methods and properties</span></a> for details.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Extension</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Extension static method that extends some other type.
See <a class="reference internal" href="statics.html#extension-methods"><span>Extension methods</span></a> for details.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Action</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Method can be invoked from outside (using Murano API).
This option is deprecated for the package format versions &gt; 1.3 in
favor of <code class="docutils literal"><span class="pre">Scope:</span> <span class="pre">Public</span></code> and occasionally will be no longer
supported.
See <a class="reference internal" href="actions.html#actions"><span>Murano actions</span></a> for details.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">Usage</span></code> attribute is optional and can be omitted (which implies
<code class="docutils literal"><span class="pre">Runtime</span></code>).</p>
</div>
<div class="section" id="method-scope">
<h3>Method scope<a class="headerlink" href="#method-scope" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Scope</span></code> attribute declares method visibility. It can have two possible
values:</p>
<ul class="simple">
<li><cite>Session</cite> - regular method that is accessible from anywhere in the current
execution session. This is the default if the attribute is omitted;</li>
<li><cite>Public</cite> - accessible anywhere, both within the session and from
outside through the API call.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">Scope</span></code> attribute is optional and can be omitted (which implies
<code class="docutils literal"><span class="pre">Session</span></code>).</p>
</div>
<div class="section" id="expressions">
<h3>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">¶</a></h3>
<p>Expressions are YAQL expressions that are executed for their side effect.
All accessible object methods can be called in the expression using
the <code class="docutils literal"><span class="pre">$obj.methodName(arguments)</span></code> syntax.</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.methodName()</div>
<div class="line">$this.methodName()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">invoke method &#8216;methodName&#8217; on this (self) object</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.property.methodName()</div>
<div class="line">$this.property.methodName()</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">invocation of method on object that is in <code class="docutils literal"><span class="pre">property</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.method(1, 2, 3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">methods can have arguments</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.method(1, 2, thirdParameter =&gt; 3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">named parameters also supported</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">list($.foo().bar($this.property), $p)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">complex expressions can be constructed</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="assignment">
<h3>Assignment<a class="headerlink" href="#assignment" title="Permalink to this headline">¶</a></h3>
<p>Assignments are single key dictionaries with a YAQL expression as a key
and arbitrary structure as a value. Such a construct is evaluated
as an assignment.</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Assignment</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$x: value</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">assigns <code class="docutils literal"><span class="pre">value</span></code> to the local variable <code class="docutils literal"><span class="pre">$x</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.x: value</div>
<div class="line">$this.x: value</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">assign <code class="docutils literal"><span class="pre">value</span></code> to the object&#8217;s property</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.x: $.y</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">copies the value of the property <code class="docutils literal"><span class="pre">y</span></code> to the property <code class="docutils literal"><span class="pre">x</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$x: [$a, $b]</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sets <code class="docutils literal"><span class="pre">$x</span></code> to the array of two values: <code class="docutils literal"><span class="pre">$a</span></code> and <code class="docutils literal"><span class="pre">$b</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$x:</div>
<div class="line-block">
<div class="line">SomeKey:</div>
<div class="line-block">
<div class="line">NestedKey: $variable</div>
</div>
</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">structures of any level of complexity can be evaluated</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.x[0]: value</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">assigns <code class="docutils literal"><span class="pre">value</span></code> to the first array entry of the <code class="docutils literal"><span class="pre">x</span></code> property</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$.x: $.x.append(value)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">appends <code class="docutils literal"><span class="pre">value</span></code> to the array in the <code class="docutils literal"><span class="pre">x</span></code> property</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.x: $.x.insert(1, value)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">inserts <code class="docutils literal"><span class="pre">value</span></code> into position 1 of the array in the <code class="docutils literal"><span class="pre">x</span></code> property</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">$x: list($a, $b).delete(0)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">sets <code class="docutils literal"><span class="pre">$x</span></code> to the list without the item at index 0</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">$.x.key.subKey: value</div>
<div class="line">$.x[key][subKey]: value</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">deep dictionary modification</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="block-constructs">
<h3>Block constructs<a class="headerlink" href="#block-constructs" title="Permalink to this headline">¶</a></h3>
<p>Block constructs control a program flow. They are dictionaries that have
strings as all their keys.</p>
<p>The following block constructs are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Assignment</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Return: value</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Returns value from a method</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">If: predicate()</div>
<div class="line">Then:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">Else:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first line-block">
<div class="line"><code class="docutils literal"><span class="pre">predicate()</span></code> is a YAQL expression that must be evaluated to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code></div>
</div>
<div class="last line-block">
<div class="line">The <code class="docutils literal"><span class="pre">Else</span></code> section is optional</div>
<div class="line">One-line code blocks can be written as scalars rather than an array.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">While: predicate()</div>
<div class="line">Do:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">predicate()</span></code> must be evaluated to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">For: variableName</div>
<div class="line">In: collection</div>
<div class="line">Do:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first line-block">
<div class="line"><code class="docutils literal"><span class="pre">collection</span></code> must be a YAQL expression returning iterable collection or
evaluatable array as in assignment instructions, for example, <code class="docutils literal"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">$x]</span></code></div>
</div>
<div class="last line-block">
<div class="line">Inside a code block loop, a variable is accessible as <code class="docutils literal"><span class="pre">$variableName</span></code></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Repeat:</div>
<div class="line">Do:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Repeats the code block specified number of times</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Break:</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Breaks from loop</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Match:</div>
<div class="line-block">
<div class="line">case1:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">case2:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
<div class="line">Value: $valExpression()</div>
<div class="line">Default:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Matches the result of <code class="docutils literal"><span class="pre">$valExpression()</span></code> against a set of possible values
(cases). The code block of first matched case is executed.</div>
</div>
<div class="last line-block">
<div class="line">If no case matched and the default key is present
than the <code class="docutils literal"><span class="pre">Default</span></code> code block get executed.</div>
<div class="line">The case values are constant values (not expressions).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Switch:</div>
<div class="line-block">
<div class="line">$predicate1():</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">$predicate2():</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
<div class="line">Default:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">All code blocks that have their predicate evaluated to <code class="docutils literal"><span class="pre">True</span></code> are executed,
but the order of predicate evaluation is not fixed.</div>
</div>
<div class="line-block">
<div class="line">The <code class="docutils literal"><span class="pre">Default</span></code> key is optional.</div>
</div>
<div class="last line-block">
<div class="line">If no predicate evaluated to <code class="docutils literal"><span class="pre">True</span></code>, the <code class="docutils literal"><span class="pre">Default</span></code> code block get executed.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Parallel:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">Limit: 5</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Executes all instructions in code block in a separate green threads in parallel.</div>
</div>
<div class="last line-block">
<div class="line">The limit is optional and means the maximum number of concurrent green threads.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">Try:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">Catch:</div>
<div class="line">With: keyError</div>
<div class="line">As: e</div>
<div class="line">Do:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">Else:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
<div class="line">Finally:</div>
<div class="line-block">
<div class="line">- code</div>
<div class="line">- block</div>
</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Try and Catch are keywords that represent the handling of exceptions due to data
or coding errors during program execution. A <code class="docutils literal"><span class="pre">Try</span></code> block is the block of code in
which exceptions occur. A <code class="docutils literal"><span class="pre">Catch</span></code> block is the block of code, that is executed if
an exception occurred.</div>
<div class="line">Exceptions are not declared in Murano PL. It means that exceptions of any types can
be handled and generated. Generating of exception can be done with construct:
<code class="docutils literal"><span class="pre">Throw:</span> <span class="pre">keyError</span></code>.</div>
</div>
<div class="line-block">
<div class="line">The <code class="docutils literal"><span class="pre">Else</span></code> is optional block. <code class="docutils literal"><span class="pre">Else</span></code> block is executed if no exception occurred.</div>
</div>
<div class="last line-block">
<div class="line">The <code class="docutils literal"><span class="pre">Finally</span></code> also is optional. It&#8217;s a place to put any code that will
be executed, whether the try-block raised an exception or not.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Notice, that if you have more than one block construct in your workflow, you
need to insert dashes before each construct. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>Body:
  - If: predicate1()
    Then:
      - code
      - block
  - While: predicate2()
    Do:
      - code
      - block
</pre></div>
</div>
</div>
</div>
<div class="section" id="object-model">
<span id="id3"></span><h2>Object model<a class="headerlink" href="#object-model" title="Permalink to this headline">¶</a></h2>
<p>Object model is a JSON serialized representation of objects and their
properties. Everything you do in the OpenStack dashboard is reflected
in an object model. The object model is sent to the Application catalog engine
when the user decides to deploy the built environment. On the engine
side, MuranoPL objects are constructed and initialized from the received
Object model, and a predefined method is executed on the root object.</p>
<p>Objects are serialized to JSON using the following template:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
    <span class="s">&quot;?&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
        <span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;globally</span><span class="nv"> </span><span class="s">unique</span><span class="nv"> </span><span class="s">object</span><span class="nv"> </span><span class="s">ID</span><span class="nv"> </span><span class="s">(UUID)&quot;</span><span class="p p-Indicator">,</span>
        <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;fully</span><span class="nv"> </span><span class="s">namespace-qualified</span><span class="nv"> </span><span class="s">class</span><span class="nv"> </span><span class="s">name&quot;</span><span class="p p-Indicator">,</span>

        <span class="s">&quot;optional</span><span class="nv"> </span><span class="s">designer-related</span><span class="nv"> </span><span class="s">entries</span><span class="nv"> </span><span class="s">can</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">placed</span><span class="nv"> </span><span class="s">here&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;key&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;value&quot;</span>
        <span class="p p-Indicator">}</span>
    <span class="p p-Indicator">},</span>

    <span class="s">&quot;classProperty1&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;propertyValue&quot;</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;classProperty2&quot;</span><span class="p p-Indicator">:</span> <span class="nv">123</span><span class="p p-Indicator">,</span>
    <span class="s">&quot;classProperty3&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;value1&quot;</span><span class="p p-Indicator">,</span> <span class="s">&quot;value2&quot;</span><span class="p p-Indicator">],</span>

    <span class="s">&quot;reference1&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
        <span class="s">&quot;?&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;object</span><span class="nv"> </span><span class="s">id&quot;</span><span class="p p-Indicator">,</span>
            <span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;object</span><span class="nv"> </span><span class="s">type&quot;</span>
        <span class="p p-Indicator">},</span>

        <span class="s">&quot;property&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;value&quot;</span>
    <span class="p p-Indicator">},</span>

    <span class="s">&quot;reference2&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;referenced</span><span class="nv"> </span><span class="s">object</span><span class="nv"> </span><span class="s">id&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
<p>Objects can be identified as dictionaries that contain the <code class="docutils literal"><span class="pre">?</span></code> entry.
All system fields are hidden in that entry.</p>
<p>There are two ways to specify references:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">reference1</span></code> as in the example above. This method allows inline
definition of an object. When the instance of the referenced object
is created, an outer object becomes its parent/owner that is responsible
for the object. The object itself may require that its parent
(direct or indirect) be of a specified type, like all applications
require to have <code class="docutils literal"><span class="pre">Environment</span></code> somewhere in a parent chain.</li>
<li>Referring to an object by specifying other object ID. That object must
be defined elsewhere in an object tree. Object references distinguished
from strings having the same value by evaluating property contracts.
The former case would have <code class="docutils literal"><span class="pre">$.class(Name)</span></code> while the later - the
<code class="docutils literal"><span class="pre">$.string()</span></code> contract.</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Common class structure</a><ul>
<li><a class="reference internal" href="#class-name">Class name</a></li>
<li><a class="reference internal" href="#namespaces">Namespaces</a></li>
<li><a class="reference internal" href="#extends">Extends</a></li>
<li><a class="reference internal" href="#properties">Properties</a><ul>
<li><a class="reference internal" href="#contract">Contract</a></li>
<li><a class="reference internal" href="#property-usage">Property usage</a></li>
<li><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li><a class="reference internal" href="#workflow">Workflow</a></li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#method-arguments">Method arguments</a></li>
<li><a class="reference internal" href="#method-body">Method body</a></li>
<li><a class="reference internal" href="#method-usage">Method usage</a></li>
<li><a class="reference internal" href="#method-scope">Method scope</a></li>
<li><a class="reference internal" href="#expressions">Expressions</a></li>
<li><a class="reference internal" href="#assignment">Assignment</a></li>
<li><a class="reference internal" href="#block-constructs">Block constructs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#object-model">Object model</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="yaql.html"
                                  title="previous chapter">YAQL</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="core_lib.html"
                                  title="next chapter">MuranoPL Core Library</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/murano
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/appdev-guide/murano_pl/class_templ.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="core_lib.html" title="MuranoPL Core Library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="yaql.html" title="YAQL"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Murano</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../developer_index.html" >Application Developer Guide</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../murano_pl.html" accesskey="U">MuranoPL Reference</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright .
      Last updated on &#39;Fri Feb 10 03:18:12 2017, commit fbee404&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/Murano");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>