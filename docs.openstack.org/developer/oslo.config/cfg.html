<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The cfg Module &mdash; oslo.config 3.22.1.dev4 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.22.1.dev4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="oslo.config 3.22.1.dev4 documentation" href="index.html" />
    <link rel="next" title="Option Definitions" href="opts.html" />
    <link rel="prev" title="oslo.config" href="index.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-oslo_config.cfg">
<span id="the-cfg-module"></span><h1>The cfg Module<a class="headerlink" href="#module-oslo_config.cfg" title="Permalink to this headline">¶</a></h1>
<p>Configuration options may be set on the command line or in config files.</p>
<p>The schema for each option is defined using the
<a class="reference internal" href="opts.html#oslo_config.cfg.Opt" title="oslo_config.cfg.Opt"><code class="xref py py-class docutils literal"><span class="pre">Opt</span></code></a> class or its sub-classes, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oslo_config</span> <span class="kn">import</span> <span class="n">cfg</span>
<span class="kn">from</span> <span class="nn">oslo_config</span> <span class="kn">import</span> <span class="n">types</span>

<span class="n">PortType</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">65535</span><span class="p">)</span>

<span class="n">common_opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;bind_host&#39;</span><span class="p">,</span>
               <span class="n">default</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span>
               <span class="n">help</span><span class="o">=</span><span class="s1">&#39;IP address to listen on.&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">Opt</span><span class="p">(</span><span class="s1">&#39;bind_port&#39;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">PortType</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="mi">9292</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Port number to listen on.&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="section" id="option-types">
<h2>Option Types<a class="headerlink" href="#option-types" title="Permalink to this headline">¶</a></h2>
<p>Options can have arbitrary types via the <cite>type</cite> parameter to the <a class="reference internal" href="opts.html#oslo_config.cfg.Opt" title="oslo_config.cfg.Opt"><code class="xref py py-class docutils literal"><span class="pre">Opt</span></code></a>
constructor. The <cite>type</cite> parameter is a callable object that takes a string and
either returns a value of that particular type or raises <code class="xref py py-class docutils literal"><span class="pre">ValueError</span></code> if
the value can not be converted.</p>
<p>For convenience, there are predefined option subclasses in
<a class="reference internal" href="#module-oslo_config.cfg" title="oslo_config.cfg"><code class="xref py py-mod docutils literal"><span class="pre">oslo_config.cfg</span></code></a> that set the option <cite>type</cite> as in the following table:</p>
<p>For <a class="reference internal" href="opts.html#oslo_config.cfg.MultiOpt" title="oslo_config.cfg.MultiOpt"><code class="xref py py-class docutils literal"><span class="pre">oslo_config.cfg.MultiOpt</span></code></a> the <cite>item_type</cite> parameter defines
the type of the values. For convenience, <a class="reference internal" href="opts.html#oslo_config.cfg.MultiStrOpt" title="oslo_config.cfg.MultiStrOpt"><code class="xref py py-class docutils literal"><span class="pre">oslo_config.cfg.MultiStrOpt</span></code></a>
is <a class="reference internal" href="opts.html#oslo_config.cfg.MultiOpt" title="oslo_config.cfg.MultiOpt"><code class="xref py py-class docutils literal"><span class="pre">MultiOpt</span></code></a> with the <cite>item_type</cite> parameter set to
<a class="reference internal" href="types.html#oslo_config.types.MultiString" title="oslo_config.types.MultiString"><code class="xref py py-class docutils literal"><span class="pre">oslo_config.types.MultiString</span></code></a>.</p>
<p>The following example defines options using the convenience classes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">enabled_apis_opt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ListOpt</span><span class="p">(</span><span class="s1">&#39;enabled_apis&#39;</span><span class="p">,</span>
                               <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ec2&#39;</span><span class="p">,</span> <span class="s1">&#39;osapi_compute&#39;</span><span class="p">],</span>
                               <span class="n">help</span><span class="o">=</span><span class="s1">&#39;List of APIs to enable by default.&#39;</span><span class="p">)</span>

<span class="n">DEFAULT_EXTENSIONS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;nova.api.openstack.compute.contrib.standard_extensions&#39;</span>
<span class="p">]</span>
<span class="n">osapi_compute_extension_opt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">MultiStrOpt</span><span class="p">(</span><span class="s1">&#39;osapi_compute_extension&#39;</span><span class="p">,</span>
                                              <span class="n">default</span><span class="o">=</span><span class="n">DEFAULT_EXTENSIONS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="registering-options">
<h2>Registering Options<a class="headerlink" href="#registering-options" title="Permalink to this headline">¶</a></h2>
<p>Option schemas are registered with the config manager at runtime, but before
the option is referenced:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExtensionManager</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">enabled_apis_opt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ListOpt</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conf</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf</span> <span class="o">=</span> <span class="n">conf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">enabled_apis_opt</span><span class="p">)</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">_load_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ext_factory</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">osapi_compute_extension</span><span class="p">:</span>
            <span class="o">....</span>
</pre></div>
</div>
<p>A common usage pattern is for each option schema to be defined in the module or
class which uses the option:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="o">...</span>

<span class="k">def</span> <span class="nf">add_common_opts</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_opts</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_bind_host</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">bind_host</span>

<span class="k">def</span> <span class="nf">get_bind_port</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">conf</span><span class="o">.</span><span class="n">bind_port</span>
</pre></div>
</div>
<p>An option may optionally be made available via the command line. Such options
must be registered with the config manager before the command line is parsed
(for the purposes of &#8211;help and CLI arg validation):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">cli_opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">BoolOpt</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span>
                <span class="n">short</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Print more verbose output.&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">BoolOpt</span><span class="p">(</span><span class="s1">&#39;debug&#39;</span><span class="p">,</span>
                <span class="n">short</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Print debugging output.&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">add_common_opts</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_cli_opts</span><span class="p">(</span><span class="n">cli_opts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-config-files">
<h2>Loading Config Files<a class="headerlink" href="#loading-config-files" title="Permalink to this headline">¶</a></h2>
<p>The config manager has two CLI options defined by default, &#8211;config-file
and &#8211;config-dir:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>class ConfigOpts(object):

    def __call__(self, ...):

        opts = [
            MultiStrOpt(&#39;config-file&#39;,
                    ...),
            StrOpt(&#39;config-dir&#39;,
                   ...),
        ]

        self.register_cli_opts(opts)
</pre></div>
</div>
<p>Option values are parsed from any supplied config files using
oslo_config.iniparser. If none are specified, a default set is used
for example glance-api.conf and glance-common.conf:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>glance-api.conf:
  [DEFAULT]
  bind_port = 9292

glance-common.conf:
  [DEFAULT]
  bind_host = 0.0.0.0
</pre></div>
</div>
<p>Lines in a configuration file should not start with whitespace. A
configuration file also supports comments, which must start with &#8216;#&#8217; or &#8216;;&#8217;.
Option values in config files and those on the command line are parsed
in order. The same option (includes deprecated option name and current
option name) can appear many times, in config files or on the command line.
Later values always override earlier ones.</p>
<p>The order of configuration files inside the same configuration directory is
defined by the alphabetic sorting order of their file names.</p>
<p>The parsing of CLI args and config files is initiated by invoking the config
manager for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ConfigOpts</span><span class="p">()</span>
<span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">BoolOpt</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">))</span>
<span class="n">conf</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="k">if</span> <span class="n">conf</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="option-groups">
<h2>Option Groups<a class="headerlink" href="#option-groups" title="Permalink to this headline">¶</a></h2>
<p>Options can be registered as belonging to a group:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rabbit_group</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">OptGroup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;rabbit&#39;</span><span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;RabbitMQ options&#39;</span><span class="p">)</span>

<span class="n">rabbit_host_opt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">,</span>
                             <span class="n">default</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="s1">&#39;IP/hostname to listen on.&#39;</span><span class="p">),</span>
<span class="n">rabbit_port_opt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">PortOpt</span><span class="p">(</span><span class="s1">&#39;port&#39;</span><span class="p">,</span>
                              <span class="n">default</span><span class="o">=</span><span class="mi">5672</span><span class="p">,</span>
                              <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Port number to listen on.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">register_rabbit_opts</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_group</span><span class="p">(</span><span class="n">rabbit_group</span><span class="p">)</span>
    <span class="c1"># options can be registered under a group in either of these ways:</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">rabbit_host_opt</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">rabbit_group</span><span class="p">)</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">rabbit_port_opt</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;rabbit&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If no group attributes are required other than the group name, the group
need not be explicitly registered for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">register_rabbit_opts</span><span class="p">(</span><span class="n">conf</span><span class="p">):</span>
    <span class="c1"># The group will automatically be created, equivalent calling::</span>
    <span class="c1">#   conf.register_group(OptGroup(name=&#39;rabbit&#39;))</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">rabbit_port_opt</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;rabbit&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If no group is specified, options belong to the &#8216;DEFAULT&#8217; section of config
files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>glance-api.conf:
  [DEFAULT]
  bind_port = 9292
  ...

  [rabbit]
  host = localhost
  port = 5672
  use_ssl = False
  userid = guest
  password = guest
  virtual_host = /
</pre></div>
</div>
<p>Command-line options in a group are automatically prefixed with the
group name:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>--rabbit-host localhost --rabbit-port 9999
</pre></div>
</div>
</div>
<div class="section" id="accessing-option-values-in-your-code">
<h2>Accessing Option Values In Your Code<a class="headerlink" href="#accessing-option-values-in-your-code" title="Permalink to this headline">¶</a></h2>
<p>Option values in the default group are referenced as attributes/properties on
the config manager; groups are also attributes on the config manager, with
attributes for each of the options associated with the group:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>server.start(app, conf.bind_port, conf.bind_host, conf)

self.connection = kombu.connection.BrokerConnection(
    hostname=conf.rabbit.host,
    port=conf.rabbit.port,
    ...)
</pre></div>
</div>
</div>
<div class="section" id="option-value-interpolation">
<h2>Option Value Interpolation<a class="headerlink" href="#option-value-interpolation" title="Permalink to this headline">¶</a></h2>
<p>Option values may reference other values using PEP 292 string substitution:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;state_path&#39;</span><span class="p">,</span>
               <span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../&#39;</span><span class="p">),</span>
               <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Top-level directory for maintaining nova state.&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;sqlite_db&#39;</span><span class="p">,</span>
               <span class="n">default</span><span class="o">=</span><span class="s1">&#39;nova.sqlite&#39;</span><span class="p">,</span>
               <span class="n">help</span><span class="o">=</span><span class="s1">&#39;File name for SQLite.&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;sql_connection&#39;</span><span class="p">,</span>
               <span class="n">default</span><span class="o">=</span><span class="s1">&#39;sqlite:///$state_path/$sqlite_db&#39;</span><span class="p">,</span>
               <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Connection string for SQL database.&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Interpolation can be avoided by using <cite>$$</cite>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use <cite>.</cite> to delimit option from other groups, e.g.
${mygroup.myoption}.</p>
</div>
</div>
<div class="section" id="special-handling-instructions">
<h2>Special Handling Instructions<a class="headerlink" href="#special-handling-instructions" title="Permalink to this headline">¶</a></h2>
<p>Options may be declared as required so that an error is raised if the user
does not supply a value for the option:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;service_name&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;image_id&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Options may be declared as secret so that their values are not leaked into
log files:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
   <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;s3_store_access_key&#39;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
   <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;s3_store_secret_key&#39;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
   <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="dictionary-options">
<h2>Dictionary Options<a class="headerlink" href="#dictionary-options" title="Permalink to this headline">¶</a></h2>
<p>If you need end users to specify a dictionary of key/value pairs, then you can
use the DictOpt:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">DictOpt</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span>
                <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The end users can then specify the option foo in their configuration file
as shown below:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">foo</span> <span class="o">=</span> <span class="s">k1:v1,k2:v2</span>
</pre></div>
</div>
</div>
<div class="section" id="global-configopts">
<h2>Global ConfigOpts<a class="headerlink" href="#global-configopts" title="Permalink to this headline">¶</a></h2>
<p>This module also contains a global instance of the ConfigOpts class
in order to support a common usage pattern in OpenStack:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oslo_config</span> <span class="kn">import</span> <span class="n">cfg</span>

<span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;bind_host&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">PortOpt</span><span class="p">(</span><span class="s1">&#39;bind_port&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">9292</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">CONF</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">CONF</span>
<span class="n">CONF</span><span class="o">.</span><span class="n">register_opts</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">server</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
    <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">CONF</span><span class="o">.</span><span class="n">bind_port</span><span class="p">,</span> <span class="n">CONF</span><span class="o">.</span><span class="n">bind_host</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="positional-command-line-arguments">
<h2>Positional Command Line Arguments<a class="headerlink" href="#positional-command-line-arguments" title="Permalink to this headline">¶</a></h2>
<p>Positional command line arguments are supported via a &#8216;positional&#8217; Opt
constructor argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ConfigOpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">register_cli_opt</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">MultiStrOpt</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">positional</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">bar</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="sub-parsers">
<h2>Sub-Parsers<a class="headerlink" href="#sub-parsers" title="Permalink to this headline">¶</a></h2>
<p>It is also possible to use argparse &#8220;sub-parsers&#8221; to parse additional
command line arguments using the SubCommandOpt class:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_parsers</span><span class="p">(</span><span class="n">subparsers</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">list_action</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">list_action</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ConfigOpts</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">register_cli_opt</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">SubCommandOpt</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="n">handler</span><span class="o">=</span><span class="n">add_parsers</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">conf</span><span class="o">.</span><span class="n">action</span><span class="o">.</span><span class="n">id</span>
<span class="go">(&#39;list&#39;, &#39;10&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-option">
<h2>Advanced Option<a class="headerlink" href="#advanced-option" title="Permalink to this headline">¶</a></h2>
<p>Use if you need to label an option as advanced in sample files, indicating the
option is not normally used by the majority of users and might have a
significant effect on stability and/or performance:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oslo_config</span> <span class="kn">import</span> <span class="n">cfg</span>

<span class="n">opts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;option1&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span>
                <span class="n">advanced</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;This is help &#39;</span>
                <span class="s1">&#39;text.&#39;</span><span class="p">),</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">PortOpt</span><span class="p">(</span><span class="s1">&#39;option2&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;default_value&#39;</span><span class="p">,</span>
                 <span class="n">help</span><span class="o">=</span><span class="s1">&#39;This is help text.&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">CONF</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">CONF</span>
<span class="n">CONF</span><span class="o">.</span><span class="n">register_opts</span><span class="p">(</span><span class="n">opts</span><span class="p">)</span>
</pre></div>
</div>
<p>This will result in the option being pushed to the bottom of the
namespace and labeled as advanced in the sample files, with a notation
about possible effects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[DEFAULT]
...
# This is help text. (string value)
# option2 = default_value
...
&lt;pushed to bottom of section&gt;
...
# This is help text. (string value)
# Advanced Option: intended for advanced users and not used
# by the majority of users, and might have a significant
# effect on stability and/or performance.
# option1 = default_value
</pre></div>
</div>
</div>
<div class="section" id="option-deprecation">
<h2>Option Deprecation<a class="headerlink" href="#option-deprecation" title="Permalink to this headline">¶</a></h2>
<p>If you want to rename some options, move them to another group or remove
completely, you may change their declarations using <cite>deprecated_name</cite>,
<cite>deprecated_group</cite>  and <cite>deprecated_for_removal</cite> parameters to the <a class="reference internal" href="opts.html#oslo_config.cfg.Opt" title="oslo_config.cfg.Opt"><code class="xref py py-class docutils literal"><span class="pre">Opt</span></code></a>
constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">oslo_config</span> <span class="kn">import</span> <span class="n">cfg</span>

<span class="n">conf</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ConfigOpts</span><span class="p">()</span>

<span class="n">opt_1</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;opt_1&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">deprecated_name</span><span class="o">=</span><span class="s1">&#39;opt1&#39;</span><span class="p">)</span>
<span class="n">opt_2</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">StrOpt</span><span class="p">(</span><span class="s1">&#39;opt_2&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;spam&#39;</span><span class="p">,</span> <span class="n">deprecated_group</span><span class="o">=</span><span class="s1">&#39;DEFAULT&#39;</span><span class="p">)</span>
<span class="n">opt_3</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">BoolOpt</span><span class="p">(</span><span class="s1">&#39;opt_3&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">deprecated_for_removal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">opt_1</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;group_1&#39;</span><span class="p">)</span>
<span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">opt_2</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;group_2&#39;</span><span class="p">)</span>
<span class="n">conf</span><span class="o">.</span><span class="n">register_opt</span><span class="p">(</span><span class="n">opt_3</span><span class="p">)</span>

<span class="n">conf</span><span class="p">([</span><span class="s1">&#39;--config-file&#39;</span><span class="p">,</span> <span class="s1">&#39;config.conf&#39;</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">conf</span><span class="o">.</span><span class="n">group_1</span><span class="o">.</span><span class="n">opt_1</span> <span class="o">==</span> <span class="s1">&#39;bar&#39;</span>
<span class="k">assert</span> <span class="n">conf</span><span class="o">.</span><span class="n">group_2</span><span class="o">.</span><span class="n">opt_2</span> <span class="o">==</span> <span class="s1">&#39;eggs&#39;</span>
<span class="k">assert</span> <span class="n">conf</span><span class="o">.</span><span class="n">opt_3</span>
</pre></div>
</div>
<p>Assuming that the file config.conf has the following content:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">group_1</span><span class="p">]</span>
<span class="n">opt1</span> <span class="o">=</span> <span class="n">bar</span>

<span class="p">[</span><span class="n">DEFAULT</span><span class="p">]</span>
<span class="n">opt_2</span> <span class="o">=</span> <span class="n">eggs</span>
<span class="n">opt_3</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>the script will succeed, but will log three respective warnings about the
given deprecated options.</p>
<p>There are also <cite>deprecated_reason</cite> and <cite>deprecated_since</cite> parameters for
specifying some additional information about a deprecation.</p>
<p>All the mentioned parameters can be mixed together in any combinations.</p>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">The cfg Module</a><ul>
<li><a class="reference internal" href="#option-types">Option Types</a></li>
<li><a class="reference internal" href="#registering-options">Registering Options</a></li>
<li><a class="reference internal" href="#loading-config-files">Loading Config Files</a></li>
<li><a class="reference internal" href="#option-groups">Option Groups</a></li>
<li><a class="reference internal" href="#accessing-option-values-in-your-code">Accessing Option Values In Your Code</a></li>
<li><a class="reference internal" href="#option-value-interpolation">Option Value Interpolation</a></li>
<li><a class="reference internal" href="#special-handling-instructions">Special Handling Instructions</a></li>
<li><a class="reference internal" href="#dictionary-options">Dictionary Options</a></li>
<li><a class="reference internal" href="#global-configopts">Global ConfigOpts</a></li>
<li><a class="reference internal" href="#positional-command-line-arguments">Positional Command Line Arguments</a></li>
<li><a class="reference internal" href="#sub-parsers">Sub-Parsers</a></li>
<li><a class="reference internal" href="#advanced-option">Advanced Option</a></li>
<li><a class="reference internal" href="#option-deprecation">Option Deprecation</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="index.html"
                                  title="previous chapter">oslo.config</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="opts.html"
                                  title="next chapter">Option Definitions</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/oslo.config
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/cfg.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="opts.html" title="Option Definitions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="oslo.config"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">oslo.config 3.22.1.dev4 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, OpenStack Foundation.
      Last updated on &#39;Fri Feb 10 05:57:31 2017, commit 572003b&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/oslo.config");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>