<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neutron Plugin Guide &mdash; searchlight 2.0.0.0rc2.dev8 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0.0rc2.dev8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="searchlight 2.0.0.0rc2.dev8 documentation" href="../index.html" />
    <link rel="up" title="Searchlight Indexing" href="../indexingservice.html" />
    <link rel="next" title="Nova Plugin Guide" href="nova.html" />
    <link rel="prev" title="Ironic Plugin Guide" href="ironic.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="neutron-plugin-guide">
<h1>Neutron Plugin Guide<a class="headerlink" href="#neutron-plugin-guide" title="Permalink to this headline">¶</a></h1>
<p>Integration is provided via a plugin. There are multiple configuration
settings required for proper indexing and incremental updates. Some of the
settings are specified in Searchlight configuration files. Others are
provided in other service configuration files.</p>
<div class="section" id="searchlight-configuration">
<h2>Searchlight Configuration<a class="headerlink" href="#searchlight-configuration" title="Permalink to this headline">¶</a></h2>
<p>Searchlight resource configuration options are shown below with their
configuration file and default values.</p>
<p>See <a class="reference internal" href="../plugins.html#searchlight-plugins"><span>Searchlight Plugin Documentation</span></a> for common options with their default values,
general configuration information, and an example complete configuration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unless you are changing to a non-default value, you do not need to
specify any of the following configuration options.</p>
</div>
<div class="section" id="searchlight-conf">
<h3>searchlight.conf<a class="headerlink" href="#searchlight-conf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="plugin-os-neutron-net">
<h4>Plugin: OS::Neutron::Net<a class="headerlink" href="#plugin-os-neutron-net" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_net]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
<div class="section" id="plugin-os-neutron-port">
<h4>Plugin: OS::Neutron::Port<a class="headerlink" href="#plugin-os-neutron-port" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_port]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
<div class="section" id="plugin-os-neutron-subnet">
<h4>Plugin: OS::Neutron::Subnet<a class="headerlink" href="#plugin-os-neutron-subnet" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_subnet]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
<div class="section" id="plugin-os-neutron-router">
<h4>Plugin: OS::Neutron::Router<a class="headerlink" href="#plugin-os-neutron-router" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_router]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
<div class="section" id="plugin-os-neutron-floatingip">
<h4>Plugin: OS::Neutron::FloatingIP<a class="headerlink" href="#plugin-os-neutron-floatingip" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_floatingip]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
<div class="section" id="plugin-os-neutron-securitygroup">
<h4>Plugin: OS::Neutron::SecurityGroup<a class="headerlink" href="#plugin-os-neutron-securitygroup" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_security_group]
enabled = true
resource_group_name = searchlight
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="neutron-configuration">
<h2>Neutron Configuration<a class="headerlink" href="#neutron-configuration" title="Permalink to this headline">¶</a></h2>
<p>Neutron sends notifications on create/update/delete actions on the
concepts that it implements. Currently Searchlight supports indexing
for networks, subnets, ports, routers, floating IPs and security groups.</p>
<div class="section" id="neutron-conf">
<h3>neutron.conf<a class="headerlink" href="#neutron-conf" title="Permalink to this headline">¶</a></h3>
<p>Notifications must be configured properly for searchlight to process
incremental updates. Enable notifications using the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">oslo_messaging_notifications</span><span class="p">]</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">messagingv2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Restart the Neutron api service (q-svc) after making changes.
See <a class="reference internal" href="../plugins.html#plugin-notifications"><span>Notifications</span></a> for more information on
notification topics.</p>
</div>
</div>
<div class="section" id="local-conf-devstack">
<h3>local.conf (devstack)<a class="headerlink" href="#local-conf-devstack" title="Permalink to this headline">¶</a></h3>
<p>The settings above may be automatically configured by <code class="docutils literal"><span class="pre">stack.sh</span></code>
by adding them to the following post config section in devstack.
Just place the following in local.conf and copy the above settings
underneath it.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[[post-config|$NEUTRON_CONF]]
[DEFAULT]
</pre></div>
</div>
</div>
</div>
<div class="section" id="neutron-rbac-reference">
<h2>Neutron RBAC Reference<a class="headerlink" href="#neutron-rbac-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rbac-filters">
<h3>RBAC Filters<a class="headerlink" href="#rbac-filters" title="Permalink to this headline">¶</a></h3>
<p>RBAC in searchlight neutron plugin is implemented as:</p>
<p>Networks are visible within a tenant OR if they are shared OR if they are external.
Subnets are visible within a tenant OR if their network is shared (OR for admins if their network is external).
Ports are visible within a tenant (OR for admins if their network is shared or external).
Routers are visible within a tenant.
Floating IPs are visible within a tenant.
Security groups are visible within a tenant.</p>
</div>
</div>
<div class="section" id="neutron-ports-notifications">
<h2>Neutron Ports Notifications<a class="headerlink" href="#neutron-ports-notifications" title="Permalink to this headline">¶</a></h2>
<p>Not all Neutron ports send notifications when created/updated. Depending on the port&#8217;s
<code class="docutils literal"><span class="pre">device_owner</span></code>, the notifications will be sent. The <code class="docutils literal"><span class="pre">device_owner</span></code>&#8216;s that will
send a notification are:</p>
<blockquote>
<div><ul class="simple">
<li>compute:*</li>
<li>baremetal:*</li>
</ul>
</div></blockquote>
<p>We want the initial indexing (and subsequent re-indexings) to match the state that
Searchlight receives from the Neutron notifications. Having this mismatch will lead
to the Searchlight state being out of sync with the Neutron state. To prevent this
from happening, <code class="docutils literal"><span class="pre">searchlight-manage</span></code> will index only the Neutron ports that have
<code class="docutils literal"><span class="pre">device_owner</span></code> defined above. All other ports with <code class="docutils literal"><span class="pre">device_owner</span></code> not listed
above will be ignored when indexing.</p>
</div>
<div class="section" id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="newton">
<h3>1.0.0.0 (Newton)<a class="headerlink" href="#newton" title="Permalink to this headline">¶</a></h3>
<p>The Neutron tenant RBAC policy functionality is supported as
part of the OS::Neutron::Net resource type.</p>
</div>
<div class="section" id="mitaka">
<h3>0.2.0.0 (Mitaka)<a class="headerlink" href="#mitaka" title="Permalink to this headline">¶</a></h3>
<p>Notifications must be configured properly for searchlight to process
incremental updates. Searchlight must use its own topic. Use the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">notification_driver</span> <span class="o">=</span> <span class="n">messaging</span>
<span class="n">notification_topics</span> <span class="o">=</span> <span class="n">searchlight_indexer</span>
</pre></div>
</div>
<p>DHCP ports are <em>not</em> indexed. Neutron doesn&#8217;t provide a reliable way for
Searchlight to index these ports since they are created and modified
asynchronously from the subnets that they&#8217;re attached to.</p>
<p>All provider:* properties of networks are exposed to administrators only.
All binding:* properties of ports are also visible only to administrators.
The &#8216;distributed&#8217; and &#8216;ha&#8217; router properties are available only to
administrators.</p>
<p>Additional properties can be protected similarly with the <cite>admin_only_fields</cite>
under each plugin&#8217;s configuration section. Glob-like patterns are supported.
For instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[resource_plugin:os_neutron_net]
admin_only_fields=admin_state_up,status
</pre></div>
</div>
<p>See: ADMIN_ONLY_FIELDS in:
* searchlight/elasticsearch/plugins/neutron/networks.py
* searchlight/elasticsearch/plugins/neutron/ports.py
* searchlight/elasticsearch/plugins/neutron/routers.py</p>
<p>Floating IP addresses are mapped as type &#8216;ip&#8217; which only supports ipv4 in
Elasticsearch prior to the 5.0 release. Neutron doesn&#8217;t seem to support ipv6
floating IPs since translating ipv4 FIPs to ipv6 internal addresses isn&#8217;t
supported and mapping ipv6-&gt;ipv6 is deemed unnecessary.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Neutron Plugin Guide</a><ul>
<li><a class="reference internal" href="#searchlight-configuration">Searchlight Configuration</a><ul>
<li><a class="reference internal" href="#searchlight-conf">searchlight.conf</a><ul>
<li><a class="reference internal" href="#plugin-os-neutron-net">Plugin: OS::Neutron::Net</a></li>
<li><a class="reference internal" href="#plugin-os-neutron-port">Plugin: OS::Neutron::Port</a></li>
<li><a class="reference internal" href="#plugin-os-neutron-subnet">Plugin: OS::Neutron::Subnet</a></li>
<li><a class="reference internal" href="#plugin-os-neutron-router">Plugin: OS::Neutron::Router</a></li>
<li><a class="reference internal" href="#plugin-os-neutron-floatingip">Plugin: OS::Neutron::FloatingIP</a></li>
<li><a class="reference internal" href="#plugin-os-neutron-securitygroup">Plugin: OS::Neutron::SecurityGroup</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#neutron-configuration">Neutron Configuration</a><ul>
<li><a class="reference internal" href="#neutron-conf">neutron.conf</a></li>
<li><a class="reference internal" href="#local-conf-devstack">local.conf (devstack)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#neutron-rbac-reference">Neutron RBAC Reference</a><ul>
<li><a class="reference internal" href="#rbac-filters">RBAC Filters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#neutron-ports-notifications">Neutron Ports Notifications</a></li>
<li><a class="reference internal" href="#release-notes">Release Notes</a><ul>
<li><a class="reference internal" href="#newton">1.0.0.0 (Newton)</a></li>
<li><a class="reference internal" href="#mitaka">0.2.0.0 (Mitaka)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="ironic.html"
                                  title="previous chapter">Ironic Plugin Guide</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="nova.html"
                                  title="next chapter">Nova Plugin Guide</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/searchlight
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/plugins/neutron.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="nova.html" title="Nova Plugin Guide"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="ironic.html" title="Ironic Plugin Guide"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">searchlight 2.0.0.0rc2.dev8 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../indexingservice.html" accesskey="U">Searchlight Indexing</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2010-2015, OpenStack Foundation..
      Last updated on &#39;Thu Feb 9 15:23:46 2017, commit 40ee622&#39;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/searchlight");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>