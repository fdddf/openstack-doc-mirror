<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Install the Container Infrastructure Management service from source &mdash; magnum 4.0.1.dev40 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0.1.dev40',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="magnum 4.0.1.dev40 documentation" href="index.html" />
    <link rel="prev" title="Configuration" href="configuring.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="install-the-container-infrastructure-management-service-from-source">
<span id="install"></span><h1>Install the Container Infrastructure Management service from source<a class="headerlink" href="#install-the-container-infrastructure-management-service-from-source" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install-and-configure">
<h2>Install and configure<a class="headerlink" href="#install-and-configure" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to install and configure the Container
Infrastructure Management service, code-named magnum, on the controller node.</p>
<p>This section assumes that you already have a working OpenStack environment with
at least the following components installed: Identity service, Image service,
Compute service, Networking service, Block Storage service and Orchestration
service. See <a class="reference external" href="http://docs.openstack.org/#install-guides">OpenStack Install Guides</a>.</p>
<p>To provide access to Docker Swarm or Kubernetes using the native clients
(docker or kubectl respectively) magnum uses TLS certificates. To store the
certificates, it is recommended to use the <a class="reference external" href="http://docs.openstack.org/project-install-guide/key-manager/draft/">Key Manager service, code-named
barbican</a>, or you can save them in magnum&#8217;s database.</p>
<p>Optionally, you can install the following components:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.openstack.org/networking-guide/config-lbaas.html">Load Balancer as a Service (LBaaS v2)</a> to create clusters with multiple
masters</li>
<li><a class="reference external" href="http://docs.openstack.org/project-install-guide/baremetal/draft/">Bare Metal service</a> to create baremetal clusters</li>
<li><a class="reference external" href="http://docs.openstack.org/project-install-guide/object-storage/draft/">Object Storage service</a> to make private Docker registries available to
users</li>
<li><a class="reference external" href="http://docs.openstack.org/project-install-guide/telemetry/draft/">Telemetry Data Collection service</a> to periodically send
magnum-related metrics</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Magnum creates clusters of compute instances on the Compute service (nova).
These instances must have basic Internet connectivity and must be able to
reach magnum&#8217;s API server. Make sure that the Compute and Network services
are configured accordingly.</p>
</div>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>Before you install and configure the Container Infrastructure Management
service, you must create a database, service credentials, and API endpoints.</p>
<ol class="arabic">
<li><p class="first">To create the database, complete these steps:</p>
<ul>
<li><p class="first">Use the database access client to connect to the database
server as the <code class="docutils literal"><span class="pre">root</span></code> user:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> mysql -u root -p
</pre></div>
</div>
</li>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">magnum</span></code> database:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">CREATE DATABASE magnum;</span>
</pre></div>
</div>
</li>
<li><p class="first">Grant proper access to the <code class="docutils literal"><span class="pre">magnum</span></code> database:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">GRANT ALL PRIVILEGES ON magnum.* TO &#39;magnum&#39;@&#39;controller&#39; \</span>
<span class="go">  IDENTIFIED BY &#39;MAGNUM_DBPASS&#39;;</span>
<span class="go">GRANT ALL PRIVILEGES ON magnum.* TO &#39;magnum&#39;@&#39;%&#39; \</span>
<span class="go">  IDENTIFIED BY &#39;MAGNUM_DBPASS&#39;;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MAGNUM_DBPASS</span></code> with a suitable password.</p>
</li>
<li><p class="first">Exit the database access client.</p>
</li>
</ul>
</li>
<li><p class="first">Source the <code class="docutils literal"><span class="pre">admin</span></code> credentials to gain access to
admin-only CLI commands:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> . admin-openrc
</pre></div>
</div>
</li>
<li><p class="first">To create the service credentials, complete these steps:</p>
<ul>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">magnum</span></code> user:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack user create --domain default <span class="se">\</span>
  --password-prompt magnum
<span class="go">User Password:</span>
<span class="go">Repeat User Password:</span>
<span class="go">+-----------+----------------------------------+</span>
<span class="go">| Field     | Value                            |</span>
<span class="go">+-----------+----------------------------------+</span>
<span class="go">| domain_id | default                          |</span>
<span class="go">| enabled   | True                             |</span>
<span class="go">| id        | a8ebafc275c54d389dfc1bff8b4fe286 |</span>
<span class="go">| name      | magnum                           |</span>
<span class="go">+-----------+----------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Add the <code class="docutils literal"><span class="pre">admin</span></code> role to the <code class="docutils literal"><span class="pre">magnum</span></code> user:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack role add --project service --user magnum admin
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command provides no output.</p>
</div>
</li>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">magnum</span></code> service entity:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack service create --name magnum <span class="se">\</span>
  --description <span class="s2">&quot;OpenStack Container Infrastructure Management Service&quot;</span> <span class="se">\</span>
  container-infra
<span class="go">+-------------+-------------------------------------------------------+</span>
<span class="go">| Field       | Value                                                 |</span>
<span class="go">+-------------+-------------------------------------------------------+</span>
<span class="go">| description | OpenStack Container Infrastructure Management Service |</span>
<span class="go">| enabled     | True                                                  |</span>
<span class="go">| id          | 194faf83e8fd4e028e5ff75d3d8d0df2                      |</span>
<span class="go">| name        | magnum                                                |</span>
<span class="go">| type        | container-infra                                       |</span>
<span class="go">+-------------+-------------------------------------------------------+</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Create the Container Infrastructure Management service API endpoints:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack endpoint create --region RegionOne <span class="se">\</span>
  container-infra public http://CONTROLLER_IP:9511/v1
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| Field        | Value                            |</span>
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| enabled      | True                             |</span>
<span class="go">| id           | cb137e6366ad495bb521cfe92d8b8858 |</span>
<span class="go">| interface    | public                           |</span>
<span class="go">| region       | RegionOne                        |</span>
<span class="go">| region_id    | RegionOne                        |</span>
<span class="go">| service_id   | 0f7f62a1f1a247d2a4cb237642814d0e |</span>
<span class="go">| service_name | magnum                           |</span>
<span class="go">| service_type | container-infra                  |</span>
<span class="go">| url          | http://CONTROLLER_IP:9511/v1     |</span>
<span class="go">+--------------+----------------------------------+</span>

<span class="gp">$</span> openstack endpoint create --region RegionOne <span class="se">\</span>
  container-infra internal http://CONTROLLER_IP:9511/v1
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| Field        | Value                            |</span>
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| enabled      | True                             |</span>
<span class="go">| id           | 17cbc3b6f51449a0a818118d6d62868d |</span>
<span class="go">| interface    | internal                         |</span>
<span class="go">| region       | RegionOne                        |</span>
<span class="go">| region_id    | RegionOne                        |</span>
<span class="go">| service_id   | 0f7f62a1f1a247d2a4cb237642814d0e |</span>
<span class="go">| service_name | magnum                           |</span>
<span class="go">| service_type | container-infra                  |</span>
<span class="go">| url          | http://CONTROLLER_IP:9511/v1     |</span>
<span class="go">+--------------+----------------------------------+</span>

<span class="gp">$</span> openstack endpoint create --region RegionOne <span class="se">\</span>
  container-infra admin http://CONTROLLER_IP:9511/v1
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| Field        | Value                            |</span>
<span class="go">+--------------+----------------------------------+</span>
<span class="go">| enabled      | True                             |</span>
<span class="go">| id           | 30f8888e6b6646d7b5cd14354c95a684 |</span>
<span class="go">| interface    | admin                            |</span>
<span class="go">| region       | RegionOne                        |</span>
<span class="go">| region_id    | RegionOne                        |</span>
<span class="go">| service_id   | 0f7f62a1f1a247d2a4cb237642814d0e |</span>
<span class="go">| service_name | magnum                           |</span>
<span class="go">| service_type | container-infra                  |</span>
<span class="go">| url          | http://CONTROLLER_IP:9511/v1     |</span>
<span class="go">+--------------+----------------------------------+</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">CONTROLLER_IP</span></code> with the IP magnum listens to. Alternatively,
you can use a hostname which is reachable by the Compute instances.</p>
</li>
<li><p class="first">Magnum requires additional information in the Identity service to
manage clusters. To add this information, complete these steps:</p>
<ul>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">magnum</span></code> domain that contains projects and users:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack domain create --description <span class="s2">&quot;Owns users and projects \</span>
<span class="s2">  created by magnum&quot;</span> magnum
<span class="go">  +-------------+-------------------------------------------+</span>
<span class="go">  | Field       | Value                                     |</span>
<span class="go">  +-------------+-------------------------------------------+</span>
<span class="go">  | description | Owns users and projects created by magnum |</span>
<span class="go">  | enabled     | True                                      |</span>
<span class="go">  | id          | 66e0469de9c04eda9bc368e001676d20          |</span>
<span class="go">  | name        | magnum                                    |</span>
<span class="go">  +-------------+-------------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the <code class="docutils literal"><span class="pre">magnum_domain_admin</span></code> user to manage projects and users
in the <code class="docutils literal"><span class="pre">magnum</span></code> domain:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack user create --domain magnum --password-prompt <span class="se">\</span>
  magnum_domain_admin
<span class="go">  User Password:</span>
<span class="go">  Repeat User Password:</span>
<span class="go">  +-----------+----------------------------------+</span>
<span class="go">  | Field     | Value                            |</span>
<span class="go">  +-----------+----------------------------------+</span>
<span class="go">  | domain_id | 66e0469de9c04eda9bc368e001676d20 |</span>
<span class="go">  | enabled   | True                             |</span>
<span class="go">  | id        | 529b81cf35094beb9784c6d06c090c2b |</span>
<span class="go">  | name      | magnum_domain_admin              |</span>
<span class="go">  +-----------+----------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Add the <code class="docutils literal"><span class="pre">admin</span></code> role to the <code class="docutils literal"><span class="pre">magnum_domain_admin</span></code> user in the
<code class="docutils literal"><span class="pre">magnum</span></code> domain to enable administrative management privileges
by the <code class="docutils literal"><span class="pre">magnum_domain_admin</span></code> user:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack role add --domain magnum --user-domain magnum <span class="se">\</span>
  --user magnum_domain_admin admin
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command provides no output.</p>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="install-and-configure-components">
<h3>Install and configure components<a class="headerlink" href="#install-and-configure-components" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Install OS-specific prerequisites:</p>
<ul>
<li><p class="first">Ubuntu 14.04 (trusty) or higher, Debian 8:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get update
<span class="gp">#</span> apt-get install python-dev libssl-dev libxml2-dev <span class="se">\</span>
                  libmysqlclient-dev libxslt-dev libpq-dev git <span class="se">\</span>
                  libffi-dev gettext build-essential
</pre></div>
</div>
</li>
<li><p class="first">Fedora 21 / Centos 7 / RHEL 7</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> yum install python-devel openssl-devel mysql-devel <span class="se">\</span>
              libxml2-devel libxslt-devel postgresql-devel git <span class="se">\</span>
              libffi-devel gettext gcc
</pre></div>
</div>
</li>
<li><p class="first">Fedora 22 or higher</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> dnf install python-devel openssl-devel mysql-devel <span class="se">\</span>
              libxml2-devel libxslt-devel postgresql-devel git <span class="se">\</span>
              libffi-devel gettext gcc
</pre></div>
</div>
</li>
<li><p class="first">openSUSE Leap 42.1</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> zypper install git libffi-devel libmysqlclient-devel <span class="se">\</span>
                 libopenssl-devel libxml2-devel libxslt-devel <span class="se">\</span>
                 postgresql-devel python-devel gettext-runtime gcc
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<ol class="arabic" start="2">
<li><p class="first">Create magnum user and necessary directories:</p>
<ul>
<li><p class="first">Create user:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> groupadd --system magnum
<span class="gp">#</span> useradd --home-dir <span class="s2">&quot;/var/lib/magnum&quot;</span> <span class="se">\</span>
      --create-home <span class="se">\</span>
      --system <span class="se">\</span>
      --shell /bin/false <span class="se">\</span>
      -g magnum <span class="se">\</span>
      magnum
</pre></div>
</div>
</li>
<li><p class="first">Create directories:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> mkdir -p /var/log/magnum
<span class="gp">#</span> mkdir -p /etc/magnum
</pre></div>
</div>
</li>
<li><p class="first">Set ownership to directories:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> chown magnum:magnum /var/log/magnum
<span class="gp">#</span> chown magnum:magnum /var/lib/magnum
<span class="gp">#</span> chown magnum:magnum /etc/magnum
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Install virtualenv and python prerequisites:</p>
<ul>
<li><p class="first">Install virtualenv and create one for magnum&#8217;s installation:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> easy_install -U virtualenv
<span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;virtualenv /var/lib/magnum/env&quot;</span> magnum
</pre></div>
</div>
</li>
<li><p class="first">Install python prerequisites:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;/var/lib/magnum/env/bin/pip install tox pymysql \</span>
<span class="s2">  python-memcached&quot;</span> magnum
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Clone and install magnum:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">cd</span> /var/lib/magnum
<span class="gp">#</span> git clone https://git.openstack.org/openstack/magnum.git
<span class="gp">#</span> chown -R magnum:magnum magnum
<span class="gp">#</span> <span class="nb">cd</span> magnum
<span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;/var/lib/magnum/env/bin/pip install -r requirements.txt&quot;</span> magnum
<span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;/var/lib/magnum/env/bin/python setup.py install&quot;</span> magnum
</pre></div>
</div>
</li>
<li><p class="first">Copy policy.json and api-paste.ini:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;cp etc/magnum/policy.json /etc/magnum&quot;</span> magnum
<span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;cp etc/magnum/api-paste.ini /etc/magnum&quot;</span> magnum
</pre></div>
</div>
</li>
<li><p class="first">Generate a sample configuration file:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;/var/lib/magnum/env/bin/tox -e genconfig&quot;</span> magnum
<span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;cp etc/magnum/magnum.conf.sample \</span>
<span class="s2">  /etc/magnum/magnum.conf&quot;</span> magnum
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">/etc/magnum/magnum.conf</span></code>:</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section,
configure <code class="docutils literal"><span class="pre">RabbitMQ</span></code> message queue access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">transport_url</span> <span class="o">=</span> <span class="s">rabbit://openstack:RABBIT_PASS@controller</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">RABBIT_PASS</span></code> with the password you chose for the
<code class="docutils literal"><span class="pre">openstack</span></code> account in <code class="docutils literal"><span class="pre">RabbitMQ</span></code>.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[api]</span></code> section, configure the host:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[api]</span>
<span class="na">...</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">CONTROLLER_IP</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">CONTROLLER_IP</span></code> with the IP address on which you wish magnum api
should listen.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[certificates]</span></code> section, select <code class="docutils literal"><span class="pre">barbican</span></code> (or <code class="docutils literal"><span class="pre">local</span></code> if
you don&#8217;t have barbican installed):</p>
<ul>
<li><p class="first">Use barbican to store certificates:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[certificates]</span>
<span class="na">...</span>
<span class="na">cert_manager_type</span> <span class="o">=</span> <span class="s">barbican</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Barbican is recommended for production environments, local store should
be used for evaluation purposes.</p>
</div>
<ul>
<li><p class="first">To use local store for certificates, you have to create and specify the
directory to use:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c  <span class="s2">&quot;mkdir -p /var/lib/magnum/certificates/&quot;</span> magnum
</pre></div>
</div>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[certificates]</span>
<span class="na">...</span>
<span class="na">cert_manager_type</span> <span class="o">=</span> <span class="s">local</span>
<span class="na">storage_path</span> <span class="o">=</span> <span class="s">/var/lib/magnum/certificates/</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[cinder_client]</span></code> section, configure the region name:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[cinder_client]</span>
<span class="na">...</span>
<span class="na">region_name</span> <span class="o">=</span> <span class="s">RegionOne</span>
</pre></div>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[database]</span></code> section, configure database access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[database]</span>
<span class="na">...</span>
<span class="na">connection</span> <span class="o">=</span> <span class="s">mysql+pymysql://magnum:MAGNUM_DBPASS@controller/magnum</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MAGNUM_DBPASS</span></code> with the password you chose for
the magnum database.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[keystone_authtoken]</span></code> and <code class="docutils literal"><span class="pre">trust</span></code> sections, configure
Identity service access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[keystone_authtoken]</span>
<span class="na">...</span>
<span class="na">memcached_servers</span> <span class="o">=</span> <span class="s">controller:11211</span>
<span class="na">auth_version</span> <span class="o">=</span> <span class="s">v3</span>
<span class="na">auth_uri</span> <span class="o">=</span> <span class="s">http://controller:5000/v3</span>
<span class="na">project_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">project_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">user_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">MAGNUM_PASS</span>
<span class="na">username</span> <span class="o">=</span> <span class="s">magnum</span>
<span class="na">auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357</span>
<span class="na">auth_type</span> <span class="o">=</span> <span class="s">password</span>

<span class="k">[trust]</span>
<span class="na">...</span>
<span class="na">trustee_domain_name</span> <span class="o">=</span> <span class="s">magnum</span>
<span class="na">trustee_domain_admin_name</span> <span class="o">=</span> <span class="s">magnum_domain_admin</span>
<span class="na">trustee_domain_admin_password</span> <span class="o">=</span> <span class="s">DOMAIN_ADMIN_PASS</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">trustee_domain_name</span></code> is the name of the <code class="docutils literal"><span class="pre">magnum</span></code> domain and
<code class="docutils literal"><span class="pre">trustee_domain_admin_name</span></code> is the name of the <code class="docutils literal"><span class="pre">magnum_domain_admin</span></code>
user. Replace MAGNUM_PASS with the password you chose for the magnum user in the
Identity service and DOMAIN_ADMIN_PASS with the password you chose for the
<code class="docutils literal"><span class="pre">magnum_domain_admin</span></code> user.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[oslo_concurrency]</span></code> section, configure the <code class="docutils literal"><span class="pre">lock_path</span></code>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[oslo_concurrency]</span>
<span class="na">...</span>
<span class="na">lock_path</span> <span class="o">=</span> <span class="s">/var/lib/magnum/tmp</span>
</pre></div>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[oslo_messaging_notifications]</span></code> section, configure the
<code class="docutils literal"><span class="pre">driver</span></code>:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[oslo_messaging_notifications]</span>
<span class="na">...</span>
<span class="na">driver</span> <span class="o">=</span> <span class="s">messaging</span>
</pre></div>
</div>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Make sure that <code class="docutils literal"><span class="pre">/etc/magnum/magnum.conf</span></code> still have the correct
permissions. You can set the permissions again with:</p>
<p class="last"># chown magnum:magnum /etc/magnum/magnum.conf</p>
</div>
</li>
<li><p class="first">Populate Magnum database:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> su -s /bin/sh -c <span class="s2">&quot;/var/lib/magnum/env/bin/magnum-db-manage upgrade&quot;</span> magnum
</pre></div>
</div>
</li>
<li><p class="first">Set magnum for log rotation:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">cd</span> /var/lib/magnum/magnum
<span class="gp">#</span> cp doc/examples/etc/logrotate.d/magnum.logrotate /etc/logrotate.d/magnum
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="finalize-installation">
<h3>Finalize installation<a class="headerlink" href="#finalize-installation" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Create init scripts and services:</p>
<ul>
<li><p class="first">Ubuntu 14.04 (trusty):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">cd</span> /var/lib/magnum/magnum
<span class="gp">#</span> cp doc/examples/etc/init/magnum-api.conf <span class="se">\</span>
  /etc/init/magnum-api.conf
<span class="gp">#</span> cp doc/examples/etc/init/magnum-conductor.conf <span class="se">\</span>
  /etc/init/magnum-conductor.conf
</pre></div>
</div>
</li>
<li><p class="first">Ubuntu 14.10 or higher, Fedora 21 or higher/RHEL 7/CentOS 7,  openSUSE
Leap 42.1 or Debian 8:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">cd</span> /var/lib/magnum/magnum
<span class="gp">#</span> cp doc/examples/etc/systemd/system/magnum-api.service <span class="se">\</span>
  /etc/systemd/system/magnum-api.service
<span class="gp">#</span> cp doc/examples/etc/systemd/system/magnum-conductor.service <span class="se">\</span>
  /etc/systemd/system/magnum-conductor.service
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Start magnum-api and magnum-conductor:</p>
<ul>
<li><p class="first">Ubuntu 14.04 (trusty):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> start magnum-api
<span class="gp">#</span> start magnum-conductor
</pre></div>
</div>
</li>
<li><p class="first">Ubuntu 14.10 or higher, Fedora 21 or higher/RHEL 7/CentOS 7,  openSUSE
Leap 42.1 or Debian 8:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> systemctl <span class="nb">enable</span> magnum-api
<span class="gp">#</span> systemctl <span class="nb">enable</span> magnum-conductor
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> systemctl start magnum-api
<span class="gp">#</span> systemctl start magnum-conductor
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Verify that magnum-api and magnum-conductor services are running:</p>
<ul>
<li><p class="first">Ubuntu 14.04 (trusty):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> status magnum-api
<span class="gp">#</span> status magnum-conductor
</pre></div>
</div>
</li>
<li><p class="first">Ubuntu 14.10 or higher, Fedora 21 or higher/RHEL 7/CentOS 7,  openSUSE
Leap 42.1 or Debian 8:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> systemctl status magnum-api
<span class="gp">#</span> systemctl status magnum-conductor
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="install-the-command-line-client">
<h3>Install the command-line client<a class="headerlink" href="#install-the-command-line-client" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Install OS-specific prerequisites:</p>
<ul>
<li><p class="first">Fedora 21/RHEL 7/CentOS 7</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> yum install python-devel openssl-devel python-virtualenv <span class="se">\</span>
              libffi-devel git gcc
</pre></div>
</div>
</li>
<li><p class="first">Fedora 22 or higher</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> dnf install python-devel openssl-devel python-virtualenv <span class="se">\</span>
              libffi-devel git gcc
</pre></div>
</div>
</li>
<li><p class="first">Ubuntu/Debian</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get update
<span class="gp">#</span> apt-get install python-dev libssl-dev python-virtualenv <span class="se">\</span>
                  libffi-dev git gcc
</pre></div>
</div>
</li>
<li><p class="first">openSUSE Leap 42.1</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> zypper install python-devel libopenssl-devel python-virtualenv <span class="se">\</span>
                 libffi-devel git gcc
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Install the client in a virtual environment:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> ~
<span class="gp">$</span> git clone https://git.openstack.org/openstack/python-magnumclient.git
<span class="gp">$</span> <span class="nb">cd</span> python-magnumclient
<span class="gp">$</span> virtualenv .magnumclient-env
<span class="gp">$</span> .magnumclient-env/bin/pip install -r requirements.txt
<span class="gp">$</span> .magnumclient-env/bin/python setup.py install
</pre></div>
</div>
</li>
<li><p class="first">Now, you can export the client in your PATH:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/.magnumclient-env/bin/magnum
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The command-line client can be installed on the controller node or
on a different host than the service. It is good practice to install it
as a non-root user.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="next-steps">
<h3>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h3>
<p>Since you have the Container Infrastructure Management service running, you
can <a class="reference external" href="http://docs.openstack.org/project-install-guide/container-infrastructure-management/draft/verify.html">Verify Operation</a> and <a class="reference external" href="http://docs.openstack.org/project-install-guide/container-infrastructure-management/draft/launch-instance.html">Launch an
instance</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Install the Container Infrastructure Management service from source</a><ul>
<li><a class="reference internal" href="#install-and-configure">Install and configure</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#install-and-configure-components">Install and configure components</a></li>
<li><a class="reference internal" href="#finalize-installation">Finalize installation</a></li>
<li><a class="reference internal" href="#install-the-command-line-client">Install the command-line client</a></li>
<li><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="configuring.html"
                                  title="previous chapter">Configuration</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/magnum
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/install-guide-from-source.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="configuring.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">magnum 4.0.1.dev40 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2013, OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/magnum");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>