<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ironic-dbsync &mdash; Ironic 6.3.0.dev823 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/toggle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.3.0.dev823',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toggle.js"></script>
    <link rel="top" title="Ironic 6.3.0.dev823 documentation" href="../index.html" />
    <link rel="prev" title="Ironic Python Agent" href="../drivers/ipa.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="ironic-dbsync">
<h1>ironic-dbsync<a class="headerlink" href="#ironic-dbsync" title="Permalink to this headline">¶</a></h1>
<p>The <strong class="command">ironic-dbsync</strong> utility is used to create the database schema
tables that the ironic services will use for storage. It can also be used to
upgrade existing database tables when migrating between
different versions of ironic.</p>
<p>The <a class="reference external" href="http://alembic.readthedocs.org">Alembic library</a> is used to perform
the database migrations.</p>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>This is a partial list of the most useful options. To see the full list,
run the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">ironic</span><span class="o">-</span><span class="n">dbsync</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<dl class="option">
<dt id="cmdoption-ironic-dbsync-h">
<span id="cmdoption-ironic-dbsync--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-ironic-dbsync-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help message and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ironic-dbsync--config-dir">
<code class="descname">--config-dir</code><code class="descclassname"> &lt;DIR&gt;</code><a class="headerlink" href="#cmdoption-ironic-dbsync--config-dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to a config directory with configuration files.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ironic-dbsync--config-file">
<code class="descname">--config-file</code><code class="descclassname"> &lt;PATH&gt;</code><a class="headerlink" href="#cmdoption-ironic-dbsync--config-file" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to a configuration file to use.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ironic-dbsync-d">
<span id="cmdoption-ironic-dbsync--debug"></span><code class="descname">-d</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--debug</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-ironic-dbsync-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Print debugging output.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ironic-dbsync--version">
<code class="descname">--version</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-ironic-dbsync--version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the program&#8217;s version number and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ironic-dbsync-arg-upgrade">
<span id="cmdoption-ironic-dbsync-arg-stamp"></span><span id="cmdoption-ironic-dbsync-arg-revision"></span><span id="cmdoption-ironic-dbsync-arg-version"></span><span id="cmdoption-ironic-dbsync-arg-create_schema"></span><code class="descname">upgrade</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">stamp</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">revision</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">version</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">create_schema</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-ironic-dbsync-arg-upgrade" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#dbsync-cmds"><span>command</span></a> to run.</p>
</dd></dl>

</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Options for the various <a class="reference internal" href="#dbsync-cmds"><span>commands</span></a> for
<strong class="command">ironic-dbsync</strong> are listed when the <a class="reference internal" href="#cmdoption-ironic-dbsync-h"><code class="xref std std-option docutils literal"><span class="pre">-h</span></code></a> or <a class="reference internal" href="#cmdoption-ironic-dbsync--help"><code class="xref std std-option docutils literal"><span class="pre">--help</span></code></a>
option is used after the command.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic-dbsync create_schema --help
</pre></div>
</div>
<p>Information about the database is read from the ironic configuration file
used by the API server and conductor services. This file must be specified
with the <a class="reference internal" href="#cmdoption-ironic-dbsync--config-file"><code class="xref std std-option docutils literal"><span class="pre">--config-file</span></code></a> option:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic-dbsync --config-file /path/to/ironic.conf create_schema
</pre></div>
</div>
<p>The configuration file defines the database backend to use with the
<em>connection</em> database option:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[database]
connection=mysql+pymysql://root@localhost/ironic
</pre></div>
</div>
<p>If no configuration file is specified with the <a class="reference internal" href="#cmdoption-ironic-dbsync--config-file"><code class="xref std std-option docutils literal"><span class="pre">--config-file</span></code></a> option,
<strong class="command">ironic-dbsync</strong> assumes an SQLite database.</p>
</div>
<div class="section" id="command-options">
<span id="dbsync-cmds"></span><h2>Command Options<a class="headerlink" href="#command-options" title="Permalink to this headline">¶</a></h2>
<p><strong class="command">ironic-dbsync</strong> is given a command that tells the utility what actions
to perform. These commands can take arguments. Several commands are available:</p>
<div class="section" id="create-schema">
<span id="id1"></span><h3>create_schema<a class="headerlink" href="#create-schema" title="Permalink to this headline">¶</a></h3>
<dl class="option">
<dt id="cmdoption-create_schema-h">
<span id="cmdoption-create_schema--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-create_schema-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help for create_schema and exit.</p>
</dd></dl>

<p>This command will create database tables based on the most current version.
It assumes that there are no existing tables.</p>
<p>An example of creating database tables with the most recent version:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic-dbsync --config-file=/etc/ironic/ironic.conf create_schema
</pre></div>
</div>
</div>
<div class="section" id="revision">
<h3>revision<a class="headerlink" href="#revision" title="Permalink to this headline">¶</a></h3>
<dl class="option">
<dt id="cmdoption-revision-h">
<span id="cmdoption-revision--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-revision-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help for revision and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-revision-m">
<span id="cmdoption-revision--message"></span><code class="descname">-m</code><code class="descclassname"> &lt;MESSAGE&gt;</code><code class="descclassname">, </code><code class="descname">--message</code><code class="descclassname"> &lt;MESSAGE&gt;</code><a class="headerlink" href="#cmdoption-revision-m" title="Permalink to this definition">¶</a></dt>
<dd><p>The message to use with the revision file.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-revision--autogenerate">
<code class="descname">--autogenerate</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-revision--autogenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares table metadata in the application with the status of the database
and generates migrations based on this comparison.</p>
</dd></dl>

<p>This command will create a new revision file. You can use the
<a class="reference internal" href="#cmdoption-revision--message"><code class="xref std std-option docutils literal"><span class="pre">--message</span></code></a> option to comment the revision.</p>
<p>This is really only useful for ironic developers making changes that require
database changes. This revision file is used during database migration and
will specify the changes that need to be made to the database tables. Further
discussion is beyond the scope of this document.</p>
</div>
<div class="section" id="stamp">
<h3>stamp<a class="headerlink" href="#stamp" title="Permalink to this headline">¶</a></h3>
<dl class="option">
<dt id="cmdoption-stamp-h">
<span id="cmdoption-stamp--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-stamp-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help for stamp and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-stamp--revision">
<code class="descname">--revision</code><code class="descclassname"> &lt;REVISION&gt;</code><a class="headerlink" href="#cmdoption-stamp--revision" title="Permalink to this definition">¶</a></dt>
<dd><p>The revision number.</p>
</dd></dl>

<p>This command will &#8216;stamp&#8217; the revision table with the version specified with
the <a class="reference internal" href="#cmdoption-stamp--revision"><code class="xref std std-option docutils literal"><span class="pre">--revision</span></code></a> option. It will not run any migrations.</p>
</div>
<div class="section" id="upgrade">
<h3>upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h3>
<dl class="option">
<dt id="cmdoption-upgrade-h">
<span id="cmdoption-upgrade--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-upgrade-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help for upgrade and exit.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-upgrade--revision">
<code class="descname">--revision</code><code class="descclassname"> &lt;REVISION&gt;</code><a class="headerlink" href="#cmdoption-upgrade--revision" title="Permalink to this definition">¶</a></dt>
<dd><p>The revision number to upgrade to.</p>
</dd></dl>

<p>This command will upgrade existing database tables to the most recent version,
or to the version specified with the <a class="reference internal" href="#cmdoption-upgrade--revision"><code class="xref std std-option docutils literal"><span class="pre">--revision</span></code></a> option.</p>
<p>If there are no existing tables, then new tables are created, beginning
with the oldest known version, and successively upgraded using all of the
database migration files, until they are at the specified version. Note
that this behavior is different from the <a class="reference internal" href="#create-schema"><span>create_schema</span></a> command
that creates the tables based on the most recent version.</p>
<p>An example of upgrading to the most recent table versions:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic-dbsync --config-file=/etc/ironic/ironic.conf upgrade
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command is the default if no command is given to
<strong class="command">ironic-dbsync</strong>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The upgrade command is not compatible with SQLite databases since it uses
ALTER TABLE commands to upgrade the database tables. SQLite supports only
a limited subset of ALTER TABLE.</p>
</div>
</div>
<div class="section" id="version">
<h3>version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h3>
<dl class="option">
<dt id="cmdoption-version-h">
<span id="cmdoption-version--help"></span><code class="descname">-h</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--help</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-version-h" title="Permalink to this definition">¶</a></dt>
<dd><p>Show help for version and exit.</p>
</dd></dl>

<p>This command will output the current database version.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">ironic-dbsync</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#command-options">Command Options</a><ul>
<li><a class="reference internal" href="#create-schema">create_schema</a></li>
<li><a class="reference internal" href="#revision">revision</a></li>
<li><a class="reference internal" href="#stamp">stamp</a></li>
<li><a class="reference internal" href="#upgrade">upgrade</a></li>
<li><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../drivers/ipa.html"
                                  title="previous chapter">Ironic Python Agent</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/ironic
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/cmds/ironic-dbsync.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../drivers/ipa.html" title="Ironic Python Agent"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Ironic 6.3.0.dev823 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/Ironic");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>