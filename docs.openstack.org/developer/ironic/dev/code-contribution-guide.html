<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Code Contribution Guide &mdash; Ironic 6.3.0.dev823 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/toggle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '6.3.0.dev823',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toggle.js"></script>
    <link rel="top" title="Ironic 6.3.0.dev823 documentation" href="../index.html" />
    <link rel="next" title="Developer Quick-Start" href="dev-quickstart.html" />
    <link rel="prev" title="REST API Version History" href="webapi-version-history.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="code-contribution-guide">
<span id="id1"></span><h1>Code Contribution Guide<a class="headerlink" href="#code-contribution-guide" title="Permalink to this headline">¶</a></h1>
<p>This document provides some necessary points for developers to consider when
writing and reviewing Ironic code. The checklist will help developers get
things right.</p>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>If you&#8217;re completely new to OpenStack and want to contribute to the ironic
project, please start by familiarizing yourself with the <a class="reference external" href="http://docs.openstack.org/infra/manual/developers.html">Infra Team&#8217;s Developer
Guide</a>. This will help
you get your accounts set up in Launchpad and Gerrit, familiarize you with the
workflow for the OpenStack continuous integration and testing systems, and help
you with your first commit.</p>
<div class="section" id="launchpad-project">
<h3>LaunchPad Project<a class="headerlink" href="#launchpad-project" title="Permalink to this headline">¶</a></h3>
<p>Most of the tools used for OpenStack require a launchpad.net ID for
authentication.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://launchpad.net">https://launchpad.net</a></li>
<li><a class="reference external" href="https://launchpad.net/ironic">https://launchpad.net/ironic</a></li>
</ul>
</div>
</div>
<div class="section" id="related-projects">
<h3>Related Projects<a class="headerlink" href="#related-projects" title="Permalink to this headline">¶</a></h3>
<p>There are several projects that are tightly integrated with ironic and which are
developed by the same community.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://launchpad.net/bifrost">https://launchpad.net/bifrost</a></li>
<li><a class="reference external" href="https://launchpad.net/ironic-inspector">https://launchpad.net/ironic-inspector</a></li>
<li><a class="reference external" href="https://launchpad.net/ironic-lib">https://launchpad.net/ironic-lib</a></li>
<li><a class="reference external" href="https://launchpad.net/ironic-python-agent">https://launchpad.net/ironic-python-agent</a></li>
<li><a class="reference external" href="https://launchpad.net/python-ironicclient">https://launchpad.net/python-ironicclient</a></li>
<li><a class="reference external" href="https://launchpad.net/python-ironic-inspector-client">https://launchpad.net/python-ironic-inspector-client</a></li>
</ul>
</div>
</div>
<div class="section" id="project-hosting-details">
<h3>Project Hosting Details<a class="headerlink" href="#project-hosting-details" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Bug tracker</dt>
<dd><a class="reference external" href="http://launchpad.net/ironic">http://launchpad.net/ironic</a></dd>
<dt>Mailing list (prefix Subject line with <code class="docutils literal"><span class="pre">[ironic]</span></code>)</dt>
<dd><a class="reference external" href="http://lists.openstack.org/cgi-bin/mailman/listinfo/openstack-dev">http://lists.openstack.org/cgi-bin/mailman/listinfo/openstack-dev</a></dd>
<dt>Wiki</dt>
<dd><a class="reference external" href="http://wiki.openstack.org/Ironic">http://wiki.openstack.org/Ironic</a></dd>
<dt>Code Hosting</dt>
<dd><a class="reference external" href="https://git.openstack.org/cgit/openstack/ironic">https://git.openstack.org/cgit/openstack/ironic</a></dd>
<dt>Code Review</dt>
<dd><a class="reference external" href="https://review.openstack.org/#/q/status:open+project:openstack/ironic,n,z">https://review.openstack.org/#/q/status:open+project:openstack/ironic,n,z</a></dd>
</dl>
</div>
</div>
<div class="section" id="adding-new-features">
<h2>Adding New Features<a class="headerlink" href="#adding-new-features" title="Permalink to this headline">¶</a></h2>
<p>Starting with the Mitaka development cycle, Ironic tracks new features using
RFEs (Requests for Feature Enhancements) instead of blueprints. These are bugs
with &#8216;rfe&#8217; tag, and they should be submitted before a spec or code is proposed.
When a member of <a class="reference external" href="https://launchpad.net/~ironic-drivers/+members">ironic-drivers launchpad team</a> decides that the proposal
is worth implementing, a spec (if needed) and code should be submitted,
referencing the RFE bug. Contributors are welcome to submit a spec and/or code
before the RFE is approved, however those patches will not land until the RFE
is approved.</p>
<p>Here is a list of steps to do during the new process of adding a new feature to
Ironic:</p>
<ol class="arabic simple">
<li>Submit a bug report at <a class="reference external" href="https://bugs.launchpad.net/ironic/+filebug">https://bugs.launchpad.net/ironic/+filebug</a>.
There are two fields that must be filled: &#8216;summary&#8217; and
&#8216;further information&#8217;. The &#8216;summary&#8217; must be brief enough to fit in one
line: if you can’t describe it in a few words it may mean that you are
either trying to capture more than one RFE at once, or that you are having
a hard time defining what you are trying to solve at all.</li>
<li>Describe the proposed change in the &#8216;further information&#8217; field. The
description should provide enough details for a knowledgeable developer to
understand what is the existing problem in the current platform that needs
to be addressed, or what is the enhancement that would make the platform
more capable, both from a functional and a non-functional standpoint.</li>
<li>Submit the bug, add an &#8216;rfe&#8217; tag to it and assign yourself or whoever is
going to work on this feature.</li>
<li>As soon as a member of the ironic-drivers team acknowledges the bug, it
will be moved into the &#8216;Triaged&#8217; state. The importance will be set to
&#8216;Wishlist&#8217; to signal the fact that the report is indeed a feature and there
is no severity associated to it. Discussion about the RFE, and whether to
approve it, happens in bug comments while in the &#8216;Triaged&#8217; state.</li>
<li>The ironic-drivers team will evaluate the RFE and may advise the submitter
to file a spec in ironic-specs to elaborate on the feature request, in case
the RFE requires extra scrutiny, more design discussion, etc. For the spec
submission process, please see the <a class="reference internal" href="#ironic-specs-process">Ironic Specs Process</a>.</li>
<li>If a spec is not required, once the discussion has happened and there is
positive consensus among the ironic-drivers team on the RFE, the RFE is
&#8216;approved&#8217;, and its tag will move from &#8216;rfe&#8217; to &#8216;rfe-approved&#8217;. This means
that the feature is approved and the related code may be merged.</li>
<li>If a spec is required, the spec must be submitted (with the bug properly
referenced as &#8216;Partial-Bug&#8217; in the commit message), reviewed, and merged
before the RFE will be &#8216;approved&#8217; (and the tag changed to &#8216;rfe-approved&#8217;).</li>
<li>The bug then goes through the usual process &#8211; first to &#8216;In progress&#8217; when
the spec/code is being worked on, then &#8216;Fix Released&#8217; when it is
implemented.</li>
<li>If the RFE is rejected, the ironic-drivers team will move the bug to
&#8220;Won&#8217;t Fix&#8221; status.</li>
</ol>
<p>When working on an RFE, please be sure to tag your commits properly:
&#8220;Partial-Bug: #xxxx&#8221; or &#8220;Related-Bug: #xxxx&#8221; for intermediate commits for the
feature, and &#8220;Closes-Bug: #xxxx&#8221; for the final commit. It is also helpful to
set a consistent review topic, such as &#8220;bug/xxxx&#8221; for all patches related to
the RFE.</p>
<p>If the RFE spans across several projects (e.g. ironic and python-ironicclient),
but the main work is going to happen within ironic, please use the same bug for
all the code you&#8217;re submitting, there is no need to create a separate RFE in
every project.</p>
<p>Note that currently the Ironic bug tracker is managed by the open &#8216;ironic-bugs&#8217;
team, not the ironic-drivers team. This means that anyone may edit bug details,
and there is room to game the system here. <strong>RFEs may only be approved by
members of the ironic-drivers team</strong>. Attempts to sneak around this rule will
not be tolerated, and will be called out in public on the mailing list.</p>
</div>
<div class="section" id="live-upgrade-related-concerns">
<h2>Live Upgrade Related Concerns<a class="headerlink" href="#live-upgrade-related-concerns" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Ironic implements upgrade with the same methodology of Nova:</dt>
<dd><a class="reference external" href="http://docs.openstack.org/developer/nova/upgrade.html">http://docs.openstack.org/developer/nova/upgrade.html</a></dd>
</dl>
<div class="section" id="ironic-api-rpc-versions">
<h3>Ironic API RPC Versions<a class="headerlink" href="#ironic-api-rpc-versions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When the signature(arguments) of an RPC method is changed, the following things
need to be considered:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>The RPC version must be incremented and be the same value for both the client
(conductor/rpcapi.py, used by ironic-api) and the server (conductor/manager.py,
used by ironic-conductor).</li>
<li>New arguments of the method can only be added as optional. Existing arguments cannot be
removed or changed in incompatible ways (with the method in older RPC versions).</li>
<li>Client-side can pin a version cap by passing <code class="docutils literal"><span class="pre">version_cap</span></code> to the constructor
of oslo_messaging.RPCClient. Methods which change arguments should run
client.can_send_version() to see if the version of the request is compatible with the
version cap of RPC Client, otherwise the request needs to be created to work with a
previous version that is supported.</li>
<li>Server-side should tolerate the older version of requests in order to keep
working during the progress of live upgrade. The behavior of server-side should
depend on the input parameters passed from the client-side.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="object-versions">
<h3>Object Versions<a class="headerlink" href="#object-versions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When Object classes (subclasses of ironic.objects.base.IronicObject) are modified, the
following things need to be considered:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>The change of fields and the signature of remotable method needs a bump of object
version.</li>
<li>The arguments of methods can only be added as optional, they cannot be
removed or changed in an incompatible way.</li>
<li>Fields types cannot be changed. If it is a must, create a new field and
deprecate the old one.</li>
<li>When new version objects communicate with old version objects,
obj_make_compatible() will be called to convert objects to the target version during
serialization. So objects should implement their own obj_make_compatible() to
remove/alter attributes which was added/changed after the target version.</li>
<li>There is a test (object/test_objects.py) to generate the hash of object fields and the
signatures of remotable methods, which helps developers to check if the change of
objects need a version bump. The object fingerprint should only be updated with a
version bump.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="driver-internal-info">
<h2>Driver Internal Info<a class="headerlink" href="#driver-internal-info" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">driver_internal_info</span></code> node field was introduced in the Kilo release. It allows
driver developers to store internal information that can not be modified by end users.
Here is the list of existing common and agent driver attributes:</p>
<dl class="docutils">
<dt>Common attributes:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">is_whole_disk_image</span></code>: A Boolean value to indicate whether the user image contains ramdisk/kernel.</li>
<li><code class="docutils literal"><span class="pre">clean_steps</span></code>: An ordered list of clean steps that will be performed on the node.</li>
<li><code class="docutils literal"><span class="pre">instance</span></code>: A list of dictionaries containing the disk layout values.</li>
<li><code class="docutils literal"><span class="pre">root_uuid_or_disk_id</span></code>: A String value of the bare metal node&#8217;s root partition uuid or disk id.</li>
<li><code class="docutils literal"><span class="pre">persistent_boot_device</span></code>: A String value of device from <code class="docutils literal"><span class="pre">ironic.common.boot_devices</span></code>.</li>
<li><code class="docutils literal"><span class="pre">is_next_boot_persistent</span></code>: A Boolean value to indicate whether the next boot device is
<code class="docutils literal"><span class="pre">persistent_boot_device</span></code>.</li>
</ul>
</dd>
<dt>Agent driver attributes:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">agent_url</span></code>: A String value of IPA API URL so that Ironic can talk to IPA ramdisk.</li>
<li><code class="docutils literal"><span class="pre">hardware_manager_version</span></code>: A String value of the version of the hardware manager in IPA ramdisk.</li>
<li><code class="docutils literal"><span class="pre">target_raid_config</span></code>: A Dictionary containing the target RAID configuration. This is a copy of
the same name attribute in Node object. But this one is never actually saved into DB and is only
read by IPA ramdisk.</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These are only some fields in use. Other vendor drivers might expose more <code class="docutils literal"><span class="pre">driver_internal_info</span></code>
properties, please check their development documentation and/or module docstring for details.
It is important for developers to make sure these properties follow the precedent of prefixing their
variable names with a specific interface name (e.g., ilo_bar, drac_xyz), so as to minimize or avoid
any conflicts between interfaces.</p>
</div>
</div>
<div class="section" id="ironic-specs-process">
<h2>Ironic Specs Process<a class="headerlink" href="#ironic-specs-process" title="Permalink to this headline">¶</a></h2>
<p>Specifications must follow the template which can be found at
<a class="reference external" href="http://git.openstack.org/cgit/openstack/ironic-specs/tree/specs/template.rst">specs/template.rst</a>, which is quite self-documenting. Specifications are
proposed by adding them to the <cite>specs/approved</cite> directory, adding a soft link
to it from the <cite>specs/not-implemented</cite> directory, and posting it for
review to Gerrit. For more information, please see the <a class="reference external" href="http://git.openstack.org/cgit/openstack/ironic-specs/tree/README.rst">README</a>.</p>
<p>The same <a class="reference external" href="http://docs.openstack.org/infra/manual/developers.html">Gerrit process</a> as with source code,
using the repository <a class="reference external" href="http://git.openstack.org/cgit/openstack/ironic-specs/">ironic-specs</a>, is used to add new specifications.</p>
<p>All approved specifications are available at:
<a class="reference external" href="http://specs.openstack.org/openstack/ironic-specs">http://specs.openstack.org/openstack/ironic-specs</a>. If a specification has
been approved but not completed within one or more releases since the
approval, it may be re-reviewed to make sure it still makes sense as written.</p>
<p>Ironic specifications are part of the <a class="reference external" href="#adding-new-features">RFE (Requests for Feature Enhancements)
process</a>.
You are welcome to submit patches associated with an RFE, but they will have
a -2 (&#8220;do not merge&#8221;) until the specification has been approved. This is to
ensure that the patches don&#8217;t get accidentally merged beforehand. You will
still be able to get reviewer feedback and push new patch sets, even with a -2.
The <a class="reference external" href="https://review.openstack.org/#/admin/groups/352,members">list of core reviewers</a> for the specifications is small but mighty. (This is not
necessarily the same list of core reviewers for code patches.)</p>
<div class="section" id="changes-to-existing-specs">
<h3>Changes to existing specs<a class="headerlink" href="#changes-to-existing-specs" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>For approved but not-completed specs:</dt>
<dd><ul class="first last simple">
<li>cosmetic cleanup, fixing errors, and changing the definition of a feature
can be done to the spec.</li>
</ul>
</dd>
<dt>For approved and completed specs:</dt>
<dd><ul class="first last simple">
<li>changing a previously approved and completed spec should only be done
for cosmetic cleanup or fixing errors.</li>
<li>changing the definition of the feature should be done in a new spec.</li>
</ul>
</dd>
</dl>
<p>Please see the <a class="reference external" href="https://wiki.openstack.org/wiki/Ironic/Specs_Process">Ironic specs process wiki page</a> for further reference.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Code Contribution Guide</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#launchpad-project">LaunchPad Project</a></li>
<li><a class="reference internal" href="#related-projects">Related Projects</a></li>
<li><a class="reference internal" href="#project-hosting-details">Project Hosting Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-new-features">Adding New Features</a></li>
<li><a class="reference internal" href="#live-upgrade-related-concerns">Live Upgrade Related Concerns</a><ul>
<li><a class="reference internal" href="#ironic-api-rpc-versions">Ironic API RPC Versions</a></li>
<li><a class="reference internal" href="#object-versions">Object Versions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#driver-internal-info">Driver Internal Info</a></li>
<li><a class="reference internal" href="#ironic-specs-process">Ironic Specs Process</a><ul>
<li><a class="reference internal" href="#changes-to-existing-specs">Changes to existing specs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="webapi-version-history.html"
                                  title="previous chapter">REST API Version History</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="dev-quickstart.html"
                                  title="next chapter">Developer Quick-Start</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/ironic
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/dev/code-contribution-guide.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev-quickstart.html" title="Developer Quick-Start"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="webapi-version-history.html" title="REST API Version History"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Ironic 6.3.0.dev823 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/Ironic");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>