<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Enrollment</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Enrollment</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="configure-port-groups.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configure port groups"></i></a>
    
    
    <a href="enabling-https.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Enabling HTTPS"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 16:59</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Enrollment</a><ul>
<li><a class="reference internal" href="#enrollment-process">Enrollment process</a></li>
<li><a class="reference internal" href="#enrolling-a-node">Enrolling a node</a><ul>
<li><a class="reference internal" href="#api-version-1-10-and-below">API version 1.10 and below</a></li>
<li><a class="reference internal" href="#api-version-1-11-and-above">API version 1.11 and above</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logical-names">Logical names</a></li>
<li><a class="reference internal" href="#hardware-inspection">Hardware Inspection</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="enrollment">
<span id="id1"></span><h1>Enrollment<a class="headerlink" href="#enrollment" title="Permalink to this headline">¶</a></h1>
<p>After all the services have been properly configured, you should enroll your
hardware with the Bare Metal service, and confirm that the Compute service sees
the available hardware. The nodes will be visible to the Compute service once
they are in the <code class="docutils literal"><span class="pre">available</span></code> provision state.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">After enrolling nodes with the Bare Metal service, the Compute service
will not be immediately notified of the new resources. The Compute service&#8217;s
resource tracker syncs periodically, and so any changes made directly to the
Bare Metal service&#8217;s resources will become visible in the Compute service
only after the next run of that periodic task.
More information is in the <a class="reference internal" href="troubleshooting.html#troubleshooting"><span>Troubleshooting</span></a> section.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Any bare metal node that is visible to the Compute service may have a
workload scheduled to it, if both the <code class="docutils literal"><span class="pre">power</span></code> and <code class="docutils literal"><span class="pre">deploy</span></code> interfaces
pass the <code class="docutils literal"><span class="pre">validate</span></code> check.
If you wish to exclude a node from the Compute service&#8217;s scheduler, for
instance so that you can perform maintenance on it, you can set the node to
&#8220;maintenance&#8221; mode.
For more information see the <a class="reference internal" href="troubleshooting.html#maintenance-mode"><span>Maintenance mode</span></a> section.</p>
</div>
<div class="section" id="enrollment-process">
<h2>Enrollment process<a class="headerlink" href="#enrollment-process" title="Permalink to this headline">¶</a></h2>
<p>This section describes the main steps to enroll a node and make it available
for provisioning. Some steps are shown separately for illustration purposes,
and may be combined if desired.</p>
<ol class="arabic">
<li><p class="first">Create a node in the Bare Metal service. At a minimum, you must
specify the driver name (for example, &#8220;pxe_ipmitool&#8221;).
This will return the node UUID along with other information
about the node. The node&#8217;s provision state will be <code class="docutils literal"><span class="pre">available</span></code>. (The
example assumes that the client is using the default API version.):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-create -d pxe_ipmitool
+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| uuid         | dfc6189f-ad83-4261-9bda-b27258eb1987 |
| driver_info  | {}                                   |
| extra        | {}                                   |
| driver       | pxe_ipmitool                         |
| chassis_uuid |                                      |
| properties   | {}                                   |
| name         | None                                 |
+--------------+--------------------------------------+

ironic node-show dfc6189f-ad83-4261-9bda-b27258eb1987
+------------------------+--------------------------------------+
| Property               | Value                                |
+------------------------+--------------------------------------+
| target_power_state     | None                                 |
| extra                  | {}                                   |
| last_error             | None                                 |
| maintenance_reason     | None                                 |
| provision_state        | available                            |
| uuid                   | dfc6189f-ad83-4261-9bda-b27258eb1987 |
| console_enabled        | False                                |
| target_provision_state | None                                 |
| provision_updated_at   | None                                 |
| maintenance            | False                                |
| power_state            | None                                 |
| driver                 | pxe_ipmitool                         |
| properties             | {}                                   |
| instance_uuid          | None                                 |
| name                   | None                                 |
| driver_info            | {}                                   |
| ...                    | ...                                  |
+------------------------+--------------------------------------+
</pre></div>
</div>
<p>Beginning with the Kilo release a node may also be referred to by a logical
name as well as its UUID. To utilize this new feature a name must be
assigned to the node. This can be done when the node is created by
adding the <code class="docutils literal"><span class="pre">-n</span></code> option to the <code class="docutils literal"><span class="pre">node-create</span></code> command or by updating an
existing node with the <code class="docutils literal"><span class="pre">node-update</span></code> command. See <a class="reference internal" href="#logical-names">Logical Names</a> for
examples.</p>
<p>Beginning with the Liberty release, with API version 1.11 and above, a newly
created node will have an initial provision state of <code class="docutils literal"><span class="pre">enroll</span></code> as opposed to
<code class="docutils literal"><span class="pre">available</span></code>. See <a class="reference internal" href="#enrolling-a-node">Enrolling a node</a> for more details.</p>
</li>
<li><p class="first">Update the node <code class="docutils literal"><span class="pre">driver_info</span></code> so that Bare Metal service can manage the
node. Different drivers may require different information about the node.
You can determine this with the <code class="docutils literal"><span class="pre">driver-properties</span></code> command, as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic driver-properties pxe_ipmitool
+----------------------+-------------------------------------------------------------------------------------------------------------+
| Property             | Description                                                                                                 |
+----------------------+-------------------------------------------------------------------------------------------------------------+
| ipmi_address         | IP address or hostname of the node. Required.                                                               |
| ipmi_password        | password. Optional.                                                                                         |
| ipmi_username        | username; default is NULL user. Optional.                                                                   |
| ...                  | ...                                                                                                         |
| deploy_kernel        | UUID (from Glance) of the deployment kernel. Required.                                                      |
| deploy_ramdisk       | UUID (from Glance) of the ramdisk that is mounted at boot time. Required.                                   |
+----------------------+-------------------------------------------------------------------------------------------------------------+

ironic node-update $NODE_UUID add \
driver_info/ipmi_username=$USER \
driver_info/ipmi_password=$PASS \
driver_info/ipmi_address=$ADDRESS
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If IPMI is running on a port other than 623 (the default). The port must
be added to <code class="docutils literal"><span class="pre">driver_info</span></code> by specifying the <code class="docutils literal"><span class="pre">ipmi_port</span></code> value.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-update $NODE_UUID add driver_info/ipmi_port=$PORT_NUMBER
</pre></div>
</div>
<p class="last">Note that you may also specify all <code class="docutils literal"><span class="pre">driver_info</span></code> parameters during
<code class="docutils literal"><span class="pre">node-create</span></code> by passing the <strong>-i</strong> option multiple times.</p>
</div>
</li>
<li><p class="first">Update the node&#8217;s properties to match the bare metal flavor you created
earlier:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-update $NODE_UUID add \
properties/cpus=$CPU \
properties/memory_mb=$RAM_MB \
properties/local_gb=$DISK_GB \
properties/cpu_arch=$ARCH
</pre></div>
</div>
<p>As above, these can also be specified at node creation by passing the <strong>-p</strong>
option to <code class="docutils literal"><span class="pre">node-create</span></code> multiple times.</p>
</li>
<li><p class="first">If you wish to perform more advanced scheduling of the instances based on
hardware capabilities, you may add metadata to each node that will be
exposed to the nova scheduler (see: <a class="reference external" href="http://docs.openstack.org/developer/nova/devref/filter_scheduler.html?highlight=computecapabilitiesfilter">ComputeCapabilitiesFilter</a>).  A full
explanation of this is outside of the scope of this document. It can be done
through the special <code class="docutils literal"><span class="pre">capabilities</span></code> member of node properties:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-update $NODE_UUID add \
properties/capabilities=key1:val1,key2:val2
</pre></div>
</div>
</li>
<li><p class="first">As mentioned in the <a class="reference internal" href="configure-integration.html#flavor-creation"><span>Create Compute flavors for use with the Bare Metal service</span></a> section, if using the Kilo or later
release of Bare Metal service, you should specify a deploy kernel and
ramdisk which correspond to the node&#8217;s driver, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-update $NODE_UUID add \
driver_info/deploy_kernel=$DEPLOY_VMLINUZ_UUID \
driver_info/deploy_ramdisk=$DEPLOY_INITRD_UUID
</pre></div>
</div>
</li>
<li><p class="first">You must also inform Bare Metal service of the network interface cards which
are part of the node by creating a port with each NIC&#8217;s MAC address.
These MAC addresses are passed to the Networking service during instance
provisioning and used to configure the network appropriately:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic port-create -n $NODE_UUID -a $MAC_ADDRESS
</pre></div>
</div>
</li>
<li><p class="first">To check if Bare Metal service has the minimum information necessary for
a node&#8217;s driver to function, you may <code class="docutils literal"><span class="pre">validate</span></code> it:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-validate $NODE_UUID

+------------+--------+--------+
| Interface  | Result | Reason |
+------------+--------+--------+
| console    | True   |        |
| deploy     | True   |        |
| management | True   |        |
| power      | True   |        |
+------------+--------+--------+
</pre></div>
</div>
<p>If the node fails validation, each driver will return information as to why
it failed:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-validate $NODE_UUID

+------------+--------+-------------------------------------------------------------------------------------------------------------------------------------+
| Interface  | Result | Reason                                                                                                                              |
+------------+--------+-------------------------------------------------------------------------------------------------------------------------------------+
| console    | None   | not supported                                                                                                                       |
| deploy     | False  | Cannot validate iSCSI deploy. Some parameters were missing in node&#39;s instance_info. Missing are: [&#39;root_gb&#39;, &#39;image_source&#39;]        |
| management | False  | Missing the following IPMI credentials in node&#39;s driver_info: [&#39;ipmi_address&#39;].                                                     |
| power      | False  | Missing the following IPMI credentials in node&#39;s driver_info: [&#39;ipmi_address&#39;].                                                     |
+------------+--------+-------------------------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</li>
<li><p class="first">If using API version 1.11 or above, the node was created in the <code class="docutils literal"><span class="pre">enroll</span></code>
provision state. In order for the node to be available for deploying a
workload (for example, by the Compute service), it needs to be in the
<code class="docutils literal"><span class="pre">available</span></code> provision state. To do this, it must be moved into the
<code class="docutils literal"><span class="pre">manageable</span></code> state and then moved into the <code class="docutils literal"><span class="pre">available</span></code> state. The
<a class="reference internal" href="#api-version-1-11-and-above">API version 1.11 and above</a> section describes the commands for this.</p>
</li>
</ol>
</div>
<div class="section" id="enrolling-a-node">
<h2>Enrolling a node<a class="headerlink" href="#enrolling-a-node" title="Permalink to this headline">¶</a></h2>
<p>In the Liberty cycle, starting with API version 1.11, the Bare Metal service
added a new initial provision state of <code class="docutils literal"><span class="pre">enroll</span></code> to its state machine.</p>
<p>Existing automation tooling that use an API version lower than 1.11 are not
affected, since the initial provision state is still <code class="docutils literal"><span class="pre">available</span></code>.
However, using API version 1.11 or above may break existing automation tooling
with respect to node creation.</p>
<p>The default API version used by (the most recent) python-ironicclient is 1.9.</p>
<p>The examples below set the API version for each command. To set the
API version for all commands, you can set the environment variable
<code class="docutils literal"><span class="pre">IRONIC_API_VERSION</span></code>.</p>
<div class="section" id="api-version-1-10-and-below">
<h3>API version 1.10 and below<a class="headerlink" href="#api-version-1-10-and-below" title="Permalink to this headline">¶</a></h3>
<p>Below is an example of creating a node with API version 1.10. After creation,
the node will be in the <code class="docutils literal"><span class="pre">available</span></code> provision state.
Other API versions below 1.10 may be substituted in place of 1.10.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic --ironic-api-version 1.10 node-create -d agent_ilo -n pre11

+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| uuid         | cc4998a0-f726-4927-9473-0582458c6789 |
| driver_info  | {}                                   |
| extra        | {}                                   |
| driver       | agent_ilo                            |
| chassis_uuid |                                      |
| properties   | {}                                   |
| name         | pre11                                |
+--------------+--------------------------------------+


ironic --ironic-api-version 1.10 node-list

+--------------------------------------+-------+---------------+-------------+--------------------+-------------+
| UUID                                 | Name  | Instance UUID | Power State | Provisioning State | Maintenance |
+--------------------------------------+-------+---------------+-------------+--------------------+-------------+
| cc4998a0-f726-4927-9473-0582458c6789 | pre11 | None          | None        | available          | False       |
+--------------------------------------+-------+---------------+-------------+--------------------+-------------+
</pre></div>
</div>
</div>
<div class="section" id="api-version-1-11-and-above">
<h3>API version 1.11 and above<a class="headerlink" href="#api-version-1-11-and-above" title="Permalink to this headline">¶</a></h3>
<p>Beginning with API version 1.11, the initial provision state for newly created
nodes is <code class="docutils literal"><span class="pre">enroll</span></code>. In the examples below, other API versions above 1.11 may be
substituted in place of 1.11.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic --ironic-api-version 1.11 node-create -d agent_ilo -n post11

+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| uuid         | 0eb013bb-1e4b-4f4c-94b5-2e7468242611 |
| driver_info  | {}                                   |
| extra        | {}                                   |
| driver       | agent_ilo                            |
| chassis_uuid |                                      |
| properties   | {}                                   |
| name         | post11                               |
+--------------+--------------------------------------+


ironic --ironic-api-version 1.11 node-list

+--------------------------------------+--------+---------------+-------------+--------------------+-------------+
| UUID                                 | Name   | Instance UUID | Power State | Provisioning State | Maintenance |
+--------------------------------------+--------+---------------+-------------+--------------------+-------------+
| 0eb013bb-1e4b-4f4c-94b5-2e7468242611 | post11 | None          | None        | enroll             | False       |
+--------------------------------------+--------+---------------+-------------+--------------------+-------------+
</pre></div>
</div>
<p>In order for nodes to be available for deploying workloads on them, nodes
must be in the <code class="docutils literal"><span class="pre">available</span></code> provision state. To do this, nodes
created with API version 1.11 and above must be moved from the <code class="docutils literal"><span class="pre">enroll</span></code> state
to the <code class="docutils literal"><span class="pre">manageable</span></code> state and then to the <code class="docutils literal"><span class="pre">available</span></code> state.</p>
<p>To move a node to a different provision state, use the
<code class="docutils literal"><span class="pre">node-set-provision-state</span></code> command.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since it is an asynchronous call, the response for
<code class="docutils literal"><span class="pre">ironic</span> <span class="pre">node-set-provision-state</span></code> will not indicate whether the
transition succeeded or not. You can check the status of the
operation via <code class="docutils literal"><span class="pre">ironic</span> <span class="pre">node-show</span></code>. If it was successful,
<code class="docutils literal"><span class="pre">provision_state</span></code> will be in the desired state. If it failed,
there will be information in the node&#8217;s <code class="docutils literal"><span class="pre">last_error</span></code>.</p>
</div>
<p>After creating a node and before moving it from its initial provision state of
<code class="docutils literal"><span class="pre">enroll</span></code>, basic power and port information needs to be configured on the node.
The Bare Metal service needs this information because it verifies that it is
capable of controlling the node when transitioning the node from <code class="docutils literal"><span class="pre">enroll</span></code> to
<code class="docutils literal"><span class="pre">manageable</span></code> state.</p>
<p>To move a node from <code class="docutils literal"><span class="pre">enroll</span></code> to <code class="docutils literal"><span class="pre">manageable</span></code> provision state:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic --ironic-api-version 1.11 node-set-provision-state $NODE_UUID manage

ironic node-show $NODE_UUID

+------------------------+--------------------------------------------------------------------+
| Property               | Value                                                              |
+------------------------+--------------------------------------------------------------------+
| ...                    | ...                                                                |
| provision_state        | manageable                                                         | &lt;- verify correct state
| uuid                   | 0eb013bb-1e4b-4f4c-94b5-2e7468242611                               |
| ...                    | ...                                                                |
+------------------------+--------------------------------------------------------------------+
</pre></div>
</div>
<p>When a node is moved from the <code class="docutils literal"><span class="pre">manageable</span></code> to <code class="docutils literal"><span class="pre">available</span></code> provision
state, the node will go through automated cleaning if configured to do so (see
<a class="reference internal" href="configure-cleaning.html#configure-cleaning"><span>Configure the Bare Metal service for cleaning</span></a>).
To move a node from <code class="docutils literal"><span class="pre">manageable</span></code> to <code class="docutils literal"><span class="pre">available</span></code> provision state:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic --ironic-api-version 1.11 node-set-provision-state $NODE_UUID provide

ironic node-show $NODE_UUID

+------------------------+--------------------------------------------------------------------+
| Property               | Value                                                              |
+------------------------+--------------------------------------------------------------------+
| ...                    | ...                                                                |
| provision_state        | available                                                          | &lt; - verify correct state
| uuid                   | 0eb013bb-1e4b-4f4c-94b5-2e7468242611                               |
| ...                    | ...                                                                |
+------------------------+--------------------------------------------------------------------+
</pre></div>
</div>
<p>For more details on the Bare Metal service&#8217;s state machine, see the
<a class="reference external" href="http://docs.openstack.org/developer/ironic/dev/states.html">state machine</a>
documentation.</p>
</div>
</div>
<div class="section" id="logical-names">
<h2>Logical names<a class="headerlink" href="#logical-names" title="Permalink to this headline">¶</a></h2>
<p>Beginning with the Kilo release a Node may also be referred to by a
logical name as well as its UUID. Names can be assigned either when
creating the node by adding the <code class="docutils literal"><span class="pre">-n</span></code> option to the <code class="docutils literal"><span class="pre">node-create</span></code> command or
by updating an existing node with the <code class="docutils literal"><span class="pre">node-update</span></code> command.</p>
<p>Node names must be unique, and conform to:</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/rfc952">rfc952</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/rfc1123">rfc1123</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Hostname">wiki_hostname</a></li>
</ul>
<p>The node is named &#8216;example&#8217; in the following examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-create -d agent_ipmitool -n example
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-update $NODE_UUID add name=example
</pre></div>
</div>
<p>Once assigned a logical name, a node can then be referred to by name or
UUID interchangeably.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ironic node-create -d agent_ipmitool -n example

+--------------+--------------------------------------+
| Property     | Value                                |
+--------------+--------------------------------------+
| uuid         | 71e01002-8662-434d-aafd-f068f69bb85e |
| driver_info  | {}                                   |
| extra        | {}                                   |
| driver       | agent_ipmitool                       |
| chassis_uuid |                                      |
| properties   | {}                                   |
| name         | example                              |
+--------------+--------------------------------------+


ironic node-show example

+------------------------+--------------------------------------+
| Property               | Value                                |
+------------------------+--------------------------------------+
| target_power_state     | None                                 |
| extra                  | {}                                   |
| last_error             | None                                 |
| updated_at             | 2015-04-24T16:23:46+00:00            |
| ...                    | ...                                  |
| instance_info          | {}                                   |
+------------------------+--------------------------------------+
</pre></div>
</div>
</div>
<div class="section" id="hardware-inspection">
<h2>Hardware Inspection<a class="headerlink" href="#hardware-inspection" title="Permalink to this headline">¶</a></h2>
<p>Starting with the Kilo release, Bare Metal service supports hardware inspection
that simplifies enrolling nodes - please see <a class="reference external" href="http://docs.openstack.org/developer/ironic/deploy/inspection.html">inspection</a> for details.</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="configure-port-groups.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configure port groups"></i></a>
          
          
            <a href="enabling-https.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Enabling HTTPS"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 16:59</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Bare Metal service overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install and configure the Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure-integration.html">Integration with other OpenStack services</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure-cleaning.html">Configure the Bare Metal service for cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure-tenant-networks.html">Configure tenant networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure-port-groups.html">Configure port groups</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Enrollment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#enrollment-process">Enrollment process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enrolling-a-node">Enrolling a node</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logical-names">Logical names</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-inspection">Hardware Inspection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="enabling-https.html">Enabling HTTPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="standalone.html">Using Bare Metal service as a standalone service</a></li>
<li class="toctree-l1"><a class="reference internal" href="configdrive.html">Enabling the configuration drive (configdrive)</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy-ramdisk.html">Building or downloading a deploy ramdisk image</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup-drivers.html">Setup the drivers for the Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced features</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="next-steps.html">Next steps</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "enrollment" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/ironic/tree/install-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 52b38ee6721ad696dd0674e382409af85899d540";
        var bugProject = "ironic";
        var bugTitle = "Enrollment in Installation Guide for Bare Metal Service";
    var fieldTags = "install-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1 on 2017-02-14 16:59";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>