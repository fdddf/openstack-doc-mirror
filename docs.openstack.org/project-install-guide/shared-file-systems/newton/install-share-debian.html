<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Install and configure a share node running Debian</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Install and configure a share node running Debian</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="install-share-ubuntu.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Install and configure a share node running Ubuntu"></i></a>
    
    
    <a href="verify.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Verify operation"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-07 19:07</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Install and configure a share node running Debian</a><ul>
<li><a class="reference internal" href="#install-and-configure-components">Install and configure components</a></li>
<li><a class="reference internal" href="#two-driver-modes">Two driver modes</a></li>
<li><a class="reference internal" href="#option-1">Option 1</a></li>
<li><a class="reference internal" href="#option-2">Option 2</a></li>
<li><a class="reference internal" href="#shared-file-systems-option-1-no-driver-support-for-share-servers-management">Shared File Systems Option 1: No driver support for share servers management</a></li>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#configure-components">Configure components</a></li>
<li><a class="reference internal" href="#shared-file-systems-option-2-driver-support-for-share-servers-management">Shared File Systems Option 2: Driver support for share servers management</a></li>
<li><a class="reference internal" href="#id1">Prerequisites</a></li>
<li><a class="reference internal" href="#id2">Configure components</a></li>
<li><a class="reference internal" href="#finalize-installation">Finalize installation</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="install-and-configure-a-share-node-running-debian">
<span id="share-node-install-debian"></span><h1>Install and configure a share node running Debian<a class="headerlink" href="#install-and-configure-a-share-node-running-debian" title="Permalink to this headline">¶</a></h1>
<p>This section describes how to install and configure a share node for the
Shared File Systems service. For simplicity, this configuration references one
storage node with the generic driver managing the share servers. The
generic backend manages share servers using compute, networking and block
services for provisioning shares.</p>
<p>Note that installation and configuration vary by distribution. This section
describes the instructions for a share node running a Debian distribution.</p>
<div class="section" id="install-and-configure-components">
<h2>Install and configure components<a class="headerlink" href="#install-and-configure-components" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Install the packages:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install manila-share python-pymysql
</pre></div>
</div>
</li>
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">/etc/manila/manila.conf</span></code> file and complete the following
actions:</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[database]</span></code> section, configure database access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[database]</span>
<span class="na">...</span>
<span class="na">connection</span> <span class="o">=</span> <span class="s">mysql+pymysql://manila:MANILA_DBPASS@controller/manila</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MANILA_DBPASS</span></code> with the password you chose for the Shared
File Systems database.</p>
</li>
</ul>
</li>
</ol>
<ol class="arabic" start="4">
<li><p class="first">Complete the rest of the configuration in <code class="docutils literal"><span class="pre">manila.conf</span></code>.</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section, configure <code class="docutils literal"><span class="pre">RabbitMQ</span></code>
message queue access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">transport_url</span> <span class="o">=</span> <span class="s">rabbit://openstack:RABBIT_PASS@controller</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">RABBIT_PASS</span></code> with the password you chose for the
<code class="docutils literal"><span class="pre">openstack</span></code> account in <code class="docutils literal"><span class="pre">RabbitMQ</span></code>.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section, set the following config values:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span>  <span class="k">[DEFAULT]</span>
  <span class="na">...</span>
  <span class="na">default_share_type</span> <span class="o">=</span> <span class="s">default_share_type</span>
<span class="s">  rootwrap_config = /etc/manila/rootwrap.conf</span>

<span class="na">.. important::</span>

  <span class="na">The ``default_share_type`` option specifies the default share type to</span>
  <span class="na">be used when shares are created without specifying the share type in</span>
  <span class="na">the request. The default share type that is specified in the</span>
  <span class="na">configuration file has to be created with the necessary required</span>
  <span class="na">extra-specs (such as ``driver_handles_share_servers``) set</span>
  <span class="na">appropriately with reference to the driver mode used. This is</span>
  <span class="na">explained in further steps.</span>
</pre></div>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> and <code class="docutils literal"><span class="pre">[keystone_authtoken]</span></code> sections, configure
Identity service access:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">auth_strategy</span> <span class="o">=</span> <span class="s">keystone</span>

<span class="k">[keystone_authtoken]</span>
<span class="na">...</span>
<span class="na">memcached_servers</span> <span class="o">=</span> <span class="s">controller:11211</span>
<span class="na">auth_uri</span> <span class="o">=</span> <span class="s">http://controller:5000</span>
<span class="na">auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357</span>
<span class="na">auth_type</span> <span class="o">=</span> <span class="s">password</span>
<span class="na">project_domain_id</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">user_domain_id</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">project_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">username</span> <span class="o">=</span> <span class="s">manila</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">MANILA_PASS</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MANILA_PASS</span></code> with the password you chose for the <code class="docutils literal"><span class="pre">manila</span></code>
user in the Identity service.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section, configure the <code class="docutils literal"><span class="pre">my_ip</span></code> option:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">my_ip</span> <span class="o">=</span> <span class="s">MANAGEMENT_INTERFACE_IP_ADDRESS</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MANAGEMENT_INTERFACE_IP_ADDRESS</span></code> with the IP address of the
management network interface on your share node, typically 10.0.0.41 for
the first node in the example architecture shown below:</p>
<div class="figure" id="id3">
<img alt="Hardware requirements" src="_images/hwreqs.png" />
<p class="caption"><span class="caption-text"><strong>Hardware requirements</strong></span></p>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[oslo_concurrency]</span></code> section, configure the lock path:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[oslo_concurrency]</span>
<span class="na">...</span>
<span class="na">lock_path</span> <span class="o">=</span> <span class="s">/var/lib/manila/tmp</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="two-driver-modes">
<h2>Two driver modes<a class="headerlink" href="#two-driver-modes" title="Permalink to this headline">¶</a></h2>
<p>The share node can support two modes, with and without the handling of
share servers. The mode depends on driver support.</p>
</div>
<div class="section" id="option-1">
<h2>Option 1<a class="headerlink" href="#option-1" title="Permalink to this headline">¶</a></h2>
<p>Deploying the service without driver support for share server management.
In this mode, the service does not do anything related to networking. The
operator must ensure network connectivity between instances and the NAS
protocol based server.</p>
<p>This tutorial demonstrates setting up the LVM driver which creates LVM volumes
on the share node and exports them with the help of an NFS server that is
installed locally on the share node. It therefore requires LVM and NFS packages
as well as an additional disk for the <code class="docutils literal"><span class="pre">manila-share</span></code> LVM volume group.</p>
<p>This driver mode may be referred to as <code class="docutils literal"><span class="pre">driver_handles_share_servers</span> <span class="pre">=</span> <span class="pre">False</span></code>
mode, or simply <code class="docutils literal"><span class="pre">DHSS=False</span></code> mode.</p>
</div>
<div class="section" id="option-2">
<h2>Option 2<a class="headerlink" href="#option-2" title="Permalink to this headline">¶</a></h2>
<p>Deploying the service with driver support for share server management. In
this mode, the service runs with a back end driver that creates and manages
share servers. This tutorial demonstrates setting up the <code class="docutils literal"><span class="pre">Generic</span></code> driver.
This driver requires Compute service (nova), Image service (glance) and
Networking service (neutron) for creating and managing share servers; and
Block storage service (cinder) for creating shares.</p>
<p>The information used for creating share servers is configured with the help of
share networks.</p>
<p>This driver mode may be referred to as <code class="docutils literal"><span class="pre">driver_handles_share_servers</span> <span class="pre">=</span> <span class="pre">True</span></code>
mode, or simply <code class="docutils literal"><span class="pre">DHSS=True</span></code> mode.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When running the generic driver in <code class="docutils literal"><span class="pre">DHSS=True</span></code> driver mode, the share
service should be run on the same node as the networking service.
However, such a service may not be able to run the LVM driver that runs
in <code class="docutils literal"><span class="pre">DHSS=False</span></code> driver mode effectively, due to a bug in some
distributions of Linux. For more information, see LVM Driver section in the
<a class="reference external" href="http://docs.openstack.org/mitaka/config-reference/shared-file-systems.html">Configuration Reference Guide</a>.</p>
</div>
<p>Choose one of the following options to configure the share driver:</p>
</div>
<div class="section" id="shared-file-systems-option-1-no-driver-support-for-share-servers-management">
<h2>Shared File Systems Option 1: No driver support for share servers management<a class="headerlink" href="#shared-file-systems-option-1-no-driver-support-for-share-servers-management" title="Permalink to this headline">¶</a></h2>
<p>For simplicity, this configuration references the same storage node
configuration for the Block Storage service. However, the LVM driver
requires a separate empty local block storage device to avoid conflict
with the Block Storage service. The instructions use <code class="docutils literal"><span class="pre">/dev/sdc</span></code>, but
you can substitute a different value for your particular node.</p>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Perform these steps on the storage node.</p>
</div>
<ol class="arabic">
<li><p class="first">Install the supporting utility packages:</p>
<ul>
<li><p class="first">Install LVM and NFS server packages:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install lvm2 nfs-kernel-server
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<ol class="arabic" start="2">
<li><p class="first">Create the LVM physical volume <code class="docutils literal"><span class="pre">/dev/sdc</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> pvcreate /dev/sdc
<span class="go">Physical volume &quot;/dev/sdc&quot; successfully created</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the LVM volume group <code class="docutils literal"><span class="pre">manila-volumes</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> vgcreate manila-volumes /dev/sdc
<span class="go">Volume group &quot;manila-volumes&quot; successfully created</span>
</pre></div>
</div>
<p>The Shared File Systems service creates logical volumes in this volume
group.</p>
</li>
<li><p class="first">Only instances can access Shared File Systems service volumes. However,
the underlying operating system manages the devices associated with
the volumes. By default, the LVM volume scanning tool scans the
<code class="docutils literal"><span class="pre">/dev</span></code> directory for block storage devices that
contain volumes. If projects use LVM on their volumes, the scanning
tool detects these volumes and attempts to cache them which can cause
a variety of problems with both the underlying operating system
and project volumes. You must reconfigure LVM to scan only the devices
that contain the <code class="docutils literal"><span class="pre">cinder-volume</span></code> and <code class="docutils literal"><span class="pre">manila-volumes</span></code> volume groups.
Edit the <code class="docutils literal"><span class="pre">/etc/lvm/lvm.conf</span></code> file and complete the following actions:</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">devices</span></code> section, add a filter that accepts the
<code class="docutils literal"><span class="pre">/dev/sdb</span></code> and <code class="docutils literal"><span class="pre">/dev/sdc</span></code> devices and rejects all other devices:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">devices {</span>
<span class="na">...</span>
<span class="na">filter</span> <span class="o">=</span> <span class="s">[ &quot;a/sdb/&quot;, &quot;a/sdc&quot;, &quot;r/.*/&quot;]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If your storage nodes use LVM on the operating system disk, you
must also add the associated device to the filter. For example,
if the <code class="docutils literal"><span class="pre">/dev/sda</span></code> device contains the operating system:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">filter</span> <span class="o">=</span> <span class="s">[ &quot;a/sda/&quot;, &quot;a/sdb/&quot;, &quot;a/sdc&quot;, &quot;r/.*/&quot;]</span>
</pre></div>
</div>
<p>Similarly, if your compute nodes use LVM on the operating
system disk, you must also modify the filter in the
<code class="docutils literal"><span class="pre">/etc/lvm/lvm.conf</span></code> file on those nodes to include only
the operating system disk. For example, if the <code class="docutils literal"><span class="pre">/dev/sda</span></code>
device contains the operating system:</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="na">filter</span> <span class="o">=</span> <span class="s">[ &quot;a/sda/&quot;, &quot;r/.*/&quot;]</span>
</pre></div>
</div>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="configure-components">
<h2>Configure components<a class="headerlink" href="#configure-components" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">/etc/manila/manila.conf</span></code> file and complete the following
actions:</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section, enable the LVM driver and the NFS
protocol:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">enabled_share_backends</span> <span class="o">=</span> <span class="s">lvm</span>
<span class="na">enabled_share_protocols</span> <span class="o">=</span> <span class="s">NFS</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Back end names are arbitrary. As an example, this guide uses the name
of the driver.</p>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[lvm]</span></code> section, configure the LVM driver:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[lvm]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">LVM</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.lvm.LVMShareDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">lvm_share_volume_group</span> <span class="o">=</span> <span class="s">manila-volumes</span>
<span class="na">lvm_share_export_ip</span> <span class="o">=</span> <span class="s">MANAGEMENT_INTERFACE_IP_ADDRESS</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal"><span class="pre">MANAGEMENT_INTERFACE_IP_ADDRESS</span></code> with the IP address
of the management network interface on your storage node,
typically 10.0.0.41 for the first node in the the example architecture
shown below:</p>
<div class="figure" id="id4">
<img alt="Hardware requirements" src="_images/hwreqs.png" />
<p class="caption"><span class="caption-text"><strong>Hardware requirements</strong>.</span></p>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="shared-file-systems-option-2-driver-support-for-share-servers-management">
<h2>Shared File Systems Option 2: Driver support for share servers management<a class="headerlink" href="#shared-file-systems-option-2-driver-support-for-share-servers-management" title="Permalink to this headline">¶</a></h2>
<p>For simplicity, this configuration references the same storage node
as the one used for the Block Storage service.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This guide describes how to configure the Shared File Systems service to
use the <code class="docutils literal"><span class="pre">generic</span></code> driver with the driver handles share server mode
(DHSS) enabled. This driver requires Compute service (nova), Image service
(glance) and Networking service (neutron) for creating and managing share
servers; and Block storage service (cinder) for creating shares. The
information used for creating share servers is configured as share
networks. Generic driver with DHSS enabled also requires the tenant&#8217;s
private network (where the compute instances are running) to be attached
to a public router.</p>
</div>
</div>
<div class="section" id="id1">
<h2>Prerequisites<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Before you proceed, verify operation of the Compute, Networking, and Block
Storage services. This options requires implementation of Networking option 2
and requires installation of some Networking service components on the storage
node.</p>
<ul>
<li><p class="first">Install the Networking service components:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> apt-get install neutron-plugin-linuxbridge-agent
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id2">
<h2>Configure components<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Edit the <code class="docutils literal"><span class="pre">/etc/manila/manila.conf</span></code> file and complete the following
actions:</p>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section, enable the generic driver and the NFS
protocol:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">...</span>
<span class="na">enabled_share_backends</span> <span class="o">=</span> <span class="s">generic</span>
<span class="na">enabled_share_protocols</span> <span class="o">=</span> <span class="s">NFS</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Back end names are arbitrary. As an example, this guide uses the name
of the driver.</p>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[neutron]</span></code>, <code class="docutils literal"><span class="pre">[nova]</span></code>, and <code class="docutils literal"><span class="pre">[cinder]</span></code> sections, enable
authentication for those services:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[neutron]</span>
<span class="na">...</span>
<span class="na">url</span> <span class="o">=</span> <span class="s">http://controller:9696</span>
<span class="na">auth_uri</span> <span class="o">=</span> <span class="s">http://controller:5000</span>
<span class="na">auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357</span>
<span class="na">memcached_servers</span> <span class="o">=</span> <span class="s">controller:11211</span>
<span class="na">auth_type</span> <span class="o">=</span> <span class="s">password</span>
<span class="na">project_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">user_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">region_name</span> <span class="o">=</span> <span class="s">RegionOne</span>
<span class="na">project_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">username</span> <span class="o">=</span> <span class="s">neutron</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">NEUTRON_PASS</span>

<span class="k">[nova]</span>
<span class="na">...</span>
<span class="na">auth_uri</span> <span class="o">=</span> <span class="s">http://controller:5000</span>
<span class="na">auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357</span>
<span class="na">memcached_servers</span> <span class="o">=</span> <span class="s">controller:11211</span>
<span class="na">auth_type</span> <span class="o">=</span> <span class="s">password</span>
<span class="na">project_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">user_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">region_name</span> <span class="o">=</span> <span class="s">RegionOne</span>
<span class="na">project_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">username</span> <span class="o">=</span> <span class="s">nova</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">NOVA_PASS</span>

<span class="k">[cinder]</span>
<span class="na">...</span>
<span class="na">auth_uri</span> <span class="o">=</span> <span class="s">http://controller:5000</span>
<span class="na">auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357</span>
<span class="na">memcached_servers</span> <span class="o">=</span> <span class="s">controller:11211</span>
<span class="na">auth_type</span> <span class="o">=</span> <span class="s">password</span>
<span class="na">project_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">user_domain_name</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">region_name</span> <span class="o">=</span> <span class="s">RegionOne</span>
<span class="na">project_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">username</span> <span class="o">=</span> <span class="s">cinder</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">CINDER_PASS</span>
</pre></div>
</div>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[generic]</span></code> section, configure the generic driver:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[generic]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">GENERIC</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.generic.GenericShareDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">service_instance_flavor_id</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">service_image_name</span> <span class="o">=</span> <span class="s">manila-service-image</span>
<span class="na">service_instance_user</span> <span class="o">=</span> <span class="s">manila</span>
<span class="na">service_instance_password</span> <span class="o">=</span> <span class="s">manila</span>
<span class="na">interface_driver</span> <span class="o">=</span> <span class="s">manila.network.linux.interface.BridgeInterfaceDriver</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also use SSH keys instead of password authentication for
service instance credentials.</p>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The <code class="docutils literal"><span class="pre">service_image_name</span></code>, <code class="docutils literal"><span class="pre">service_instance_flavor_id</span></code>,
<code class="docutils literal"><span class="pre">service_instance_user</span></code> and <code class="docutils literal"><span class="pre">service_instance_password</span></code> are with
reference to the service image that is used by the driver to create
share servers. A sample service image for use with the <code class="docutils literal"><span class="pre">generic</span></code>
driver is available in the <code class="docutils literal"><span class="pre">manila-image-elements</span></code> project. Its
creation is explained in the post installation steps (See:
<a class="reference internal" href="post-install.html#post-install"><span>Creating and using shared file systems</span></a>).</p>
</div>
</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="finalize-installation">
<h2>Finalize installation<a class="headerlink" href="#finalize-installation" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Prepare manila-share as start/stop service. Start the Shared File Systems
service including its dependencies:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> service manila-share restart
</pre></div>
</div>
</li>
</ol>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="install-share-ubuntu.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Install and configure a share node running Ubuntu"></i></a>
          
          
            <a href="verify.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Verify operation"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-07 19:07</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="get-started-with-shared-file-systems.html">Shared File Systems service overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-controller-node.html">Install and configure controller node</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="install-share-node.html">Install and configure a share node</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="install-share-obs.html">Install and configure a share node running openSUSE and SUSE Linux Enterprise</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-share-rdo.html">Install and configure a share node running Red Hat Enterprise Linux and CentOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="install-share-ubuntu.html">Install and configure a share node running Ubuntu</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Install and configure a share node running Debian</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="verify.html">Verify operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="post-install.html">Creating and using shared file systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="next-steps.html">Next steps</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "install-share-debian" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/manila/tree/install-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 45935cd271a1598db2cd473117e80368c33dfbce";
        var bugProject = "manila";
        var bugTitle = "Install and configure a share node running Debian in Installation Guide for Shared File Systems Service";
    var fieldTags = "install-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.1 on 2017-02-07 19:07";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>