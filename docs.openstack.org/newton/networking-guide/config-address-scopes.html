<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Address scopes</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Address scopes</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="config-ml2.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: ML2 plug-in"></i></a>
    
    
    <a href="config-auto-allocation.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Automatic allocation of network topologies"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Address scopes</a><ul>
<li><a class="reference internal" href="#accessing-address-scopes">Accessing address scopes</a></li>
<li><a class="reference internal" href="#backwards-compatibility">Backwards compatibility</a></li>
<li><a class="reference internal" href="#create-shared-address-scopes-as-an-administrative-user">Create shared address scopes as an administrative user</a></li>
<li><a class="reference internal" href="#routing-with-address-scopes-for-non-privileged-users">Routing with address scopes for non-privileged users</a><ul>
<li><a class="reference internal" href="#checking-connectivity">Checking connectivity</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="address-scopes">
<span id="config-address-scopes"></span><h1>Address scopes<a class="headerlink" href="#address-scopes" title="Permalink to this headline">¶</a></h1>
<p>Address scopes build from subnet pools. While subnet pools provide a mechanism
for controlling the allocation of addresses to subnets, address scopes show
where addresses can be routed between networks, preventing the use of
overlapping addresses in any two subnets. Because all addresses allocated in
the address scope do not overlap, neutron routers do not NAT between your
projects&#8217; network and your external network. As long as the addresses within
an address scope match, the Networking service performs simple routing
between networks.</p>
<div class="section" id="accessing-address-scopes">
<h2>Accessing address scopes<a class="headerlink" href="#accessing-address-scopes" title="Permalink to this headline">¶</a></h2>
<p>Anyone with access to the Networking service can create their own address
scopes. However, network administrators can create shared address scopes,
allowing other projects to create networks within that address scope.</p>
<p>Access to addresses in a scope are managed through subnet pools.
Subnet pools can either be created in an address scope, or updated to belong
to an address scope.</p>
<p>With subnet pools, all addresses in use within the address
scope are unique from the point of view of the address scope owner. Therefore,
add more than one subnet pool to an address scope if the
pools have different owners, allowing for delegation of parts of the
address scope. Delegation prevents address overlap across the
whole scope. Otherwise, you receive an error if two pools have the same
address ranges.</p>
<p>Each router interface is associated with an address scope by looking at
subnets connected to the network. When a router connects
to an external network with matching address scopes, network traffic routes
between without Network address translation (NAT).
The router marks all traffic connections originating from each interface
with its corresponding address scope. If traffic leaves an interface in the
wrong scope, the router blocks the traffic.</p>
</div>
<div class="section" id="backwards-compatibility">
<h2>Backwards compatibility<a class="headerlink" href="#backwards-compatibility" title="Permalink to this headline">¶</a></h2>
<p>Networks created before the Mitaka release do not
contain explicitly named address scopes, unless the network contains
subnets from a subnet pool that belongs to a created or updated
address scope. The Networking service preserves backwards compatibility with
pre-Mitaka networks through special address scope properties so that
these networks can perform advanced routing:</p>
<ol class="arabic simple">
<li>Unlimited address overlap is allowed.</li>
<li>Neutron routers, by default, will NAT traffic from internal networks
to external networks.</li>
<li>Pre-Mitaka address scopes are not visible through the API. You cannot
list address scopes or show details. Scopes exist
implicitly as a catch-all for addresses that are not explicitly scoped.</li>
</ol>
</div>
<div class="section" id="create-shared-address-scopes-as-an-administrative-user">
<h2>Create shared address scopes as an administrative user<a class="headerlink" href="#create-shared-address-scopes-as-an-administrative-user" title="Permalink to this headline">¶</a></h2>
<p>This section shows how to set up shared address scopes to
allow simple routing for project networks with the same subnet pools.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Irrelevant fields have been trimmed from the output of
these commands for brevity.</p>
</div>
<ol class="arabic">
<li><p class="first">Create IPv6 and IPv4 address scopes:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron address-scope-create --shared address-scope-ip6 <span class="m">6</span>
<span class="go">Created a new address_scope:</span>
<span class="go">+------------+--------------------------------------+</span>
<span class="go">| Field      | Value                                |</span>
<span class="go">+------------+--------------------------------------+</span>
<span class="go">| id         | 13b83fb2-beb4-4533-9e12-4bf9a5721ef5 |</span>
<span class="go">| ip_version | 6                                    |</span>
<span class="go">| name       | address-scope-ip6                    |</span>
<span class="go">| shared     | True                                 |</span>
<span class="go">+------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron address-scope-create --shared address-scope-ip4 <span class="m">4</span>
<span class="go">Created a new address_scope:</span>
<span class="go">+------------+--------------------------------------+</span>
<span class="go">| Field      | Value                                |</span>
<span class="go">+------------+--------------------------------------+</span>
<span class="go">| id         | 97702525-e145-40c8-8c8f-d415930d12ce |</span>
<span class="go">| ip_version | 4                                    |</span>
<span class="go">| name       | address-scope-ip4                    |</span>
<span class="go">| shared     | True                                 |</span>
<span class="go">+------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Create subnet pools specifying the name (or UUID) of the address
scope that the subnet pool belongs to. If you have existing
subnet pools, use the <strong class="command">neutron subnetpool-update</strong> command to put
them in a new address scope:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnetpool-create --address-scope address-scope-ip6 <span class="se">\</span>
  --shared --pool-prefix <span class="m">2001</span>:db8:a583::/48 --default-prefixlen <span class="m">64</span> <span class="se">\</span>
  subnet-pool-ip6
<span class="go">Created a new subnetpool:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| address_scope_id  | 13b83fb2-beb4-4533-9e12-4bf9a5721ef5 |</span>
<span class="go">| default_prefixlen | 64                                   |</span>
<span class="go">| id                | 14813344-d11a-4896-906c-e4c378291058 |</span>
<span class="go">| ip_version        | 6                                    |</span>
<span class="go">| name              | subnet-pool-ip6                      |</span>
<span class="go">| prefixes          | 2001:db8:a583::/48                   |</span>
<span class="go">| shared            | True                                 |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnetpool-create --address-scope address-scope-ip4 <span class="se">\</span>
  --shared --pool-prefix <span class="m">203</span>.0.113.0/21 --default-prefixlen <span class="m">26</span> <span class="se">\</span>
  subnet-pool-ip4
<span class="go">Created a new subnetpool:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| address_scope_id  | 97702525-e145-40c8-8c8f-d415930d12ce |</span>
<span class="go">| default_prefixlen | 26                                   |</span>
<span class="go">| id                | e2c4f12d-307f-4616-a4df-203a45e6cb7f |</span>
<span class="go">| ip_version        | 4                                    |</span>
<span class="go">| name              | subnet-pool-ip4                      |</span>
<span class="go">| prefixes          | 203.0.112.0/21                       |</span>
<span class="go">| shared            | True                                 |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Make sure that subnets on an external network are created
from the subnet pools created above:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-show ipv6-public-subnet
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 2001:db8::/64                        |</span>
<span class="go">| enable_dhcp       | False                                |</span>
<span class="go">| gateway_ip        | 2001:db8::2                          |</span>
<span class="go">| id                | 8e9299bf-5c48-4143-b081-010ba26636a2 |</span>
<span class="go">| ip_version        | 6                                    |</span>
<span class="go">| name              | ipv6-public-subnet                   |</span>
<span class="go">| network_id        | d2ac8578-7e86-4646-849a-afdf5a05fff0 |</span>
<span class="go">| subnetpool_id     | 14813344-d11a-4896-906c-e4c378291058 |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-show public-subnet
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 172.24.4.0/24                        |</span>
<span class="go">| enable_dhcp       | False                                |</span>
<span class="go">| gateway_ip        | 172.24.4.1                           |</span>
<span class="go">| id                | 3c3029d2-8081-4e56-9842-6007ce742860 |</span>
<span class="go">| ip_version        | 4                                    |</span>
<span class="go">| name              | public-subnet                        |</span>
<span class="go">| network_id        | d2ac8578-7e86-4646-849a-afdf5a05fff0 |</span>
<span class="go">| subnetpool_id     | e2c4f12d-307f-4616-a4df-203a45e6cb7f |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="routing-with-address-scopes-for-non-privileged-users">
<h2>Routing with address scopes for non-privileged users<a class="headerlink" href="#routing-with-address-scopes-for-non-privileged-users" title="Permalink to this headline">¶</a></h2>
<p>This section shows how non-privileged users can use address scopes to
route straight to an external network without NAT.</p>
<ol class="arabic">
<li><p class="first">Create a couple of networks to host subnets:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron net-create network1
<span class="go">Created a new network:</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| Field                   | Value                                |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| id                      | f5a980d9-5521-438e-b831-0ebacba2b372 |</span>
<span class="go">| name                    | network1                             |</span>
<span class="go">| subnets                 |                                      |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron net-create network2
<span class="go">Created a new network:</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| Field                   | Value                                |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| id                      | 438e4f26-0e45-4b26-9797-57d0bd817953 |</span>
<span class="go">| name                    | network2                             |</span>
<span class="go">| subnets                 |                                      |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a subnet not associated with a subnet pool or
an address scope:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-create --name subnet-ip4-1 network1 <span class="m">198</span>.51.100.0/26
<span class="go">Created a new subnet:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 198.51.100.0/26                      |</span>
<span class="go">| id                | 48ed5c71-2a1d-4f73-b29e-371deec04d44 |</span>
<span class="go">| name              | subnet-ip4-1                         |</span>
<span class="go">| network_id        | f5a980d9-5521-438e-b831-0ebacba2b372 |</span>
<span class="go">| subnetpool_id     |                                      |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-create --name subnet-ip6-1 network1 <span class="se">\</span>
  --ipv6-ra-mode slaac --ipv6-address-mode slaac <span class="se">\</span>
  --ip_version <span class="m">6</span> <span class="m">2001</span>:db8:80d2:c4d3::/64
<span class="go">Created a new subnet:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 2001:db8:80d2:c4d3::/64              |</span>
<span class="go">| id                | c9f0bb79-1d7b-435f-b362-05a9a7259aa6 |</span>
<span class="go">| name              | subnet-ip6-1                         |</span>
<span class="go">| network_id        | f5a980d9-5521-438e-b831-0ebacba2b372 |</span>
<span class="go">| subnetpool_id     |                                      |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a subnet using a subnet pool associated with a address scope
from an external network:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-create --name subnet-ip4-2 <span class="se">\</span>
  --subnetpool subnet-pool-ip4 network2
<span class="go">Created a new subnet:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 203.0.112.0/26                       |</span>
<span class="go">| id                | deb36645-8d46-4c13-a489-1135174d8a8c |</span>
<span class="go">| name              | subnet-ip4-2                         |</span>
<span class="go">| network_id        | 438e4f26-0e45-4b26-9797-57d0bd817953 |</span>
<span class="go">| subnetpool_id     | e2c4f12d-307f-4616-a4df-203a45e6cb7f |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron subnet-create --name subnet-ip6-2 --ip_version <span class="m">6</span> <span class="se">\</span>
  --ipv6-ra-mode slaac --ipv6-address-mode slaac <span class="se">\</span>
  --subnetpool subnet-pool-ip6 network2
<span class="go">Created a new subnet:</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| Field             | Value                                |</span>
<span class="go">+-------------------+--------------------------------------+</span>
<span class="go">| cidr              | 2001:db8:a583::/64                   |</span>
<span class="go">| id                | b157e288-748e-4c4b-9b2e-8b8e65241036 |</span>
<span class="go">| name              | subnet-ip6-2                         |</span>
<span class="go">| network_id        | 438e4f26-0e45-4b26-9797-57d0bd817953 |</span>
<span class="go">| subnetpool_id     | 14813344-d11a-4896-906c-e4c378291058 |</span>
<span class="go">+-------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>By creating subnets from scoped subnet pools, the network is
associated with the address scope.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron net-show network2
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| Field                   | Value                                |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
<span class="go">| id                      | 4f677ab6-32a1-452c-8feb-b0b6b7ed1a0f |</span>
<span class="go">| ipv4_address_scope      | 97702525-e145-40c8-8c8f-d415930d12ce |</span>
<span class="go">| ipv6_address_scope      | 13b83fb2-beb4-4533-9e12-4bf9a5721ef5 |</span>
<span class="go">| name                    | network2                             |</span>
<span class="go">| subnets                 | d5d68ac3-3eaa-439e-b75b-0e0b2c1d221a |</span>
<span class="go">|                         | 917f9360-a840-45c1-83a1-2a093bd7b376 |</span>
<span class="go">+-------------------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Connect a router to each of the project subnets that have been created, for
example, using a router called <code class="docutils literal"><span class="pre">router1</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron router-interface-add router1 subnet-ip4-1
<span class="go">Added interface 73d832e1-e4a7-4029-9a66-f4e0f4ba0e76 to router router1.</span>
<span class="gp">$</span> neutron router-interface-add router1 subnet-ip4-2
<span class="go">Added interface 94b4cdb2-875d-4ab3-9a6e-803c3626c4d9 to router router1.</span>
<span class="gp">$</span> neutron router-interface-add router1 subnet-ip6-1
<span class="go">Added interface f35c4541-d529-4bd8-af4e-1b069269c263 to router router1.</span>
<span class="gp">$</span> neutron router-interface-add router1 subnet-ip6-2
<span class="go">Added interface f5904a4b-9547-4c08-bc7e-bc5fc71a8db9 to router router1.</span>
</pre></div>
</div>
</li>
</ol>
<div class="section" id="checking-connectivity">
<h3>Checking connectivity<a class="headerlink" href="#checking-connectivity" title="Permalink to this headline">¶</a></h3>
<p>This example shows how to check the connectivity between networks
with address scopes.</p>
<ol class="arabic">
<li><p class="first">Launch two instances, <code class="docutils literal"><span class="pre">instance1</span></code> on <code class="docutils literal"><span class="pre">network1</span></code> and
<code class="docutils literal"><span class="pre">instance2</span></code> on <code class="docutils literal"><span class="pre">network2</span></code>. Associate a floating IP address to both
instances.</p>
</li>
<li><p class="first">Adjust security groups to allow pings and SSH (both IPv4 and IPv6):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> nova list
<span class="go">+--------------+-----------+---------------------------------------------------------------------------+</span>
<span class="go">| ID           | Name      | Networks                                                                  |</span>
<span class="go">+--------------+-----------+---------------------------------------------------------------------------+</span>
<span class="go">| 97e49c8e-... | instance1 | network1=2001:db8:80d2:c4d3:f816:3eff:fe52:b69f, 198.51.100.3, 172.24.4.3 |</span>
<span class="go">| ceba9638-... | instance2 | network2=203.0.112.3, 2001:db8:a583:0:f816:3eff:fe42:1eeb, 172.24.4.4     |</span>
<span class="go">+--------------+-----------+---------------------------------------------------------------------------+</span>
</pre></div>
</div>
</li>
</ol>
<p>Regardless of address scopes, the floating IPs can be pinged from the
external network:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ping -c <span class="m">1</span> <span class="m">172</span>.24.4.3
<span class="go">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span>
<span class="gp">$</span> ping -c <span class="m">1</span> <span class="m">172</span>.24.4.4
<span class="go">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span>
</pre></div>
</div>
<p>You can now ping <code class="docutils literal"><span class="pre">instance2</span></code> directly because <code class="docutils literal"><span class="pre">instance2</span></code> shares the
same address scope as the external network:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">BGP routing can be used to automatically set up a static
route for your instances.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ip route add <span class="m">203</span>.0.112.0/26 via <span class="m">172</span>.24.4.2
<span class="gp">$</span> ping -c <span class="m">1</span> <span class="m">203</span>.0.112.3
<span class="go">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ip route add <span class="m">2001</span>:db8:a583::/64 via <span class="m">2001</span>:db8::1
<span class="gp">$</span> ping6 -c <span class="m">1</span> <span class="m">2001</span>:db8:a583:0:f816:3eff:fe42:1eeb
<span class="go">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span>
</pre></div>
</div>
<p>You cannot ping <code class="docutils literal"><span class="pre">instance1</span></code> directly because the address scopes do not
match:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ip route add <span class="m">198</span>.51.100.0/26 via <span class="m">172</span>.24.4.2
<span class="gp">$</span> ping -c <span class="m">1</span> <span class="m">198</span>.51.100.3
<span class="go">1 packets transmitted, 0 received, 100% packet loss, time 0ms</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> ip route add <span class="m">2001</span>:db8:80d2:c4d3::/64 via <span class="m">2001</span>:db8::1
<span class="gp">$</span> ping6 -c <span class="m">1</span> <span class="m">2001</span>:db8:80d2:c4d3:f816:3eff:fe52:b69f
<span class="go">1 packets transmitted, 0 received, 100% packet loss, time 0ms</span>
</pre></div>
</div>
<p>If the address scopes match between
networks then pings and other traffic route directly through. If the
scopes do not match between networks, the router either drops the
traffic or applies NAT to cross scope boundaries.</p>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="config-ml2.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: ML2 plug-in"></i></a>
          
          
            <a href="config-auto-allocation.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Automatic allocation of network topologies"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="config.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-ml2.html">ML2 plug-in</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Address scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-auto-allocation.html">Automatic allocation of network topologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-az.html">Availability zones</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-bgp-dynamic-routing.html">BGP dynamic routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dhcp-ha.html">High-availability for DHCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-int.html">DNS integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-res.html">Name resolution for instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dvr-ha-snat.html">Distributed Virtual Routing with VRRP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipam.html">IPAM configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-lbaas.html">Load Balancer as a Service (LBaaS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-macvtap.html">Macvtap mechanism driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-mtu.html">MTU considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovs-dpdk.html">Open vSwitch with DPDK datapath</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovsfwdriver.html">Native Open vSwitch firewall driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-qos.html">Quality of Service (QoS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-rbac.html">Role-Based Access Control (RBAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-routed-networks.html">Routed provider networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sfc.html">Service function chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sriov.html">SR-IOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-subnet-pools.html">Subnet pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-service-subnets.html">Service subnets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "config-address-scopes" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/networking-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: b8fd8c76e4ec1d07c2970cbd5770a38196b5b343";
        var bugProject = "openstack-manuals";
        var bugTitle = "Address scopes in Networking Guide";
    var fieldTags = "networking-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 13:48";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>