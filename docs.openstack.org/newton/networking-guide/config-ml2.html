<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: ML2 plug-in</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>ML2 plug-in</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="config.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configuration"></i></a>
    
    
    <a href="config-address-scopes.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Address scopes"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">ML2 plug-in</a><ul>
<li><a class="reference internal" href="#architecture">Architecture</a><ul>
<li><a class="reference internal" href="#ml2-driver-support-matrix">ML2 driver support matrix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#network-type-drivers">Network type drivers</a><ul>
<li><a class="reference internal" href="#provider-network-types">Provider network types</a></li>
<li><a class="reference internal" href="#project-network-types">Project network types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mechanism-drivers">Mechanism drivers</a></li>
<li><a class="reference internal" href="#agents">Agents</a><ul>
<li><a class="reference internal" href="#l2-agent">L2 agent</a></li>
<li><a class="reference internal" href="#l3-agent">L3 agent</a></li>
<li><a class="reference internal" href="#dhcp-agent">DHCP agent</a></li>
<li><a class="reference internal" href="#metadata-agent">Metadata agent</a></li>
<li><a class="reference internal" href="#l3-metering-agent">L3 metering agent</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security">Security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-implementations">Reference implementations</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#buying-guide">Buying guide</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="ml2-plug-in">
<span id="config-plugin-ml2"></span><h1>ML2 plug-in<a class="headerlink" href="#ml2-plug-in" title="Permalink to this headline">¶</a></h1>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>The Modular Layer 2 (ML2) neutron plug-in is a framework allowing OpenStack
Networking to simultaneously use the variety of layer 2 networking
technologies found in complex real-world data centers. The ML2 framework
distinguishes between the two kinds of drivers that can be configured:</p>
<ul>
<li><p class="first">Type drivers</p>
<p>Define how an OpenStack network is technically realized. Example: VXLAN</p>
<p>Each available network type is managed by an ML2 type driver. Type drivers
maintain any needed type-specific network state. They validate the type
specific information for provider networks and are responsible for the
allocation of a free segment in project networks.</p>
</li>
<li><p class="first">Mechanism drivers</p>
<p>Define the mechanism to access an OpenStack network of a certain type.
Example: Open vSwitch mechanism driver.</p>
<p>The mechanism driver is responsible for taking the information established by
the type driver and ensuring that it is properly applied given the
specific networking mechanisms that have been enabled.</p>
<p>Mechanism drivers can utilize L2 agents (via RPC) and/or interact directly
with external devices or controllers.</p>
</li>
</ul>
<p>Multiple mechanism and type drivers can be used simultaneously to access
different ports of the same virtual network.</p>
<div class="section" id="ml2-driver-support-matrix">
<h3>ML2 driver support matrix<a class="headerlink" href="#ml2-driver-support-matrix" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">Mechanism drivers and L2 agents</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">type driver / mech driver</th>
<th class="head">Flat</th>
<th class="head">VLAN</th>
<th class="head">VXLAN</th>
<th class="head">GRE</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Open vSwitch</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>Linux bridge</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>SRIOV</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>MacVTap</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-even"><td>L2 population</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">L2 population is a special mechanism driver that optimizes BUM (Broadcast,
unknown destination address, multicast) traffic in the overlay networks
VXLAN and GRE. It needs to be used in conjunction with either the
Linux bridge or the Open vSwitch mechanism driver and cannot be used as
standalone mechanism driver. For more information, see the
<em>Mechanism drivers</em> section below.</p>
</div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="network-type-drivers">
<h3>Network type drivers<a class="headerlink" href="#network-type-drivers" title="Permalink to this headline">¶</a></h3>
<p>To enable type drivers in the ML2 plug-in. Edit the
<code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/ml2_conf.ini</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ml2]</span>
<span class="na">type_drivers</span> <span class="o">=</span> <span class="s">flat,vlan,vxlan,gre</span>
</pre></div>
</div>
<p>For more details, see the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-plug-in-configuration-options">Networking configuration options</a>
of Configuration Reference.</p>
<p>The following type drivers are available</p>
<ul class="simple">
<li>Flat</li>
<li>VLAN</li>
<li>GRE</li>
<li>VXLAN</li>
</ul>
<div class="section" id="provider-network-types">
<h4>Provider network types<a class="headerlink" href="#provider-network-types" title="Permalink to this headline">¶</a></h4>
<p>Provider networks provide connectivity like project networks.
But only administrative (privileged) users can manage those
networks because they interface with the physical network infrastructure.
More information about provider networks see
<a class="reference internal" href="intro-os-networking.html"><em>OpenStack Networking</em></a> or the <a class="reference external" href="http://docs.openstack.org/admin-guide/networking-adv-features.html#provider-networks">OpenStack Administrator Guide</a>.</p>
<ul>
<li><p class="first">Flat</p>
<p>The administrator needs to configure a list of physical network names that
can be used for provider networks.
For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-flat-type-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">VLAN</p>
<p>The administrator needs to configure a list of physical network names that
can be used for provider networks.
For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-vlan-type-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">GRE</p>
<p>No additional configuration required.</p>
</li>
<li><p class="first">VXLAN</p>
<p>The administrator can configure the VXLAN multicast group that should be
used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>VXLAN multicast group configuration is not applicable for the Open
vSwitch agent.</p>
<p class="last">As of today it is not used in the Linux bridge agent. The Linux bridge
agent has its own agent specific configuration option. Please see
the following bug for more details:
<a class="reference external" href="https://bugs.launchpad.net/neutron/+bug/1523614">https://bugs.launchpad.net/neutron/+bug/1523614</a></p>
</div>
</li>
</ul>
</div>
<div class="section" id="project-network-types">
<h4>Project network types<a class="headerlink" href="#project-network-types" title="Permalink to this headline">¶</a></h4>
<p>Project networks provide connectivity to instances for a particular
project. Regular (non-privileged) users can manage project networks
within the allocation that an administrator or operator defines for
them. More information about project and provider networks see
<a class="reference internal" href="intro-os-networking.html"><em>OpenStack Networking</em></a>
or the <a class="reference external" href="http://docs.openstack.org/admin-guide/networking-adv-features.html#provider-networks">OpenStack Administrator Guide</a>.</p>
<p>Project network configurations are made in the
<code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/ml2_conf.ini</span></code> configuration file on the neutron
server:</p>
<ul>
<li><p class="first">VLAN</p>
<p>The administrator needs to configure the range of VLAN IDs that can be
used for project network allocation.
For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-vlan-type-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">GRE</p>
<p>The administrator needs to configure the range of tunnel IDs that can be
used for project network allocation.
For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-gre-type-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">VXLAN</p>
<p>The administrator needs to configure the range of VXLAN IDs that can be
used for project network allocation.
For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-vxlan-type-configuration-options">Configuration Reference</a>.</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Flat networks for project allocation are not supported. They only
can exist as a provider network.</p>
</div>
</div>
</div>
<div class="section" id="mechanism-drivers">
<h3>Mechanism drivers<a class="headerlink" href="#mechanism-drivers" title="Permalink to this headline">¶</a></h3>
<p>To enable mechanism drivers in the ML2 plug-in, edit the
<code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/ml2_conf.ini</span></code> file on the neutron server:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ml2]</span>
<span class="na">mechanism_drivers</span> <span class="o">=</span> <span class="s">ovs,l2pop</span>
</pre></div>
</div>
<p>For more details, see the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-plug-in-configuration-options">Configuration Reference</a>.</p>
<ul>
<li><p class="first">Linux bridge</p>
<p>No additional configurations required for the mechanism driver. Additional
agent configuration is required. For details, see the related <em>L2 agent</em>
section below.</p>
</li>
<li><p class="first">Open vSwitch</p>
<p>No additional configurations required for the mechanism driver. Additional
agent configuration is required. For details, see the related <em>L2 agent</em>
section below.</p>
</li>
<li><p class="first">SRIOV</p>
<p>The administrator needs to define a list PCI hardware that shall be used
by OpenStack. For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-sr-iov-mechanism-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">MacVTap</p>
<p>No additional configurations required for the mechanism driver. Additional
agent configuration is required. Please see the related section.</p>
</li>
<li><p class="first">L2 population</p>
<p>The administrator can configure some optional configuration options. For more
details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-l2-population-mechanism-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">Specialized</p>
<ul>
<li><p class="first">Open source</p>
<p>External open source mechanism drivers exist as well as the neutron
integrated reference implementations. Configuration of those drivers is not
part of this document. For example:</p>
<ul class="simple">
<li>OpenDaylight</li>
<li>OpenContrail</li>
</ul>
</li>
<li><p class="first">Proprietary (vendor)</p>
<p>External mechanism drivers from various vendors exist as well as the
neutron integrated reference implementations.</p>
<p>Configuration of those drivers is not part of this document.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="agents">
<h3>Agents<a class="headerlink" href="#agents" title="Permalink to this headline">¶</a></h3>
<div class="section" id="l2-agent">
<h4>L2 agent<a class="headerlink" href="#l2-agent" title="Permalink to this headline">¶</a></h4>
<p>An L2 agent serves layer 2 (Ethernet) network connectivity to OpenStack
resources. It typically runs on each Network Node and on each Compute Node.</p>
<ul>
<li><p class="first">Open vSwitch agent</p>
<p>The Open vSwitch agent configures the Open vSwitch to realize L2 networks for
OpenStack resources.</p>
<p>Configuration for the Open vSwitch agent is typically done in the
<code class="docutils literal"><span class="pre">openvswitch_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#open-vswitch-agent-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">Linux bridge agent</p>
<p>The Linux bridge agent configures Linux bridges to realize L2 networks for
OpenStack resources.</p>
<p>Configuration for the Linux bridge agent is typically done in the
<code class="docutils literal"><span class="pre">linuxbridge_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#linux-bridge-agent-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">SRIOV Nic Switch agent</p>
<p>The sriov nic switch agent configures PCI virtual functions to realize L2
networks for OpenStack instances. Network attachments for other resources
like routers, DHCP, and so on are not supported.</p>
<p>Configuration for the SRIOV nic switch agent is typically done in the
<code class="docutils literal"><span class="pre">sriov_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#sr-iov-agent-configuration-options">Configuration Reference</a>.</p>
</li>
<li><p class="first">MacVTap agent</p>
<p>The MacVTap agent uses kernel MacVTap devices for realizing L2
networks for OpenStack instances. Network attachments for other resources
like routers, DHCP, and so on are not supported.</p>
<p>Configuration for the MacVTap agent is typically done in the
<code class="docutils literal"><span class="pre">macvtap_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#modular-layer-2-ml2-macvtap-mechanism-configuration-options">Configuration Reference</a>.</p>
</li>
</ul>
</div>
<div class="section" id="l3-agent">
<h4>L3 agent<a class="headerlink" href="#l3-agent" title="Permalink to this headline">¶</a></h4>
<p>The L3 agent offers advanced layer 3 services, like virtual Routers and
Floating IPs. It requires an L2 agent running in parallel.</p>
<p>Configuration for the L3 agent is typically done in the
<code class="docutils literal"><span class="pre">l3_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#l3-agent">Configuration Reference</a>.</p>
</div>
<div class="section" id="dhcp-agent">
<h4>DHCP agent<a class="headerlink" href="#dhcp-agent" title="Permalink to this headline">¶</a></h4>
<p>The DHCP agent is responsible for <a class="reference internal" href="common/glossary.html#term-dynamic-host-configuration-protocol-dhcp"><span class="xref std std-term">DHCP</span></a> and RADVD (Router Advertisement Daemon) services.
It requires a running L2 agent on the same node.</p>
<p>Configuration for the DHCP agent is typically done in the
<code class="docutils literal"><span class="pre">dhcp_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#dhcp-agent">Configuration Reference</a>.</p>
</div>
<div class="section" id="metadata-agent">
<h4>Metadata agent<a class="headerlink" href="#metadata-agent" title="Permalink to this headline">¶</a></h4>
<p>The Metadata agent allows instances to access cloud-init meta data and user
data via the network. It requires a running L2 agent on the same node.</p>
<p>Configuration for the Metadata agent is typically done in the
<code class="docutils literal"><span class="pre">metadata_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#metadata-agent">Configuration Reference</a>.</p>
</div>
<div class="section" id="l3-metering-agent">
<h4>L3 metering agent<a class="headerlink" href="#l3-metering-agent" title="Permalink to this headline">¶</a></h4>
<p>The L3 metering agent enables layer3 traffic metering. It requires a running L3
agent on the same node.</p>
<p>Configuration for the L3 metering agent is typically done in the
<code class="docutils literal"><span class="pre">metering_agent.ini</span></code> configuration file. Make sure that on agent start
you pass this configuration file as argument.</p>
<p>For a detailed list of configuration options, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#metering-agent">Configuration Reference</a>.</p>
</div>
</div>
<div class="section" id="security">
<h3>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h3>
<p>L2 agents support some important security configurations.</p>
<ul>
<li><p class="first">Security Groups</p>
<p>For more details, see the related section in the
<a class="reference external" href="http://docs.openstack.org/newton/config-reference/networking/networking_options_reference.html#security-groups">Configuration Reference</a>.</p>
</li>
<li><p class="first">Arp Spoofing Prevention</p>
<p>Configured in the <em>L2 agent</em> configuration.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="reference-implementations">
<h2>Reference implementations<a class="headerlink" href="#reference-implementations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>In this section, the combination of a mechanism driver and an L2 agent is
called &#8216;reference implementation&#8217;. The following table lists these
implementations:</p>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">Mechanism drivers and L2 agents</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Mechanism Driver</th>
<th class="head">L2 agent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Open vSwitch</td>
<td>Open vSwitch agent</td>
</tr>
<tr class="row-odd"><td>Linux bridge</td>
<td>Linux bridge agent</td>
</tr>
<tr class="row-even"><td>SRIOV</td>
<td>SRIOV nic switch agent</td>
</tr>
<tr class="row-odd"><td>MacVTap</td>
<td>MacVTap agent</td>
</tr>
<tr class="row-even"><td>L2 population</td>
<td>Open vSwitch agent, Linux bridge agent</td>
</tr>
</tbody>
</table>
<p>The following tables shows which reference implementations support which
non-L2 neutron agents:</p>
<table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Reference implementations and other agents</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Reference Implementation</th>
<th class="head">L3 agent</th>
<th class="head">DHCP agent</th>
<th class="head">Metadata agent</th>
<th class="head">L3 Metering agent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Open vSwitch &amp; Open vSwitch agent</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>Linux bridge &amp; Linux bridge agent</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>SRIOV &amp; SRIOV nic switch agent</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>MacVTap &amp; MacVTap agent</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>L2 population is not listed here, as it is not a standalone mechanism.
If other agents are supported depends on the conjunctive mechanism driver
that is used for binding a port.</p>
<p class="last">More information about L2 population see the
<a class="reference external" href="http://docs.ocselected.org/openstack-manuals/kilo/networking-guide/content/ml2_l2pop_scenarios.html">OpenStack Manuals</a>.</p>
</div>
</div>
<div class="section" id="buying-guide">
<h3>Buying guide<a class="headerlink" href="#buying-guide" title="Permalink to this headline">¶</a></h3>
<p>This guide characterizes the L2 reference implementations that currently exist.</p>
<ul>
<li><p class="first">Open vSwitch mechanism and Open vSwitch agent</p>
<p>Can be used for instance network attachments as well as for attachments of
other network resources like routers, DHCP, and so on.</p>
</li>
<li><p class="first">Linux bridge mechanism and Linux bridge agent</p>
<p>Can be used for instance network attachments as well as for attachments of
other network resources like routers, DHCP, and so on.</p>
</li>
<li><p class="first">SRIOV mechanism driver and SRIOV NIC switch agent</p>
<p>Can only be used for instance network attachments (device_owner = compute).</p>
<p>Is deployed besides an other mechanism driver and L2 agent such as OVS or
Linux bridge. It offers instances direct access to the network adapter
through a PCI Virtual Function (VF). This gives an instance direct access to
hardware capabilities and high performance networking.</p>
<p>The cloud consumer can decide via the neutron APIs VNIC_TYPE attribute, if
an instance gets a normal OVS port or an SRIOV port.</p>
<p>Due to direct connection, some features are not available when using SRIOV.
For example, DVR, security groups, migration.</p>
<p>For more information see the <a class="reference internal" href="config-sriov.html#config-sriov"><span>SR-IOV</span></a>.</p>
</li>
<li><p class="first">MacVTap mechanism driver and MacVTap agent</p>
<p>Can only be used for instance network attachments (device_owner = compute)
and not for attachment of other resources like routers, DHCP, and so on.</p>
<p>It is positioned as alternative to Open vSwitch or Linux bridge support on
the compute node for internal deployments.</p>
<p>MacVTap offers a direct connection with very little overhead between
instances and down to the adapter. You can use MacVTap agent on the
compute node when you require a network connection that is performance
critical. It does not require specific hardware (like with SRIOV).</p>
<p>Due to the direct connection, some features are not available when using
it on the compute node. For example, DVR, security groups and arp-spoofing
protection.</p>
</li>
</ul>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="config.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Configuration"></i></a>
          
          
            <a href="config-address-scopes.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Address scopes"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="config.html">Configuration</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">ML2 plug-in</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-address-scopes.html">Address scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-auto-allocation.html">Automatic allocation of network topologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-az.html">Availability zones</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-bgp-dynamic-routing.html">BGP dynamic routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dhcp-ha.html">High-availability for DHCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-int.html">DNS integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-res.html">Name resolution for instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dvr-ha-snat.html">Distributed Virtual Routing with VRRP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipam.html">IPAM configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-lbaas.html">Load Balancer as a Service (LBaaS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-macvtap.html">Macvtap mechanism driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-mtu.html">MTU considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovs-dpdk.html">Open vSwitch with DPDK datapath</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovsfwdriver.html">Native Open vSwitch firewall driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-qos.html">Quality of Service (QoS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-rbac.html">Role-Based Access Control (RBAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-routed-networks.html">Routed provider networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sfc.html">Service function chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sriov.html">SR-IOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-subnet-pools.html">Subnet pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-service-subnets.html">Service subnets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "config-ml2" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/networking-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: b8fd8c76e4ec1d07c2970cbd5770a38196b5b343";
        var bugProject = "openstack-manuals";
        var bugTitle = "ML2 plug-in in Networking Guide";
    var fieldTags = "networking-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 13:48";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>