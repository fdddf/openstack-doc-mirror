<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Quality of Service (QoS)</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Quality of Service (QoS)</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="config-ovsfwdriver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Native Open vSwitch firewall driver"></i></a>
    
    
    <a href="config-rbac.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Role-Based Access Control (RBAC)"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Quality of Service (QoS)</a><ul>
<li><a class="reference internal" href="#supported-qos-rule-types">Supported QoS rule types</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#trusted-projects-policy-json-configuration">Trusted projects policy.json configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-workflow">User workflow</a><ul>
<li><a class="reference internal" href="#administrator-enforcement">Administrator enforcement</a></li>
<li><a class="reference internal" href="#rule-modification">Rule modification</a></li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="quality-of-service-qos">
<span id="config-qos"></span><h1>Quality of Service (QoS)<a class="headerlink" href="#quality-of-service-qos" title="Permalink to this headline">¶</a></h1>
<p>QoS is defined as the ability to guarantee certain network requirements
like bandwidth, latency, jitter, and reliability in order to satisfy a
Service Level Agreement (SLA) between an application provider and end
users.</p>
<p>Network devices such as switches and routers can mark traffic so that it is
handled with a higher priority to fulfill the QoS conditions agreed under
the SLA. In other cases, certain network traffic such as Voice over IP (VoIP)
and video streaming needs to be transmitted with minimal bandwidth
constraints. On a system without network QoS management, all traffic will be
transmitted in a &#8220;best-effort&#8221; manner making it impossible to guarantee service
delivery to customers.</p>
<p>QoS is an advanced service plug-in. QoS is decoupled from the rest of the
OpenStack Networking code on multiple levels and it is available through the
ml2 extension driver.</p>
<p>Details about the DB models, API extension, and use cases are out of the scope
of this guide but can be found in the
<a class="reference external" href="http://specs.openstack.org/openstack/neutron-specs/specs/liberty/qos-api-extension.html">Neutron QoS specification</a>.</p>
<div class="section" id="supported-qos-rule-types">
<h2>Supported QoS rule types<a class="headerlink" href="#supported-qos-rule-types" title="Permalink to this headline">¶</a></h2>
<p>Any plug-in or ml2 mechanism driver can claim support for some QoS rule types
by providing a plug-in/driver class property called
<code class="docutils literal"><span class="pre">supported_qos_rule_types</span></code> that returns a list of strings that correspond
to <a class="reference external" href="https://git.openstack.org/cgit/openstack/neutron/tree/neutron/services/qos/qos_consts.py">QoS rule types</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the Newton release onward DSCP marking will be supported.</p>
</div>
<p>In the most simple case, the property can be represented by a simple Python
list defined on the class.</p>
<p>For an ml2 plug-in, the list of supported QoS rule types is defined as a common
subset of rules supported by all active mechanism drivers.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The list of supported rule types reported by core plug-in is not
enforced when accessing QoS rule resources. This is mostly because
then we would not be able to create any rules while at least one ml2
driver lacks support for QoS (at the moment of writing, only macvtap
is such a driver).</p>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>To enable the service, follow the steps below:</p>
<p>On network nodes:</p>
<ol class="arabic">
<li><p class="first">Add the QoS service to the <code class="docutils literal"><span class="pre">service_plugins</span></code> setting in
<code class="docutils literal"><span class="pre">/etc/neutron/neutron.conf</span></code>. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">service_plugins</span> <span class="o">=</span> <span class="s">\</span>
<span class="na">neutron.services.l3_router.l3_router_plugin.L3RouterPlugin,</span>
<span class="na">neutron.services.metering.metering_plugin.MeteringPlugin,</span>
<span class="na">neutron.services.qos.qos_plugin.QoSPlugin</span>
</pre></div>
</div>
</li>
<li><p class="first">Optionally, set the needed <code class="docutils literal"><span class="pre">notification_drivers</span></code> in the <code class="docutils literal"><span class="pre">[qos]</span></code>
section in <code class="docutils literal"><span class="pre">/etc/neutron/neutron.conf</span></code> (<code class="docutils literal"><span class="pre">message_queue</span></code> is the
default).</p>
</li>
<li><p class="first">In <code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/ml2_conf.ini</span></code>, add <code class="docutils literal"><span class="pre">qos</span></code> to
<code class="docutils literal"><span class="pre">extension_drivers</span></code> in the <code class="docutils literal"><span class="pre">[ml2]</span></code> section. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ml2]</span>
<span class="na">extension_drivers</span> <span class="o">=</span> <span class="s">port_security, qos</span>
</pre></div>
</div>
</li>
<li><p class="first">If the Open vSwitch agent is being used, set <code class="docutils literal"><span class="pre">extensions</span></code> to
<code class="docutils literal"><span class="pre">qos</span></code> in the <code class="docutils literal"><span class="pre">[agent]</span></code> section of
<code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/openvswitch_agent.ini</span></code>. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[agent]</span>
<span class="na">extensions</span> <span class="o">=</span> <span class="s">qos</span>
</pre></div>
</div>
</li>
</ol>
<p>On compute nodes:</p>
<ol class="arabic">
<li><p class="first">In <code class="docutils literal"><span class="pre">/etc/neutron/plugins/ml2/openvswitch_agent.ini</span></code>, add <code class="docutils literal"><span class="pre">qos</span></code> to the
<code class="docutils literal"><span class="pre">extensions</span></code> setting in the <code class="docutils literal"><span class="pre">[agent]</span></code> section. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[agent]</span>
<span class="na">extensions</span> <span class="o">=</span> <span class="s">qos</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">QoS currently works with ml2 only (SR-IOV, Open vSwitch, and linuxbridge
are drivers that are enabled for QoS in Mitaka release).</p>
</div>
<div class="section" id="trusted-projects-policy-json-configuration">
<h3>Trusted projects policy.json configuration<a class="headerlink" href="#trusted-projects-policy-json-configuration" title="Permalink to this headline">¶</a></h3>
<p>If projects are trusted to administrate their own QoS policies in
your cloud, neutron&#8217;s file <code class="docutils literal"><span class="pre">policy.json</span></code> can be modified to allow this.</p>
<p>Modify <code class="docutils literal"><span class="pre">/etc/neutron/policy.json</span></code> policy entries as follows:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>&quot;get_policy&quot;: &quot;rule:regular_user&quot;,
&quot;create_policy&quot;: &quot;rule:regular_user&quot;,
&quot;update_policy&quot;: &quot;rule:regular_user&quot;,
&quot;delete_policy&quot;: &quot;rule:regular_user&quot;,
</pre></div>
</div>
<p>To enable bandwidth limit rule:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>&quot;get_policy_bandwidth_limit_rule&quot;: &quot;rule:regular_user&quot;,
&quot;create_policy_bandwidth_limit_rule&quot;: &quot;rule:admin_only&quot;,
&quot;delete_policy_bandwidth_limit_rule&quot;: &quot;rule:admin_only&quot;,
&quot;update_policy_bandwidth_limit_rule&quot;: &quot;rule:admin_only&quot;,
&quot;get_rule_type&quot;: &quot;rule:regular_user&quot;,
</pre></div>
</div>
<p>To enable DSCP marking rule:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span>&quot;get_policy_dscp_marking_rule&quot;: &quot;rule:regular_user&quot;,
&quot;create_dscp_marking_rule&quot;: &quot;rule:admin_only&quot;,
&quot;delete_dscp_marking_rule&quot;: &quot;rule:admin_only&quot;,
&quot;update_dscp_marking_rule&quot;: &quot;rule:admin_only&quot;,
&quot;get_rule_type&quot;: &quot;rule:regular_user&quot;,
</pre></div>
</div>
</div>
</div>
<div class="section" id="user-workflow">
<h2>User workflow<a class="headerlink" href="#user-workflow" title="Permalink to this headline">¶</a></h2>
<p>QoS policies are only created by admins with the default <code class="docutils literal"><span class="pre">policy.json</span></code>.
Therefore, you should have the cloud operator set them up on
behalf of the cloud projects.</p>
<p>If projects are trusted to create their own policies, check the trusted
projects <code class="docutils literal"><span class="pre">policy.json</span></code> configuration section.</p>
<p>First, create a QoS policy and its bandwidth limit rule:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron qos-policy-create bw-limiter

<span class="go">Created a new policy:</span>
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| Field       | Value                                |</span>
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| description |                                      |</span>
<span class="go">| id          | 0ee1c673-5671-40ca-b55f-4cd4bbd999c7 |</span>
<span class="go">| name        | bw-limiter                           |</span>
<span class="go">| rules       |                                      |</span>
<span class="go">| shared      | False                                |</span>
<span class="go">| tenant_id   | 85b859134de2428d94f6ee910dc545d8     |</span>
<span class="go">+-------------+--------------------------------------+</span>

<span class="gp">$</span> neutron qos-bandwidth-limit-rule-create bw-limiter --max-kbps <span class="m">3000</span> <span class="se">\</span>
  --max-burst-kbps <span class="m">300</span>

<span class="go">Created a new bandwidth_limit_rule:</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| Field          | Value                                |</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| id             | 92ceb52f-170f-49d0-9528-976e2fee2d6f |</span>
<span class="go">| max_burst_kbps | 300                                  |</span>
<span class="go">| max_kbps       | 3000                                 |</span>
<span class="go">+----------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The burst value is given in kilobits, not in kilobits per second as the name
of the parameter might suggest. This is an amount of data which can be sent
before the bandwidth limit applies.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The QoS implementation requires a burst value to ensure proper behavior of
bandwidth limit rules in the Open vSwitch and Linux bridge agents. If you
do not provide a value, it defaults to 80% of the bandwidth limit which
works for typical TCP traffic.</p>
</div>
<p>Second, associate the created policy with an existing neutron port.
In order to do this, user extracts the port id to be associated to
the already created policy. In the next example, we will assign the
<code class="docutils literal"><span class="pre">bw-limiter</span></code> policy to the VM with IP address 10.0.0.3</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron port-list

<span class="go">+--------------------------------------+----------------------------------+</span>
<span class="go">| id                                   | fixed_ips                        |</span>
<span class="go">+--------------------------------------+----------------------------------+</span>
<span class="go">| 0271d1d9-1b16-4410-bd74-82cdf6dcb5b3 | { ... , &quot;ip_address&quot;: &quot;10.0.0.1&quot;}|</span>
<span class="go">| 88101e57-76fa-4d12-b0e0-4fc7634b874a | { ... , &quot;ip_address&quot;: &quot;10.0.0.3&quot;}|</span>
<span class="go">| e04aab6a-5c6c-4bd9-a600-33333551a668 | { ... , &quot;ip_address&quot;: &quot;10.0.0.2&quot;}|</span>
<span class="go">+--------------------------------------+----------------------------------+</span>

<span class="gp">$</span> neutron port-update 88101e57-76fa-4d12-b0e0-4fc7634b874a --qos-policy bw-limiter
<span class="go">Updated port: 88101e57-76fa-4d12-b0e0-4fc7634b874a</span>
</pre></div>
</div>
<p>In order to detach a port from the QoS policy, simply update again the
port configuration.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron port-update 88101e57-76fa-4d12-b0e0-4fc7634b874a --no-qos-policy
<span class="go">Updated port: 88101e57-76fa-4d12-b0e0-4fc7634b874a</span>
</pre></div>
</div>
<p>Ports can be created with a policy attached to them too.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron port-create private --qos-policy-id bw-limiter

<span class="go">Created a new port:</span>
<span class="go">+-----------------------+--------------------------------------------------+</span>
<span class="go">| Field                 | Value                                            |</span>
<span class="go">+-----------------------+--------------------------------------------------+</span>
<span class="go">| admin_state_up        | True                                             |</span>
<span class="go">| allowed_address_pairs |                                                  |</span>
<span class="go">| binding:vnic_type     | normal                                           |</span>
<span class="go">| device_id             |                                                  |</span>
<span class="go">| device_owner          |                                                  |</span>
<span class="go">| dns_assignment        | {&quot;hostname&quot;: &quot;host-10-0-0-4&quot;, ...   }            |</span>
<span class="go">| dns_name              |                                                  |</span>
<span class="go">| fixed_ips             | {&quot;subnet_id&quot;:                                    |</span>
<span class="go">|                       |         &quot;fabaf9b6-7a84-43b6-9d23-543591b531b8&quot;,  |</span>
<span class="go">|                       |          &quot;ip_address&quot;: &quot;10.0.0.4&quot;}               |</span>
<span class="go">| id                    | c3cb8faa-db36-429d-bd25-6003fafe63c5             |</span>
<span class="go">| mac_address           | fa:16:3e:02:65:15                                |</span>
<span class="go">| name                  |                                                  |</span>
<span class="go">| network_id            | 4920548d-1a6c-4d67-8de4-06501211587c             |</span>
<span class="go">| port_security_enabled | True                                             |</span>
<span class="go">| qos_policy_id         | 0ee1c673-5671-40ca-b55f-4cd4bbd999c7             |</span>
<span class="go">| security_groups       | b9cecbc5-a136-4032-b196-fb3eb091fff2             |</span>
<span class="go">| status                | DOWN                                             |</span>
<span class="go">| tenant_id             | 85b859134de2428d94f6ee910dc545d8                 |</span>
<span class="go">+-----------------------+--------------------------------------------------+</span>
</pre></div>
</div>
<p>You can attach networks to a QoS policy. The meaning of this is that
any compute port connected to the network will use the network policy by
default unless the port has a specific policy attached to it. Network owned
ports like DHCP and router ports are excluded from network policy application.</p>
<p>In order to attach a QoS policy to a network, update an existing
network, or initially create the network attached to the policy.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron net-update private --qos-policy bw-limiter
<span class="go">Updated network: private</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Configuring the proper burst value is very important. If the burst value is
set too low, bandwidth usage will be throttled even with a proper bandwidth
limit setting. This issue is discussed in various documentation sources, for
example in <a class="reference external" href="http://www.juniper.net/documentation/en_US/junos12.3/topics/concept/policer-mx-m120-m320-burstsize-determining.html">Juniper&#8217;s documentation</a>.
Burst value for TCP traffic can be set as 80% of desired bandwidth limit
value. For example, if the bandwidth limit is set to 1000kbps then enough
burst value will be 800kbit. If the configured burst value is too low,
achieved bandwidth limit will be lower than expected. If the configured burst
value is too high, too few packets could be limited and achieved bandwidth
limit would be higher than expected.</p>
</div>
<div class="section" id="administrator-enforcement">
<h3>Administrator enforcement<a class="headerlink" href="#administrator-enforcement" title="Permalink to this headline">¶</a></h3>
<p>Administrators are able to enforce policies on project ports or networks.
As long as the policy is not shared, the project is not be able to detach
any policy attached to a network or port.</p>
<p>If the policy is shared, the project is able to attach or detach such
policy from its own ports and networks.</p>
</div>
<div class="section" id="rule-modification">
<h3>Rule modification<a class="headerlink" href="#rule-modification" title="Permalink to this headline">¶</a></h3>
<p>You can modify rules at runtime. Rule modifications will be propagated to any
attached port.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron qos-bandwidth-limit-rule-update <span class="se">\</span>
    92ceb52f-170f-49d0-9528-976e2fee2d6f bw-limiter <span class="se">\</span>
    --max-kbps <span class="m">2000</span> --max-burst-kbps <span class="m">200</span>
<span class="go">Updated bandwidth_limit_rule: 92ceb52f-170f-49d0-9528-976e2fee2d6f</span>

<span class="gp">$</span> neutron qos-bandwidth-limit-rule-show <span class="se">\</span>
    92ceb52f-170f-49d0-9528-976e2fee2d6f bw-limiter

<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| Field          | Value                                |</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| id             | 92ceb52f-170f-49d0-9528-976e2fee2d6f |</span>
<span class="go">| max_burst_kbps | 200                                  |</span>
<span class="go">| max_kbps       | 2000                                 |</span>
<span class="go">+----------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Just like with bandwidth limiting, create a policy for DSCP marking rule:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron qos-policy-create dscp-marking

<span class="go">Created a new policy:</span>
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| Field       | Value                                |</span>
<span class="go">+-------------+--------------------------------------+</span>
<span class="go">| description |                                      |</span>
<span class="go">| id          | 8569fb4d-3d63-483e-b49a-9f9290d794f4 |</span>
<span class="go">| name        | dscp-marking                         |</span>
<span class="go">| rules       |                                      |</span>
<span class="go">| shared      | False                                |</span>
<span class="go">| tenant_id   | 85b859134de2428d94f6ee910dc545d8     |</span>
<span class="go">+-------------+--------------------------------------+</span>
</pre></div>
</div>
<p>You can create, update, list, delete, and show DSCP markings
with the neutron client:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron qos-dscp-marking-rule-create dscp-marking --dscp-mark <span class="m">26</span>

<span class="go">Created a new dscp marking rule</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| Field          | Value                                |</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| id             | 115e4f70-8034-4176-8fe9-2c47f8878a7d |</span>
<span class="go">| dscp_mark      | 26                                   |</span>
<span class="go">+----------------+--------------------------------------+</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> neutron qos-dscp-marking-rule-update <span class="se">\</span>
    115e4f70-8034-4176-8fe9-2c47f8878a7d dscp-marking --dscp-mark <span class="m">22</span>
<span class="go">Updated dscp_rule: 115e4f70-8034-4176-8fe9-2c47f8878a7d</span>

<span class="gp">$</span> neutron qos-dscp-marking-rule-list dscp-marking

<span class="go">+--------------------------------------+----------------------------------+</span>
<span class="go">| id                                   | dscp_mark                        |</span>
<span class="go">+--------------------------------------+----------------------------------+</span>
<span class="go">| 115e4f70-8034-4176-8fe9-2c47f8878a7d | 22                               |</span>
<span class="go">+--------------------------------------+----------------------------------+</span>

<span class="gp">$</span> neutron qos-dscp-marking-rule-show <span class="se">\</span>
    115e4f70-8034-4176-8fe9-2c47f8878a7d dscp-marking

<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| Field          | Value                                |</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| id             | 115e4f70-8034-4176-8fe9-2c47f8878a7d |</span>
<span class="go">| dscp_mark      | 22                                   |</span>
<span class="go">+----------------+--------------------------------------+</span>

<span class="gp">$</span> neutron qos-dscp-marking-rule-delete <span class="se">\</span>
    115e4f70-8034-4176-8fe9-2c47f8878a7d dscp-marking
<span class="go">  Deleted dscp_rule: 115e4f70-8034-4176-8fe9-2c47f8878a7d</span>
</pre></div>
</div>
</div>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="config-ovsfwdriver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Native Open vSwitch firewall driver"></i></a>
          
          
            <a href="config-rbac.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Role-Based Access Control (RBAC)"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:48</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="config.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-ml2.html">ML2 plug-in</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-address-scopes.html">Address scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-auto-allocation.html">Automatic allocation of network topologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-az.html">Availability zones</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-bgp-dynamic-routing.html">BGP dynamic routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dhcp-ha.html">High-availability for DHCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-int.html">DNS integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-res.html">Name resolution for instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dvr-ha-snat.html">Distributed Virtual Routing with VRRP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipam.html">IPAM configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-lbaas.html">Load Balancer as a Service (LBaaS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-macvtap.html">Macvtap mechanism driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-mtu.html">MTU considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovs-dpdk.html">Open vSwitch with DPDK datapath</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovsfwdriver.html">Native Open vSwitch firewall driver</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Quality of Service (QoS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-rbac.html">Role-Based Access Control (RBAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-routed-networks.html">Routed provider networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sfc.html">Service function chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sriov.html">SR-IOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-subnet-pools.html">Subnet pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-service-subnets.html">Service subnets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "config-qos" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/networking-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: b8fd8c76e4ec1d07c2970cbd5770a38196b5b343";
        var bugProject = "openstack-manuals";
        var bugTitle = "Quality of Service (QoS) in Networking Guide";
    var fieldTags = "networking-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 13:48";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>