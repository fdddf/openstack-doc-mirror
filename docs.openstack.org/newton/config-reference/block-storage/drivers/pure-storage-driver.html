<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Pure Storage iSCSI and Fibre Channel volume drivers</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../../_static/css/combined.css" rel="stylesheet">
<link href="../../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Pure Storage iSCSI and Fibre Channel volume drivers</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="prophetstor-dpl-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: ProphetStor Fibre Channel and iSCSI drivers"></i></a>
    
    
    <a href="quobyte-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Quobyte driver"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 13:49</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Pure Storage iSCSI and Fibre Channel volume drivers</a><ul>
<li><a class="reference internal" href="#limitations-and-known-issues">Limitations and known issues</a></li>
<li><a class="reference internal" href="#supported-operations">Supported operations</a></li>
<li><a class="reference internal" href="#configure-openstack-and-purity">Configure OpenStack and Purity</a><ul>
<li><a class="reference internal" href="#configure-the-openstack-block-storage-service">Configure the OpenStack Block Storage service</a></li>
</ul>
</li>
<li><a class="reference internal" href="#volume-auto-eradication">Volume auto-eradication</a></li>
<li><a class="reference internal" href="#ssl-certification">SSL certification</a></li>
<li><a class="reference internal" href="#replication-configuration">Replication configuration</a></li>
<li><a class="reference internal" href="#automatic-thin-provisioning-oversubscription-ratio">Automatic thin-provisioning/oversubscription ratio</a></li>
<li><a class="reference internal" href="#scheduling-metrics">Scheduling metrics</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="pure-storage-iscsi-and-fibre-channel-volume-drivers">
<h1>Pure Storage iSCSI and Fibre Channel volume drivers<a class="headerlink" href="#pure-storage-iscsi-and-fibre-channel-volume-drivers" title="Permalink to this headline">¶</a></h1>
<p>The Pure Storage FlashArray volume drivers for OpenStack Block Storage
interact with configured Pure Storage arrays and support various
operations.</p>
<p>Support for iSCSI storage protocol is available with the PureISCSIDriver
Volume Driver class, and Fibre Channel with PureFCDriver.</p>
<p>All drivers are compatible with Purity FlashArrays that support the REST
API version 1.2, 1.3, or 1.4 (Purity 4.0.0 and newer).</p>
<div class="section" id="limitations-and-known-issues">
<h2>Limitations and known issues<a class="headerlink" href="#limitations-and-known-issues" title="Permalink to this headline">¶</a></h2>
<p>If you do not set up the nodes hosting instances to use multipathing,
all network connectivity will use a single physical port on the array.
In addition to significantly limiting the available bandwidth, this
means you do not have the high-availability and non-disruptive upgrade
benefits provided by FlashArray. Multipathing must be used to take advantage
of these benefits.</p>
</div>
<div class="section" id="supported-operations">
<h2>Supported operations<a class="headerlink" href="#supported-operations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Create, delete, attach, detach, retype, clone, and extend volumes.</li>
<li>Create a volume from snapshot.</li>
<li>Create, list, and delete volume snapshots.</li>
<li>Create, list, update, and delete consistency groups.</li>
<li>Create, list, and delete consistency group snapshots.</li>
<li>Manage and unmanage a volume.</li>
<li>Manage and unmanage a snapshot.</li>
<li>Get volume statistics.</li>
<li>Create a thin provisioned volume.</li>
<li>Replicate volumes to remote Pure Storage array(s).</li>
</ul>
</div>
<div class="section" id="configure-openstack-and-purity">
<h2>Configure OpenStack and Purity<a class="headerlink" href="#configure-openstack-and-purity" title="Permalink to this headline">¶</a></h2>
<p>You need to configure both your Purity array and your OpenStack cluster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These instructions assume that the <code class="docutils literal"><span class="pre">cinder-api</span></code> and <code class="docutils literal"><span class="pre">cinder-scheduler</span></code>
services are installed and configured in your OpenStack cluster.</p>
</div>
<div class="section" id="configure-the-openstack-block-storage-service">
<h3>Configure the OpenStack Block Storage service<a class="headerlink" href="#configure-the-openstack-block-storage-service" title="Permalink to this headline">¶</a></h3>
<p>In these steps, you will edit the <code class="docutils literal"><span class="pre">cinder.conf</span></code> file to configure the
OpenStack Block Storage service to enable multipathing and to use the
Pure Storage FlashArray as back-end storage.</p>
<ol class="arabic">
<li><p class="first">Install Pure Storage PyPI module.
A requirement for the Pure Storage driver is the installation of the
Pure Storage Python SDK version 1.4.0 or later from PyPI.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install purestorage
</pre></div>
</div>
</li>
<li><p class="first">Retrieve an API token from Purity.
The OpenStack Block Storage service configuration requires an API token
from Purity. Actions performed by the volume driver use this token for
authorization. Also, Purity logs the volume driver&#8217;s actions as being
performed by the user who owns this API token.</p>
<p>If you created a Purity user account that is dedicated to managing your
OpenStack Block Storage volumes, copy the API token from that user
account.</p>
<p>Use the appropriate create or list command below to display and copy the
Purity API token:</p>
<ul>
<li><p class="first">To create a new API token:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pureadmin create --api-token USER
</pre></div>
</div>
<p>The following is an example output:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pureadmin create --api-token pureuser
<span class="go">Name      API Token                             Created</span>
<span class="go">pureuser  902fdca3-7e3f-d2e4-d6a6-24c2285fe1d9  2014-08-04 14:50:30</span>
</pre></div>
</div>
</li>
<li><p class="first">To list an existing API token:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pureadmin list --api-token --expose USER
</pre></div>
</div>
<p>The following is an example output:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pureadmin list --api-token --expose pureuser
<span class="go">Name      API Token                             Created</span>
<span class="go">pureuser  902fdca3-7e3f-d2e4-d6a6-24c2285fe1d9  2014-08-04 14:50:30</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Copy the API token retrieved (<code class="docutils literal"><span class="pre">902fdca3-7e3f-d2e4-d6a6-24c2285fe1d9</span></code> from
the examples above) to use in the next step.</p>
</li>
<li><p class="first">Edit the OpenStack Block Storage service configuration file.
The following sample <code class="docutils literal"><span class="pre">/etc/cinder/cinder.conf</span></code> configuration lists the
relevant settings for a typical Block Storage service using a single
Pure Storage array:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">enabled_backends</span> <span class="o">=</span> <span class="s">puredriver-1</span>
<span class="na">default_volume_type</span> <span class="o">=</span> <span class="s">puredriver-1</span>

<span class="k">[puredriver-1]</span>
<span class="na">volume_backend_name</span> <span class="o">=</span> <span class="s">puredriver-1</span>
<span class="na">volume_driver</span> <span class="o">=</span> <span class="s">PURE_VOLUME_DRIVER</span>
<span class="na">san_ip</span> <span class="o">=</span> <span class="s">IP_PURE_MGMT</span>
<span class="na">pure_api_token</span> <span class="o">=</span> <span class="s">PURE_API_TOKEN</span>
<span class="na">use_multipath_for_image_xfer</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
<p>Replace the following variables accordingly:</p>
<dl class="docutils">
<dt>PURE_VOLUME_DRIVER</dt>
<dd><p class="first last">Use either <code class="docutils literal"><span class="pre">cinder.volume.drivers.pure.PureISCSIDriver</span></code> for iSCSI or
<code class="docutils literal"><span class="pre">cinder.volume.drivers.pure.PureFCDriver</span></code> for Fibre Channel
connectivity.</p>
</dd>
<dt>IP_PURE_MGMT</dt>
<dd><p class="first last">The IP address of the Pure Storage array&#8217;s management interface or a
domain name that resolves to that IP address.</p>
</dd>
<dt>PURE_API_TOKEN</dt>
<dd><p class="first last">The Purity Authorization token that the volume driver uses to
perform volume management on the Pure Storage array.</p>
</dd>
</dl>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The volume driver automatically creates Purity host objects for
initiators as needed. If CHAP authentication is enabled via the
<code class="docutils literal"><span class="pre">use_chap_auth</span></code> setting, you must ensure there are no manually
created host objects with IQN&#8217;s that will be used by the OpenStack
Block Storage service. The driver will only modify credentials on hosts that
it manages.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If using the PureFCDriver it is recommended to use the OpenStack
Block Storage Fibre Channel Zone Manager.</p>
</div>
</div>
</div>
<div class="section" id="volume-auto-eradication">
<h2>Volume auto-eradication<a class="headerlink" href="#volume-auto-eradication" title="Permalink to this headline">¶</a></h2>
<p>To enable auto-eradication of deleted volumes, snapshots, and consistency
groups on deletion, modify the following option in the <code class="docutils literal"><span class="pre">cinder.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">pure_eradicate_on_delete</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
<p>By default, auto-eradication is disabled and all deleted volumes, snapshots,
and consistency groups are retained on the Pure Storage array in a recoverable
state for 24 hours from time of deletion.</p>
</div>
<div class="section" id="ssl-certification">
<h2>SSL certification<a class="headerlink" href="#ssl-certification" title="Permalink to this headline">¶</a></h2>
<p>To enable SSL certificate validation, modify the following option in the
<code class="docutils literal"><span class="pre">cinder.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">driver_ssl_cert_verify</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
<p>By default, SSL certificate validation is disabled.</p>
<p>To specify a non-default path to <code class="docutils literal"><span class="pre">CA_Bundle</span></code> file or directory with
certificates of trusted CAs:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">driver_ssl_cert_path</span> <span class="o">=</span> <span class="s">Certificate path</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This requires the use of Pure Storage Python SDK &gt; 1.4.0.</p>
</div>
</div>
<div class="section" id="replication-configuration">
<h2>Replication configuration<a class="headerlink" href="#replication-configuration" title="Permalink to this headline">¶</a></h2>
<p>Add the following to the back-end specification to specify another Flash
Array to replicate to:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[puredriver-1]</span>
<span class="na">replication_device</span> <span class="o">=</span> <span class="s">backend_id:PURE2_NAME,san_ip:IP_PURE2_MGMT,api_token:PURE2_API_TOKEN</span>
</pre></div>
</div>
<p>Where <code class="docutils literal"><span class="pre">PURE2_NAME</span></code> is the name of the remote Pure Storage system,
<code class="docutils literal"><span class="pre">IP_PURE2_MGMT</span></code> is the management IP address of the remote array,
and <code class="docutils literal"><span class="pre">PURE2_API_TOKEN</span></code> is the Purity Authorization token
of the remote array.</p>
<p>Note that more than one <code class="docutils literal"><span class="pre">replication_device</span></code> line can be added to allow for
multi-target device replication.</p>
<p>A volume is only replicated if the volume is of a volume-type that has
the extra spec <code class="docutils literal"><span class="pre">replication_enabled</span></code> set to <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">True</span></code>.</p>
<p>To create a volume type that specifies replication to remote back ends:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack volume <span class="nb">type</span> create ReplicationType
<span class="gp">$</span> openstack volume <span class="nb">type</span> <span class="nb">set</span> --property <span class="nv">replication_enabled</span><span class="o">=</span><span class="s1">&#39;&lt;is&gt; True&#39;</span> ReplicationType
</pre></div>
</div>
<p>The following table contains the optional configuration parameters available
for replication configuration with the Pure Storage array.</p>
<table border="1" class="docutils">
<colgroup>
<col width="70%" />
<col width="18%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
<th class="head">Default</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">pure_replica_interval_default</span></code></td>
<td>Snapshot
replication
interval in
seconds.</td>
<td><code class="docutils literal"><span class="pre">900</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">pure_replica_retention_short_term_default</span></code></td>
<td>Retain all
snapshots on
target for
this time
(in seconds).</td>
<td><code class="docutils literal"><span class="pre">14400</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">pure_replica_retention_long_term_per_day_default</span></code></td>
<td>Retain how
many
snapshots
for each
day.</td>
<td><code class="docutils literal"><span class="pre">3</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">pure_replica_retention_long_term_default</span></code></td>
<td>Retain
snapshots
per day
on target
for this
time (in
days).</td>
<td><code class="docutils literal"><span class="pre">7</span></code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">replication-failover</span></code> is only supported from the primary array to any of the
multiple secondary arrays, but subsequent <code class="docutils literal"><span class="pre">replication-failover</span></code> is only
supported back to the original primary array.</p>
</div>
</div>
<div class="section" id="automatic-thin-provisioning-oversubscription-ratio">
<h2>Automatic thin-provisioning/oversubscription ratio<a class="headerlink" href="#automatic-thin-provisioning-oversubscription-ratio" title="Permalink to this headline">¶</a></h2>
<p>To enable this feature where we calculate the array oversubscription ratio as
(total provisioned/actual used), add the following option in the
<code class="docutils literal"><span class="pre">cinder.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[puredriver-1]</span>
<span class="na">pure_automatic_max_oversubscription_ratio</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
<p>By default, this is disabled and we honor the hard-coded configuration option
<code class="docutils literal"><span class="pre">max_over_subscription_ratio</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Arrays with very good data reduction rates (compression/data deduplication/thin provisioning)
can get <em>very</em> large oversubscription rates applied.</p>
</div>
</div>
<div class="section" id="scheduling-metrics">
<h2>Scheduling metrics<a class="headerlink" href="#scheduling-metrics" title="Permalink to this headline">¶</a></h2>
<p>A large number of metrics are reported by the volume driver which can be useful
in implementing more control over volume placement in multi-backend
environments using the driver filter and weighter methods.</p>
<p>Metrics reported include, but are not limited to:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">total_capacity_gb</span>
<span class="na">free_capacity_gb</span>
<span class="na">provisioned_capacity</span>
<span class="na">total_volumes</span>
<span class="na">total_snapshots</span>
<span class="na">total_hosts</span>
<span class="na">total_pgroups</span>
<span class="na">writes_per_sec</span>
<span class="na">reads_per_sec</span>
<span class="na">input_per_sec</span>
<span class="na">output_per_sec</span>
<span class="na">usec_per_read_op</span>
<span class="na">usec_per_read_op</span>
<span class="na">queue_depth</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All total metrics include non-OpenStack managed objects on the array.</p>
</div>
<p>In conjunction with QOS extra-specs, you can create very complex algorithms to
manage volume placement. More detailed documentation on this is available in
other external documentation.</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="prophetstor-dpl-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: ProphetStor Fibre Channel and iSCSI drivers"></i></a>
          
          
            <a href="quobyte-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Quobyte driver"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 13:49</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../config-overview.html">OpenStack configuration overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../common-configurations.html">Common configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application-catalog.html">Application Catalog service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bare-metal.html">Bare Metal service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../block-storage.html">Block Storage service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../block-storage-overview.html">Introduction to the Block Storage service</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../volume-drivers.html">Volume drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backup-drivers.html">Backup drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../schedulers.html">Block Storage schedulers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logs.html">Log files used by Block Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fc-zoning.html">Fibre Channel Zone Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nested-quota.html">Nested quotas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../volume-encryption.html">Volume encryption supported by the key manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config-options.html">Additional options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../samples/index.html">Block Storage service sample configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tables/conf-changes/cinder.html">New, updated, and deprecated options in Newton for Block Storage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../clustering.html">Clustering service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compute.html">Compute service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-processing.html">Data Processing service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../database.html">Database service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../identity.html">Identity service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../image.html">Image service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../message.html">Message service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking.html">Networking service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage.html">Object Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../orchestration.html">Orchestration service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../shared-file-systems.html">Shared File Systems service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../telemetry.html">Telemetry service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../policy-json-file.html">The policy.json file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "block-storage/drivers/pure-storage-driver" + ".rst";
        gitURL = "Source: http://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/config-reference/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: b8fd8c76e4ec1d07c2970cbd5770a38196b5b343";
        var bugProject = "openstack-manuals";
        var bugTitle = "Pure Storage iSCSI and Fibre Channel volume drivers in Configuration Reference";
    var fieldTags = "config-reference";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 13:49";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>