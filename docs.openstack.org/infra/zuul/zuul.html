<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Zuul &mdash; Zuul 2.5.2.dev54 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.5.2.dev54',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Zuul 2.5.2.dev54 documentation" href="index.html" />
    <link rel="next" title="Merger" href="merger.html" />
    <link rel="prev" title="Reporters" href="reporters.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="merger.html" title="Merger"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reporters.html" title="Reporters"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Zuul 2.5.2.dev54 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="zuul">
<h1>Zuul<a class="headerlink" href="#zuul" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Zuul has three configuration files:</p>
<dl class="docutils">
<dt><strong>zuul.conf</strong></dt>
<dd>Connection information for Gerrit and Gearman, locations of the
other config files. (required)</dd>
<dt><strong>layout.yaml</strong></dt>
<dd>Project and pipeline configuration &#8211; what Zuul does. (required)</dd>
<dt><strong>logging.conf</strong></dt>
<dd>Python logging config. (optional)</dd>
</dl>
<p>Examples of each of the three files can be found in the etc/ directory
of the source distribution.</p>
<div class="section" id="zuul-conf">
<span id="zuulconf"></span><h3>zuul.conf<a class="headerlink" href="#zuul-conf" title="Permalink to this headline">¶</a></h3>
<p>Zuul will look for <tt class="docutils literal"><span class="pre">/etc/zuul/zuul.conf</span></tt> or <tt class="docutils literal"><span class="pre">~/zuul.conf</span></tt> to
bootstrap its configuration.  Alternately, you may specify <tt class="docutils literal"><span class="pre">-c</span>
<span class="pre">/path/to/zuul.conf</span></tt> on the command line.</p>
<p>Gerrit and Gearman connection information are each described in a
section of zuul.conf.  The location of the other two configuration
files (as well as the location of the PID file when running Zuul as a
server) are specified in a third section.</p>
<p>The three sections of this config and their options are documented below.
You can also find an example zuul.conf file in the git
<a class="reference external" href="https://git.openstack.org/cgit/openstack-infra/zuul/tree/etc/zuul.conf-sample">repository</a></p>
<div class="section" id="gearman">
<h4>gearman<a class="headerlink" href="#gearman" title="Permalink to this headline">¶</a></h4>
<p>Client connection information for gearman. If using Zuul&#8217;s builtin gearmand
server just set <strong>server</strong> to 127.0.0.1.</p>
<dl class="docutils">
<dt><strong>server</strong></dt>
<dd>Hostname or IP address of the Gearman server.
<tt class="docutils literal"><span class="pre">server=gearman.example.com</span></tt> (required)</dd>
<dt><strong>port</strong></dt>
<dd>Port on which the Gearman server is listening.
<tt class="docutils literal"><span class="pre">port=4730</span></tt> (optional)</dd>
<dt><strong>check_job_registration</strong></dt>
<dd>Check to see if job is registered with Gearman or not. When True
a build result of NOT_REGISTERED will be return if job is not found.
<tt class="docutils literal"><span class="pre">check_job_registration=True</span></tt></dd>
</dl>
</div>
<div class="section" id="gearman-server">
<h4>gearman_server<a class="headerlink" href="#gearman-server" title="Permalink to this headline">¶</a></h4>
<p>The builtin gearman server. Zuul can fork a gearman process from itself rather
than connecting to an external one.</p>
<dl class="docutils">
<dt><strong>start</strong></dt>
<dd>Whether to start the internal Gearman server (default: False).
<tt class="docutils literal"><span class="pre">start=true</span></tt></dd>
<dt><strong>listen_address</strong></dt>
<dd>IP address or domain name on which to listen (default: all addresses).
<tt class="docutils literal"><span class="pre">listen_address=127.0.0.1</span></tt></dd>
<dt><strong>log_config</strong></dt>
<dd>Path to log config file for internal Gearman server.
<tt class="docutils literal"><span class="pre">log_config=/etc/zuul/gearman-logging.yaml</span></tt></dd>
</dl>
</div>
<div class="section" id="webapp">
<h4>webapp<a class="headerlink" href="#webapp" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt><strong>listen_address</strong></dt>
<dd>IP address or domain name on which to listen (default: 0.0.0.0).
<tt class="docutils literal"><span class="pre">listen_address=127.0.0.1</span></tt></dd>
<dt><strong>port</strong></dt>
<dd>Port on which the webapp is listening (default: 8001).
<tt class="docutils literal"><span class="pre">port=8008</span></tt></dd>
</dl>
</div>
<div class="section" id="id1">
<h4>zuul<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Zuul&#8217;s main configuration section. At minimum zuul must be able to find
layout.yaml to be useful.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Must be provided when running zuul-server</p>
</div>
<dl class="docutils" id="layout-config">
<dt><strong>layout_config</strong></dt>
<dd>Path to layout config file.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">layout_config=/etc/zuul/layout.yaml</span></tt></dd>
<dt><strong>log_config</strong></dt>
<dd>Path to log config file.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">log_config=/etc/zuul/logging.yaml</span></tt></dd>
<dt><strong>pidfile</strong></dt>
<dd>Path to PID lock file.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">pidfile=/var/run/zuul/zuul.pid</span></tt></dd>
<dt><strong>state_dir</strong></dt>
<dd>Path to directory that Zuul should save state to.  Used by all Zuul
commands.
<tt class="docutils literal"><span class="pre">state_dir=/var/lib/zuul</span></tt></dd>
<dt><strong>report_times</strong></dt>
<dd>Boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) that determines if Zuul should
include elapsed times for each job in the textual report.  Used by
zuul-server only.
<tt class="docutils literal"><span class="pre">report_times=true</span></tt></dd>
<dt><strong>status_url</strong></dt>
<dd>URL that will be posted in Zuul comments made to Gerrit changes when
starting jobs for a change.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">status_url=https://zuul.example.com/status</span></tt></dd>
<dt><strong>status_expiry</strong></dt>
<dd>Zuul will cache the status.json file for this many seconds. This is an
optional value and <tt class="docutils literal"><span class="pre">1</span></tt> is used by default.
<tt class="docutils literal"><span class="pre">status_expiry=1</span></tt></dd>
<dt><strong>url_pattern</strong></dt>
<dd>If you are storing build logs external to the system that originally
ran jobs and wish to link to those logs when Zuul makes comments on
Gerrit changes for completed jobs this setting configures what the
URLs for those links should be.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">http://logs.example.com/{change.number}/{change.patchset}/{pipeline.name}/{job.name}/{build.number}</span></tt></dd>
<dt><strong>job_name_in_report</strong></dt>
<dd>Boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) that indicates whether the
job name should be included in the report (normally only the URL
is included).  Defaults to <tt class="docutils literal"><span class="pre">false</span></tt>.  Used by zuul-server only.
<tt class="docutils literal"><span class="pre">job_name_in_report=true</span></tt></dd>
</dl>
</div>
<div class="section" id="merger">
<h4>merger<a class="headerlink" href="#merger" title="Permalink to this headline">¶</a></h4>
<p>The zuul-merger process configuration. Detailed documentation on this process
can be found on the <a class="reference internal" href="merger.html"><em>Merger</em></a> page.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Must be provided when running zuul-merger. Both services may share the
same configuration (and even host) or otherwise have an individual
zuul.conf.</p>
</div>
<dl class="docutils">
<dt><strong>git_dir</strong></dt>
<dd>Directory that Zuul should clone local git repositories to.
<tt class="docutils literal"><span class="pre">git_dir=/var/lib/zuul/git</span></tt></dd>
<dt><strong>git_user_email</strong></dt>
<dd>Optional: Value to pass to <cite>git config user.email</cite>.
<tt class="docutils literal"><span class="pre">git_user_email=zuul&#64;example.com</span></tt></dd>
<dt><strong>git_user_name</strong></dt>
<dd>Optional: Value to pass to <cite>git config user.name</cite>.
<tt class="docutils literal"><span class="pre">git_user_name=zuul</span></tt></dd>
<dt><strong>zuul_url</strong></dt>
<dd>URL of this merger&#8217;s git repos, accessible to test workers.  Usually
&#8220;<a class="reference external" href="http://zuul.example.com/p">http://zuul.example.com/p</a>&#8221; or &#8220;<a class="reference external" href="http://zuul-merger01.example.com/p">http://zuul-merger01.example.com/p</a>&#8221;
depending on whether the merger is co-located with the Zuul server.</dd>
<dt><strong>log_config</strong></dt>
<dd>Path to log config file for the merger process.
<tt class="docutils literal"><span class="pre">log_config=/etc/zuul/logging.yaml</span></tt></dd>
<dt><strong>pidfile</strong></dt>
<dd>Path to PID lock file for the merger process.
<tt class="docutils literal"><span class="pre">pidfile=/var/run/zuul-merger/merger.pid</span></tt></dd>
</dl>
</div>
<div class="section" id="swift">
<span id="id2"></span><h4>swift<a class="headerlink" href="#swift" title="Permalink to this headline">¶</a></h4>
<p>To send (optional) swift upload instructions this section must be
present. Multiple destinations can be defined in the <a class="reference internal" href="#jobs"><em>Jobs</em></a> section
of the layout.</p>
<p>If you are sending the temp-url-key or fetching the x-storage-url, you
will need the python-swiftclient module installed.</p>
<dl class="docutils">
<dt><strong>X-Account-Meta-Temp-Url-Key</strong> (optional)</dt>
<dd>This is the key used to sign the HMAC message. If you do not set a
key Zuul will generate one automatically.</dd>
<dt><strong>Send-Temp-Url-Key</strong> (optional)</dt>
<dd>Zuul can send the X-Account-Meta-Temp-Url-Key to swift for you if
you have set up the appropriate credentials in <tt class="docutils literal"><span class="pre">authurl</span></tt> below.
This isn&#8217;t necessary if you know and have set your
X-Account-Meta-Temp-Url-Key.
If set, Zuul requires the python-swiftclient module.
<tt class="docutils literal"><span class="pre">default:</span> <span class="pre">true</span></tt></dd>
<dt><strong>X-Storage-Url</strong> (optional)</dt>
<dd>The storage URL is the destination to upload files into. If you do
not set this the <tt class="docutils literal"><span class="pre">authurl</span></tt> credentials are used to fetch the url
from swift and Zuul will requires the python-swiftclient module.</dd>
<dt><strong>authurl</strong> (optional)</dt>
<dd>The (keystone) Auth URL for swift.
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example,</span> <span class="pre">https://identity.api.rackspacecloud.com/v2.0/</span></tt>
This is required if you have Send-Temp-Url-Key set to <tt class="docutils literal"><span class="pre">True</span></tt> or
if you have not supplied the X-Storage-Url.</dd>
</dl>
<p>Any of the <a class="reference external" href="http://docs.openstack.org/developer/python-swiftclient/swiftclient.html#module-swiftclient.client">swiftclient connection parameters</a> can also be defined
here by the same name. Including the os_options by their key name (
<tt class="docutils literal"><span class="pre">for</span> <span class="pre">example</span> <span class="pre">tenant_id</span></tt>)</p>
<dl class="docutils">
<dt><strong>region_name</strong> (optional)</dt>
<dd>The region name holding the swift container
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example,</span> <span class="pre">SYD</span></tt></dd>
</dl>
<p>Each destination defined by the <a class="reference internal" href="#jobs"><em>Jobs</em></a> will have the following
default values that it may overwrite.</p>
<dl class="docutils">
<dt><strong>default_container</strong> (optional)</dt>
<dd>Container name to place the log into
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example,</span> <span class="pre">logs</span></tt></dd>
<dt><strong>default_expiry</strong> (optional)</dt>
<dd>How long the signed destination should be available for
<tt class="docutils literal"><span class="pre">default:</span> <span class="pre">7200</span> <span class="pre">(2hrs)</span></tt></dd>
<dt><strong>default_max_file_size</strong> (optional)</dt>
<dd>The maximum size of an individual file
<tt class="docutils literal"><span class="pre">default:</span> <span class="pre">104857600</span> <span class="pre">(100MB)</span></tt></dd>
<dt><strong>default_max_file_count</strong> (optional)</dt>
<dd>The maximum number of separate files to allow
<tt class="docutils literal"><span class="pre">default:</span> <span class="pre">10</span></tt></dd>
<dt><strong>default_logserver_prefix</strong></dt>
<dd>Provide a URL to the CDN or logserver app so that a worker knows
what URL to return. The worker should return the logserver_prefix
url and the object path.
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example:</span> <span class="pre">http://logs.example.org/server.app?obj=</span></tt></dd>
</dl>
</div>
<div class="section" id="connection-arbitraryname">
<span id="connection"></span><h4>connection ArbitraryName<a class="headerlink" href="#connection-arbitraryname" title="Permalink to this headline">¶</a></h4>
<p>A connection can be listed with any arbitrary name. The required
parameters are specified in the <a class="reference internal" href="connections.html#connections"><em>Connections</em></a> documentation
depending on what driver you are using.</p>
</div>
</div>
<div class="section" id="layout-yaml">
<span id="layoutyaml"></span><h3>layout.yaml<a class="headerlink" href="#layout-yaml" title="Permalink to this headline">¶</a></h3>
<p>This is the main configuration file for Zuul, where all of the pipelines
and projects are defined, what tests should be run, and what actions
Zuul should perform.  There are three sections: pipelines, jobs, and
projects.</p>
<div class="section" id="includes">
<span id="id3"></span><h4>Includes<a class="headerlink" href="#includes" title="Permalink to this headline">¶</a></h4>
<p>Custom functions to be used in Zuul&#8217;s configuration may be provided
using the <tt class="docutils literal"><span class="pre">includes</span></tt> directive.  It accepts a list of files to
include, and currently supports one type of inclusion, a python file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>includes:
  - python-file: local_functions.py
</pre></div>
</div>
<dl class="docutils">
<dt><strong>python-file</strong></dt>
<dd>The path to a python file (either an absolute path or relative to the
directory name of <a class="reference internal" href="#layout-config"><em>layout_config</em></a>).  The
file will be loaded and objects that it defines will be placed in a
special environment which can be referenced in the Zuul configuration.
Currently only the parameter-function attribute of a Job uses this
feature.</dd>
</dl>
</div>
<div class="section" id="pipelines">
<h4>Pipelines<a class="headerlink" href="#pipelines" title="Permalink to this headline">¶</a></h4>
<p>Zuul can have any number of independent pipelines.  Whenever a matching
Gerrit event is found for a pipeline, that event is added to the
pipeline, and the jobs specified for that pipeline are run.  When all
jobs specified for the pipeline that were triggered by an event are
completed, Zuul reports back to Gerrit the results.</p>
<p>There are no pre-defined pipelines in Zuul, rather you can define
whatever pipelines you need in the layout file.  This is a very flexible
system that can accommodate many kinds of workflows.</p>
<p>Here is a quick example of a pipeline definition followed by an
explanation of each of the parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: check
  manager: IndependentPipelineManager
  source: my_gerrit
  trigger:
    my_gerrit:
      - event: patchset-created
  success:
    my_gerrit:
      verified: 1
  failure:
    my_gerrit
      verified: -1
</pre></div>
</div>
<dl class="docutils">
<dt><strong>name</strong></dt>
<dd>This is used later in the project definition to indicate what jobs
should be run for events in the pipeline.</dd>
<dt><strong>description</strong></dt>
<dd>This is an optional field that may be used to provide a textual
description of the pipeline.</dd>
<dt><strong>source</strong></dt>
<dd>A required field that specifies a connection that provides access to
the change objects that this pipeline operates on. The name of the
connection as per the zuul.conf should be specified. The driver used
for the connection named will be the source. Currently only <tt class="docutils literal"><span class="pre">gerrit</span></tt>
drivers are supported.</dd>
<dt><strong>success-message</strong></dt>
<dd>An optional field that supplies the introductory text in message
reported back to Gerrit when all the voting builds are successful.
Defaults to &#8220;Build successful.&#8221;</dd>
<dt><strong>failure-message</strong></dt>
<dd>An optional field that supplies the introductory text in message
reported back to Gerrit when at least one voting build fails.
Defaults to &#8220;Build failed.&#8221;</dd>
<dt><strong>merge-failure-message</strong></dt>
<dd>An optional field that supplies the introductory text in message
reported back to Gerrit when a change fails to merge with the
current state of the repository.
Defaults to &#8220;Merge failed.&#8221;</dd>
<dt><strong>footer-message</strong></dt>
<dd>An optional field to supply additional information after test results.
Useful for adding information about the CI system such as debugging
and contact details.</dd>
<dt><strong>manager</strong></dt>
<dd><p class="first">There are currently two schemes for managing pipelines:</p>
<dl class="last docutils">
<dt><em>IndependentPipelineManager</em></dt>
<dd><p class="first">Every event in this pipeline should be treated as independent of
other events in the pipeline.  This is appropriate when the order of
events in the pipeline doesn&#8217;t matter because the results of the
actions this pipeline performs can not affect other events in the
pipeline.  For example, when a change is first uploaded for review,
you may want to run tests on that change to provide early feedback
to reviewers.  At the end of the tests, the change is not going to
be merged, so it is safe to run these tests in parallel without
regard to any other changes in the pipeline.  They are independent.</p>
<p class="last">Another type of pipeline that is independent is a post-merge
pipeline. In that case, the changes have already merged, so the
results can not affect any other events in the pipeline.</p>
</dd>
<dt><em>DependentPipelineManager</em></dt>
<dd><p class="first">The dependent pipeline manager is designed for gating.  It ensures
that every change is tested exactly as it is going to be merged
into the repository.  An ideal gating system would test one change
at a time, applied to the tip of the repository, and only if that
change passed tests would it be merged.  Then the next change in
line would be tested the same way.  In order to achieve parallel
testing of changes, the dependent pipeline manager performs
speculative execution on changes.  It orders changes based on
their entry into the pipeline.  It begins testing all changes in
parallel, assuming that each change ahead in the pipeline will pass
its tests.  If they all succeed, all the changes can be tested and
merged in parallel.  If a change near the front of the pipeline
fails its tests, each change behind it ignores whatever tests have
been completed and are tested again without the change in front.
This way gate tests may run in parallel but still be tested
correctly, exactly as they will appear in the repository when
merged.</p>
<p>One important characteristic of the DependentPipelineManager is that
it analyzes the jobs that are triggered by different projects, and
if those projects have jobs in common, it treats those projects as
related, and they share a single virtual queue of changes.  Thus,
if there is a job that performs integration testing on two
projects, those two projects will automatically share a virtual
change queue.  If a third project does not invoke that job, it
will be part of a separate virtual change queue, and changes to
it will not depend on changes to the first two jobs.</p>
<p class="last">For more detail on the theory and operation of Zuul&#8217;s
DependentPipelineManager, see: <a class="reference internal" href="gating.html"><em>Project Gating</em></a>.</p>
</dd>
</dl>
</dd>
<dt><strong>trigger</strong></dt>
<dd><p class="first">At least one trigger source must be supplied for each pipeline.
Triggers are not exclusive &#8211; matching events may be placed in
multiple pipelines, and they will behave independently in each of
the pipelines they match.</p>
<p class="last">Triggers are loaded from their connection name. The driver type of
the connection will dictate which options are available.
See <a class="reference internal" href="triggers.html"><em>Triggers</em></a>.</p>
</dd>
<dt><strong>require</strong></dt>
<dd>If this section is present, it established pre-requisites for any
kind of item entering the Pipeline.  Regardless of how the item is
to be enqueued (via any trigger or automatic dependency resolution),
the conditions specified here must be met or the item will not be
enqueued.</dd>
</dl>
<blockquote id="pipeline-require-approval">
<div><p><strong>approval</strong>
This requires that a certain kind of approval be present for the
current patchset of the change (the approval could be added by the
event in question).  It takes several sub-parameters, all of which
are optional and are combined together so that there must be an
approval matching all specified requirements.</p>
<blockquote>
<div><p><em>username</em>
If present, an approval from this username is required.  It is
treated as a regular expression.</p>
<p><em>email</em>
If present, an approval with this email address is required.  It
is treated as a regular expression.</p>
<p><em>email-filter</em> (deprecated)
A deprecated alternate spelling of <em>email</em>.  Only one of <em>email</em> or
<em>email_filter</em> should be used.</p>
<p><em>older-than</em>
If present, the approval must be older than this amount of time
to match.  Provide a time interval as a number with a suffix of
&#8220;w&#8221; (weeks), &#8220;d&#8221; (days), &#8220;h&#8221; (hours), &#8220;m&#8221; (minutes), &#8220;s&#8221;
(seconds).  Example <tt class="docutils literal"><span class="pre">48h</span></tt> or <tt class="docutils literal"><span class="pre">2d</span></tt>.</p>
<p><em>newer-than</em>
If present, the approval must be newer than this amount of time
to match.  Same format as &#8220;older-than&#8221;.</p>
<p>Any other field is interpreted as a review category and value
pair.  For example <tt class="docutils literal"><span class="pre">verified:</span> <span class="pre">1</span></tt> would require that the approval
be for a +1 vote in the &#8220;Verified&#8221; column.  The value may either
be a single value or a list: <tt class="docutils literal"><span class="pre">verified:</span> <span class="pre">[1,</span> <span class="pre">2]</span></tt> would match
either a +1 or +2 vote.</p>
</div></blockquote>
<p><strong>open</strong>
A boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) that indicates whether the change
must be open or closed in order to be enqueued.</p>
<p><strong>current-patchset</strong>
A boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) that indicates whether the change
must be the current patchset in order to be enqueued.</p>
<p><strong>status</strong>
A string value that corresponds with the status of the change
reported by the trigger.  For example, when using the Gerrit
trigger, status values such as <tt class="docutils literal"><span class="pre">NEW</span></tt> or <tt class="docutils literal"><span class="pre">MERGED</span></tt> may be useful.</p>
</div></blockquote>
<dl class="docutils">
<dt><strong>reject</strong></dt>
<dd><p class="first">If this section is present, it establishes pre-requisites that can
block an item from being enqueued. It can be considered a negative
version of <strong>require</strong>.</p>
<p><strong>approval</strong>
This takes a list of approvals. If an approval matches the provided
criteria the change can not be entered into the pipeline. It follows
the same syntax as the <a class="reference internal" href="#pipeline-require-approval"><em>&#8220;require approval&#8221; pipeline above</em></a>.</p>
<p>Example to reject a change with any negative vote:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>reject:
  approval:
    - code-review: [-1, -2]
</pre></div>
</div>
</dd>
<dt><strong>dequeue-on-new-patchset</strong></dt>
<dd>Normally, if a new patchset is uploaded to a change that is in a
pipeline, the existing entry in the pipeline will be removed (with
jobs canceled and any dependent changes that can no longer merge as
well.  To suppress this behavior (and allow jobs to continue
running), set this to <tt class="docutils literal"><span class="pre">false</span></tt>.  Default: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><strong>ignore-dependencies</strong></dt>
<dd>In any kind of pipeline (dependent or independent), Zuul will
attempt to enqueue all dependencies ahead of the current change so
that they are tested together (independent pipelines report the
results of each change regardless of the results of changes ahead).
To ignore dependencies completely in an independent pipeline, set
this to <tt class="docutils literal"><span class="pre">true</span></tt>.  This option is ignored by dependent pipelines.
The default is: <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><strong>success</strong></dt>
<dd>Describes where Zuul should report to if all the jobs complete
successfully.
This section is optional; if it is omitted, Zuul will run jobs and
do nothing on success; it will not even report a message to Gerrit.
If the section is present, the listed reporter plugins will be
asked to report on the jobs.
The reporters are listed by their connection name. The options
available depend on the driver for the supplied connection.
See <a class="reference internal" href="reporters.html"><em>Reporters</em></a> for more details.</dd>
<dt><strong>failure</strong></dt>
<dd>Uses the same syntax as <strong>success</strong>, but describes what Zuul should
do if at least one job fails.</dd>
<dt><strong>merge-failure</strong></dt>
<dd>Uses the same syntax as <strong>success</strong>, but describes what Zuul should
do if it is unable to merge in the patchset. If no merge-failure
reporters are listed then the <tt class="docutils literal"><span class="pre">failure</span></tt> reporters will be used to
notify of unsuccessful merges.</dd>
<dt><strong>start</strong></dt>
<dd>Uses the same syntax as <strong>success</strong>, but describes what Zuul should
do when a change is added to the pipeline manager.  This can be used,
for example, to reset the value of the Verified review category.</dd>
<dt><strong>disabled</strong></dt>
<dd>Uses the same syntax as <strong>success</strong>, but describes what Zuul should
do when a pipeline is disabled.
See <tt class="docutils literal"><span class="pre">disable-after-consecutive-failures</span></tt>.</dd>
<dt><strong>disable-after-consecutive-failures</strong></dt>
<dd>If set, a pipeline can enter a &#8216;&#8217;disabled&#8217;&#8217; state if too many changes
in a row fail. When this value is exceeded the pipeline will stop
reporting to any of the <tt class="docutils literal"><span class="pre">success</span></tt>, <tt class="docutils literal"><span class="pre">failure</span></tt> or <tt class="docutils literal"><span class="pre">merge-failure</span></tt>
reporters and instead only report to the <tt class="docutils literal"><span class="pre">disabled</span></tt> reporters.
(No <tt class="docutils literal"><span class="pre">start</span></tt> reports are made when a pipeline is disabled).</dd>
<dt><strong>precedence</strong></dt>
<dd>Indicates how the build scheduler should prioritize jobs for
different pipelines.  Each pipeline may have one precedence, jobs
for pipelines with a higher precedence will be run before ones with
lower.  The value should be one of <tt class="docutils literal"><span class="pre">high</span></tt>, <tt class="docutils literal"><span class="pre">normal</span></tt>, or <tt class="docutils literal"><span class="pre">low</span></tt>.
Default: <tt class="docutils literal"><span class="pre">normal</span></tt>.</dd>
<dt><strong>window</strong></dt>
<dd>DependentPipelineManagers only. Zuul can rate limit
DependentPipelineManagers in a manner similar to TCP flow control.
Jobs are only started for changes in the queue if they sit in the
actionable window for the pipeline. The initial length of this window
is configurable with this value. The value given should be a positive
integer value. A value of <tt class="docutils literal"><span class="pre">0</span></tt> disables rate limiting on the
DependentPipelineManager.
Default: <tt class="docutils literal"><span class="pre">20</span></tt>.</dd>
<dt><strong>window-floor</strong></dt>
<dd>DependentPipelineManagers only. This is the minimum value for the
window described above. Should be a positive non zero integer value.
Default: <tt class="docutils literal"><span class="pre">3</span></tt>.</dd>
<dt><strong>window-increase-type</strong></dt>
<dd>DependentPipelineManagers only. This value describes how the window
should grow when changes are successfully merged by zuul. A value of
<tt class="docutils literal"><span class="pre">linear</span></tt> indicates that <tt class="docutils literal"><span class="pre">window-increase-factor</span></tt> should be added
to the previous window value. A value of <tt class="docutils literal"><span class="pre">exponential</span></tt> indicates
that <tt class="docutils literal"><span class="pre">window-increase-factor</span></tt> should be multiplied against the
previous window value and the result will become the window size.
Default: <tt class="docutils literal"><span class="pre">linear</span></tt>.</dd>
<dt><strong>window-increase-factor</strong></dt>
<dd>DependentPipelineManagers only. The value to be added or multiplied
against the previous window value to determine the new window after
successful change merges.
Default: <tt class="docutils literal"><span class="pre">1</span></tt>.</dd>
<dt><strong>window-decrease-type</strong></dt>
<dd>DependentPipelineManagers only. This value describes how the window
should shrink when changes are not able to be merged by Zuul. A value
of <tt class="docutils literal"><span class="pre">linear</span></tt> indicates that <tt class="docutils literal"><span class="pre">window-decrease-factor</span></tt> should be
subtracted from the previous window value. A value of <tt class="docutils literal"><span class="pre">exponential</span></tt>
indicates that <tt class="docutils literal"><span class="pre">window-decrease-factor</span></tt> should be divided against
the previous window value and the result will become the window size.
Default: <tt class="docutils literal"><span class="pre">exponential</span></tt>.</dd>
<dt><strong>window-decrease-factor</strong></dt>
<dd>DependentPipelineManagers only. The value to be subtracted or divided
against the previous window value to determine the new window after
unsuccessful change merges.
Default: <tt class="docutils literal"><span class="pre">2</span></tt>.</dd>
</dl>
<p>Some example pipeline configurations are included in the sample layout
file.  The first is called a <em>check</em> pipeline:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: check
  manager: IndependentPipelineManager
  trigger:
    my_gerrit:
      - event: patchset-created
  success:
    my_gerrit:
      verified: 1
  failure:
    my_gerrit:
      verified: -1
</pre></div>
</div>
<p>This will trigger jobs each time a new patchset (or change) is
uploaded to Gerrit, and report +/-1 values to Gerrit in the
<tt class="docutils literal"><span class="pre">verified</span></tt> review category.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: gate
  manager: DependentPipelineManager
  trigger:
    my_gerrit:
      - event: comment-added
        approval:
          - approved: 1
  success:
    my_gerrit:
      verified: 2
      submit: true
  failure:
    my_gerrit:
      verified: -2
</pre></div>
</div>
<p>This will trigger jobs whenever a reviewer leaves a vote of <tt class="docutils literal"><span class="pre">1</span></tt> in the
<tt class="docutils literal"><span class="pre">approved</span></tt> review category in Gerrit (a non-standard category).
Changes will be tested in such a way as to guarantee that they will be
merged exactly as tested, though that will happen in parallel by
creating a virtual queue of dependent changes and performing
speculative execution of jobs.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: post
  manager: IndependentPipelineManager
  trigger:
    my_gerrit:
      - event: ref-updated
        ref: ^(?!refs/).*$
</pre></div>
</div>
<p>This will trigger jobs whenever a change is merged to a named branch
(e.g., <tt class="docutils literal"><span class="pre">master</span></tt>).  No output will be reported to Gerrit.  This is
useful for side effects such as creating per-commit tarballs.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: silent
  manager: IndependentPipelineManager
  trigger:
    my_gerrit:
      - event: patchset-created
</pre></div>
</div>
<p>This also triggers jobs when changes are uploaded to Gerrit, but no
results are reported to Gerrit.  This is useful for jobs that are in
development and not yet ready to be presented to developers.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pipelines:
  - name: post-merge
    manager: IndependentPipelineManager
    trigger:
      my_gerrit:
        - event: change-merged
    success:
      my_gerrit:
        force-message: True
    failure:
      my_gerrit:
        force-message: True
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">change-merged</span></tt> events happen when a change has been merged in the git
repository. The change is thus closed and Gerrit will not accept modifications
to the review scoring such as <tt class="docutils literal"><span class="pre">code-review</span></tt> or <tt class="docutils literal"><span class="pre">verified</span></tt>. By using the
<tt class="docutils literal"><span class="pre">force-message:</span> <span class="pre">True</span></tt> parameter, Zuul will pass <tt class="docutils literal"><span class="pre">--force-message</span></tt> to the
<tt class="docutils literal"><span class="pre">gerrit</span> <span class="pre">review</span></tt> command, thus making sure the message is actually
sent back to Gerrit regardless of approval scores.
That kind of pipeline is nice to run regression or performance tests.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">change-merged</span></tt> event does not include the commit sha1 which can be
hazardous, it would let you report back to Gerrit though.  If you were to
build a tarball for a specific commit, you should consider instead using
the <tt class="docutils literal"><span class="pre">ref-updated</span></tt> event which does include the commit sha1 (but lacks the
Gerrit change number).</p>
</div>
</div>
<div class="section" id="jobs">
<span id="id4"></span><h4>Jobs<a class="headerlink" href="#jobs" title="Permalink to this headline">¶</a></h4>
<p>The jobs section is optional, and can be used to set attributes of
jobs that are independent of their association with a project.  For
example, if a job should return a customized message on failure, that
may be specified here.  Otherwise, Zuul does not need to be told about
each job as it builds a list from the project specification.</p>
<dl class="docutils">
<dt><strong>name</strong></dt>
<dd>The name of the job.  This field is treated as a regular expression
and will be applied to each job that matches.</dd>
<dt><strong>queue-name (optional)</strong></dt>
<dd>Zuul will automatically combine projects that share a job into
shared change queues for dependent pipeline managers.  In order to
report statistics about these queues, it is convenient for them to
have names.  Zuul can automatically name change queues, however
these can grow quite long and are prone to changing as projects in
the queue change.  If you assign a queue-name to a job, Zuul will
use that as the name for the shared change queue that contains that
job instead of the automatically generated one.  It is an error for
a shared change queue to have more than one job with a queue-name if
they are not the same.</dd>
<dt><strong>failure-message (optional)</strong></dt>
<dd>The message that should be reported to Gerrit if the job fails.</dd>
<dt><strong>success-message (optional)</strong></dt>
<dd>The message that should be reported to Gerrit if the job fails.</dd>
<dt><strong>failure-pattern (optional)</strong></dt>
<dd>The URL that should be reported to Gerrit if the job fails.
Defaults to the build URL or the url_pattern configured in
zuul.conf.  May be supplied as a string pattern with substitutions
as described in url_pattern in <a class="reference internal" href="#zuulconf"><em>zuul.conf</em></a>.</dd>
<dt><strong>success-pattern (optional)</strong></dt>
<dd>The URL that should be reported to Gerrit if the job succeeds.
Defaults to the build URL or the url_pattern configured in
zuul.conf.  May be supplied as a string pattern with substitutions
as described in url_pattern in <a class="reference internal" href="#zuulconf"><em>zuul.conf</em></a>.</dd>
<dt><strong>hold-following-changes (optional)</strong></dt>
<dd>This is a boolean that indicates that changes that follow this
change in a dependent change pipeline should wait until this job
succeeds before launching.  If this is applied to a very short job
that can predict whether longer jobs will fail early, this can be
used to reduce the number of jobs that Zuul will launch and
ultimately have to cancel.  In that case, a small amount of
parallelization of jobs is traded for more efficient use of testing
resources.  On the other hand, to apply this to a long running job
would largely defeat the parallelization of dependent change testing
that is the main feature of Zuul.  Default: <tt class="docutils literal"><span class="pre">false</span></tt>.</dd>
<dt><strong>mutex (optional)</strong></dt>
<dd>This is a string that names a mutex that should be observed by this
job.  Only one build of any job that references the same named mutex
will be enqueued at a time.  This applies across all pipelines.</dd>
<dt><strong>branch (optional)</strong></dt>
<dd>This job should only be run on matching branches.  This field is
treated as a regular expression and multiple branches may be
listed.</dd>
<dt><strong>files (optional)</strong></dt>
<dd>This job should only be run if at least one of the files involved in
the change (added, deleted, or modified) matches at least one of the
file patterns listed here.  This field is treated as a regular
expression and multiple expressions may be listed.</dd>
</dl>
<p><strong>skip-if (optional)</strong></p>
<blockquote>
<div><p>This job should not be run if all the patterns specified by the
optional fields listed below match on their targets.  When multiple
sets of parameters are provided, this job will be skipped if any set
matches.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>jobs:
  - name: check-tempest-dsvm-neutron
    skip-if:
      - project: ^openstack/neutron$
        branch: ^stable/juno$
        all-files-match-any:
          - ^neutron/tests/.*$
          - ^tools/.*$
      - all-files-match-any:
          - ^doc/.*$
          - ^.*\.rst$
</pre></div>
</div>
<p>With this configuration, the job would be skipped for a neutron
patchset for the stable/juno branch provided that every file in the
change matched at least one of the specified file regexes.  The job
will also be skipped for any patchset that modified only the doc
tree or rst files.</p>
<dl class="docutils">
<dt><em>project</em> (optional)</dt>
<dd>The regular expression to match against the project of the change.</dd>
<dt><em>branch</em> (optional)</dt>
<dd>The regular expression to match against the branch or ref of the
change.</dd>
<dt><em>all-files-match-any</em> (optional)</dt>
<dd><p class="first">A list of regular expressions intended to match the files involved
in the change.  This parameter will be considered matching a
change only if all files in a change match at least one of these
expressions.</p>
<p class="last">The pattern for &#8216;/COMMIT_MSG&#8217; is always matched on and does not
have to be included. Exception is merge commits (without modified
files), in this case &#8216;/COMMIT_MSG&#8217; is not matched, and job is not
skipped. In case of merge commits it&#8217;s assumed that list of modified
files isn&#8217;t predictible and CI should be run.</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt><strong>voting (optional)</strong></dt>
<dd>Boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) that indicates whatever
a job is voting or not.  Default: <tt class="docutils literal"><span class="pre">true</span></tt>.</dd>
<dt><strong>attempts (optional)</strong></dt>
<dd>Number of attempts zuul will launch a job. Once reached, zuul will report
RETRY_LIMIT as the job result.
Defaults to 3.</dd>
<dt><strong>tags (optional)</strong></dt>
<dd>A list of arbitrary strings which will be associated with the job.
Can be used by the parameter-function to alter behavior based on
their presence on a job.  If the job name is a regular expression,
tags will accumulate on jobs that match.</dd>
<dt><strong>parameter-function (optional)</strong></dt>
<dd><p class="first">Specifies a function that should be applied to the parameters before
the job is launched.  The function should be defined in a python file
included with the <a class="reference internal" href="#includes"><em>Includes</em></a> directive.  The function
should have the following signature:</p>
<dl class="function">
<dt id="parameters">
<tt class="descname">parameters</tt><big>(</big><em>item</em>, <em>job</em>, <em>parameters</em><big>)</big><a class="headerlink" href="#parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Manipulate the parameters passed to a job before a build is
launched.  The <tt class="docutils literal"><span class="pre">parameters</span></tt> dictionary will already contain the
standard Zuul job parameters, and is expected to be modified
in-place.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>item</strong> (<em>zuul.model.QueueItem</em>) &#8211; the current queue item</li>
<li><strong>job</strong> (<em>zuul.model.Job</em>) &#8211; the job about to be run</li>
<li><strong>parameters</strong> (<em>dict</em>) &#8211; parameters to be passed to the job</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="last">If the parameter <strong>ZUUL_NODE</strong> is set by this function, then it will
be used to specify on what node (or class of node) the job should be
run.</p>
</dd>
<dt><strong>swift</strong></dt>
<dd><p class="first">If <a class="reference internal" href="#swift"><em>swift</em></a> is configured then each job can define a destination
container for the builder to place logs and/or assets into. Multiple
containers can be listed for each job by providing a unique <tt class="docutils literal"><span class="pre">name</span></tt>.</p>
<dl class="docutils">
<dt><em>name</em></dt>
<dd>Set an identifying name for the container. This is used in the
parameter key sent to the builder. For example if it <tt class="docutils literal"><span class="pre">logs</span></tt> then
one of the parameters sent will be <tt class="docutils literal"><span class="pre">SWIFT_logs_CONTAINER</span></tt>
(case-sensitive).</dd>
</dl>
<p>Each of the defaults defined in <a class="reference internal" href="#swift"><em>swift</em></a> can be overwritten as:</p>
<dl class="last docutils">
<dt><em>container</em> (optional)</dt>
<dd>Container name to place the log into
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example,</span> <span class="pre">logs</span></tt></dd>
<dt><em>expiry</em> (optional)</dt>
<dd>How long the signed destination should be available for</dd>
<dt><em>max-file-size*</em> (optional)</dt>
<dd>The maximum size of an individual file</dd>
<dt><em>max_file_size*</em> (optional, deprecated)</dt>
<dd>A deprecated alternate spelling of <em>max-file-size</em>.</dd>
<dt><em>max-file-count</em> (optional)</dt>
<dd>The maximum number of separate files to allow</dd>
<dt><em>max_file_count</em> (optional, deprecated)</dt>
<dd>A deprecated alternate spelling of <em>max-file-count</em>.</dd>
<dt><em>logserver-prefix</em></dt>
<dd>Provide a URL to the CDN or logserver app so that a worker knows
what URL to return.
<tt class="docutils literal"><span class="pre">For</span> <span class="pre">example:</span> <span class="pre">http://logs.example.org/server.app?obj=</span></tt>
The worker should return the logserver-prefix url and the object
path as the URL in the results data packet.</dd>
<dt><em>logserver_prefix</em> (deprecated)</dt>
<dd>A deprecated alternate spelling of <em>logserver-prefix</em>.</dd>
</dl>
</dd>
</dl>
<p>Here is an example of setting the failure message for jobs that check
whether a change merges cleanly:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: ^.*-merge$
  failure-message: This change or one of its cross-repo dependencies
  was unable to be automatically merged with the current state of
  its repository. Please rebase the change and upload a new
  patchset.
</pre></div>
</div>
</div>
<div class="section" id="projects">
<h4>Projects<a class="headerlink" href="#projects" title="Permalink to this headline">¶</a></h4>
<p>The projects section indicates what jobs should be run in each pipeline
for events associated with each project.  It contains a list of
projects.  Here is an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: example/project
  check:
    - project-merge:
      - project-unittest
      - project-pep8
      - project-pyflakes
  gate:
    - project-merge:
      - project-unittest
      - project-pep8
      - project-pyflakes
  post:
    - project-publish
</pre></div>
</div>
<dl class="docutils">
<dt><strong>name</strong></dt>
<dd>The name of the project (as known by Gerrit).</dd>
<dt><strong>merge-mode (optional)</strong></dt>
<dd><p class="first">An optional value that indicates what strategy should be used to
merge changes to this project.  Supported values are:</p>
<p>** merge-resolve **
Equivalent to &#8216;git merge -s resolve&#8217;.  This corresponds closely to
what Gerrit performs (using JGit) for a project if the &#8220;Merge if
necessary&#8221; merge mode is selected and &#8220;Automatically resolve
conflicts&#8221; is checked.  This is the default.</p>
<p>** merge **
Equivalent to &#8216;git merge&#8217;.</p>
<p class="last">** cherry-pick **
Equivalent to &#8216;git cherry-pick&#8217;.</p>
</dd>
</dl>
<p>This is followed by a section for each of the pipelines defined above.
Pipelines may be omitted if no jobs should run for this project in a
given pipeline.  Within the pipeline section, the jobs that should be
executed are listed.  If a job is entered as a dictionary key, then
jobs contained within that key are only executed if the key job
succeeds.  In the above example, project-unittest, project-pep8, and
project-pyflakes are only executed if project-merge succeeds.  This
can help avoid running unnecessary jobs.</p>
<p>The special job named <tt class="docutils literal"><span class="pre">noop</span></tt> is internal to Zuul and will always
return <tt class="docutils literal"><span class="pre">SUCCESS</span></tt> immediately.  This can be useful if you require
that all changes be processed by a pipeline but a project has no jobs
that can be run on it.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The OpenStack Zuul configuration for a comprehensive example: <a class="reference external" href="https://git.openstack.org/cgit/openstack-infra/project-config/tree/zuul/layout.yaml">https://git.openstack.org/cgit/openstack-infra/project-config/tree/zuul/layout.yaml</a></p>
</div>
</div>
<div class="section" id="project-templates">
<h4>Project Templates<a class="headerlink" href="#project-templates" title="Permalink to this headline">¶</a></h4>
<p>Whenever you have lot of similar projects (such as plugins for a project) you
will most probably want to use the same pipeline configurations.  The
project templates let you define pipelines and job name templates to trigger.
One can then just apply the template on its project which make it easier to
update several similar projects. As an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>project-templates:
  # Name of the template
  - name: plugin-triggering
    # Definition of pipelines just like for a `project`
    check:
     - &#39;{jobprefix}-merge&#39;:
       - &#39;{jobprefix}-pep8&#39;
       - &#39;{jobprefix}-pyflakes&#39;
    gate:
     - &#39;{jobprefix}-merge&#39;:
       - &#39;{jobprefix}-unittest&#39;
       - &#39;{jobprefix}-pep8&#39;
       - &#39;{jobprefix}-pyflakes&#39;
</pre></div>
</div>
<p>In your projects definition, you will then apply the template using the template
key:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>projects:
 - name: plugin/foobar
   template:
    - name: plugin-triggering
      jobprefix: plugin-foobar
</pre></div>
</div>
<p>You can pass several parameters to a template. A <tt class="docutils literal"><span class="pre">parameter</span></tt> value
will be used for expansion of <tt class="docutils literal"><span class="pre">{parameter}</span></tt> in the template
strings. The parameter <tt class="docutils literal"><span class="pre">name</span></tt> will be automatically provided and
will contain the short name of the project, that is the portion of the
project name after the last <tt class="docutils literal"><span class="pre">/</span></tt> character.</p>
<p>Multiple templates can be combined in a project, and the jobs from all
of those templates will be added to the project.  Individual jobs may
also be added:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>projects:
 - name: plugin/foobar
   template:
    - name: plugin-triggering
      jobprefix: plugin-foobar
    - name: plugin-extras
      jobprefix: plugin-foobar
   check:
    - foobar-extra-special-job
</pre></div>
</div>
<p>Individual jobs may optionally be added to pipelines (e.g. check,
gate, et cetera) for a project, in addition to those provided by
templates.</p>
<p>The order of the jobs listed in the project (which only affects the
order of jobs listed on the report) will be the jobs from each
template in the order listed, followed by any jobs individually listed
for the project.</p>
<p>Note that if multiple templates are used for a project and one
template specifies a job that is also specified in another template,
or specified in the project itself, the configuration defined by
either the last template or the project itself will take priority.</p>
</div>
</div>
<div class="section" id="logging-conf">
<h3>logging.conf<a class="headerlink" href="#logging-conf" title="Permalink to this headline">¶</a></h3>
<p>This file is optional.  If provided, it should be a standard
<tt class="xref py py-mod docutils literal"><span class="pre">logging.config</span></tt> module configuration file.  If not present, Zuul will
output all log messages of DEBUG level or higher to the console.</p>
</div>
</div>
<div class="section" id="starting-zuul">
<h2>Starting Zuul<a class="headerlink" href="#starting-zuul" title="Permalink to this headline">¶</a></h2>
<p>To start Zuul, run <strong>zuul-server</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>usage: zuul-server [-h] [-c CONFIG] [-l LAYOUT] [-d] [-t] [--version]

Project gating system.

optional arguments:
  -h, --help  show this help message and exit
  -c CONFIG   specify the config file
  -l LAYOUT   specify the layout file
  -d          do not run as a daemon
  -t          validate layout file syntax
  --version   show zuul version
</pre></div>
</div>
<p>You may want to use the <tt class="docutils literal"><span class="pre">-d</span></tt> argument while you are initially setting
up Zuul so you can detect any configuration errors quickly.  Under
normal operation, omit <tt class="docutils literal"><span class="pre">-d</span></tt> and let Zuul run as a daemon.</p>
<p>If you send signal 1 (SIGHUP) to the zuul-server process, Zuul will
stop executing new jobs, wait until all executing jobs are finished,
reload its layout.yaml, and resume. Changes to any connections or
the PID  file will be ignored until Zuul is restarted.</p>
<p>If you send a SIGUSR1 to the zuul-server process, Zuul will stop
executing new jobs, wait until all executing jobs are finished,
then exit. While waiting to exit Zuul will queue Gerrit events and
save these events prior to exiting. When Zuul starts again it will
read these saved events and act on them.</p>
<p>If you need to abort Zuul and intend to manually requeue changes for
jobs which were running in its pipelines, prior to terminating you can
use the zuul-changes.py tool script to simplify the process. For
example, this would give you a list of zuul-enqueue commands to requeue
changes for the gate and check pipelines respectively:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>./tools/zuul-changes.py http://zuul.openstack.org/ gate
./tools/zuul-changes.py http://zuul.openstack.org/ check
</pre></div>
</div>
<p>If you send a SIGUSR2 to the zuul-server process, or the forked process
that runs the Gearman daemon, Zuul will dump a stack trace for each
running thread into its debug log. It is written under the log bucket
<tt class="docutils literal"><span class="pre">zuul.stack_dump</span></tt>.  This is useful for tracking down deadlock or
otherwise slow threads.</p>
<p>When <a class="reference external" href="https://code.google.com/p/yappi/">yappi</a> (Yet Another Python
Profiler) is available, additional functions&#8217; and threads&#8217; stats are
emitted as well. The first SIGUSR2 will enable yappi, on the second
SIGUSR2 it dumps the information collected, resets all yappi state and
stops profiling. This is to minimize the impact of yappi on a running
system.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Zuul</a><ul>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#zuul-conf">zuul.conf</a><ul>
<li><a class="reference internal" href="#gearman">gearman</a></li>
<li><a class="reference internal" href="#gearman-server">gearman_server</a></li>
<li><a class="reference internal" href="#webapp">webapp</a></li>
<li><a class="reference internal" href="#id1">zuul</a></li>
<li><a class="reference internal" href="#merger">merger</a></li>
<li><a class="reference internal" href="#swift">swift</a></li>
<li><a class="reference internal" href="#connection-arbitraryname">connection ArbitraryName</a></li>
</ul>
</li>
<li><a class="reference internal" href="#layout-yaml">layout.yaml</a><ul>
<li><a class="reference internal" href="#includes">Includes</a></li>
<li><a class="reference internal" href="#pipelines">Pipelines</a></li>
<li><a class="reference internal" href="#jobs">Jobs</a></li>
<li><a class="reference internal" href="#projects">Projects</a></li>
<li><a class="reference internal" href="#project-templates">Project Templates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging-conf">logging.conf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#starting-zuul">Starting Zuul</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reporters.html"
                        title="previous chapter">Reporters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="merger.html"
                        title="next chapter">Merger</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/zuul.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="merger.html" title="Merger"
             >next</a> |</li>
        <li class="right" >
          <a href="reporters.html" title="Reporters"
             >previous</a> |</li>
        <li><a href="index.html">Zuul 2.5.2.dev54 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, OpenStack.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>