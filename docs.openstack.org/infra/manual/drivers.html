<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Project Driver’s Guide &mdash; OpenStack Project Infrastructure Manual 0.0.1.dev268 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1.dev268',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="OpenStack Project Infrastructure Manual 0.0.1.dev268 documentation" href="index.html" />
    <link rel="next" title="Project Creator’s Guide" href="creators.html" />
    <link rel="prev" title="Core Reviewer’s Guide" href="core.html" /> 
  </head>
  <body role="document">
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="project-driver-s-guide">
<span id="driver-manual"></span><h1>Project Driver&#8217;s Guide<a class="headerlink" href="#project-driver-s-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="feature-branches">
<h2>Feature Branches<a class="headerlink" href="#feature-branches" title="Permalink to this headline">¶</a></h2>
<p>There are times when prolonged development on specific features is easier
on a feature branch rather than on master. In particular it organizes
work to a location that interested parties can follow. Feature branches
also move merge points to specific points in time rather than at every
proposed change. Learn more about <a class="reference external" href="http://docs.openstack.org/project-team-guide/other-branches.html#feature-branches">feature branches in the project team
guide</a>.</p>
<p>To get started with a feature branch you will need to create the new
branch in Gerrit with the &#8216;feature/&#8217; prefix. Note that Gerrit ACLs do
not allow for pushing of new branches via git, but specific groups of
Gerrit users can create new branches. For official OpenStack projects
the Release Manager creates feature branches. Unofficial projects may
update their Gerrit ACLs to allow their release teams to create these
branches. For similar Gerrit ACL reasons branch deletion is typically
limited to the Infra team. Keep this in mind before creating many
branches that will need cleanup.</p>
<p>If more than one project is involved in a feature development effort,
the same feature branch name should be used across all involved
projects. This will cause integration testing with Zuul to use the
respective feature branch from any project that carries it.
Projects without an equivalently named feature branch will use
master instead. Use care not to create a feature branch with the same
name as a feature branch for an unrelated effort in another
project.</p>
<p>One additional thing to keep in mind is that feature branches should be
treated like master in most cases. They are specifically not for sustained
long term development like stable branches.</p>
<div class="section" id="merge-commits">
<h3>Merge Commits<a class="headerlink" href="#merge-commits" title="Permalink to this headline">¶</a></h3>
<p>An important activity when using feature branches is syncing to and from
the project&#8217;s master branch. During development on a feature
branch a project will want to merge master into the feature branch
periodically to keep up to date with changes over time. Then when
development on the feature branch is complete, it will need to be
merged into master.</p>
<p>Before this can happen the project team&#8217;s release group will need to
have access to push merge commits in Gerrit:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[access &quot;refs/for/refs/*&quot;]
pushMerge = group &lt;projectname&gt;-release
</pre></div>
</div>
<p>Should be added to the project&#8217;s ACL file in the project-config
repo.</p>
</div>
<div class="section" id="merge-master-into-feature-branch">
<h3>Merge Master into Feature Branch<a class="headerlink" href="#merge-master-into-feature-branch" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>git remote update
git checkout feature-branch
git pull --ff-only origin feature-branch
git checkout -b merge-branch
git merge origin/master
# Amend the merge commit to automatically add a Change-ID to the commit message
GIT_EDITOR=/bin/true git commit --amend
git review -R feature-branch
git checkout master
git branch -D merge-branch
</pre></div>
</div>
</div>
<div class="section" id="merge-feature-branch-into-master">
<h3>Merge Feature Branch into Master<a class="headerlink" href="#merge-feature-branch-into-master" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span>git remote update
git checkout master
git pull --ff-only origin master
git checkout -b merge-branch
# Force a merge commit by not fast-forwarding, in case master hasn&#39;t updated:
git merge --no-ff origin/feature-branch
# Amend the merge commit to automatically add a Change-ID to the commit message:
GIT_EDITOR=/bin/true git commit --amend
git review -R
git checkout master
git branch -D merge-branch
</pre></div>
</div>
</div>
<div class="section" id="how-to-avoid-merging-specific-files">
<h3>How To Avoid Merging Specific Files<a class="headerlink" href="#how-to-avoid-merging-specific-files" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you may have files on one branch you don&#8217;t want merged to
or from another. An easy workaround for this is to checkout the file
in question from the target branch and amend your merge commit
before pushing it for review. For example, as in the last section
you&#8217;ve just merged from <code class="docutils literal"><span class="pre">origin/feature-branch</span></code> into your local
<code class="docutils literal"><span class="pre">merge-branch</span></code> but want to keep the <code class="docutils literal"><span class="pre">.gitreview</span></code> file from
<code class="docutils literal"><span class="pre">master</span></code> because you don&#8217;t want <code class="docutils literal"><span class="pre">defaultbranch=feature-branch</span></code>
added to it. Immediately before you <code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code> do:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git checkout origin/master -- .gitreview
</pre></div>
</div>
</div>
</div>
<div class="section" id="release-management">
<h2>Release Management<a class="headerlink" href="#release-management" title="Permalink to this headline">¶</a></h2>
<p>This section describes topics related to release management.</p>
<div class="section" id="release-and-stable-branches">
<h3>Release and stable branches<a class="headerlink" href="#release-and-stable-branches" title="Permalink to this headline">¶</a></h3>
<p>Projects following the release:cycle-with-milestones model generate
release candidates before the final release to encourage 3rd-party
testing. The first release candidate (RC1) is cut from the master
branch. You can learn more about <a class="reference external" href="http://docs.openstack.org/project-team-guide/release-management.html">release management in the project
team guide</a>.</p>
<p>Between RC1 and the final release, there needs to be a separate branch
in Gerrit for release-critical changes destined for the final
release. Meanwhile, development on the master branch should continue
as normal (with the addition that changes proposed for the final
release should also be proposed for master, and some changes for
master may need to be applied to the release branch).</p>
<p>In order to avoid tracking different branches pre- and post-release,
this process directly creates a stable/&lt;series&gt; (for example,
stable/mitaka) branch that will be reused as the stable maintenance
branch post-release. Specific ACLs apply to the branch pre-release,
and when the final release is tagged the generic stable branch ACLs
are applied instead.</p>
<div class="section" id="create-stable-branch">
<h4>Create stable/* Branch<a class="headerlink" href="#create-stable-branch" title="Permalink to this headline">¶</a></h4>
<p>For OpenStack projects this should be performed by the OpenStack
Release Management Team at the Release Branch Point. If you are managing
branches for your project you may have permission to do this
yourself.</p>
<ul class="simple">
<li>Go to <a class="reference external" href="https://review.openstack.org/">https://review.openstack.org/</a> and sign in</li>
<li>Select &#8216;Admin&#8217;, &#8216;Projects&#8217;, then the project</li>
<li>Select &#8216;Branches&#8217;</li>
<li>Enter <code class="docutils literal"><span class="pre">stable/&lt;series&gt;</span></code> in the &#8216;Branch Name&#8217; field, and <code class="docutils literal"><span class="pre">HEAD</span></code>
as the &#8216;Initial Revision&#8217;, then press &#8216;Create Branch&#8217;.
Alternatively, you may run <code class="docutils literal"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">stable/&lt;series&gt;</span> <span class="pre">&lt;sha&gt;</span> <span class="pre">&amp;&amp;</span>
<span class="pre">git</span> <span class="pre">push</span> <span class="pre">gerrit</span> <span class="pre">stable/&lt;series&gt;</span></code></li>
</ul>
<p>Once this is done, you should push a change updating the defaultbranch in
.gitreview to match the new name of the branch, so that &#8220;git review&#8221;
automatically pushes to the right branch:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>defaultbranch=stable/&lt;series&gt;
</pre></div>
</div>
<p>To check out the new branch in your local checkout, you can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git checkout master
git pull
git checkout stable/&lt;series&gt;
</pre></div>
</div>
</div>
<div class="section" id="authoring-changes-for-stable">
<h4>Authoring Changes for stable/*<a class="headerlink" href="#authoring-changes-for-stable" title="Permalink to this headline">¶</a></h4>
<p>Create topic branches as normal, but branch them from stable/*
rather than master:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git checkout stable/&lt;series&gt;
git pull
git checkout -b &lt;topic branch&gt;
</pre></div>
</div>
<p>Generally the defaultbranch in .gitreview is adjusted on the new branch
so that you can directly use <code class="docutils literal"><span class="pre">git</span> <span class="pre">review</span></code>. If not, changes for stable/*
should be submitted with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git review stable/&lt;series&gt;
</pre></div>
</div>
</div>
<div class="section" id="submit-changes-in-master-to-stable">
<h4>Submit Changes in master to stable/*<a class="headerlink" href="#submit-changes-in-master-to-stable" title="Permalink to this headline">¶</a></h4>
<p>If a change to master should also be included in stable/*, use this
procedure to cherry-pick that change and submit it for review:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git checkout stable/&lt;series&gt;
git pull
git checkout -b master-to-mp
git cherry-pick -x &lt;SHA1 or &quot;master&quot;&gt;
git review stable/&lt;series&gt;
git checkout master
git branch -D master-to-mp
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">master</span></code> will pick the most recent commit from master
to apply, if you want a different patch, use the SHA1 of the commit
instead.</p>
<p>The <code class="docutils literal"><span class="pre">-x</span></code> flag will ensure the commit message records the SHA1 hash of
the original commit in master.</p>
<p>If there are conflicts when cherry-picking, do not delete the
&#8216;Conflicts&#8217; lines git adds to the commit message. These are valuable
to reviewers to identify files which need extra attention.</p>
<p>You can learn more about <a class="reference external" href="http://docs.openstack.org/project-team-guide/stable-branches.html">stable branches in the project team guide</a>.</p>
</div>
<div class="section" id="tagging-a-release">
<h4>Tagging a Release<a class="headerlink" href="#tagging-a-release" title="Permalink to this headline">¶</a></h4>
<p>This step should be performed by the OpenStack Release Management Team
when the release is made. If you are managing your own releases, you may
have permission to do this yourself.</p>
<p>Tag the tip of the appropriate branch (stable/&lt;series&gt; for server
projects using release candidates, master for the others) with a release tag
and push that tag to Gerrit by running the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>git checkout &lt;branch name&gt;
git pull --ff-only
git tag -s &lt;version number&gt;
git push gerrit &lt;version number&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Git won&#8217;t have a remote named gerrit until the first time git-review
runs. You may need to run <code class="docutils literal"><span class="pre">git</span> <span class="pre">review</span> <span class="pre">-s</span></code> before the push.</p>
</li>
<li><p class="first">The -s option to git tag signs the tag using GnuPG, so it&#8217;s
important to ensure that the person making the release has a
suitable OpenPGP key.</p>
</li>
<li><p class="first">Make sure you&#8217;re only adding a single tag when pushing to
gerrit, like in the example above.</p>
</li>
<li><p class="first">After a tag is created the release build will generate a source code
tarball and may publish it to a repository such as PyPI.</p>
</li>
<li><p class="first">Tags need to follow the format of <cite>PEP 440
&lt;https://www.python.org/dev/peps/pep-0440/&gt;</cite> which consists for
final releases of one or more non-negative integer values,
separated by dots. Be aware that <code class="docutils literal"><span class="pre">pbr</span></code> needs a three component
version, like <code class="docutils literal"><span class="pre">1.0.0</span></code> or <code class="docutils literal"><span class="pre">1.2.3</span></code>.</p>
<p>If you need to support other version schemes, you might need to
use the <code class="docutils literal"><span class="pre">tag</span></code> pipeline instead of the default <code class="docutils literal"><span class="pre">release</span></code>
pipeline. Best discuss this with the OpenStack Infra team.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="gerrit-irc-notifications">
<h2>Gerrit IRC Notifications<a class="headerlink" href="#gerrit-irc-notifications" title="Permalink to this headline">¶</a></h2>
<p>The intent of this section is to detail how to set up notifications
about all the projects that are hosted on OpenStack Gerrit in the
appropriate IRC channels.</p>
<p>GerritBot is an IRC bot that listens to the OpenStack Gerrit server
for events and notifies those on Freenode&#8217;s OpenStack channels.</p>
<p>GerritBot is able to notify the channel for events like creation of
patchsets, changes merged, comments added to patchsets and updates to
refs.  These event notifications can be configured per project, so the
channel can have multiple notifications per project.</p>
<p>Before you can configure GerritBot, you need to give channel permissions with
an accessbot configuration specific to the channel where you want
notifications posted. The configuration file is hosted in
<a class="reference external" href="http://git.openstack.org/cgit/openstack-infra/project-config/">openstack-infra/project-config</a>. Edit
<code class="docutils literal"><span class="pre">accessbot/channels.yaml</span></code> to add your IRC channel if it is not
already listed.</p>
<p>In order for GerritBot to post notifications on the IRC channel of the
project you are configuring, you need to add your GerritBot
configuration into
<code class="docutils literal"><span class="pre">gerritbot/channels.yaml</span></code>.  This file
is hosted in <a class="reference external" href="http://git.openstack.org/cgit/openstack-infra/project-config/">openstack-infra/project-config</a>.</p>
<p>The syntax for configuring the notifications is:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;IRC channel&gt;:
      events:
        - patchset-created
        - change-merged
        - comment-added
        - ref-updated
      projects:
        - &lt;project name&gt;
      branches:
        - &lt;branch name&gt;
</pre></div>
</div>
<p>Please note that the text between the angle brackets are placeholder
values. Multiple projects and branches can be listed in the YAML
file.</p>
</div>
<div class="section" id="running-jobs-with-zuul">
<h2>Running Jobs with Zuul<a class="headerlink" href="#running-jobs-with-zuul" title="Permalink to this headline">¶</a></h2>
<p>There are two major components in getting jobs running under Zuul. First
you must ensure that the job you want to run is defined in the <a class="reference external" href="https://git.openstack.org/cgit/openstack-infra/project-config/tree/jenkins/jobs">JJB
config</a>.
The <a class="reference external" href="http://docs.openstack.org/infra/jenkins-job-builder/">JJB documentation</a>
is extensive as are the examples in our JJB config so we will not cover
that here.</p>
<p>The second thing you need to do is update <a class="reference external" href="https://git.openstack.org/cgit/openstack-infra/project-config/tree/zuul/layout.yaml">Zuul&#8217;s layout file</a>
instructing Zuul to run your job when appropriate. This file is organized
into several sections.</p>
<ol class="arabic simple">
<li>Zuul python includes. You can largely ignore this section as it
declares arbitrary python functions loaded into Zuul and is managed
by the Infra team.</li>
<li>Pipelines. You should not need to add or modify any of these
pipelines but they provide information on why each pipeline exists
and when it is triggered. This section is good as a reference.</li>
<li>Project templates. Useful if you want to collect several jobs under
a single name that can be reused across projects.</li>
<li>Job specific overrides. This section is where you specify that a
specific job should not vote or run only against a specific set
of branches.</li>
<li>Projects. This is the section where you will likely spend most of
your time. Note it is organized into alphabetical subsections based
on git repo name prefix.</li>
</ol>
<p>To add a job to a project you will need to edit your project in the
projects list or add your project to the list if it does not
exist. You should end up with something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: openstack/&lt;projectname&gt;
  template:
    - name: merge-check
  check:
    - gate-new-&lt;projectname&gt;-job
  gate:
    - gate-new-&lt;projectname&gt;-job
</pre></div>
</div>
<p>The template section applies the common <code class="docutils literal"><span class="pre">merge-check</span></code> jobs to the
project (every project should use this template). Then we have
<code class="docutils literal"><span class="pre">gate-new-&lt;projectname&gt;-job</span></code> listed in the check and gate
pipelines. This says if an event comes in for
<code class="docutils literal"><span class="pre">openstack/&lt;projectname&gt;</span></code> that matches the check or gate pipeline
triggers run the <code class="docutils literal"><span class="pre">gate-new-&lt;projectname&gt;-job</span></code> job against
<code class="docutils literal"><span class="pre">openstack/&lt;projectname&gt;</span></code> in the matching pipeline.</p>
<div class="section" id="integration-tests">
<h3>Integration Tests<a class="headerlink" href="#integration-tests" title="Permalink to this headline">¶</a></h3>
<p>One of Zuul&#8217;s most powerful features is the ability to perform complex
integration testing across interrelated repositories.  Projects that
share one or more jobs are combined into a shared change queue.  That
means that as changes are approved, they are sequenced in order and
can be tested together.  It also means that if a change specifies that
it depends on another change with a &#8220;Depends-On:&#8221; header, those
changes can be tested together and merged in rapid succession.</p>
<p>In order to use this to its full advantage, your job should allow Zuul
to perform all of the git operations for all of the projects related
to the integration test.  If you install the software under test from
the git checkouts supplied by Zuul, the test run will include all of
the changes that will be merged ahead of the change under test.</p>
<p>To do this, use the <code class="docutils literal"><span class="pre">zuul-cloner</span></code> command as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo -E /usr/zuul-env/bin/zuul-cloner --cache-dir /opt/git \
    https://git.openstack.org \
    openstack/project1 \
    openstack/project2 \
    openstack/projectN
</pre></div>
</div>
<p>Where the final arguments are the names of all of the projects
involved in the integration test.  They will be checked out into the
current directory (e.g., <code class="docutils literal"><span class="pre">./openstack/project1</span></code>).  If you need them
to be placed in a different location, see the <code class="docutils literal"><span class="pre">clonemap</span></code> feature of
<code class="docutils literal"><span class="pre">zuul-cloner</span></code> which allows for very flexible (including regular
expressions) directory layout descriptions.</p>
<p>Use that command in a single Jenkins Job Builder definition that you
then invoke from all of the related projects.  This way they all run
the same job (which tests the entire system) and Zuul knows to combine
those projects into a shared change queue.</p>
<p>Zuul comes with extensive <a class="reference external" href="http://docs.openstack.org/infra/zuul/">documentation</a>
too and should be referenced for more information.</p>
</div>
</div>
<div class="section" id="retiring-a-project">
<h2>Retiring a Project<a class="headerlink" href="#retiring-a-project" title="Permalink to this headline">¶</a></h2>
<p>If you need to retire a project and no longer accept patches, it is
important to communicate that to both users and contributors.  The
following steps will help you wind down a project gracefully.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following sections are really separate steps. If your project
has jobs set up and is an official project, you need to submit
<em>four</em> different changes as explained below. We recommend to link
these changes with &#8220;Depends-On:&#8221; and &#8220;Needed-By:&#8221; headers.</p>
</div>
<div class="section" id="prerequirement-announce-retirement">
<h3>Prerequirement: Announce Retirement<a class="headerlink" href="#prerequirement-announce-retirement" title="Permalink to this headline">¶</a></h3>
<p>Use mailing lists or other channels to announce to users and
contributors that the project is being retired.  Be sure to include a
date upon which maintenance will end, if that date is in the future.</p>
</div>
<div class="section" id="step-1-end-project-gating">
<h3>Step 1: End Project Gating<a class="headerlink" href="#step-1-end-project-gating" title="Permalink to this headline">¶</a></h3>
<p>Check out a copy of the <code class="docutils literal"><span class="pre">openstack-infra/project-config</span></code> repository
and edit <code class="docutils literal"><span class="pre">zuul/layout.yaml</span></code>.  Find the section for your project and
change it to look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: openstack/&lt;projectname&gt;
  template:
    - name: merge-check
    - name: noop-jobs
</pre></div>
</div>
<p>Also, remove your project from <code class="docutils literal"><span class="pre">jenkins/jobs/projects.yaml</span></code>, and if
you have created any other jobs specific for your project in
<code class="docutils literal"><span class="pre">jenkins/jobs/</span></code>, remove them as well.</p>
<p>Submit that change and make sure to mention in the commit message that
you are ending project gating for the purposes of retiring the
project.  Wait for that change to merge and then proceed.</p>
</div>
<div class="section" id="step-2-remove-project-content">
<h3>Step 2: Remove Project Content<a class="headerlink" href="#step-2-remove-project-content" title="Permalink to this headline">¶</a></h3>
<p>Once Zuul is no longer running tests on your project, prepare a change
that removes all of the files from your project except the README.
Double check that all dot files (such as <code class="docutils literal"><span class="pre">.gitignore</span></code>, <code class="docutils literal"><span class="pre">.testr.conf</span></code>,
and <code class="docutils literal"><span class="pre">.gitreview</span></code>) are also removed.</p>
<p>Replace the contents of the README with a message such as this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>This project is no longer maintained.

The contents of this repository are still available in the Git
source code management system.  To see the contents of this
repository before it reached its end of life, please check out the
previous commit with &quot;git checkout HEAD^1&quot;.

(Optional:)
For an alternative project, please see &lt;alternative project name&gt; at
&lt;alternative project URL&gt;.

For any further questions, please email
openstack-dev@lists.openstack.org or join #openstack-dev on
Freenode.
</pre></div>
</div>
<p>Merge this commit to your project.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before removing <code class="docutils literal"><span class="pre">.gitreview</span></code> be sure to run <code class="docutils literal"><span class="pre">git</span> <span class="pre">review</span> <span class="pre">-s</span></code>,  this
will record the necessary information about the repository.</p>
</div>
<p>If any users missed the announcement that the project is being
retired, removing the content of the repository will cause any users
who continuously deploy the software as well as users who track
changes to the repository to notice the retirement.  While this may be
disruptive, it is generally considered better than continuing to
deploy unmaintained software.  Potential contributors who may not have
otherwise read the README will in this case, as it is the only file in
the repository.</p>
</div>
<div class="section" id="step-3-remove-project-from-infrastructure-systems">
<h3>Step 3: Remove Project from Infrastructure Systems<a class="headerlink" href="#step-3-remove-project-from-infrastructure-systems" title="Permalink to this headline">¶</a></h3>
<p>Once your repository is in its final state, prepare a second change to
the <code class="docutils literal"><span class="pre">openstack-infra/project-config</span></code> repository that does the
following:</p>
<ul>
<li><p class="first">Remove your project from <code class="docutils literal"><span class="pre">zuul/layout.yaml</span></code>.</p>
</li>
<li><p class="first">By default, project ACLs are defined in a file called
<code class="docutils literal"><span class="pre">gerrit/acls/openstack/&lt;projectname&gt;.config</span></code>. If this file exists,
replace the contents with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[project]
state = read only
</pre></div>
</div>
</li>
<li><p class="first">If a file called <code class="docutils literal"><span class="pre">gerrit/acls/openstack/&lt;projectname&gt;.config</span></code> does
not exist, that implies that your project shared ACLs with some other
project(s). You will need to do two things in that case:</p>
<ol class="arabic">
<li><p class="first">Find the entry for your project in <code class="docutils literal"><span class="pre">gerrit/projects.yaml</span></code> and
delete the line which defines the acl-config. This will cause the
default to be used, and that default is a file that you create
next.</p>
</li>
<li><p class="first">Create and submit a new file called
<code class="docutils literal"><span class="pre">gerrit/acls/openstack/&lt;projectname&gt;.config</span></code> which contains the
text:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>[project]
state = read only
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Remove your project from <code class="docutils literal"><span class="pre">gerritbot/channels.yaml</span></code>.</p>
</li>
</ul>
</div>
<div class="section" id="step-4-remove-repository-from-the-governance-repository">
<h3>Step 4: Remove Repository from the Governance Repository<a class="headerlink" href="#step-4-remove-repository-from-the-governance-repository" title="Permalink to this headline">¶</a></h3>
<p>If this was an official OpenStack project, remove it from the
<code class="docutils literal"><span class="pre">reference/projects.yaml</span></code> file and add it to the file
<code class="docutils literal"><span class="pre">reference/legacy.yaml</span></code> in the <code class="docutils literal"><span class="pre">openstack/governance</span></code> repository.
Note that if the project was recently active, this may have
implications for automatic detection of ATCs.</p>
</div>
</div>
<div class="section" id="package-requirements">
<h2>Package Requirements<a class="headerlink" href="#package-requirements" title="Permalink to this headline">¶</a></h2>
<p>The OpenStack CI infrastructure sets up nodes for testing that contain
a minimal system and a number of convenience distribution packages.</p>
<p>If you want to add additional packages, you have several options.</p>
<p>If you run Python tests using <code class="docutils literal"><span class="pre">tox</span></code>, you can install them using
<code class="docutils literal"><span class="pre">requirements.txt</span></code> and <code class="docutils literal"><span class="pre">test-requirements.txt</span></code> files (see also the
<a class="reference external" href="http://docs.openstack.org/developer/requirements/">global requirements process</a>). If these
Python tests need additional distribution packages installed as well
and if those are not in the nodes used for testing, they have to be
installed explicitly.</p>
<p>If you run devstack based tests, then list missing binary packages
below the <a class="reference external" href="http://git.openstack.org/cgit/openstack-dev/devstack/tree/files">files</a>
directory of devstack.</p>
<p>For non-devstack based tests, add a <code class="docutils literal"><span class="pre">bindep.txt</span></code> file
containing listing the required distribution packages. It is a
cross-platform list of all dependencies needed for running tests. The
<a class="reference external" href="http://docs.openstack.org/infra/bindep/">bindep</a> utility will be
used to install the right dependencies per distribution when running
in the OpenStack CI infrastructure.</p>
<p>If you use bindep, create a bindep tox environment as well:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[testenv:bindep]</span>
<span class="c1"># Do not install any requirements. We want this to be fast and work even if</span>
<span class="c1"># system dependencies are missing, since it&#39;s used to tell you what system</span>
<span class="c1"># dependencies are missing! This also means that bindep must be installed</span>
<span class="c1"># separately, outside of the requirements files.</span>
<span class="na">deps</span> <span class="o">=</span> <span class="s">bindep</span>
<span class="na">commands</span> <span class="o">=</span> <span class="s">bindep test</span>
</pre></div>
</div>
<p>This way a developer can just run bindep to get a list of missing
packages for their own system:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> tox -e bindep
</pre></div>
</div>
<p>The output of this can then be fed into the distribution package
manager like <code class="docutils literal"><span class="pre">apt-get</span></code>, <code class="docutils literal"><span class="pre">dnf</span></code>, <code class="docutils literal"><span class="pre">yum</span></code>, or <code class="docutils literal"><span class="pre">zypper</span></code> to install
missing binary packages.</p>
<p>The OpenStack CI infrastructure will install packages marked for a
<a class="reference external" href="http://docs.openstack.org/infra/bindep/readme.html#profiles">profile</a> named
&#8220;test&#8221; along with any packages belonging to the default profile of the
<code class="docutils literal"><span class="pre">bindep.txt</span></code> file. Add any build time requirements and any
requirements specific to the test jobs to the &#8220;test&#8221; profile, add
requirements for both test and runtime to the base profile:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># A runtime dependency</span>
<span class="n">libffi6</span>
<span class="c1"># A build time dependency</span>
<span class="n">libffi</span><span class="o">-</span><span class="n">devel</span> <span class="p">[</span><span class="n">test</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Project Driver&#8217;s Guide</a><ul>
<li><a class="reference internal" href="#feature-branches">Feature Branches</a><ul>
<li><a class="reference internal" href="#merge-commits">Merge Commits</a></li>
<li><a class="reference internal" href="#merge-master-into-feature-branch">Merge Master into Feature Branch</a></li>
<li><a class="reference internal" href="#merge-feature-branch-into-master">Merge Feature Branch into Master</a></li>
<li><a class="reference internal" href="#how-to-avoid-merging-specific-files">How To Avoid Merging Specific Files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#release-management">Release Management</a><ul>
<li><a class="reference internal" href="#release-and-stable-branches">Release and stable branches</a><ul>
<li><a class="reference internal" href="#create-stable-branch">Create stable/* Branch</a></li>
<li><a class="reference internal" href="#authoring-changes-for-stable">Authoring Changes for stable/*</a></li>
<li><a class="reference internal" href="#submit-changes-in-master-to-stable">Submit Changes in master to stable/*</a></li>
<li><a class="reference internal" href="#tagging-a-release">Tagging a Release</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#gerrit-irc-notifications">Gerrit IRC Notifications</a></li>
<li><a class="reference internal" href="#running-jobs-with-zuul">Running Jobs with Zuul</a><ul>
<li><a class="reference internal" href="#integration-tests">Integration Tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retiring-a-project">Retiring a Project</a><ul>
<li><a class="reference internal" href="#prerequirement-announce-retirement">Prerequirement: Announce Retirement</a></li>
<li><a class="reference internal" href="#step-1-end-project-gating">Step 1: End Project Gating</a></li>
<li><a class="reference internal" href="#step-2-remove-project-content">Step 2: Remove Project Content</a></li>
<li><a class="reference internal" href="#step-3-remove-project-from-infrastructure-systems">Step 3: Remove Project from Infrastructure Systems</a></li>
<li><a class="reference internal" href="#step-4-remove-repository-from-the-governance-repository">Step 4: Remove Repository from the Governance Repository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#package-requirements">Package Requirements</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="core.html"
                                  title="previous chapter">Core Reviewer&#8217;s Guide</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="creators.html"
                                  title="next chapter">Project Creator&#8217;s Guide</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack-infra/infra-manual
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/drivers.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="creators.html" title="Project Creator’s Guide"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="core.html" title="Core Reviewer’s Guide"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenStack Project Infrastructure Manual 0.0.1.dev268 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2017, OpenStack Contributors. Freely licensed under <a href="http://creativecommons.org/licenses/by/3.0/legalcode">CC BY 3.0</a>. Propose changes to the <a href="https://git.openstack.org/cgit/openstack-infra/infra-manual">infra-manual git repo</a>.
      Last updated on Mon Jan 9 15:25:21 2017, commit 2e3a682.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/OpenStack Project Infrastructure Manual");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>