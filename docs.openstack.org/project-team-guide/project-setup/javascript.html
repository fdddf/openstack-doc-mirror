
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JavaScript Project Setup Guidelines &mdash; OpenStack Project Team Guide 0.0.1.dev126 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1.dev126',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenStack Project Team Guide 0.0.1.dev126 documentation" href="../index.html" />
    <link rel="up" title="Project Setup" href="../project-setup.html" />
    <link rel="next" title="Testing (QA and CI)" href="../testing.html" />
    <link rel="prev" title="Python Project Guide" href="python.html" /> 
  </head>
  <body>
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="javascript-project-setup-guidelines">
<h1>JavaScript Project Setup Guidelines<a class="headerlink" href="#javascript-project-setup-guidelines" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We support the current version of node.js and npm available in the LTS
releases of Ubuntu. As of this writing, these are Node v0.10.29 and
npm v1.4.21. Using newer versions may create unexpected results.</p>
</div>
<div class="section" id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h2>
<p>These are generic project setup instructions for an OpenStack JavaScript
project. Individual projects may extend or override these instructions, so
please check for additional documentation.</p>
<div class="section" id="install-dependencies">
<h3>Install Dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h3>
<p>On OSX (using homebrew):</p>
<div class="highlight-python"><pre>brew install nodejs</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Homebrew does not provide an easy way to install our supported version of
node.js and npm. The above appears to be compatible, however unexpected
results may still occur.</p>
</div>
<p>On Debian:</p>
<div class="highlight-python"><pre># Using Ubuntu
sudo curl -sL https://deb.nodesource.com/setup_0.10 | sudo -E bash -
sudo apt-get install -y nodejs

# Using Debian
sudo curl -sL https://deb.nodesource.com/setup_0.10 | sudo bash -
sudo apt-get install -y nodejs</pre>
</div>
<p>On CentOS:</p>
<div class="highlight-python"><pre>sudo curl -sL https://rpm.nodesource.com/setup | bash -
sudo yum install -y nodejs</pre>
</div>
</div>
<div class="section" id="check-out-and-initialize-the-project">
<h3>Check out and initialize the project<a class="headerlink" href="#check-out-and-initialize-the-project" title="Permalink to this headline">¶</a></h3>
<p>All project initialization, and virtual environment creation, is handled via
npm. This process is fairly straightforward, and will ensure that all
dependencies, tools, and other resources are available.:</p>
<div class="highlight-python"><pre># Check out the project
git checkout git://git.openstack.org/openstack/&lt;PROJECT NAME&gt;.git

# Initialize the project.
cd &lt;PROJECT NAME&gt;
npm install</pre>
</div>
</div>
<div class="section" id="exercise-the-codebase">
<h3>Exercise the codebase<a class="headerlink" href="#exercise-the-codebase" title="Permalink to this headline">¶</a></h3>
<p>After initialization, you should be able to run some basic tests.</p>
<blockquote>
<div><dl class="docutils">
<dt><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">lint</span></tt></dt>
<dd>This will run our codestyle checks.</dd>
<dt><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">test</span></tt></dt>
<dd>This will run tests and report on test coverage.</dd>
<dt><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">start</span></tt></dt>
<dd>For web-based projects, this command should launch a server.</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="common-tools">
<h2>Common Tools<a class="headerlink" href="#common-tools" title="Permalink to this headline">¶</a></h2>
<p>The following section addresses each command prescribed by the
Consistent Testing Interface, including tools and setup instructions for the
same.</p>
<div class="section" id="codestyle-checks">
<h3>Codestyle Checks<a class="headerlink" href="#codestyle-checks" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">lint</span></tt></dd>
</dl>
</div></blockquote>
<p>OpenStack requires the custom npm script &#8216;lint&#8217; to execute our codestyle
checks. The tool we use is called ESLint, and our rules are published to npm
as <a class="reference external" href="http://git.openstack.org/cgit/openstack/eslint-config-openstack">eslint-config-openstack</a>. To initialize your project with these rules,
perform the following steps in your project root.</p>
<p>First, add eslint and eslint-config-openstack to your project, and initialize
a basic .eslintrc file.:</p>
<div class="highlight-python"><pre>npm install --save-dev eslint eslint-config-openstack
echo "extends: openstack" &gt; .eslintrc</pre>
</div>
<p>Second, add the lint script to your <tt class="code docutils literal"><span class="pre">project.json</span></tt> file:</p>
<div class="highlight-python"><pre>{
  ...
  'scripts' : {
    'lint': 'eslint ./'
  },
  ...
}</pre>
</div>
<p>For more information on how to exclude files, override specific rules, or on
the rules themselves, please visit the <a class="reference external" href="http://eslint.org">ESLint Project</a>. If you&#8217;d like to
contribute to OpenStack&#8217;s ESLint rules, you may do so at
<a class="reference external" href="http://git.openstack.org/cgit/openstack/eslint-config-openstack">eslint-config-openstack</a>.</p>
</div>
<div class="section" id="executing-tests-and-coverage">
<h3>Executing Tests and Coverage<a class="headerlink" href="#executing-tests-and-coverage" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">test</span></tt></dd>
</dl>
</div></blockquote>
<p>OpenStack requires a sane testing and code coverage strategy for each
project, though we do not prescribe the tools and coverage threshold, as
these may differ based on circumstance and project type. Generated test
reports should be placed in <tt class="code docutils literal"><span class="pre">./reports</span></tt> in your projects&#8217; root directory.
Generated coverage output should similarly be placed in <tt class="code docutils literal"><span class="pre">./cover</span></tt>.</p>
<p>Example setup for browser projects, using Karma, Jasmine, and Istanbul.:</p>
<div class="highlight-python"><pre>// ./package.json
{
  ...
  "scripts": {
    ...
    "test": "karma start ./karma.conf.js",
    ...
  },
  "devDependencies": {
    ...
    "jasmine": "2.3.2",
    "karma": "0.13.9",
    "karma-chrome-launcher": "0.2.0",
    "karma-cli": "0.1.0",
    "karma-coverage": "0.5.0",
    "karma-firefox-launcher": "0.1.6",
    "karma-jasmine": "0.3.6",
    "karma-phantomjs-launcher": "0.2.1",
    "karma-threshold-reporter": "0.1.15",
    ...
  }
}

// ./karma.conf.js
module.exports = function (config) {
  config.set({
    'frameworks': ['jasmine'],
    'browsers': ['PhantomJS', 'Chrome', 'Firefox'],
    'reporters': ['progress', 'coverage', 'threshold'],

    'plugins': [
      'karma-jasmine',
      'karma-coverage',
      'karma-threshold-reporter',
      'karma-phantomjs-launcher',
      'karma-chrome-launcher',
      'karma-firefox-launcher'
    ],

    'preprocessors': {
      'www/js/{!lib/**/*.js,*.js}': ['coverage']
    },

    'files': [
      // Library files, with some ordering.
      'www/js/lib/angular.js',
      'node_modules/angular-mocks/angular-mocks.js',
      'www/js/lib/*.js',

      // Application files
      'www/js/**/*.js',

      // Tests
      'test/js/**/*.js'
    ],

    'coverageReporter': {
      type: 'html',
      dir: 'cover',
      instrumenterOptions: {
        istanbul: {noCompact: true}
      }
    },

    // Coverage threshold values.
    thresholdReporter: {
      statements: 100,
      branches: 100,
      functions: 100,
      lines: 100
    },
    'singleRun': true
  });
};</pre>
</div>
<p>Example setup for node.js projects, using Jasmine and Istanbul:</p>
<div class="highlight-python"><pre># /package.json
{
  ...
  "scripts": {
    "test": "istanbul cover --print=detail --include-all-sources jasmine",
    ...
  },
  ...
  "devDependencies": {
    ...
    "istanbul": "0.3.17",
    "jasmine": "2.3.1",
    ...
  }
}

# /spec/support/jasmine.json
{
  "spec_dir": "spec",
  "spec_files": [
    "**/*.js",
    "!helpers/**/*.js"
  ],
  "helpers": [
    "helpers/**/*.js"
  ]
}</pre>
</div>
</div>
<div class="section" id="package-tarball-generation">
<h3>Package Tarball Generation<a class="headerlink" href="#package-tarball-generation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">pack</span></tt></dd>
</dl>
</div></blockquote>
<p>OpenStack uses <tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">pack</span></tt> to generate a release tarball, which will
compile all files listed in <tt class="code docutils literal"><span class="pre">package.json</span></tt>. If your project requires
concatenation, minification, or any other preprocessing to create a valid
tarball, you may use the npm <tt class="code docutils literal"><span class="pre">prepublish</span></tt> hook to trigger these steps.</p>
<p>An example package.json file may look as follows.:</p>
<div class="highlight-python"><pre>{
  ...
  'scripts': {
    'prepublish': 'uglify -s ./src/**/*.js -o ./lib/generated.min.js'
  },
  files: [
    'LICENSE',
    'README.md',
    'index.js',
    'lib/*.js'
  ],
  ...
}</pre>
</div>
<p>All packages should include:</p>
<blockquote>
<div><ul class="simple">
<li>A README</li>
<li>A LICENSE file</li>
<li>All source code</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="generate-documentation">
<h3>Generate Documentation<a class="headerlink" href="#generate-documentation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">document</span></tt></dd>
</dl>
</div></blockquote>
<p>No canonical way of generating documentation for JavaScript projects has been
discussed yet. If you would like to contribute, please join the conversation
on freenode in #openstack-docs or #openstack-javascript.</p>
</div>
<div class="section" id="validate-dependency-licences">
<h3>Validate Dependency Licences<a class="headerlink" href="#validate-dependency-licences" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">document</span></tt></dd>
</dl>
</div></blockquote>
<p>No common way of validating dependency licenses has been discussed yet. If you
would like to contribute, please join the conversation on freenode in
#openstack-javascript.</p>
</div>
<div class="section" id="import-translation-strings">
<h3>Import Translation Strings<a class="headerlink" href="#import-translation-strings" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>Commands:</dt>
<dd><tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">translate</span></tt></dd>
</dl>
</div></blockquote>
<p>No canonical way of importing translations for JavaScript projects has been
discussed yet. If you would like to contribute, please join the conversation
on freenode in #openstack-i18n and #openstack-javascript.</p>
</div>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<p>All best practices outlined in the general project setup guide apply to
JavaScript projects. What follows are additional suggestions.</p>
<div class="section" id="use-the-tool-not-the-adapter">
<h3>Use the tool, not the adapter<a class="headerlink" href="#use-the-tool-not-the-adapter" title="Permalink to this headline">¶</a></h3>
<p>This section in particular addresses gulp, grunt, and similar build
tools that aim to be the collect all build steps under one roof. While
useful, they often achieve this by wrapping a tool that already exists, while
adding dependencies of their own. In order to avoid this bloat - and
potential cross-dependency version mismatch - it is far easier to use the
tool directly, than maintaining the additional abstraction layer.</p>
<p>Examples:
* Use <tt class="code docutils literal"><span class="pre">eslint</span></tt> instead of <tt class="code docutils literal"><span class="pre">gulp-eslint</span></tt>
* Use <tt class="code docutils literal"><span class="pre">karma</span></tt> instead of <tt class="code docutils literal"><span class="pre">grunt-karma</span></tt>
* Use <tt class="code docutils literal"><span class="pre">webpack</span></tt> instead of <tt class="code docutils literal"><span class="pre">gulp-webpack</span></tt></p>
</div>
<div class="section" id="do-not-minify">
<h3>Do Not Minify<a class="headerlink" href="#do-not-minify" title="Permalink to this headline">¶</a></h3>
<p>Minification is a frequently used optimization step that reduces
JavaScript file size at the cost of legibility. While this step often provides
significant load reduction, especially when combined with HTTP GZip
compression and HTTP Cache headers, we prefer to leave this decision in the
hands of the operator.</p>
</div>
<div class="section" id="do-not-use-fuzzy-versions">
<h3>Do Not Use Fuzzy Versions<a class="headerlink" href="#do-not-use-fuzzy-versions" title="Permalink to this headline">¶</a></h3>
<p>Dependencies declared in package.json or bower.json use a fuzzy version
markup that allows installed dependencies to be flexible at the cost of
deterministic builds. This is especially dangerous if one of your project&#8217;s
dependencies also uses fuzzy versioning, when an incompatibility is introduced
in a transient dependency. Please use fixed versions for all your
dependencies, and (if possible) lock them using <tt class="code docutils literal"><span class="pre">npm</span> <span class="pre">shrinkwrap</span></tt>.</p>
</div>
<div class="section" id="naming-conventions">
<h3>Naming conventions<a class="headerlink" href="#naming-conventions" title="Permalink to this headline">¶</a></h3>
<p>Naming a project is tricky, as each project must avoid name reservation
conflict, while clearly communicating its purpose and intent. Names should
consider the following:</p>
<ul class="simple">
<li>How does it distinguish itself - amongst openstack projects - as a
javascript project rather than a python project.</li>
<li>How does it distinguish itself - among npm or bower packages - that it is an
openstack project.</li>
<li>How does it clearly communicate which team it is associated with?</li>
<li>How does it communicate its purpose and content?</li>
<li>How does it acommodate our existing naming conventions in gerrit?</li>
<li>How does it communiate peer library requirements, such as angular.js?</li>
</ul>
<dl class="docutils">
<dt>Suggested names patterns:</dt>
<dd><dl class="first last docutils">
<dt><tt class="code docutils literal"><span class="pre">openstack/oslo-jslib</span></tt></dt>
<dd>A javascript library of common utilities used in other OpenStack
projects, published to bower as <tt class="code docutils literal"><span class="pre">openstack-oslo-jslib</span></tt></dd>
<dt><tt class="code docutils literal"><span class="pre">openstack/ironic-jslib</span></tt></dt>
<dd>A javascript library that integrates with the Ironic API, published to bower
as <tt class="code docutils literal"><span class="pre">openstack-ironic-jslib</span></tt></dd>
<dt><tt class="code docutils literal"><span class="pre">openstack/ironic-jsclient</span></tt></dt>
<dd>A commandline client for ironic, written in JavaScript, published to npm
as <tt class="code docutils literal"><span class="pre">openstack-ironic-jsclient</span></tt></dd>
<dt><tt class="code docutils literal"><span class="pre">openstack/ironic-webclient</span></tt></dt>
<dd>A web client that provides a human interface to the Ironic API.</dd>
</dl>
</dd>
</dl>
<p>Exceptions may occur where a tool prescribes an existing naming convention.</p>
<blockquote>
<div><dl class="docutils">
<dt>eslint-config-openstack</dt>
<dd>A list of JavaScript style rules for eslint.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="publish-multiple-artifacts">
<h3>Publish multiple artifacts<a class="headerlink" href="#publish-multiple-artifacts" title="Permalink to this headline">¶</a></h3>
<p>If your JavaScript project can be consumed by more than one style of
application, it&#8217;s often helpful to publish separate artifacts for each
indented use.</p>
<p>Example artifact names might include:</p>
<ul class="simple">
<li>openstack-oslo-jslib.ng.js</li>
<li>openstack-oslo-jslib.react.js</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3><a href="../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">JavaScript Project Setup Guidelines</a><ul>
<li><a class="reference internal" href="#quickstart">Quickstart</a><ul>
<li><a class="reference internal" href="#install-dependencies">Install Dependencies</a></li>
<li><a class="reference internal" href="#check-out-and-initialize-the-project">Check out and initialize the project</a></li>
<li><a class="reference internal" href="#exercise-the-codebase">Exercise the codebase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-tools">Common Tools</a><ul>
<li><a class="reference internal" href="#codestyle-checks">Codestyle Checks</a></li>
<li><a class="reference internal" href="#executing-tests-and-coverage">Executing Tests and Coverage</a></li>
<li><a class="reference internal" href="#package-tarball-generation">Package Tarball Generation</a></li>
<li><a class="reference internal" href="#generate-documentation">Generate Documentation</a></li>
<li><a class="reference internal" href="#validate-dependency-licences">Validate Dependency Licences</a></li>
<li><a class="reference internal" href="#import-translation-strings">Import Translation Strings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li><a class="reference internal" href="#use-the-tool-not-the-adapter">Use the tool, not the adapter</a></li>
<li><a class="reference internal" href="#do-not-minify">Do Not Minify</a></li>
<li><a class="reference internal" href="#do-not-use-fuzzy-versions">Do Not Use Fuzzy Versions</a></li>
<li><a class="reference internal" href="#naming-conventions">Naming conventions</a></li>
<li><a class="reference internal" href="#publish-multiple-artifacts">Publish multiple artifacts</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="python.html"
                                  title="previous chapter">Python Project Guide</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../testing.html"
                                  title="next chapter">Testing (QA and CI)</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/openstack/project-team-guide
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/project-setup/javascript.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../testing.html" title="Testing (QA and CI)"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="python.html" title="Python Project Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">OpenStack Project Team Guide 0.0.1.dev126 documentation</a> &raquo;</li>
          <li><a href="../project-setup.html" accesskey="U">Project Setup</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2017, OpenStack Contributors - use the <a href="https://git.openstack.org/cgit/openstack/project-team-guide">project-team-guide git repo</a> to propose changes.
      Last updated on Tue Jan 31 20:58:51 2017, commit b2069ac.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/OpenStack Project Team Guide");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>