<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Integrate Identity with LDAP</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Integrate Identity with LDAP</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="identity-external-authentication.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: External authentication with Identity"></i></a>
    
    
    <a href="identity-tokens.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Keystone tokens"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Integrate Identity with LDAP</a><ul>
<li><a class="reference internal" href="#identity-ldap-server-setup">Identity LDAP server set up</a></li>
<li><a class="reference internal" href="#integrate-identity-back-end-with-ldap">Integrate Identity back end with LDAP</a></li>
<li><a class="reference internal" href="#secure-the-openstack-identity-service-connection-to-an-ldap-back-end">Secure the OpenStack Identity service connection to an LDAP back end</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="integrate-identity-with-ldap">
<span id="id1"></span><h1>Integrate Identity with LDAP<a class="headerlink" href="#integrate-identity-with-ldap" title="Permalink to this headline">¶</a></h1>
<p>The OpenStack Identity service supports integration with existing LDAP
directories for authentication and authorization services. LDAP back
ends require initialization before configuring the OpenStack Identity
service to work with it. For more information, see <a class="reference external" href="https://wiki.openstack.org/wiki/OpenLDAP">Setting up LDAP
for use with Keystone</a>.</p>
<p>When the OpenStack Identity service is configured to use LDAP back ends,
you can split authentication (using the <em>identity</em> feature) and
authorization (using the <em>assignment</em> feature).</p>
<p>The <em>identity</em> feature enables administrators to manage users and groups
by each domain or the OpenStack Identity service entirely.</p>
<p>The <em>assignment</em> feature enables administrators to manage project role
authorization using the OpenStack Identity service SQL database, while
providing user authentication through the LDAP directory.</p>
<div class="section" id="identity-ldap-server-setup">
<span id="identity-ldap-server-set-up"></span><h2>Identity LDAP server set up<a class="headerlink" href="#identity-ldap-server-setup" title="Permalink to this headline">¶</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>For the OpenStack Identity service to access LDAP servers, you must
enable the <code class="docutils literal"><span class="pre">authlogin_nsswitch_use_ldap</span></code> boolean value for SELinux
on the server running the OpenStack Identity service. To enable and
make the option persistent across reboots, set the following boolean
value as the root user:</p>
<div class="last highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> setsebool -P authlogin_nsswitch_use_ldap on
</pre></div>
</div>
</div>
<p>The Identity configuration is split into two separate back ends; identity
(back end for users and groups), and assignments (back end for domains,
projects, roles, role assignments). To configure Identity, set options
in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file. See
<a class="reference internal" href="#integrate-identity-backend-ldap"><span class="std std-ref">Integrate Identity back end with LDAP</span></a> for Identity back end configuration
examples. Modify these examples as needed.</p>
<p><strong>To define the destination LDAP server</strong></p>
<ol class="arabic">
<li><p class="first">Define the destination LDAP server in the
<code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">url</span> <span class="o">=</span> <span class="s">ldap://localhost</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">dc=Manager,dc=example,dc=org</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">samplepassword</span>
<span class="na">suffix</span> <span class="o">=</span> <span class="s">dc=example,dc=org</span>
</pre></div>
</div>
</li>
</ol>
<p><strong>Additional LDAP integration settings</strong></p>
<p>Set these options in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file for a
single LDAP server, or <code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code>
files for multiple back ends. Example configurations appear below each
setting summary:</p>
<p><strong>Query option</strong></p>
<table class="hlist"><tr><td><ul class="simple">
<li>Use <code class="docutils literal"><span class="pre">query_scope</span></code> to control the scope level of data presented
(search only the first level or search an entire sub-tree)
through LDAP.</li>
<li>Use <code class="docutils literal"><span class="pre">page_size</span></code> to control the maximum results per page. A value
of zero disables paging.</li>
<li>Use <code class="docutils literal"><span class="pre">alias_dereferencing</span></code> to control the LDAP dereferencing
option for queries.</li>
</ul>
</td></tr></table>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">query_scope</span> <span class="o">=</span> <span class="s">sub</span>
<span class="na">page_size</span> <span class="o">=</span> <span class="s">0</span>
<span class="na">alias_dereferencing</span> <span class="o">=</span> <span class="s">default</span>
<span class="na">chase_referrals</span> <span class="o">=</span>
</pre></div>
</div>
<p><strong>Debug</strong></p>
<p>Use <code class="docutils literal"><span class="pre">debug_level</span></code> to set the LDAP debugging level for LDAP calls.
A value of zero means that debugging is not enabled.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">debug_level</span> <span class="o">=</span> <span class="s">0</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This value is a bitmask, consult your LDAP documentation for
possible values.</p>
</div>
<p><strong>Connection pooling</strong></p>
<p>Use <code class="docutils literal"><span class="pre">use_pool</span></code> to enable LDAP connection pooling. Configure the
connection pool size, maximum retry, reconnect trials, timeout (-1
indicates indefinite wait) and lifetime in seconds.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">use_pool</span> <span class="o">=</span> <span class="s">true</span>
<span class="na">pool_size</span> <span class="o">=</span> <span class="s">10</span>
<span class="na">pool_retry_max</span> <span class="o">=</span> <span class="s">3</span>
<span class="na">pool_retry_delay</span> <span class="o">=</span> <span class="s">0.1</span>
<span class="na">pool_connection_timeout</span> <span class="o">=</span> <span class="s">-1</span>
<span class="na">pool_connection_lifetime</span> <span class="o">=</span> <span class="s">600</span>
</pre></div>
</div>
<p><strong>Connection pooling for end user authentication</strong></p>
<p>Use <code class="docutils literal"><span class="pre">use_auth_pool</span></code> to enable LDAP connection pooling for end user
authentication. Configure the connection pool size and lifetime in
seconds.</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">use_auth_pool</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">auth_pool_size</span> <span class="o">=</span> <span class="s">100</span>
<span class="na">auth_pool_connection_lifetime</span> <span class="o">=</span> <span class="s">60</span>
</pre></div>
</div>
<p>When you have finished the configuration, restart the OpenStack Identity
service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">During the service restart, authentication and authorization are
unavailable.</p>
</div>
</div>
<div class="section" id="integrate-identity-back-end-with-ldap">
<span id="integrate-identity-backend-ldap"></span><h2>Integrate Identity back end with LDAP<a class="headerlink" href="#integrate-identity-back-end-with-ldap" title="Permalink to this headline">¶</a></h2>
<p>The Identity back end contains information for users, groups, and group
member lists. Integrating the Identity back end with LDAP allows
administrators to use users and groups in LDAP.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">For OpenStack Identity service to access LDAP servers, you must
define the destination LDAP server in the
<code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file. For more information,
see <a class="reference internal" href="#identity-ldap-server-setup"><span class="std std-ref">Identity LDAP server set up</span></a>.</p>
</div>
<p><strong>To integrate one Identity back end with LDAP</strong></p>
<ol class="arabic">
<li><p class="first">Enable the LDAP Identity driver in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code>
file. This allows LDAP as an identity back end:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[identity]</span>
<span class="c1">#driver = sql</span>
<span class="na">driver</span> <span class="o">=</span> <span class="s">ldap</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the organizational units (OU) in the LDAP directory, and define
the corresponding location in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code>
file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_tree_dn</span> <span class="o">=</span> <span class="s">ou=Users,dc=example,dc=org</span>
<span class="na">user_objectclass</span> <span class="o">=</span> <span class="s">inetOrgPerson</span>

<span class="na">group_tree_dn</span> <span class="o">=</span> <span class="s">ou=Groups,dc=example,dc=org</span>
<span class="na">group_objectclass</span> <span class="o">=</span> <span class="s">groupOfNames</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These schema attributes are extensible for compatibility with
various schemas. For example, this entry maps to the person
attribute in Active Directory:</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="na">user_objectclass</span> <span class="o">=</span> <span class="s">person</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">A read-only implementation is recommended for LDAP integration. These
permissions are applied to object types in the
<code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_allow_create</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">user_allow_update</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">user_allow_delete</span> <span class="o">=</span> <span class="s">False</span>

<span class="na">group_allow_create</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">group_allow_update</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">group_allow_delete</span> <span class="o">=</span> <span class="s">False</span>
</pre></div>
</div>
<p>Restart the OpenStack Identity service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">During service restart, authentication and authorization are
unavailable.</p>
</div>
</li>
</ol>
<p><strong>To integrate multiple Identity back ends with LDAP</strong></p>
<ol class="arabic">
<li><p class="first">Set the following options in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code>
file:</p>
<ol class="arabic">
<li><p class="first">Enable the LDAP driver:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[identity]</span>
<span class="c1">#driver = sql</span>
<span class="na">driver</span> <span class="o">=</span> <span class="s">ldap</span>
</pre></div>
</div>
</li>
<li><p class="first">Enable domain-specific drivers:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[identity]</span>
<span class="na">domain_specific_drivers_enabled</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">domain_config_dir</span> <span class="o">=</span> <span class="s">/etc/keystone/domains</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Restart the OpenStack Identity service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">During service restart, authentication and authorization are
unavailable.</p>
</div>
</li>
<li><p class="first">List the domains using the dashboard, or the OpenStackClient CLI. Refer
to the <a class="reference external" href="https://docs.openstack.org/developer/python-openstackclient/command-list.html">Command List</a>
for a list of OpenStackClient commands.</p>
</li>
<li><p class="first">Create domains using OpenStack dashboard, or the OpenStackClient CLI.</p>
</li>
<li><p class="first">For each domain, create a domain-specific configuration file in the
<code class="docutils literal"><span class="pre">/etc/keystone/domains</span></code> directory. Use the file naming convention
<code class="docutils literal"><span class="pre">keystone.DOMAIN_NAME.conf</span></code>, where DOMAIN_NAME is the domain name
assigned in the previous step.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The options set in the
<code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code> file will
override options in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file.</p>
</div>
</li>
<li><p class="first">Define the destination LDAP server in the
<code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code> file. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">url</span> <span class="o">=</span> <span class="s">ldap://localhost</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">dc=Manager,dc=example,dc=org</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">samplepassword</span>
<span class="na">suffix</span> <span class="o">=</span> <span class="s">dc=example,dc=org</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the organizational units (OU) in the LDAP directories, and define
their corresponding locations in the
<code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code> file. For example:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_tree_dn</span> <span class="o">=</span> <span class="s">ou=Users,dc=example,dc=org</span>
<span class="na">user_objectclass</span> <span class="o">=</span> <span class="s">inetOrgPerson</span>

<span class="na">group_tree_dn</span> <span class="o">=</span> <span class="s">ou=Groups,dc=example,dc=org</span>
<span class="na">group_objectclass</span> <span class="o">=</span> <span class="s">groupOfNames</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>These schema attributes are extensible for compatibility with
various schemas. For example, this entry maps to the person
attribute in Active Directory:</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="na">user_objectclass</span> <span class="o">=</span> <span class="s">person</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">A read-only implementation is recommended for LDAP integration. These
permissions are applied to object types in the
<code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code> file:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_allow_create</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">user_allow_update</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">user_allow_delete</span> <span class="o">=</span> <span class="s">False</span>

<span class="na">group_allow_create</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">group_allow_update</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">group_allow_delete</span> <span class="o">=</span> <span class="s">False</span>
</pre></div>
</div>
</li>
<li><p class="first">Restart the OpenStack Identity service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">During service restart, authentication and authorization are
unavailable.</p>
</div>
</li>
</ol>
<p><strong>Additional LDAP integration settings</strong></p>
<p>Set these options in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file for a
single LDAP server, or <code class="docutils literal"><span class="pre">/etc/keystone/domains/keystone.DOMAIN_NAME.conf</span></code>
files for multiple back ends. Example configurations appear below each
setting summary:</p>
<dl class="docutils">
<dt>Filters</dt>
<dd><p class="first">Use filters to control the scope of data presented through LDAP.</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_filter</span> <span class="o">=</span> <span class="s">(memberof=cn=openstack-users,ou=workgroups,dc=example,dc=org)</span>
<span class="na">group_filter</span> <span class="o">=</span>
</pre></div>
</div>
</dd>
<dt>Identity attribute mapping</dt>
<dd><p class="first">Mask account status values (include any additional attribute
mappings) for compatibility with various directory services.
Superfluous accounts are filtered with <code class="docutils literal"><span class="pre">user_filter</span></code>.</p>
<p>Setting attribute ignore to list of attributes stripped off on
update.</p>
<p>For example, you can mask Active Directory account status attributes
in the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> file:</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_id_attribute</span>      <span class="o">=</span> <span class="s">cn</span>
<span class="na">user_name_attribute</span>    <span class="o">=</span> <span class="s">sn</span>
<span class="na">user_mail_attribute</span>    <span class="o">=</span> <span class="s">mail</span>
<span class="na">user_pass_attribute</span>    <span class="o">=</span> <span class="s">userPassword</span>
<span class="na">user_enabled_attribute</span> <span class="o">=</span> <span class="s">userAccountControl</span>
<span class="na">user_enabled_mask</span>      <span class="o">=</span> <span class="s">2</span>
<span class="na">user_enabled_invert</span>    <span class="o">=</span> <span class="s">false</span>
<span class="na">user_enabled_default</span>   <span class="o">=</span> <span class="s">512</span>
<span class="na">user_default_project_id_attribute</span> <span class="o">=</span>
<span class="na">user_additional_attribute_mapping</span> <span class="o">=</span>

<span class="na">group_id_attribute</span>     <span class="o">=</span> <span class="s">cn</span>
<span class="na">group_name_attribute</span>   <span class="o">=</span> <span class="s">ou</span>
<span class="na">group_member_attribute</span> <span class="o">=</span> <span class="s">member</span>
<span class="na">group_desc_attribute</span>   <span class="o">=</span> <span class="s">description</span>
<span class="na">group_additional_attribute_mapping</span> <span class="o">=</span>
</pre></div>
</div>
</dd>
<dt>Enabled emulation</dt>
<dd><p class="first">An alternative method to determine if a user is enabled or not is by
checking if that user is a member of the emulation group.</p>
<p>Use DN of the group entry to hold enabled user when using enabled
emulation.</p>
<div class="last highlight-ini"><div class="highlight"><pre><span></span><span class="k">[ldap]</span>
<span class="na">user_enabled_emulation</span> <span class="o">=</span> <span class="s">false</span>
<span class="na">user_enabled_emulation_dn</span> <span class="o">=</span> <span class="s">false</span>
</pre></div>
</div>
</dd>
</dl>
<p>When you have finished configuration, restart the OpenStack Identity
service.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">During service restart, authentication and authorization are
unavailable.</p>
</div>
</div>
<div class="section" id="secure-the-openstack-identity-service-connection-to-an-ldap-back-end">
<h2>Secure the OpenStack Identity service connection to an LDAP back end<a class="headerlink" href="#secure-the-openstack-identity-service-connection-to-an-ldap-back-end" title="Permalink to this headline">¶</a></h2>
<p>The Identity service supports the use of TLS to encrypt LDAP traffic.
Before configuring this, you must first verify where your certificate
authority file is located. For more information, see the
<a class="reference external" href="https://docs.openstack.org/security-guide/secure-communication/introduction-to-ssl-and-tls.html">OpenStack Security Guide SSL introduction</a>.</p>
<p>Once you verify the location of your certificate authority file:</p>
<p><strong>To configure TLS encryption on LDAP traffic</strong></p>
<ol class="arabic">
<li><p class="first">Open the <code class="docutils literal"><span class="pre">/etc/keystone/keystone.conf</span></code> configuration file.</p>
</li>
<li><p class="first">Find the <code class="docutils literal"><span class="pre">[ldap]</span></code> section.</p>
</li>
<li><p class="first">In the <code class="docutils literal"><span class="pre">[ldap]</span></code> section, set the <code class="docutils literal"><span class="pre">use_tls</span></code> configuration key to
<code class="docutils literal"><span class="pre">True</span></code>. Doing so will enable TLS.</p>
</li>
<li><p class="first">Configure the Identity service to use your certificate authorities file.
To do so, set the <code class="docutils literal"><span class="pre">tls_cacertfile</span></code> configuration key in the <code class="docutils literal"><span class="pre">ldap</span></code>
section to the certificate authorities file&#8217;s path.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can also set the <code class="docutils literal"><span class="pre">tls_cacertdir</span></code> (also in the <code class="docutils literal"><span class="pre">ldap</span></code>
section) to the directory where all certificate authorities files
are kept. If both <code class="docutils literal"><span class="pre">tls_cacertfile</span></code> and <code class="docutils literal"><span class="pre">tls_cacertdir</span></code> are set,
then the latter will be ignored.</p>
</div>
</li>
<li><p class="first">Specify what client certificate checks to perform on incoming TLS
sessions from the LDAP server. To do so, set the <code class="docutils literal"><span class="pre">tls_req_cert</span></code>
configuration key in the <code class="docutils literal"><span class="pre">[ldap]</span></code> section to <code class="docutils literal"><span class="pre">demand</span></code>, <code class="docutils literal"><span class="pre">allow</span></code>, or
<code class="docutils literal"><span class="pre">never</span></code>:</p>
<table class="hlist"><tr><td><ul class="simple">
<li><code class="docutils literal"><span class="pre">demand</span></code> - The LDAP server always receives certificate
requests. The session terminates if no certificate
is provided, or if the certificate provided cannot be verified
against the existing certificate authorities file.</li>
<li><code class="docutils literal"><span class="pre">allow</span></code> - The LDAP server always receives certificate
requests. The session will proceed as normal even if a certificate
is not provided. If a certificate is provided but it cannot be
verified against the existing certificate authorities file, the
certificate will be ignored and the session will proceed as
normal.</li>
<li><code class="docutils literal"><span class="pre">never</span></code> - A certificate will never be requested.</li>
</ul>
</td></tr></table>
</li>
</ol>
<p>On distributions that include openstack-config, you can configure TLS
encryption on LDAP traffic by running the following commands instead.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">#</span> openstack-config --set /etc/keystone/keystone.conf <span class="se">\</span>
  ldap use_tls True
<span class="gp">#</span> openstack-config --set /etc/keystone/keystone.conf <span class="se">\</span>
  ldap tls_cacertfile <span class="sb">``</span>CA_FILE<span class="sb">``</span>
<span class="gp">#</span> openstack-config --set /etc/keystone/keystone.conf <span class="se">\</span>
  ldap tls_req_cert <span class="sb">``</span>CERT_BEHAVIOR<span class="sb">``</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">CA_FILE</span></code> is the absolute path to the certificate authorities file
that should be used to encrypt LDAP traffic.</li>
<li><code class="docutils literal"><span class="pre">CERT_BEHAVIOR</span></code> specifies what client certificate checks to perform
on an incoming TLS session from the LDAP server (<code class="docutils literal"><span class="pre">demand</span></code>,
<code class="docutils literal"><span class="pre">allow</span></code>, or <code class="docutils literal"><span class="pre">never</span></code>).</li>
</ul>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="identity-external-authentication.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: External authentication with Identity"></i></a>
          
          
            <a href="identity-tokens.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Keystone tokens"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/get-started-with-openstack.html">Get started with OpenStack</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="identity-management.html">Identity management</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="identity-concepts.html">Identity concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-certificates-for-pki.html">Certificates for PKI</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-domain-specific-config.html">Domain-specific configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-external-authentication.html">External authentication with Identity</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Integrate Identity with LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-tokens.html">Keystone tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-token-binding.html">Configure Identity service for token binding</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-fernet-token-faq.html">Fernet - Frequently Asked Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-use-trusts.html">Use trusts</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-caching-layer.html">Caching layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-security-compliance.html">Security compliance and PCI-DSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-keystone-usage-and-features.html">Example usage and Identity features</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-auth-token-middleware.html">Authentication middleware with user name and password</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-service-api-protection.html">Identity API protection with role-based access control (RBAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity-troubleshoot.html">Troubleshoot the Identity service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="objectstorage.html">Object Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="blockstorage.html">Block Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared-file-systems.html">Shared File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="baremetal.html">Bare Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration.html">Orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">OpenStack command-line clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross-project.html">Cross-project features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "identity-integrate-with-ldap" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/admin-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 0719207c6d82d2c215b9c13234f3a27478e0c0f3";
        var bugProject = "openstack-manuals";
        var bugTitle = "Integrate Identity with LDAP in Administrator Guide";
    var fieldTags = "admin-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 08:39";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>