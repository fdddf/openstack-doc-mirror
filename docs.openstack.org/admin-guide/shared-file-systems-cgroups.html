<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Consistency groups</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Consistency groups</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="shared-file-systems-security-services.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Security services"></i></a>
    
    
    <a href="shared-file-systems-share-replication.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Share replication"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Consistency groups</a><ul>
<li><a class="reference internal" href="#id1">Consistency groups</a></li>
<li><a class="reference internal" href="#consistency-group-snapshots">Consistency group snapshots</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="consistency-groups">
<span id="shared-file-systems-cgroups"></span><h1>Consistency groups<a class="headerlink" href="#consistency-groups" title="Permalink to this headline">¶</a></h1>
<p>Consistency groups enable you to create snapshots from multiple file system
shares at the same point in time. For example, a database might place its
tables, logs, and configurations on separate shares. Store logs, tables,
and configurations at the same point in time to effectively restore a
database.</p>
<p>The Shared File System service allows you to create a snapshot of the
consistency group and restore all shares that were associated with a
consistency group.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The <strong>consistency groups and snapshots</strong> are an <strong>experimental</strong>
Shared File Systems API in the Liberty release.
Contributors can change or remove the experimental part of the
Shared File Systems API in further releases without maintaining
backward compatibility. Experimental APIs have an
<code class="docutils literal"><span class="pre">X-OpenStack-Manila-API-Experimental:</span> <span class="pre">true</span></code> header in
their HTTP requests.</p>
</div>
<div class="section" id="id1">
<h2>Consistency groups<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Before using consistency groups, make sure the Shared File System driver
that you are running has consistency group support. You can check it in the
<code class="docutils literal"><span class="pre">manila-scheduler</span></code> service reports. The <code class="docutils literal"><span class="pre">consistency_group_support</span></code> can
have the following values:</p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">pool</span></code> or <code class="docutils literal"><span class="pre">host</span></code>. Consistency groups are supported. Specifies the
level of consistency groups support.</li>
<li><code class="docutils literal"><span class="pre">false</span></code>. Consistency groups are not supported.</li>
</ul>
</div>
<p>The <strong class="command">manila cg-create</strong> command creates a new consistency group.
With this command, you can specify a share network, and one or more share
types. In the example a consistency group <code class="docutils literal"><span class="pre">cgroup1</span></code> was created by
specifying two comma-separated share types:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-create --name cgroup1 --description <span class="s2">&quot;My first CG.&quot;</span> --share-types my_type1,default --share-network my_share_net
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| Property             | Value                                |</span>
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| status               | creating                             |</span>
<span class="go">| description          | My first CG.                         |</span>
<span class="go">| source_cgsnapshot_id | None                                 |</span>
<span class="go">| created_at           | 2015-09-29T15:01:12.102472           |</span>
<span class="go">| share_network_id     | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |</span>
<span class="go">| share_server_id      | None                                 |</span>
<span class="go">| host                 | None                                 |</span>
<span class="go">| project_id           | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| share_types          | a4218aa5-f16a-42b3-945d-113496d40558 |</span>
<span class="go">|                      | c0086582-30a6-4060-b096-a42ec9d66b86 |</span>
<span class="go">| id                   | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |</span>
<span class="go">| name                 | cgroup1                              |</span>
<span class="go">+----------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Check that consistency group status is <code class="docutils literal"><span class="pre">available</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-show cgroup1
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| Property             | Value                                |</span>
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| status               | available                            |</span>
<span class="go">| description          | My first CG.                         |</span>
<span class="go">| source_cgsnapshot_id | None                                 |</span>
<span class="go">| created_at           | 2015-09-29T15:05:40.000000           |</span>
<span class="go">| share_network_id     | 5c3cbabb-f4da-465f-bc7f-fadbe047b85a |</span>
<span class="go">| share_server_id      | None                                 |</span>
<span class="go">| host                 | manila@generic1#GENERIC1             |</span>
<span class="go">| project_id           | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| share_types          | c0086582-30a6-4060-b096-a42ec9d66b86 |</span>
<span class="go">|                      | a4218aa5-f16a-42b3-945d-113496d40558 |</span>
<span class="go">| id                   | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |</span>
<span class="go">| name                 | cgroup1                              |</span>
<span class="go">+----------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>To add a share to the consistency group, create a share by adding the
<code class="docutils literal"><span class="pre">--consistency-group</span></code> option where you specify the ID of the consistency
group in <code class="docutils literal"><span class="pre">available</span></code> status:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila create nfs <span class="m">1</span> --name <span class="s2">&quot;Share2&quot;</span> --description <span class="s2">&quot;My second share&quot;</span> <span class="se">\</span>
--share-type default --share-network my_share_net --consistency-group cgroup1
<span class="go">+-----------------------------+--------------------------------------+</span>
<span class="go">| Property                    | Value                                |</span>
<span class="go">+-----------------------------+--------------------------------------+</span>
<span class="go">| status                      | None                                 |</span>
<span class="go">| share_type_name             | default                              |</span>
<span class="go">| description                 | My second share                      |</span>
<span class="go">| availability_zone           | None                                 |</span>
<span class="go">| share_network_id            | None                                 |</span>
<span class="go">| export_locations            | []                                   |</span>
<span class="go">| share_server_id             | None                                 |</span>
<span class="go">| host                        | None                                 |</span>
<span class="go">| snapshot_id                 | None                                 |</span>
<span class="go">| is_public                   | False                                |</span>
<span class="go">| task_state                  | None                                 |</span>
<span class="go">| snapshot_support            | True                                 |</span>
<span class="go">| id                          | 7bcd888b-681b-4836-ac9c-c3add4e62537 |</span>
<span class="go">| size                        | 1                                    |</span>
<span class="go">| name                        | Share2                               |</span>
<span class="go">| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86 |</span>
<span class="go">| created_at                  | 2015-09-29T15:09:24.156387           |</span>
<span class="go">| export_location             | None                                 |</span>
<span class="go">| share_proto                 | NFS                                  |</span>
<span class="go">| consistency_group_id        | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |</span>
<span class="go">| source_cgsnapshot_member_id | None                                 |</span>
<span class="go">| project_id                  | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| metadata                    | {}                                   |</span>
<span class="go">+-----------------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Administrators can rename the consistency group, or change its
description using the <strong class="command">manila cg-update</strong> command. Delete the group
with the <strong class="command">manila cg-delete</strong> command.</p>
<p>As an administrator, you can also reset the state of a consistency group and
force delete a specified consistency group in any state. Use the
<code class="docutils literal"><span class="pre">policy.json</span></code> file to grant permissions for these actions to other roles.</p>
<p>Use <strong class="command">manila cg-reset-state [--state &lt;state&gt;] &lt;consistency_group&gt;</strong>
to update the state of a consistency group explicitly. A valid value of a
status are <code class="docutils literal"><span class="pre">available</span></code>, <code class="docutils literal"><span class="pre">error</span></code>, <code class="docutils literal"><span class="pre">creating</span></code>, <code class="docutils literal"><span class="pre">deleting</span></code>,
<code class="docutils literal"><span class="pre">error_deleting</span></code>. If no state is provided, <code class="docutils literal"><span class="pre">available</span></code> will be used.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-reset-state cgroup1 --state error
</pre></div>
</div>
<p>Use <strong class="command">manila cg-delete &lt;consistency_group&gt; [&lt;consistency_group&gt; ...]</strong>
to soft-delete one or more consistency groups.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A consistency group can be deleted only if it has no dependent
<a class="reference internal" href="#shared-file-systems-cgsnapshots"><span class="std std-ref">Consistency group snapshots</span></a>.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-delete cgroup1
</pre></div>
</div>
<p>Use <strong class="command">manila cg-delete --force &lt;consistency_group&gt;
[&lt;consistency_group&gt; ...]</strong>
to force-delete a specified consistency group in any state.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-delete --force cgroup1
</pre></div>
</div>
</div>
<div class="section" id="consistency-group-snapshots">
<span id="shared-file-systems-cgsnapshots"></span><h2>Consistency group snapshots<a class="headerlink" href="#consistency-group-snapshots" title="Permalink to this headline">¶</a></h2>
<p>To create a snapshot, specify the ID or name of the consistency group.
After creating a consistency group snapshot, it is possible to generate
a new consistency group.</p>
<p>Create a snapshot of consistency group <code class="docutils literal"><span class="pre">cgroup1</span></code>:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-snapshot-create cgroup1 --name CG_snapshot1 --description <span class="s2">&quot;A snapshot of the first CG.&quot;</span>
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| Property             | Value                                |</span>
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| status               | creating                             |</span>
<span class="go">| name                 | CG_snapshot1                         |</span>
<span class="go">| created_at           | 2015-09-29T15:26:16.839704           |</span>
<span class="go">| consistency_group_id | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |</span>
<span class="go">| project_id           | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| id                   | 876ad24c-1efd-4607-a2b1-6a2c90034fa5 |</span>
<span class="go">| description          | A snapshot of the first CG.          |</span>
<span class="go">+----------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Check the status of created consistency group snapshot:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-snapshot-show CG_snapshot1
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| Property             | Value                                |</span>
<span class="go">+----------------------+--------------------------------------+</span>
<span class="go">| status               | available                            |</span>
<span class="go">| name                 | CG_snapshot1                         |</span>
<span class="go">| created_at           | 2015-09-29T15:26:22.000000           |</span>
<span class="go">| consistency_group_id | 6fdd91bc-7a48-48b4-8e40-0f4f98d0ecd6 |</span>
<span class="go">| project_id           | 20787a7ba11946adad976463b57d8a2f     |</span>
<span class="go">| id                   | 876ad24c-1efd-4607-a2b1-6a2c90034fa5 |</span>
<span class="go">| description          | A snapshot of the first CG.          |</span>
<span class="go">+----------------------+--------------------------------------+</span>
</pre></div>
</div>
<p>Administrators can rename a consistency group snapshot, change its
description using the <strong class="command">cg-snapshot-update</strong> command, or delete
it with the <strong class="command">cg-snapshot-delete</strong> command.</p>
<p>A consistency group snapshot can have <code class="docutils literal"><span class="pre">members</span></code>. To add a member,
include the <code class="docutils literal"><span class="pre">--consistency-group</span></code> optional parameter in the
create share command. This ID must match the ID of the consistency group from
which the consistency group snapshot was created. Then, while restoring data,
and operating with consistency group snapshots, you can quickly
find which shares belong to a specified consistency group.</p>
<p>You created the share <code class="docutils literal"><span class="pre">Share2</span></code> in <code class="docutils literal"><span class="pre">cgroup1</span></code> consistency group. Since
you made a snapshot of it, you can see that the only member of the consistency
group snapshot is <code class="docutils literal"><span class="pre">Share2</span></code> share:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-snapshot-members CG_snapshot1
<span class="go">+--------------+------+----------------------------+----------------+--------------+--------------+</span>
<span class="go">| Id           | Size | Created_at                 | Share_protocol | Share_id     | Share_type_id|</span>
<span class="go">+--------------+------+----------------------------+----------------+--------------+--------------+</span>
<span class="go">| 5c62af2b-... | 1    | 2015-09-29T15:26:22.000000 | NFS            | 7bcd888b-... | c0086582-... |</span>
<span class="go">+--------------+------+----------------------------+----------------+--------------+--------------+</span>
</pre></div>
</div>
<p>After you create a consistency group snapshot, you can create a consistency
group from the new snapshot:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-create --source-cgsnapshot-id 876ad24c-1efd-4607-a2b1-6a2c90034fa5 --name cgroup2 --description <span class="s2">&quot;A consistency group from a CG snapshot.&quot;</span>
<span class="go">+----------------------+-----------------------------------------+</span>
<span class="go">| Property             | Value                                   |</span>
<span class="go">+----------------------+-----------------------------------------+</span>
<span class="go">| status               | creating                                |</span>
<span class="go">| description          | A consistency group from a CG snapshot. |</span>
<span class="go">| source_cgsnapshot_id | 876ad24c-1efd-4607-a2b1-6a2c90034fa5    |</span>
<span class="go">| created_at           | 2015-09-29T15:47:47.937991              |</span>
<span class="go">| share_network_id     | None                                    |</span>
<span class="go">| share_server_id      | None                                    |</span>
<span class="go">| host                 | manila@generic1#GENERIC1                |</span>
<span class="go">| project_id           | 20787a7ba11946adad976463b57d8a2f        |</span>
<span class="go">| share_types          | c0086582-30a6-4060-b096-a42ec9d66b86    |</span>
<span class="go">|                      | a4218aa5-f16a-42b3-945d-113496d40558    |</span>
<span class="go">| id                   | ffee08d9-c86c-45e5-861e-175c731daca2    |</span>
<span class="go">| name                 | cgroup2                                 |</span>
<span class="go">+----------------------+-----------------------------------------+</span>
</pre></div>
</div>
<p>Check the consistency group list. Two groups now appear:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila cg-list
<span class="go">+-------------------+---------+-----------------------------------------+-----------+</span>
<span class="go">| id                | name    | description                             | status    |</span>
<span class="go">+-------------------+---------+-----------------------------------------+-----------+</span>
<span class="go">| 6fdd91bc-7a48-... | cgroup1 | My first CG.                            | available |</span>
<span class="go">| ffee08d9-c86c-... | cgroup2 | A consistency group from a CG snapshot. | available |</span>
<span class="go">+-------------------+---------+-----------------------------------------+-----------+</span>
</pre></div>
</div>
<p>Check a list of the shares. New share with
<code class="docutils literal"><span class="pre">ba52454e-2ea3-47fa-a683-3176a01295e6</span></code> ID appeared after the
consistency group <code class="docutils literal"><span class="pre">cgroup2</span></code> was built from a snapshot with a member.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila list
<span class="go">+------+-------+-----+------------+----------+----------+-----------+--------------------------+</span>
<span class="go">| ID   | Name  | Size| Share Proto| Status   | Is Public| Share Type| Host                     |</span>
<span class="go">+------+-------+-----+------------+----------+----------+-----------+--------------------------+</span>
<span class="go">| 7bc..| Share2| 1   | NFS        | available| False    | c008658...| manila@generic1#GENERIC1 |</span>
<span class="go">| ba5..| None  | 1   | NFS        | available| False    | c008658...| manila@generic1#GENERIC1 |</span>
<span class="go">+------+-------+-----+------------+----------+----------+-----------+--------------------------+</span>
</pre></div>
</div>
<p>Print detailed information about new share:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pay attention on the <code class="docutils literal"><span class="pre">source_cgsnapshot_member_id</span></code> and
<code class="docutils literal"><span class="pre">consistency_group_id</span></code> fields in a new share. It has
<code class="docutils literal"><span class="pre">source_cgsnapshot_member_id</span></code> that is equal to the ID of the consistency
group snapshot and <code class="docutils literal"><span class="pre">consistency_group_id</span></code> that is equal to the ID of
<code class="docutils literal"><span class="pre">cgroup2</span></code> created from a snapshot.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila show ba52454e-2ea3-47fa-a683-3176a01295e6
<span class="go">+-----------------------------+---------------------------------------------------------------+</span>
<span class="go">| Property                    | Value                                                         |</span>
<span class="go">+-----------------------------+---------------------------------------------------------------+</span>
<span class="go">| status                      | available                                                     |</span>
<span class="go">| share_type_name             | default                                                       |</span>
<span class="go">| description                 | None                                                          |</span>
<span class="go">| availability_zone           | None                                                          |</span>
<span class="go">| share_network_id            | None                                                          |</span>
<span class="go">| export_locations            | 10.254.0.5:/shares/share-5acadf4d-f81a-4515-b5ce-3ab641ab4d1e |</span>
<span class="go">| share_server_id             | None                                                          |</span>
<span class="go">| host                        | manila@generic1#GENERIC1                                      |</span>
<span class="go">| snapshot_id                 | None                                                          |</span>
<span class="go">| is_public                   | False                                                         |</span>
<span class="go">| task_state                  | None                                                          |</span>
<span class="go">| snapshot_support            | True                                                          |</span>
<span class="go">| id                          | ba52454e-2ea3-47fa-a683-3176a01295e6                          |</span>
<span class="go">| size                        | 1                                                             |</span>
<span class="go">| name                        | None                                                          |</span>
<span class="go">| share_type                  | c0086582-30a6-4060-b096-a42ec9d66b86                          |</span>
<span class="go">| created_at                  | 2015-09-29T15:47:48.000000                                    |</span>
<span class="go">| share_proto                 | NFS                                                           |</span>
<span class="go">| consistency_group_id        | ffee08d9-c86c-45e5-861e-175c731daca2                          |</span>
<span class="go">| source_cgsnapshot_member_id | 5c62af2b-0870-4d00-b3fa-174831eb15ca                          |</span>
<span class="go">| project_id                  | 20787a7ba11946adad976463b57d8a2f                              |</span>
<span class="go">| metadata                    | {}                                                            |</span>
<span class="go">+-----------------------------+---------------------------------------------------------------+</span>
</pre></div>
</div>
<p>As an administrator, you can also reset the state of a consistency group
snapshot with the <strong class="command">cg-snapshot-reset-state</strong> command, and force delete a specified
consistency group snapshot in any state using the <strong class="command">cg-snapshot-delete</strong> command
with the <code class="docutils literal"><span class="pre">--force</span></code> key. Use the <code class="docutils literal"><span class="pre">policy.json</span></code> file to grant permissions for
these actions to other roles.</p>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="shared-file-systems-security-services.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Security services"></i></a>
          
          
            <a href="shared-file-systems-share-replication.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Share replication"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/get-started-with-openstack.html">Get started with OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="identity-management.html">Identity management</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="objectstorage.html">Object Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="blockstorage.html">Block Storage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="shared-file-systems.html">Shared File Systems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-key-concepts.html">Key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-share-management.html">Share management</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-manage-shares-cli.html">Migrate shares</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-share-types.html">Share types</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-snapshots.html">Share snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-security-services.html">Security services</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Consistency groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-share-replication.html">Share replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-multi-backend.html">Multi-storage configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-networking.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared-file-systems-troubleshoot.html">Troubleshoot Shared File Systems service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="baremetal.html">Bare Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration.html">Orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">OpenStack command-line clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross-project.html">Cross-project features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "shared-file-systems-cgroups" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/admin-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 0719207c6d82d2c215b9c13234f3a27478e0c0f3";
        var bugProject = "openstack-manuals";
        var bugTitle = "Consistency groups in Administrator Guide";
    var fieldTags = "admin-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 08:39";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>