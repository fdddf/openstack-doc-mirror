<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Database</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//ask.openstack.org">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="//superuser.openstack.org">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Database</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="telemetry-best-practices.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Telemetry best practices"></i></a>
    
    
    <a href="baremetal.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Bare Metal"></i></a>
    
    <a id="logABugLink1" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="#">Database</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#create-a-data-store">Create a data store</a><ul>
<li><a class="reference internal" href="#data-store-classifications">Data store classifications</a></li>
<li><a class="reference internal" href="#redis-data-store-replication">Redis data store replication</a></li>
<li><a class="reference internal" href="#redis-integration-and-unit-tests">Redis integration and unit tests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-a-cluster">Configure a cluster</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="database">
<span id="id1"></span><h1>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h1>
<p>The Database service provides database management features.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Database service provides scalable and reliable cloud
provisioning functionality for both relational and non-relational
database engines. Users can quickly and easily use database features
without the burden of handling complex administrative tasks. Cloud
users and database administrators can provision and manage multiple
database instances as needed.</p>
<p>The Database service provides resource isolation at high performance
levels, and automates complex administrative tasks such as deployment,
configuration, patching, backups, restores, and monitoring.</p>
<p>You can modify various cluster characteristics by editing the
<code class="docutils literal"><span class="pre">/etc/trove/trove.conf</span></code> file. A comprehensive list of the Database
service configuration options is described in the <a class="reference external" href="https://docs.openstack.org/newton/config-reference/database.html">Database service</a>
chapter in the <em>Configuration Reference</em>.</p>
</div>
<div class="section" id="create-a-data-store">
<h2>Create a data store<a class="headerlink" href="#create-a-data-store" title="Permalink to this headline">¶</a></h2>
<p>An administrative user can create data stores for a variety of
databases.</p>
<p>This section assumes you do not yet have a MySQL data store, and shows
you how to create a MySQL data store and populate it with a MySQL 5.5
data store version.</p>
<p><strong>To create a data store</strong></p>
<ol class="arabic">
<li><p class="first"><strong>Create a trove image</strong></p>
<p>Create an image for the type of database you want to use, for
example, MySQL, MongoDB, Cassandra.</p>
<p>This image must have the trove guest agent installed, and it must
have the <code class="docutils literal"><span class="pre">trove-guestagent.conf</span></code> file configured to connect to
your OpenStack environment. To configure <code class="docutils literal"><span class="pre">trove-guestagent.conf</span></code>,
add the following lines to <code class="docutils literal"><span class="pre">trove-guestagent.conf</span></code> on the guest
instance you are using to build your image:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="na">rabbit_host</span> <span class="o">=</span> <span class="s">controller</span>
<span class="na">rabbit_password</span> <span class="o">=</span> <span class="s">RABBIT_PASS</span>
<span class="na">nova_proxy_admin_user</span> <span class="o">=</span> <span class="s">admin</span>
<span class="na">nova_proxy_admin_pass</span> <span class="o">=</span> <span class="s">ADMIN_PASS</span>
<span class="na">nova_proxy_admin_tenant_name</span> <span class="o">=</span> <span class="s">service</span>
<span class="na">trove_auth_url</span> <span class="o">=</span> <span class="s">http://controller:35357/v2.0</span>
</pre></div>
</div>
<p>This example assumes you have created a MySQL 5.5 image called
<code class="docutils literal"><span class="pre">mysql-5.5.qcow2</span></code>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>If you have a guest image that was created with an OpenStack version
before Kilo, modify the guest agent init script for the guest image to
read the configuration files from the directory <code class="docutils literal"><span class="pre">/etc/trove/conf.d</span></code>.</p>
<p class="last">For a backwards compatibility with pre-Kilo guest instances, set the
database service configuration options <code class="docutils literal"><span class="pre">injected_config_location</span></code> to
<code class="docutils literal"><span class="pre">/etc/trove</span></code> and <code class="docutils literal"><span class="pre">guest_info</span></code> to <code class="docutils literal"><span class="pre">/etc/guest_info</span></code>.</p>
</div>
</li>
<li><p class="first"><strong>Register image with Image service</strong></p>
<p>You need to register your guest image with the Image service.</p>
<p>In this example, you use the <strong class="command">openstack image create</strong>
command to register a <code class="docutils literal"><span class="pre">mysql-5.5.qcow2</span></code> image.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack image create mysql-5.5 --disk-format qcow2 --container-format bare --public &lt; mysql-5.5.qcow2
<span class="go">+------------------+------------------------------------------------------+</span>
<span class="go">| Field            | Value                                                |</span>
<span class="go">+------------------+------------------------------------------------------+</span>
<span class="go">| checksum         | 133eae9fb1c98f45894a4e60d8736619                     |</span>
<span class="go">| container_format | bare                                                 |</span>
<span class="go">| created_at       | 2016-12-21T12:10:02Z                                 |</span>
<span class="go">| disk_format      | qcow2                                                |</span>
<span class="go">| file             | /v2/images/d1afb4f0-2360-4400-8d97-846b1ab6af52/file |</span>
<span class="go">| id               | d1afb4f0-2360-4400-8d97-846b1ab6af52                 |</span>
<span class="go">| min_disk         | 0                                                    |</span>
<span class="go">| min_ram          | 0                                                    |</span>
<span class="go">| name             | mysql-5.5                                            |</span>
<span class="go">| owner            | 5669caad86a04256994cdf755df4d3c1                     |</span>
<span class="go">| protected        | False                                                |</span>
<span class="go">| schema           | /v2/schemas/image                                    |</span>
<span class="go">| size             | 13200896                                             |</span>
<span class="go">| status           | active                                               |</span>
<span class="go">| tags             |                                                      |</span>
<span class="go">| updated_at       | 2016-12-21T12:10:03Z                                 |</span>
<span class="go">| virtual_size     | None                                                 |</span>
<span class="go">| visibility       | public                                               |</span>
<span class="go">+------------------+------------------------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Create the data store</strong></p>
<p>Create the data store that will house the new image. To do this, use
the <strong class="command">trove-manage</strong> <strong class="command">datastore_update</strong> command.</p>
<p>This example uses the following arguments:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
<th class="head">In this example:</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>config file</td>
<td>The configuration file to use.</td>
<td><code class="docutils literal"><span class="pre">--config-file=/etc/trove/trove.conf</span></code></td>
</tr>
<tr class="row-odd"><td>name</td>
<td>Name you want to use for this data store.</td>
<td><code class="docutils literal"><span class="pre">mysql</span></code></td>
</tr>
<tr class="row-even"><td>default version</td>
<td>You can attach multiple versions/images to a data store. For
example, you might have a MySQL 5.5 version and a MySQL 5.6
version. You can designate one version as the default, which
the system uses if a user does not explicitly request a
specific version.</td>
<td><p class="first"><code class="docutils literal"><span class="pre">&quot;&quot;</span></code></p>
<p class="last">At this point, you do not yet have a default version, so pass
in an empty string.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove-manage --config-file<span class="o">=</span>/etc/trove/trove.conf datastore_update mysql <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Add a version to the new data store</strong></p>
<p>Now that you have a MySQL data store, you can add a version to it,
using the <strong class="command">trove-manage</strong> <strong class="command">datastore_version_update</strong>
command. The version indicates which guest image to use.</p>
<p>This example uses the following arguments:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
<th class="head">In this example:</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>config file</td>
<td>The configuration file to use.</td>
<td><code class="docutils literal"><span class="pre">--config-file=/etc/trove/trove.conf</span></code></td>
</tr>
<tr class="row-odd"><td>data store</td>
<td>The name of the data store you just created via
<code class="docutils literal"><span class="pre">trove-manage</span></code> <strong class="command">datastore_update</strong>.</td>
<td><code class="docutils literal"><span class="pre">mysql</span></code></td>
</tr>
<tr class="row-even"><td>version name</td>
<td>The name of the version you are adding to the data store.</td>
<td><code class="docutils literal"><span class="pre">mysql-5.5</span></code></td>
</tr>
<tr class="row-odd"><td>data store manager</td>
<td><p class="first">Which data store manager to use for this version. Typically,
the data store manager is identified by one of the following
strings, depending on the database:</p>
<ul class="last simple">
<li>cassandra</li>
<li>couchbase</li>
<li>couchdb</li>
<li>db2</li>
<li>mariadb</li>
<li>mongodb</li>
<li>mysql</li>
<li>percona</li>
<li>postgresql</li>
<li>pxc</li>
<li>redis</li>
<li>vertica</li>
</ul>
</td>
<td><code class="docutils literal"><span class="pre">mysql</span></code></td>
</tr>
<tr class="row-even"><td>glance ID</td>
<td>The ID of the guest image you just added to the Image
service. You can get this ID by using the glance
<strong class="command">image-show</strong> IMAGE_NAME command.</td>
<td>bb75f870-0c33-4907-8467-1367f8cb15b6</td>
</tr>
<tr class="row-odd"><td>packages</td>
<td>If you want to put additional packages on each guest that
you create with this data store version, you can list the
package names here.</td>
<td><p class="first"><code class="docutils literal"><span class="pre">&quot;&quot;</span></code></p>
<p class="last">In this example, the guest image already contains all the
required packages, so leave this argument empty.</p>
</td>
</tr>
<tr class="row-even"><td>active</td>
<td><dl class="first last docutils">
<dt>Set this to either 1 or 0:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal"><span class="pre">1</span></code> = active</li>
<li><code class="docutils literal"><span class="pre">0</span></code> = disabled</li>
</ul>
</dd>
</dl>
</td>
<td>1</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove-manage --config-file<span class="o">=</span>/etc/trove/trove.conf datastore_version_update mysql mysql-5.5 mysql GLANCE_ID <span class="s2">&quot;&quot;</span> <span class="m">1</span>
</pre></div>
</div>
<p><strong>Optional.</strong> Set your new version as the default version. To do
this, use the <strong class="command">trove-manage</strong> <strong class="command">datastore_update</strong>
command again, this time specifying the version you just created.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove-manage --config-file<span class="o">=</span>/etc/trove/trove.conf datastore_update mysql mysql-5.5
</pre></div>
</div>
</li>
<li><p class="first"><strong>Load validation rules for configuration groups</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Applies only to MySQL and Percona data stores</strong></p>
<ul class="last simple">
<li>If you just created a MySQL or Percona data store, then you need
to load the appropriate validation rules, as described in this
step.</li>
<li>If you just created a different data store, skip this step.</li>
</ul>
</div>
<p><strong>Background.</strong> You can manage database configuration tasks by using
configuration groups. Configuration groups let you set configuration
parameters, in bulk, on one or more databases.</p>
<p>When you set up a configuration group using the trove
<strong class="command">configuration-create</strong> command, this command compares the configuration
values you are setting against a list of valid configuration values
that are stored in the <code class="docutils literal"><span class="pre">validation-rules.json</span></code> file.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Operating System</th>
<th class="head">Location of <code class="file docutils literal"><span class="pre">validation-rules.json</span></code></th>
<th class="head">Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Ubuntu 14.04</td>
<td><code class="file docutils literal"><span class="pre">/usr/lib/python2.7/dist-packages/trove/templates/DATASTORE_NAME</span></code></td>
<td>DATASTORE_NAME is the name of either the MySQL data store or
the Percona data store. This is typically either <code class="docutils literal"><span class="pre">mysql</span></code>
or <code class="docutils literal"><span class="pre">percona</span></code>.</td>
</tr>
<tr class="row-odd"><td>RHEL 7, CentOS 7, Fedora 20, and Fedora 21</td>
<td><code class="file docutils literal"><span class="pre">/usr/lib/python2.7/site-packages/trove/templates/DATASTORE_NAME</span></code></td>
<td>DATASTORE_NAME is the name of either the MySQL data store or
the Percona data store. This is typically either <code class="docutils literal"><span class="pre">mysql</span></code> or <code class="docutils literal"><span class="pre">percona</span></code>.</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Therefore, as part of creating a data store, you need to load the
<code class="docutils literal"><span class="pre">validation-rules.json</span></code> file, using the <strong class="command">trove-manage</strong>
<strong class="command">db_load_datastore_config_parameters</strong> command. This command
takes the following arguments:</p>
<ul class="simple">
<li>Data store name</li>
<li>Data store version</li>
<li>Full path to the <code class="docutils literal"><span class="pre">validation-rules.json</span></code> file</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This example loads the <code class="docutils literal"><span class="pre">validation-rules.json</span></code> file for a MySQL
database on Ubuntu 14.04:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove-manage db_load_datastore_config_parameters mysql mysql-5.5 /usr/lib/python2.7/dist-packages/trove/templates/mysql/validation-rules.json
</pre></div>
</div>
</li>
<li><p class="first"><strong>Validate data store</strong></p>
<p>To validate your new data store and version, start by listing the
data stores on your system:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove datastore-list
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">|                  id                  |     name     |</span>
<span class="go">+--------------------------------------+--------------+</span>
<span class="go">| 10000000-0000-0000-0000-000000000001 | Legacy MySQL |</span>
<span class="go">| e5dc1da3-f080-4589-a4c2-eff7928f969a |    mysql     |</span>
<span class="go">+--------------------------------------+--------------+</span>
</pre></div>
</div>
<p>Take the ID of the MySQL data store and pass it in with the
<strong class="command">datastore-version-list</strong> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> trove datastore-version-list DATASTORE_ID
<span class="go">+--------------------------------------+-----------+</span>
<span class="go">|                  id                  |    name   |</span>
<span class="go">+--------------------------------------+-----------+</span>
<span class="go">| 36a6306b-efd8-4d83-9b75-8b30dd756381 | mysql-5.5 |</span>
<span class="go">+--------------------------------------+-----------+</span>
</pre></div>
</div>
</li>
</ol>
<div class="section" id="data-store-classifications">
<h3>Data store classifications<a class="headerlink" href="#data-store-classifications" title="Permalink to this headline">¶</a></h3>
<p>The Database service supports a variety of both relational and
non-relational database engines, but to a varying degree of support for
each <a class="reference internal" href="common/glossary.html#term-data-store"><span class="xref std std-term">data store</span></a>. The Database service project has defined
several classifications that indicate the quality of support for each
data store. Data stores also implement different extensions.
An extension is called a <a class="reference internal" href="common/glossary.html#term-strategy"><span class="xref std std-term">strategy</span></a> and is classified similar to
data stores.</p>
<p>Valid classifications for a data store and a strategy are:</p>
<ul class="simple">
<li>Experimental</li>
<li>Technical preview</li>
<li>Stable</li>
</ul>
<p>Each classification builds on the previous one. This means that a data store
that meets the <code class="docutils literal"><span class="pre">technical</span> <span class="pre">preview</span></code> requirements must also meet all the
requirements for <code class="docutils literal"><span class="pre">experimental</span></code>, and a data store that meets the <code class="docutils literal"><span class="pre">stable</span></code>
requirements must also meet all the requirements for <code class="docutils literal"><span class="pre">technical</span> <span class="pre">preview</span></code>.</p>
<p><strong>Requirements</strong></p>
<ul>
<li><p class="first">Experimental</p>
<p>A data store is considered to be <code class="docutils literal"><span class="pre">experimental</span></code> if it meets these criteria:</p>
<ul class="simple">
<li>It implements a basic subset of the Database service API including
<code class="docutils literal"><span class="pre">create</span></code> and <code class="docutils literal"><span class="pre">delete</span></code>.</li>
<li>It has guest agent elements that allow guest agent creation.</li>
<li>It has a definition of supported operating systems.</li>
<li>It meets the other
<a class="reference external" href="https://specs.openstack.org/openstack/trove-specs/specs/kilo/experimental-datastores.html#requirements">Documented Technical Requirements</a>.</li>
</ul>
<p>A strategy is considered <code class="docutils literal"><span class="pre">experimental</span></code> if:</p>
<ul class="simple">
<li>It meets the
<a class="reference external" href="https://specs.openstack.org/openstack/trove-specs/specs/kilo/experimental-datastores.html#requirements">Documented Technical Requirements</a>.</li>
</ul>
</li>
<li><p class="first">Technical preview</p>
<p>A data store is considered to be a <code class="docutils literal"><span class="pre">technical</span> <span class="pre">preview</span></code> if it meets the
requirements of <code class="docutils literal"><span class="pre">experimental</span></code> and further:</p>
<ul>
<li><p class="first">It implements APIs required to plant and start the capabilities of the
data store as defined in the
<a class="reference external" href="https://wiki.openstack.org/wiki/Trove/DatastoreCompatibilityMatrix">Datastore Compatibility Matrix</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is not required that the data store implements all features like
resize, backup, replication, or clustering to meet this classification.</p>
</div>
</li>
<li><p class="first">It provides a mechanism for building a guest image that allows you to
exercise its capabilities.</p>
</li>
<li><p class="first">It meets the other
<a class="reference external" href="https://specs.openstack.org/openstack/trove-specs/specs/kilo/experimental-datastores.html#requirements">Documented Technical Requirements</a>.</p>
</li>
</ul>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">A strategy is not normally considered to be <code class="docutils literal"><span class="pre">technical</span>
<span class="pre">preview</span></code>.</p>
</div>
</li>
<li><p class="first">Stable</p>
<p>A data store or a strategy is considered <code class="docutils literal"><span class="pre">stable</span></code> if:</p>
<ul class="simple">
<li>It meets the requirements of <code class="docutils literal"><span class="pre">technical</span> <span class="pre">preview</span></code>.</li>
<li>It meets the other
<a class="reference external" href="https://specs.openstack.org/openstack/trove-specs/specs/kilo/experimental-datastores.html#requirements">Documented Technical Requirements</a>.</li>
</ul>
</li>
</ul>
<p><strong>Initial Classifications</strong></p>
<p>The following table shows the current classification assignments for the
different data stores.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Classification</th>
<th class="head">Data store</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Stable</td>
<td>MySQL</td>
</tr>
<tr class="row-odd"><td>Technical Preview</td>
<td>Cassandra, MongoDB</td>
</tr>
<tr class="row-even"><td>Experimental</td>
<td>All others</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="redis-data-store-replication">
<h3>Redis data store replication<a class="headerlink" href="#redis-data-store-replication" title="Permalink to this headline">¶</a></h3>
<p>Replication strategies are available for Redis with
several commands located in the Redis data store
manager:</p>
<ul class="simple">
<li><strong class="command">create</strong></li>
<li><strong class="command">detach-replica</strong></li>
<li><strong class="command">eject-replica-source</strong></li>
<li><strong class="command">promote-to-replica-source</strong></li>
</ul>
<p>Additional arguments for the <strong class="command">create</strong> command
include <strong class="command">--replica_of</strong> and
<strong class="command">--replica_count</strong>.</p>
</div>
<div class="section" id="redis-integration-and-unit-tests">
<h3>Redis integration and unit tests<a class="headerlink" href="#redis-integration-and-unit-tests" title="Permalink to this headline">¶</a></h3>
<p>Unit tests and integration tests are also available for
Redis.</p>
<ol class="arabic">
<li><p class="first">Install redstack:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./redstack install

<span class="go">.. note::</span>

<span class="go">   Redstack is a development script used for integration</span>
<span class="go">   testing and Database service development installations.</span>
<span class="go">   Do not use Redstack in a production environment. For</span>
<span class="go">   more information, see `the Database service</span>
<span class="go">   developer docs &lt;https://docs.openstack.org/developer/trove/dev/install.html#running-redstack-to-install-trove&gt;`_</span>
</pre></div>
</div>
</li>
<li><p class="first">Start Redis:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./redstack kick-start redis
</pre></div>
</div>
</li>
<li><p class="first">Run integration tests:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./redstack int-tests --group<span class="o">=</span>replication
</pre></div>
</div>
<p>You can run <strong class="command">--group=redis_supported</strong>
instead of <strong class="command">--group=replication</strong> if needed.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="configure-a-cluster">
<h2>Configure a cluster<a class="headerlink" href="#configure-a-cluster" title="Permalink to this headline">¶</a></h2>
<p>An administrative user can configure various characteristics of a
MongoDB cluster.</p>
<p><strong>Query routers and config servers</strong></p>
<p><strong>Background.</strong> Each cluster includes at least one query router and
one config server. Query routers and config servers count against your
quota. When you delete a cluster, the system deletes the associated
query router(s) and config server(s).</p>
<p><strong>Configuration.</strong> By default, the system creates one query router and
one config server per cluster. You can change this by editing
the <code class="docutils literal"><span class="pre">/etc/trove/trove.conf</span></code> file. These settings are in the
<code class="docutils literal"><span class="pre">mongodb</span></code> section of the file:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setting</th>
<th class="head">Valid values are:</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>num_config_servers_per_cluster</td>
<td>1 or 3</td>
</tr>
<tr class="row-odd"><td>num_query_routers_per_cluster</td>
<td>1 or 3</td>
</tr>
</tbody>
</table>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="telemetry-best-practices.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Telemetry best practices"></i></a>
          
          
            <a href="baremetal.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Bare Metal"></i></a>
          
            <a id="logABugLink3" href="" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2017-02-14 08:39</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="search-icon show">
    <i class="fa fa-search"></i> Search
  </div>
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/get-started-with-openstack.html">Get started with OpenStack</a></li>
<li class="toctree-l1"><a class="reference internal" href="identity-management.html">Identity management</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute.html">Compute</a></li>
<li class="toctree-l1"><a class="reference internal" href="objectstorage.html">Object Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="blockstorage.html">Block Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared-file-systems.html">Shared File Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-data-store">Create a data store</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-a-cluster">Configure a cluster</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="baremetal.html">Bare Metal</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration.html">Orchestration</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">OpenStack command-line clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross-project.html">Cross-project features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="firewalls-default-ports.html">Firewalls and default ports</a></li>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-1.12.4.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "database" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/admin-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 0719207c6d82d2c215b9c13234f3a27478e0c0f3";
        var bugProject = "openstack-manuals";
        var bugTitle = "Database in Administrator Guide";
    var fieldTags = "admin-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 0.9 on 2017-02-14 08:39";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>